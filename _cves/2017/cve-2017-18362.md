---
layout: post
cve_id: CVE-2017-18362
title: Kaseya VSA 2017 ConnectWise ManagedITSync - Remote Code Execution
pcap: true
pcap_path: /pcaps/2017/CVE-2017-18362.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-18362.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary SQL queries to access and
  modify the Kaseya VSA database, deploy ransomware to all managed endpoints, and
  potentially compromise entire customer infrastructures.

  '
remediation: 'Disable or remove the ConnectWise ManagedITSync integration. If required,
  apply the latest security patches and restrict access to the ManagedIT.asmx endpoint.

  '
reference:
- https://github.com/kbni/owlky
- https://www.huntress.com/blog/cve-2017-18362-arbitrary-sql-injection-in-mangeditsync-integration-ba142ff24f4d
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2017-18362
  cwe-id: CWE-89
  epss-score: 0.87164
  epss-percentile: 0.99419
  cpe: cpe:2.3:a:connectwise:manageditsync:*:*:*:*:*:kaseya_vsa:*:*
metadata:
  vendor: connectwise
  product: manageditsync
  framework: kaseya_vsa
tags:
- cve
- cve2017
- kaseya
- connectwise
- sqli
- kev
- vkev
---

## üîç Vulnerability Description
ConnectWise ManagedITSync integration through 2017 for Kaseya VSA is vulnerable to unauthenticated remote commands that allow full direct access to the Kaseya VSA database. If the ManagedIT.asmx page is available via the Kaseya VSA web interface, anyone with access to the page is able to run arbitrary SQL queries, both read and write, without authentication.In February 2019, attackers actively exploited this vulnerability in the wild to download and execute ransomware payloads on all endpoints managed by the VSA server.


## üåê HTTP Request
```nohighlight
GET /KaseyaCwWebService/ManagedIT.asmx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

