---
layout: post
cve_id: CVE-2017-8046
title: Spring Data REST < 2.6.9 (Ingalls SR9) / 3.0.1 (Kay SR1) - PATCH Request Remote
  Code Execution
pcap: true
pcap_path: /pcaps/2017/CVE-2017-8046.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-8046.yaml
snort2_rule: N/A
snort3_rule: N/A
author: domwhewell-sage
severity: critical
impact: 'Malicious PATCH requests submitted to servers using Spring Data REST versions
  prior to 2.6.9 (Ingalls SR9), versions prior to 3.0.1 (Kay SR1) and Spring Boot
  versions prior to 1.5.9, 2.0 M6 can use specially crafted JSON data to run arbitrary
  Java code.

  '
remediation: 'To remediate this vulnerability, update to Spring Data REST version
  2.6.9 or later, or 3.0.1 or later, and Spring Boot version 1.5.9 or later, or 2.0
  M6 or later.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2017-8046
- https://spring.io/security/cve-2017-8046
- https://access.redhat.com/errata/RHSA-2018:2405
- https://www.exploit-db.com/exploits/44289/
- https://github.com/jkutner/spring-break-cve-2017-8046
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2017-8046
  cwe-id: CWE-20
  epss-score: 0.93978
  epss-percentile: 0.9988
  cpe: cpe:2.3:a:vmware:spring_boot:*:*:*:*:*:*:*:*
metadata:
  vendor: vmware
  product: spring_boot
  shodan-query: http.title:"eureka"
  fofa-query: title="eureka"
  google-query: intitle:"eureka"
tags:
- cve
- cve2017
- pivotal
- springboot
- pivotal_software
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Spring Data REST < 2.6.9 and 3.0.1, Spring Boot < 1.5.9 and 2.0 M6 contain a remote code execution caused by processing malicious PATCH requests with crafted JSON data, letting attackers execute arbitrary Java code, exploit requires sending malicious PATCH requests.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

