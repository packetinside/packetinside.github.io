---
layout: post
cve_id: CVE-2019-11253
title: Kubernetes API Server - YAML Parsing DoS (Billion Laughs)
pcap: true
pcap_path: /pcaps/2019/CVE-2019-11253.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-11253.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Attackers can cause the API server to crash or become unavailable by consuming
  excessive CPU or memory resources.

  '
remediation: 'Upgrade to Kubernetes v1.13.12, v1.14.8, v1.15.5, v1.16.2 or later versions
  with fixed input validation.

  '
reference:
- https://gist.github.com/bgeesaman/0e0349e94cd22c48bf14d8a9b7d6b8f2
- https://github.com/kubernetes/kubernetes/issues/83253
- https://nvd.nist.gov/vuln/detail/CVE-2019-11253
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  cvss-score: 7.5
  cve-id: CVE-2019-11253
  epss-score: 0.86289
  epss-percentile: 0.99377
  cwe-id: CWE-400
metadata:
  max-request: 1
  vendor: kubernetes
  product: kubernetes
  shodan-query: http.favicon.hash:-847792508
  fofa-query: icon_hash="-847792508"
tags:
- cve
- cve2019
- kubernetes
- yaml
- k8s
---

## üîç Vulnerability Description
The Kubernetes API server is vulnerable to a denial of service attack via YAML/JSON parsing. An attacker can send a specially crafted YAML/JSON payload that causes exponential memory consumption (Billion Laughs attack), leading to API server crash.


## üåê HTTP Request
```nohighlight
POST /apis/authorization.k8s.io/v1/selfsubjectaccessreviews HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Connection: close
Transfer-Encoding: chunked
Content-Type: application/yaml
Accept-Encoding: gzip

0
```

