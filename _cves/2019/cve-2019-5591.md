---
layout: post
cve_id: CVE-2019-5591
title: FortiOS - Insecure LDAP Configuration Detection
pcap: true
pcap_path: /pcaps/2019/CVE-2019-5591.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-5591.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ayewo
severity: medium
impact: 'Unauthenticated attackers can intercept sensitive information by impersonating
  LDAP servers within the same subnet.

  '
remediation: 'Configure LDAP server settings properly and disable default configurations;
  update to the latest firmware version.

  '
reference:
- https://github.com/ayewo/fortios-ldap-mitm-poc-CVE-2019-5591
- https://www.fortiguard.com/psirt/FG-IR-19-037
classification:
  cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2019-5591
  epss-score: 0.49178
  epss-percentile: 0.97675
  cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: fortinet
  product: fortigate
  shodan-query: cpe:"cpe:2.3:o:fortinet:fortios"
  tags: cve,cve2019,fortinet,ldap,kev,vkev,oast
---

## üîç Vulnerability Description
The FortiGate LDAP configuration was detected to be insecure due to missing ca-cert, secure LDAPS, or server-identity-check, potentially exposing LDAP communications to credential interception or man-in-the-middle attacks under specific network conditions.


## üåê HTTP Request
```nohighlight
GET /login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /logincheck HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Content-Length: 78
Content-Type: text/plain;charset=UTF-8
Accept-Encoding: gzip
ajax=1&username=YCgAsR&secretkey=d5j00t1le0o4s00bod20hig7x4cyu3ppb.oast.online
```

