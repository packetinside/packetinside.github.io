---
layout: "post"
cve_id: "CVE-2019-7609"
title: "Kibana Timelion - Arbitrary Code Execution"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-7609.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-7609.yaml"
author: "dwisiswant0"
severity: "critical"
impact: "Arbitrary code execution can result in unauthorized access, data leakage, and system compromise.
"
remediation: "Apply the latest security patches or upgrade to a patched version of Kibana to mitigate the vulnerability.
"
reference:
  - "https://github.com/mpgn/CVE-2019-7609"
  - "https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077"
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-7609"
  - "https://www.elastic.co/community/security"
  - "https://access.redhat.com/errata/RHBA-2019:2824"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 10, 'cve-id': 'CVE-2019-7609', 'cwe-id': 'CWE-94', 'epss-score': 0.94446, 'epss-percentile': 0.9999, 'cpe': 'cpe:2.3:a:elastic:kibana:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'elastic', 'product': 'kibana', 'shodan-query': 'http.title:"kibana"', 'fofa-query': 'title="kibana"', 'google-query': 'intitle:"kibana"'}"
tags:
  - "cve"
  - "cve2019"
  - "kibana"
  - "rce"
  - "kev"
  - "elastic"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Kibana versions before 5.6.15 and 6.6.1 contain an arbitrary code execution flaw in the Timelion visualizer. An attacker with access to the Timelion application could send a request that will attempt to execute javascript code. This could possibly lead to an attacker executing arbitrary commands with permissions of the Kibana process on the host system.

## üåê HTTP Request
```nohighlight
POST /api/timelion/run HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36
Connection: close
Content-Length: 116
Accept: */*
Accept-Language: en
Content-Type: application/json; charset=utf-8
Accept-Encoding: gzip

{"sheet":[".es(*)"],"time":{"from":"now-1m","to":"now","mode":"quick","interval":"auto","timezone":"Asia/Shanghai"}}
```

