---
layout: post
cve_id: CVE-2021-21087
title: Adobe ColdFusion - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-21087.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21087.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Daviey
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the victim''s browser, potentially leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Apply the latest security patches or updates provided by Adobe to mitigate
  this vulnerability.

  '
reference:
- https://helpx.adobe.com/security/products/coldfusion/apsb21-16.html
- https://twitter.com/Daviey/status/1374070630283415558
- https://nvd.nist.gov/vuln/detail/CVE-2021-21087
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2021-21087
  cwe-id: CWE-79
  epss-score: 0.81792
  epss-percentile: 0.99156
  cpe: cpe:2.3:a:adobe:coldfusion:2016:-:*:*:*:*:*:*
metadata:
  max-request: 7
  vendor: adobe
  product: coldfusion
  shodan-query:
  - http.component:"Adobe ColdFusion"
  - http.component:"adobe coldfusion"
  - http.title:"coldfusion administrator login"
  - cpe:"cpe:2.3:a:adobe:coldfusion"
  fofa-query:
  - title="coldfusion administrator login"
  - app="adobe-coldfusion"
  google-query: intitle:"coldfusion administrator login"
tags:
- cve2021
- cve
- xss
- adobe
- misc
- coldfusion
- vkev
- vuln
---

## üîç Vulnerability Description
Adobe Coldfusion versions 2016 (update 16 and earlier), 2018 (update 10 and earlier) and 2021.0.0.323925 are affected by an Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') vulnerability. An attacker could abuse this vulnerability to execute arbitrary JavaScript code in context of the current user. Exploitation of this issue requires user interaction.


## üåê HTTP Request
```nohighlight
GET /cf_scripts/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.3 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cf-scripts/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: WMS/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /CFIDE/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0, Win64, x64, rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cfide/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /CF_SFSD/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.16
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cfide-scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.12
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cfmx/CFIDE/scripts/ajax/package/cfajax.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.2
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

