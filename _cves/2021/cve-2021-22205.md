---
layout: "post"
cve_id: "CVE-2021-22205"
title: "GitLab CE/EE - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-22205.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-22205.yaml"
author: "GitLab Red Team"
severity: "critical"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected GitLab instance.
"
remediation: "Upgrade to GitLab CE/EE version 13.10.3 or 13.11.1 to mitigate this vulnerability.
"
reference:
  - "https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/red-team-research/cve-2021-22205-hash-generator"
  - "https://gitlab.com/gitlab-com/gl-security/security-operations/gl-redteam/red-team-operations/-/issues/196"
  - "https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22205.json"
  - "https://censys.io/blog/cve-2021-22205-it-was-a-gitlab-smash/"
  - "https://security.humanativaspa.it/gitlab-ce-cve-2021-22205-in-the-wild/"
  - "https://hackerone.com/reports/1154542"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-22205"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 10, 'cve-id': 'CVE-2021-22205', 'cwe-id': 'CWE-94', 'epss-score': 0.94467, 'epss-percentile': 0.99995, 'cpe': 'cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'gitlab', 'product': 'gitlab', 'shodan-query': ['http.title:"GitLab"', 'cpe:"cpe:2.3:a:gitlab:gitlab"', 'http.title:"gitlab"'], 'fofa-query': 'title="gitlab"', 'google-query': 'intitle:"gitlab"'}"
tags:
  - "cve2021"
  - "cve"
  - "kev"
  - "hackerone"
  - "gitlab"
  - "rce"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
GitLab CE/EE starting from 11.9 does not properly validate image files that were passed to a file parser, resulting in a remote command execution vulnerability. This template attempts to passively identify vulnerable versions of GitLab without the need for an exploit by matching unique hashes for the application-<hash>.css file in the header for unauthenticated requests. Positive matches do not guarantee exploitability. Tooling to find relevant hashes based on the semantic version ranges specified in the CVE is linked in the references section below.

## üåê HTTP Request
```nohighlight
GET /users/sign_in HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.75 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

