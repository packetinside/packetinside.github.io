---
layout: post
cve_id: CVE-2021-24220
title: Multiple Thrive Themes < 2.0.0 -  Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24220.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24220.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: critical
impact: 'Attackers can execute arbitrary PHP code, potentially leading to full site
  compromise and malicious control.

  '
remediation: 'Update all affected themes to version 2.0.0 or later to fix the vulnerability.

  '
reference:
- https://www.wordfence.com/blog/2021/03/recently-patched-vulnerability-in-thrive-themes-actively-exploited-in-the-wild
- https://wpscan.com/vulnerability/a2424354-2639-4f53-a24f-afc11f6c4cac
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
  cvss-score: 9.1
  cve-id: CVE-2021-24220
  cwe-id: CWE-434
  epss-score: 0.53243
  epss-percentile: 0.9787
  cpe: cpe:2.3:a:thrivethemes:focusblog:*:*:*:*:*:wordpress_:*:*
metadata:
  verified: true
  vendor: thrivethemes
  product: focusblog
  framework: wordpress
tags:
- cve
- cve2021
- wordpress
- wp
- wpscan
- wp-theme
- thrive
- passive
- vkev
---

## ðŸ” Vulnerability Description
Thrive â€œLegacyâ€ Rise by Thrive Themes WordPress theme before 2.0.0, Luxe by Thrive Themes WordPress theme before 2.0.0, Minus by Thrive Themes WordPress theme before 2.0.0, Ignition by Thrive Themes WordPress theme before 2.0.0, FocusBlog by Thrive Themes WordPress theme before 2.0.0, Squared by Thrive Themes WordPress theme before 2.0.0, Voice WordPress theme before 2.0.0, Performag by Thrive Themes WordPress theme before 2.0.0, Pressive by Thrive Themes WordPress theme before 2.0.0, Storied by Thrive Themes WordPress theme before 2.0.0 register a REST API endpoint to compress images using the Kraken image optimization engine. By supplying a crafted request in combination with data inserted using the Option Update vulnerability, it was possible to use this endpoint to retrieve malicious code from a remote URL and overwrite an existing file on the site with it or create a new file.This includes executable PHP files that contain malicious code.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/themes/rise/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/storied/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/minus/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_7; en-us) AppleWebKit/534.16+ (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/luxe/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/pressive/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/focusblog/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/squared/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.9
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/performag/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/voice/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-content/themes/ignition/style.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14.5) AppleWebKit/618.3.5 (KHTML, like Gecko) Version/17.4 Safari/618.3.5
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

