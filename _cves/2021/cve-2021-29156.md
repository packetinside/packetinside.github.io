---
layout: post
cve_id: CVE-2021-29156
title: LDAP Injection In OpenAM
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29156.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29156.yaml
snort2_rule: N/A
snort3_rule: N/A
author: melbadry9,xelkomy
severity: high
impact: 'Allows an attacker to execute arbitrary LDAP queries and potentially gain
  unauthorized access to sensitive information or perform unauthorized actions

  '
remediation: Upgrade to OpenAM commercial version 13.5.1 or later.
reference:
- https://github.com/sullo/advisory-archives/blob/master/Forgerock_OpenAM_LDAP_injection.md
  https://hackerone.com/reports/1278050 https://www.guidepointsecurity.com/blog/ldap-injection-in-forgerock-openam-exploiting-cve-2021-29156/
  https://portswigger.net/research/hidden-oauth-attack-vectors
- https://portswigger.net/research/hidden-oauth-attack-vectors
- https://bugster.forgerock.org/jira/browse/OPENAM-10135
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-29156
  cwe-id: CWE-74
  epss-score: 0.88035
  epss-percentile: 0.99455
  cpe: cpe:2.3:a:forgerock:openam:*:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: forgerock
  product: openam
  shodan-query:
  - http.title:"OpenAM"
  - http.title:"openam"
  fofa-query: title="openam"
  google-query: intitle:"openam"
tags:
- cve2021
- cve
- openam
- ldap
- injection
- forgerock
- vuln
---

## üîç Vulnerability Description
OpenAM contains an LDAP injection vulnerability. When a user tries to reset his password, they are asked to enter username, and then the backend validates whether the user exists or not through an LDAP query. If the user exists, the password reset token is sent to the user's email. Enumeration can allow for full password retrieval.

## üåê HTTP Request
```nohighlight
GET /openam/ui/PWResetUserValidation HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /OpenAM-11.0.0/ui/PWResetUserValidation HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6,2 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /ui/PWResetUserValidation HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

