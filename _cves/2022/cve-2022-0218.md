---
layout: post
cve_id: CVE-2022-0218
title: HTML Email Template Designer < 3.1 - Stored Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0218.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0218.yaml
snort2_rule: N/A
snort3_rule: N/A
author: hexcat
severity: medium
impact: 'An attacker can exploit this vulnerability to inject malicious scripts into
  the subject field of an email template, potentially leading to unauthorized access,
  data theft, or further compromise of the affected system.

  '
remediation: 'Update to version 3.1 or later of the HTML Email Template Designer plugin
  to fix the vulnerability.

  '
reference:
- https://www.wordfence.com/blog/2022/01/unauthenticated-xss-vulnerability-patched-in-html-email-template-designer-plugin/
- https://wordpress.org/plugins/wp-html-mail/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0218
- https://plugins.trac.wordpress.org/changeset/2656984/wp-html-mail/trunk/includes/class-template-designer.php
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-0218
  cwe-id: CWE-79
  epss-score: 0.62403
  epss-percentile: 0.98294
  cpe: cpe:2.3:a:codemiq:wordpress_email_template_designer:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 1
  vendor: codemiq
  product: wordpress_email_template_designer
  framework: wordpress
tags:
- cve
- cve2022
- wordpress
- wp-plugin
- xss
- codemiq
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WordPress Email Template Designer WP HTML Mail allows stored cross-site scripting through an unprotected REST-API endpoint.

## ðŸŒ HTTP Request
```nohighlight
GET /index.php?rest_route=/whm/v3/themesettings HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/16.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

