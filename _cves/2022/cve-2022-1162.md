---
layout: post
cve_id: CVE-2022-1162
title: GitLab CE/EE - Hard-Coded Credentials
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1162.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1162.yaml
snort2_rule: N/A
snort3_rule: N/A
author: GitLab Red Team
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access
  to sensitive information or unauthorized actions within the GitLab application.

  '
remediation: Tooling to find relevant hashes based on the semantic version ranges
  specified in the CVE is linked in the reference section below.
reference:
- https://gitlab.com/gitlab-com/gl-security/threatmanagement/redteam/redteam-public/cve-hash-harvester
- https://gitlab.com/gitlab-org/cves/-/blob/master/2022/CVE-2022-1162.json
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1162
- http://packetstormsecurity.com/files/166828/Gitlab-14.9-Authentication-Bypass.html
- https://nvd.nist.gov/vuln/detail/cve-2022-1162
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-1162
  cwe-id: CWE-798
  epss-score: 0.88627
  epss-percentile: 0.99482
  cpe: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
metadata:
  max-request: 1
  vendor: gitlab
  product: gitlab
  shodan-query:
  - http.title:"GitLab"
  - cpe:"cpe:2.3:a:gitlab:gitlab"
  - http.title:"gitlab"
  fofa-query: title="gitlab"
  google-query: intitle:"gitlab"
tags:
- cve
- cve2022
- gitlab
- packetstorm
- vuln
---

## üîç Vulnerability Description
GitLab CE/EE contains a hard-coded credentials vulnerability. A hardcoded password was set for accounts registered using an OmniAuth provider (e.g. OAuth, LDAP, SAML), allowing attackers to potentially take over accounts. This template attempts to passively identify vulnerable versions of GitLab without the need for an exploit by matching unique hashes for the application-<hash>.css file in the header for unauthenticated requests. Positive matches do not guarantee exploitability. Affected versions are 14.7 prior to 14.7.7, 14.8 prior to 14.8.5, and 14.9 prior to 14.9.2.

## üåê HTTP Request
```nohighlight
GET /users/sign_in HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

