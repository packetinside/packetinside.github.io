---
layout: post
cve_id: CVE-2023-40044
title: WS_FTP Server - Insecure Deserialization
pcap: true
pcap_path: /pcaps/2023/CVE-2023-40044.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-40044.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0x_Akoko
severity: critical
impact: 'Unauthenticated attackers can exploit .NET deserialization vulnerability
  in the Ad Hoc Transfer module to execute arbitrary commands on the WS_FTP Server,
  potentially compromising the entire file transfer infrastructure and accessing all
  transferred files.

  '
remediation: 'Update Progress WS_FTP Server to version 8.7.4 or 8.8.2 or later that
  properly validates deserialization input in the Ad Hoc Transfer module.

  '
reference:
- https://attackerkb.com/topics/bn32f9sNax/cve-2023-40044
- https://censys.com/cve-2023-40044/
- https://www.progress.com/ws_ftp
- https://www.rapid7.com/blog/post/2023/09/29/etr-critical-vulnerabilities-in-ws_ftp-server/
- https://www.theregister.com/2023/10/02/ws_ftp_update/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2023-40044
  cwe-id: CWE-502
  epss-score: 0.94449
  epss-percentile: 0.99991
  cpe: cpe:2.3:a:progress:ws_ftp_server:*:*:*:*:*:*:*:*
metadata:
  verified: true
  shodan-query: title:"Ad Hoc Transfer"
  max-request: 1
  vendor: progress
  product: ws_ftp_server
tags:
- cve
- cve2023
- ws_ftp
- kev
- passive
- vkev
---

## üîç Vulnerability Description
In WS_FTP Server versions prior to 8.7.4 and 8.8.2, a pre-authenticated attacker could leverage a .NET deserialization vulnerability in the Ad Hoc Transfer module to execute remote commands on the underlying WS_FTP Server operating system.


## üåê HTTP Request
```nohighlight
GET /AHT/AHT_UI/public/js/app.min.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

