---
layout: post
cve_id: CVE-2023-43261
title: Milesight Routers - Information Disclosure
pcap: true
pcap_path: /pcaps/2023/CVE-2023-43261.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-43261.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gy741
severity: high
impact: 'Unauthenticated attackers can access publicly exposed log files containing
  encrypted admin and user passwords, then decrypt them using the hardcoded AES key
  found in JavaScript code, gaining full administrative access to industrial cellular
  routers.

  '
remediation: 'Update Milesight Industrial Cellular Router firmware to disable directory
  listing, restrict access to log files, and remove hardcoded cryptographic keys from
  the web interface.

  '
reference:
- https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
- https://github.com/win3zz/CVE-2023-43261
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
- http://milesight.com
- http://ur5x.com
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-43261
  cwe-id: CWE-532
  epss-score: 0.93058
  epss-percentile: 0.99772
  cpe: cpe:2.3:h:milesight:ur51:-:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: milesight
  product: ur51
  shodan-query: http.html:rt_title
tags:
- cve2023
- cve
- router
- milesight
- disclosure
- unauth
- iot
- vkev
- vuln
---

## üîç Vulnerability Description
A critical security vulnerability has been identified in Milesight Industrial Cellular Routers, compromising the security of sensitive credentials and permitting unauthorized access. This vulnerability stems from a misconfiguration that results in directory listing being enabled on the router systems, rendering log files publicly accessible. These log files, while containing sensitive information such as admin and other user passwords (encrypted as a security measure), can be exploited by attackers via the router's web interface. The presence of a hardcoded AES secret key and initialization vector (IV) in the JavaScript code further exacerbates the situation, facilitating the decryption of these passwords. This chain of vulnerabilities allows malicious actors to gain unauthorized access to the router.


## üåê HTTP Request
```nohighlight
GET /lang/log/httpd.log HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/16.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

