---
layout: post
cve_id: CVE-2023-47117
title: Label Studio - Sensitive Information Exposure
pcap: true
pcap_path: /pcaps/2023/CVE-2023-47117.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-47117.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Unauthenticated attackers can leak sensitive user information including passwords
  character-by-character by exploiting Django ORM filter chains.

  '
remediation: 'Upgrade Label Studio to a patched version that addresses the ORM filter
  vulnerability.

  '
reference:
- https://security.snyk.io/vuln/SNYK-PYTHON-LABELSTUDIO-6056277
- https://nvd.nist.gov/vuln/detail/CVE-2023-47117
- https://github.com/elttam/publications
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-47117
  cwe-id: CWE-200
  epss-score: 0.65766
  epss-percentile: 0.98442
  cpe: cpe:2.3:a:humansignal:label_studio:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 4
  vendor: humansignal
  product: label_studio
  shodan-query: http.favicon.hash:-1649949475
tags:
- cve
- cve2023
- label_studio
- oss
- exposure
- authenticated
- vuln
---

## üîç Vulnerability Description
An attacker can construct a filter chain to filter tasks based on sensitive fields for all user accounts on the platform by exploiting Django's Object Relational Mapper (ORM). Since the results of query can be manipulated by the ORM filter, an attacker can leak these sensitive fields character by character.


## üåê HTTP Request
```nohighlight
GET /user/login/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /user/login/?next=/projects/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1 Safari/605.1.15
Connection: close
Content-Length: 74
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

csrfmiddlewaretoken=AXLIPr&email=T03K5r&password=rj4rjq&persist_session=on
```

