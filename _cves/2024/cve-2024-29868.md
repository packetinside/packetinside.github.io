---
layout: post
cve_id: CVE-2024-29868
title: Apache StreamPipes <= 0.93.0 - Use of Cryptographically Weak PRNG in Recovery
  Token Generation
pcap: true
pcap_path: /pcaps/2024/CVE-2024-29868.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-29868.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Alessandro Albani - DEVisions
severity: critical
impact: 'Successful exploitation of this vulnerability could allow an attacker to
  take over user accounts.

  '
remediation: 'Update to Apache StreamPipes 0.95.0 or later.

  '
reference:
- https://labs.yarix.com/2024/06/cve-2024-29868
- https://www.cve.org/CVERecord?id=CVE-2024-29868
- https://lists.apache.org/thread/g7t7zctvq2fysrw1x17flnc12592nhx7
- https://nvd.nist.gov/vuln/detail/CVE-2024-29868
classification:
  cve-id: CVE-2024-29868
  cwe-id: CWE-338
  epss-score: 0.74201
  epss-percentile: 0.98792
  cpe: cpe:2.3:a:apache:streampipes:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  shodan-query: http.title:"apache streampipes"
  fofa-query: title="apache streampipes"
  product: streampipes
  vendor: apache
tags:
- cve
- cve2024
- apache
- streampipes
- account-takeover
- passive
- vuln
---

## ðŸ” Vulnerability Description
Apache StreamPipes from version 0.69.0 through 0.93.0 uses a cryptographically weak Pseudo-Random Number Generator (PRNG) in the recovery token generation mechanism. Given a valid token it's possible to predict all past and future generated tokens.


## ðŸŒ HTTP Request
```nohighlight
GET /streampipes-backend/api/v2/auth/settings HTTP/1.1
Host: www.victim.com
User-Agent: 38El76dpBCCwvba462hSTUkvSb3
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /streampipes-backend/api/openapi.json HTTP/1.1
Host: www.victim.com
User-Agent: 38El76dpBCCwvba462hSTUkvSb3
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

