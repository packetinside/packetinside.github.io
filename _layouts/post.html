<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.cve_id }} - {{ page.title }}</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <style>
        /* í™”ë©´ ë„ˆë¹„ 95% ì‚¬ìš© */
        body { 
            box-sizing: border-box; 
            min-width: 200px; 
            max-width: 95%; 
            margin: 0 auto; 
            padding: 45px; 
        }
        @media (max-width: 767px) { body { padding: 15px; } }
        
        .header-link { font-size: 0.9em; margin-bottom: 20px; display: inline-block; text-decoration: none; }
        
        /* [ìˆ˜ì •ë¨] ì œëª© ìŠ¤íƒ€ì¼: ë§ì¤„ì„í‘œ ì œê±°, ì¤„ë°”ê¿ˆ í—ˆìš© */
        h1.page-title {
            margin-bottom: 5px;
            font-size: 2em;
            line-height: 1.3;
            
            /* ë§ì¤„ì„í‘œ ì œê±° ë° ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ */
            white-space: normal;      
            word-break: keep-all;     /* ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì¤„ë°”ê¿ˆ */
            overflow: visible;
        }

        /* íƒ­ ë° ê¸°íƒ€ ìŠ¤íƒ€ì¼ì€ ê¸°ì¡´ ìœ ì§€ */
        .tab-container { margin-top: 30px; border-bottom: 1px solid #d0d7de; }
        .tab-button {
            background: none; border: none; padding: 10px 20px; font-size: 16px; cursor: pointer;
            color: #57606a; border-bottom: 2px solid transparent; margin-bottom: -1px;
        }
        .tab-button:hover { color: #0969da; }
        .tab-button.active { font-weight: bold; color: #0969da; border-bottom: 2px solid #fd8c73; }
        
        .content-section { display: none; padding-top: 20px; animation: fadeIn 0.3s; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .meta-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .meta-table th { text-align: left; background: #f6f8fa; padding: 8px 15px; border: 1px solid #d0d7de; width: 25%; font-weight: 600; }
        .meta-table td { padding: 8px 15px; border: 1px solid #d0d7de; }
        .tag { background: #ddf4ff; color: #0969da; padding: 2px 8px; border-radius: 12px; font-size: 0.85em; margin-right: 5px; display: inline-block; margin-bottom: 2px; }
        
        .rule-box { border: 1px solid #d0d7de; border-radius: 6px; margin-bottom: 25px; overflow: hidden; }
        .rule-header { background-color: #f6f8fa; border-bottom: 1px solid #d0d7de; padding: 8px 15px; display: flex; justify-content: space-between; align-items: center; }
        .rule-title { font-weight: 600; font-size: 0.9em; color: #57606a; }

        .copy-btn { background-color: white; border: 1px solid rgba(27, 31, 35, 0.15); border-radius: 6px; cursor: pointer; color: #57606a; padding: 3px 8px; display: flex; align-items: center; transition: 0.2s; }
        .copy-btn:hover { background-color: #f3f4f6; color: #0969da; border-color: #0969da; }
        .copy-btn.success { border-color: #2da44e; color: #2da44e; }

        .rule-content { background-color: #ffffff; padding: 0; }
        .rule-content pre { margin: 0 !important; padding: 16px !important; border: none !important; border-radius: 0 !important; background-color: #ffffff !important; white-space: pre-wrap !important; word-break: break-all !important; overflow-x: hidden !important; }
        .rule-content pre code { white-space: pre-wrap !important; word-break: break-all !important; font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace !important; font-size: 13px !important; }
        .hljs { background: transparent !important; padding: 0 !important; }
    </style>
</head>
<body>
    <div class="markdown-body">
        <a href="{{ site.baseurl }}/" class="header-link">ğŸ”™ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        
        <h1 class="page-title">{{ page.cve_id }}: {{ page.title }}</h1>
        
        <div class="tab-container">
            <button class="tab-button" onclick="openTab('info')" id="btn-info">ğŸ“‹ Vulnerability Info</button>
            <button class="tab-button" onclick="openTab('rules')" id="btn-rules">ğŸ›¡ï¸ Snort Rules</button>
        </div>

        <div id="info" class="content-section">
            <table class="meta-table">
                <tr><th>Title</th><td>{{ page.title }}</td></tr>
                
                {% if page.author %}
                <tr><th>Author</th><td>{{ page.author }}</td></tr>
                {% endif %}

                {% if page.severity %}
                <tr><th>Severity</th><td style="color: #cf222e; font-weight: bold;">{{ page.severity | capitalize }}</td></tr>
                {% endif %}
                
                {% if page.impact %}
                <tr><th>Impact</th><td>{{ page.impact }}</td></tr>
                {% endif %}

                {% if page.remediation %}
                <tr><th>Remediation</th><td>{{ page.remediation }}</td></tr>
                {% endif %}

                {% if page.classification %}
                    {% if page.classification.cvss-score %}
                    <tr><th>CVSS Score</th><td>{{ page.classification.cvss-score }}</td></tr>
                    {% endif %}
                    {% if page.classification.epss-score %}
                    <tr><th>EPSS Score</th><td>{{ page.classification.epss-score }}</td></tr>
                    {% endif %}
                    {% if page.classification.cve-id %}
                    <tr><th>CVE ID</th><td>{{ page.classification.cve-id }}</td></tr>
                    {% endif %}
                    {% if page.classification.cwe-id %}
                    <tr><th>CWE ID</th><td>{{ page.classification.cwe-id }}</td></tr>
                    {% endif %}
                {% endif %}
                
                {% if page.metadata %}
                    {% if page.metadata.shodan-query %}
                    <tr><th>Shodan Query</th><td>{{ page.metadata.shodan-query }}</td></tr>
                    {% endif %}
                    {% if page.metadata.fofa-query %}
                    <tr><th>Fofa Query</th><td>{{ page.metadata.fofa-query }}</td></tr>
                    {% endif %}
                {% endif %}

                {% if page.tags %}
                <tr><th>Tags</th><td>
                    {% comment %} íƒœê·¸ê°€ ë¦¬ìŠ¤íŠ¸ì¸ì§€ ë¬¸ìì—´ì¸ì§€ í™•ì¸í•˜ì—¬ ì²˜ë¦¬ {% endcomment %}
                    {% assign tags_raw = page.tags %}
                    
                    {% if tags_raw.first %}
                        {% assign tags_list = tags_raw %} {% else %}
                        {% assign tags_list = tags_raw | split: ',' %} {% endif %}
                    
                    {% for tag in tags_list %}
                        <span class="tag">{{ tag | strip }}</span>
                    {% endfor %}
                </td></tr>
                {% endif %}
            </table>

            <div>{{ content }}</div>

            {% if page.reference %}
            <h3>ğŸ“š References</h3>
            <ul>
                {% for ref in page.reference %}
                <li><a href="{{ ref }}" target="_blank">{{ ref }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
            
            <hr>
            <div style="margin-top: 20px;">
                {% if page.nuclei_url %}
                <p><strong>ğŸ”— Nuclei Template:</strong> <a href="{{ page.nuclei_url }}" target="_blank">{{ page.nuclei_url }}</a></p>
                {% endif %}
                
                {% if page.pcap %}
                <p><strong>ğŸ¦ˆ Packet Capture:</strong> <a href="{{ site.baseurl }}{{ page.pcap_path }}" download>â¬‡ï¸ Download {{ page.cve_id | downcase }}.pcap</a></p>
                {% endif %}
            </div>
        </div>

        <div id="rules" class="content-section">
            <div style="background-color: #fff8c5; padding: 15px; border-radius: 6px; margin-bottom: 20px; border: 1px solid #d4a72c; color: #4a3b05;">âš ï¸ <strong>Notice:</strong> These rules are for detection purposes. Please tune them before applying to a production environment.</div>
            
            {% if page.snort2_rule %}
            <div class="rule-box">
                <div class="rule-header"><span class="rule-title">Snort 2 Rule</span><button class="copy-btn" onclick="copyCode(this)" aria-label="Copy"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" class="octicon octicon-copy"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></button></div>
                <div class="rule-content"><pre><code class="language-bash">{{ page.snort2_rule }}</code></pre></div>
            </div>
            {% endif %}

            {% if page.snort3_rule %}
            <div class="rule-box">
                <div class="rule-header"><span class="rule-title">Snort 3 Rule</span><button class="copy-btn" onclick="copyCode(this)" aria-label="Copy"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" class="octicon octicon-copy"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></button></div>
                <div class="rule-content"><pre><code class="language-bash">{{ page.snort3_rule }}</code></pre></div>
            </div>
            {% endif %}
            
            {% unless page.snort2_rule or page.snort3_rule %}<p>ë“±ë¡ëœ Snort Ruleì´ ì—†ìŠµë‹ˆë‹¤.</p>{% endunless %}
        </div>
    </div>

    <script>
        hljs.highlightAll();
        function openTab(tabName) {
            var contents = document.getElementsByClassName("content-section");
            var buttons = document.getElementsByClassName("tab-button");
            for (var i = 0; i < contents.length; i++) contents[i].classList.remove("active");
            for (var i = 0; i < buttons.length; i++) buttons[i].classList.remove("active");
            document.getElementById(tabName).classList.add("active");
            document.getElementById("btn-" + tabName).classList.add("active");
        }
        function copyCode(btn) {
            var box = btn.closest('.rule-box');
            var text = box.querySelector('.rule-content code').innerText;
            var clipboardIcon = '<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" class="octicon octicon-copy"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg>';
            var checkIcon = '<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" class="octicon octicon-check"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg>';
            navigator.clipboard.writeText(text).then(function() { btn.innerHTML = checkIcon; btn.classList.add("success"); setTimeout(function() { btn.innerHTML = clipboardIcon; btn.classList.remove("success"); }, 2000); }, function(err) { alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'); });
        }
        window.onload = function() { var hash = window.location.hash.substring(1); if (hash === 'rules') { openTab('rules'); } else { openTab('info'); } };
    </script>
</body>
</html>
